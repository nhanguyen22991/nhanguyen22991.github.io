"use strict";(self.webpackChunkcheapflightclient=self.webpackChunkcheapflightclient||[]).push([[2982],{2982:(ht,V,y)=>{y.r(V),y.d(V,{QuotationModalComponent:()=>we,SearchFlightResultPageComponent:()=>$r});var I=y(36895),B=y(24006),J=y(83700),Y=y(88516),x=y(72506),Me=y(19010),gt=y(24513),z=y(67534),re=y(40105),E=y(44890),pt=y(65441),M=y(27361),T=y(88001),L=y(40899),ne=y(51948);const R=r=>!["Kh\xf4ng","0 kg","0 KG","0 Kg"].includes(r);var Re=y(17489),f=y(15439),W=y(77296),Be=y(61135),mt=y(77579),Le=y(82722),X=y(28746),ft=y(56451),U=y(39646),j=y(46590),$=y(54004),H=y(15861),q=y(10908),Qe=y(27898),e=y(94650);let _t=(()=>{class r{constructor(){this.percent=0,this.text="",this.circumference=60*Math.PI}ngOnInit(){}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275cmp=e.Xpm({type:r,selectors:[["cf-progress"]],inputs:{percent:"percent",text:"text"},standalone:!0,features:[e.jDz],decls:15,vars:4,consts:[[1,"flex","justify-center","flex-col","items-center"],[1,"flex","items-center","justify-center","overflow-hidden","rounded-full"],[1,"w-20","h-20"],["stroke-width","5","stroke","currentColor","fill","transparent","r","30","cx","40","cy","40",1,"text-neutral-gray-1"],["stroke-width","5","stroke-linecap","round","stroke","currentColor","fill","transparent","r","30","cx","40","cy","40",1,"text-secondary-5-4"],[1,"absolute","text-body-md","text-secondary-5-4"],[1,"text-body-md","text-secondary-5-4"],[1,"dot-one"],[1,"dot-two"],[1,"dot-three"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1),e.O4$(),e.TgZ(2,"svg",2),e._UZ(3,"circle",3)(4,"circle",4),e.qZA(),e.kcU(),e.TgZ(5,"span",5),e._uU(6),e.qZA()(),e.TgZ(7,"div",6),e._uU(8),e.TgZ(9,"span",7),e._uU(10," ."),e.qZA(),e.TgZ(11,"span",8),e._uU(12," ."),e.qZA(),e.TgZ(13,"span",9),e._uU(14," ."),e.qZA()()()),2&t&&(e.xp6(4),e.uIk("stroke-dasharray",i.circumference)("stroke-dashoffset",i.circumference-i.percent/100*i.circumference),e.xp6(2),e.hij("",i.percent,"%"),e.xp6(2),e.hij("",i.text," "))},styles:["span[class^=dot-][_ngcontent-%COMP%]{opacity:0}.dot-one[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_dot-one 2s infinite linear}.dot-two[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_dot-two 2s infinite linear}.dot-three[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_dot-three 2s infinite linear}@keyframes _ngcontent-%COMP%_dot-one{0%{opacity:0}15%{opacity:0}25%{opacity:1}to{opacity:1}}@keyframes _ngcontent-%COMP%_dot-two{0%{opacity:0}25%{opacity:0}50%{opacity:1}to{opacity:1}}@keyframes _ngcontent-%COMP%_dot-three{0%{opacity:0}50%{opacity:0}75%{opacity:1}to{opacity:1}}"]}),r})();var le,He=y(19123),oe=y(48373),se=y(62331);const G=typeof window<"u"?null===(le=window.navigator)||void 0===le?void 0:le.userAgent:void 0,vt=(null==G?void 0:G.includes("AppleWebKit"))&&!(null!=G&&G.includes("Chrome"));function ce(r){const l=[];for(let t=0,i=r.length;t<i;t++)l.push(r[t]);return l}function Je(r,l){return`data:${l};base64,${r}`}function Oe(r,l,t){return he.apply(this,arguments)}function he(){return(he=(0,H.Z)(function*(r,l,t){const i=yield fetch(r,l);if(404===i.status)throw new Error(`Resource "${i.url}" not found`);const a=yield i.blob();return new Promise((n,o)=>{const s=new FileReader;s.onerror=o,s.onloadend=()=>{try{n(t({res:i,result:s.result}))}catch(d){o(d)}},s.readAsDataURL(a)})})).apply(this,arguments)}const ge={};function Ue(r,l,t){return pe.apply(this,arguments)}function pe(){return(pe=(0,H.Z)(function*(r,l,t){const i=function Ft(r,l,t){let i=r.replace(/\?.*/,"");return t&&(i=r),/ttf|otf|eot|woff2?/i.test(i)&&(i=i.replace(/.*\//,"")),l?`[${l}]${i}`:i}(r,l,t.includeQueryParams);if(null!=ge[i])return ge[i];let a;t.cacheBust&&(r+=(/\?/.test(r)?"&":"?")+(new Date).getTime());try{const n=yield Oe(r,t.fetchRequestInit,({res:o,result:s})=>(l||(l=o.headers.get("Content-Type")||""),function xt(r){return r.split(/,/)[1]}(s)));a=Je(n,l)}catch(n){a=t.imagePlaceholder||"";let o=`Failed to fetch resource: ${r}`;n&&(o="string"==typeof n?n:n.message),o&&console.warn(o)}return ge[i]=a,a})).apply(this,arguments)}const Ye="application/font-woff",qe="image/jpeg",kt={woff:Ye,woff2:Ye,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:qe,jpeg:qe,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml",webp:"image/webp"};function Ge(r){const l=function Pt(r){const l=/\.([^./]*?)$/g.exec(r);return l?l[1]:""}(r).toLowerCase();return kt[l]||""}const je=/url\((['"]?)([^'"]+?)\1\)/g,It=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,At=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function me(){return(me=(0,H.Z)(function*(r,l,t,i,a){try{const n=t?function Tt(r,l){if(r.match(/^[a-z]+:\/\//i))return r;if(r.match(/^\/\//))return window.location.protocol+r;if(r.match(/^[a-z]+:/i))return r;const t=document.implementation.createHTMLDocument(),i=t.createElement("base"),a=t.createElement("a");return t.head.appendChild(i),t.body.appendChild(a),l&&(i.href=l),a.href=r,a.href}(l,t):l,o=Ge(l);let s;return s=a?Je(yield a(n),o):yield Ue(n,o,i),r.replace(function Et(r){const l=r.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1");return new RegExp(`(url\\(['"]?)(${l})(['"]?\\))`,"g")}(l),`$1${s}$3`)}catch{}return r})).apply(this,arguments)}function $e(r){return-1!==r.search(je)}function fe(){return fe=(0,H.Z)(function*(r,l,t){if(!$e(r))return r;const i=function Zt(r,{preferredFontFormat:l}){return l?r.replace(At,t=>{for(;;){const[i,,a]=It.exec(t)||[];if(!a)return"";if(a===l)return`src: ${i};`}}):r}(r,t);return function wt(r){const l=[];return r.replace(je,(t,i,a)=>(l.push(a),t)),l.filter(t=>!function Dt(r){return-1!==r.search(/^(data:)/)}(t))}(i).reduce((n,o)=>n.then(s=>function Nt(r,l,t,i,a){return me.apply(this,arguments)}(s,o,l,t)),Promise.resolve(i))}),fe.apply(this,arguments)}const Ke={};function Ve(r){return _e.apply(this,arguments)}function _e(){return(_e=(0,H.Z)(function*(r){let l=Ke[r];return null!=l||(l={url:r,cssText:yield(yield fetch(r)).text()},Ke[r]=l),l})).apply(this,arguments)}function ze(r,l){return ve.apply(this,arguments)}function ve(){return ve=(0,H.Z)(function*(r,l){let t=r.cssText;const i=/url\(["']?([^"')]+)["']?\)/g,n=(t.match(/url\([^)]+\)/g)||[]).map(function(){var o=(0,H.Z)(function*(s){let d=s.replace(i,"$1");return d.startsWith("https://")||(d=new URL(d,r.url).href),Oe(d,l.fetchRequestInit,({result:u})=>(t=t.replace(s,`url(${u})`),[s,u]))});return function(s){return o.apply(this,arguments)}}());return Promise.all(n).then(()=>t)}),ve.apply(this,arguments)}function We(r){if(null==r)return[];const l=[];let i=r.replace(/(\/\*[\s\S]*?\*\/)/gi,"");const a=new RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");for(;;){const d=a.exec(i);if(null===d)break;l.push(d[0])}i=i.replace(a,"");const n=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi,s=new RegExp("((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})","gi");for(;;){let d=n.exec(i);if(null===d){if(d=s.exec(i),null===d)break;n.lastIndex=s.lastIndex}else s.lastIndex=n.lastIndex;l.push(d[0])}return l}function Te(){return(Te=(0,H.Z)(function*(r,l){const t=[],i=[];return r.forEach(a=>{if("cssRules"in a)try{ce(a.cssRules||[]).forEach((n,o)=>{if(n.type===CSSRule.IMPORT_RULE){let s=o+1;const u=Ve(n.href).then(g=>ze(g,l)).then(g=>We(g).forEach(c=>{try{a.insertRule(c,c.startsWith("@import")?s+=1:a.cssRules.length)}catch(h){console.error("Error inserting rule from remote css",{rule:c,error:h})}})).catch(g=>{console.error("Error loading remote css",g.toString())});i.push(u)}})}catch(n){const o=r.find(s=>null==s.href)||document.styleSheets[0];null!=a.href&&i.push(Ve(a.href).then(s=>ze(s,l)).then(s=>We(s).forEach(d=>{o.insertRule(d,a.cssRules.length)})).catch(s=>{console.error("Error loading remote stylesheet",s)})),console.error("Error inlining remote css file",n)}}),Promise.all(i).then(()=>(r.forEach(a=>{if("cssRules"in a)try{ce(a.cssRules||[]).forEach(n=>{t.push(n)})}catch(n){console.error(`Error while reading CSS rules from ${a.href}`,n)}}),t))})).apply(this,arguments)}function ye(){return ye=(0,H.Z)(function*(r,l){if(null==r.ownerDocument)throw new Error("Provided element is not within a Document");const t=ce(r.ownerDocument.styleSheets),i=yield function Rt(r,l){return Te.apply(this,arguments)}(t,l);return function Bt(r){return r.filter(l=>l.type===CSSRule.FONT_FACE_RULE).filter(l=>$e(l.style.getPropertyValue("src")))}(i)}),ye.apply(this,arguments)}function Ce(){return Ce=(0,H.Z)(function*(r,l){let t=yield function Lt(r,l){return ye.apply(this,arguments)}(r,l);return l.includeFontSrc&&(t=t.filter(a=>{var n;return null===(n=l.includeFontSrc)||void 0===n?void 0:n.some(o=>a.cssText.includes(o))})),(yield Promise.all(t.map(a=>function Mt(r,l,t){return fe.apply(this,arguments)}(a.cssText,a.parentStyleSheet?a.parentStyleSheet.href:null,l)))).join("\n")}),Ce.apply(this,arguments)}function et(r){return Ie.apply(this,arguments)}function Ie(){return(Ie=(0,H.Z)(function*(r,l={}){return function Xe(r,l){return Ce.apply(this,arguments)}(r,l)})).apply(this,arguments)}var tt=y(94327),Ht=y(47822),Jt=y(25650),it=y(74710),Ae=y(4128),ie=y(88996),at=y(49770),rt=y(44143),K=y(97579),nt=y(82761),Ee=y(21174);function Ot(r,l){if(1&r&&(e.ynx(0),e.TgZ(1,"div",16)(2,"div",17),e._UZ(3,"img",18),e.TgZ(4,"span",19),e._uU(5),e.qZA()(),e._UZ(6,"cf-input-number",20),e.TgZ(7,"span",21),e._uU(8,"\u0111"),e.qZA()(),e.BQk()),2&r){const t=l.$implicit,i=e.oxw();let a,n;e.xp6(3),e.Q6J("src",null==(a=i.getSurchargeItem(t))?null:a.logo,e.LSH),e.xp6(2),e.Oqu("GDS"===(null==(n=i.getSurchargeItem(t))?null:n.airline)?"1A, 1G":null==(n=i.getSurchargeItem(t))?null:n.airline),e.xp6(1),e.Q6J("placeholder","0")("negative",!1)("formControl",i.getFormControlInSurcharges(t))}}function Ut(r,l){if(1&r){const t=e.EpF();e.TgZ(0,"div")(1,"cf-checkbox",22),e.NdJ("checkChange",function(a){e.CHM(t);const n=e.oxw();return e.KtG(n.checkChange(a))}),e._uU(2," \u0110\u1eb7t l\xe0m m\u1ee9c ph\xed ph\u1ee5 thu m\u1eb7c \u0111\u1ecbnh "),e.qZA()()}if(2&r){const t=e.oxw();e.xp6(1),e.Q6J("checked",t.hasDefaultConfig)}}function Yt(r,l){if(1&r){const t=e.EpF();e.TgZ(0,"button",10),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.gotoSettings())}),e._UZ(1,"cf-icon",11),e.qZA()}}function qt(r,l){1&r&&e._UZ(0,"cf-spinner")}let ot=(()=>{class r{constructor(t,i,a,n,o,s,d,u,g,c,h){this.ref=i,this.fb=a,this.bottomSheetRefDialog=n,this.bottomSheetData=o,this.bottomSheetRef=s,this._modal=d,this._route=u,this._generalService=g,this._toastService=c,this._permissionService=h,this.hasDefaultConfig=!1,this.isUpdateSurchargeFee=this._permissionService.hasPermission(L.or.CreateOrUpdateSurchargeFeeConfig)&&this._permissionService.hasPermission(L.or.ViewSurchargeFeeConfig),this.surchargeConfigs=[],this.isLoading=!1,this.isChangeConfig=!1,t.registerIcons([x.UNF,x.Xzk]),this.surcharges=i?i.data.surcharges:o.surcharges,this.surchargeConfigs=i?i.data.surchargeConfigs:o.surchargeConfigs}ngOnInit(){this.initFormGroup(),this.formGroup.valueChanges.subscribe(()=>{this.isChangeConfig=!0})}initFormGroup(){this.formGroup=this.fb.group({surcharges:this.fb.array(this.surcharges.map(t=>this.fb.group({airline:[t.airline],surchargePrice:[t.surchargePrice]})))})}onSubmit(){let i={};this.formGroup.value.surcharges.forEach(a=>{i[a.airline]=a.surchargePrice}),this.surcharges=this.surcharges.map(a=>(a.surchargePrice=i[a.airline],a)),this.saveConfig(()=>this.ref.close(this.surcharges))}onMobileSubmit(){let i={};this.formGroup.value.surcharges.forEach(a=>{i[a.airline]=a.surchargePrice}),this.surcharges=this.surcharges.map(a=>(a.surchargePrice=i[a.airline],a)),this.saveConfig(()=>this.bottomSheetRef.dismiss(this.surcharges))}saveConfig(t){var i;if(this.hasDefaultConfig){const a=(null===(i=this.surchargeConfigs)||void 0===i?void 0:i.map(n=>{const o=this.surcharges.find(s=>"LCC"===s.airline&&"FLY_ONE"===n.airline||s.airline===n.airline);return Object.assign(Object.assign({},n),{amount:o?o.surchargePrice:n.amount})}))||[];this.isLoading=!0,this._generalService.updateSurchargeFeeConfig(a).pipe((0,X.x)(()=>{this.isLoading=!1,t()})).subscribe({next:n=>{var o,s;if(n.success)this._toastService.add({severity:"success",summary:"C\u1eadp nh\u1eadt th\xe0nh c\xf4ng",detail:"C\u1eadp nh\u1eadt th\xf4ng tin c\u1ea5u h\xecnh th\xe0nh c\xf4ng!",sticky:!1});else{const d=null===(s=null===(o=n.objectError)||void 0===o?void 0:o.errorDescription)||void 0===s?void 0:s.vi;this._toastService.add({severity:"error",summary:"C\xf3 l\u1ed7i x\u1ea3y ra",detail:d||"Kh\xf4ng th\u1ec3 c\u1eadp nh\u1eadt c\u1ea5u h\xecnh m\u1edbi. Vui l\xf2ng th\u1eed l\u1ea1i!",sticky:!0})}},error:()=>{this._toastService.add({severity:"error",summary:"C\xf3 l\u1ed7i x\u1ea3y ra",detail:"Kh\xf4ng th\u1ec3 c\u1eadp nh\u1eadt c\u1ea5u h\xecnh m\u1edbi. Vui l\xf2ng th\u1eed l\u1ea1i!",sticky:!0})}})}else t()}onClose(){this.ref.close(!1)}getSurchargesForms(){return this.formGroup.controls.surcharges}getSurchargeItem(t){return this.surcharges.find(i=>i.airline===t.value.airline)}getFormControlInSurcharges(t){return t.controls.surchargePrice}checkChange(t){this.hasDefaultConfig=t}gotoSettings(){const t=()=>{this.bottomSheetRefDialog&&this.bottomSheetRefDialog.closeAll(),this._modal.closeAllModals(),this._route.navigate(["admin/general"])};this.isChangeConfig?this._modal.open(z.V0,{title:"H\u1ee7y b\u1ecf thay \u0111\u1ed5i?",body:"B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n h\u1ee7y b\u1ecf thay \u0111\u1ed5i v\xe0 d\u1eebng vi\u1ec7c ch\u1ec9nh s\u1eeda? H\xe0nh \u0111\u1ed9ng n\xe0y kh\xf4ng th\u1ec3 ho\xe0n t\xe1c.",okText:"C\xf3, h\u1ee7y b\u1ecf",cancelText:"Kh\xf4ng, ti\u1ebfp t\u1ee5c",isSecondary:!0}).afterClosed$.subscribe({next:a=>{a.data&&t()}}):t()}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(x.KNP),e.Y36(K.gb,8),e.Y36(B.qu),e.Y36(q.a2,8),e.Y36(q.Rr,8),e.Y36(q.Zu,8),e.Y36(K.oE),e.Y36(nt.F0),e.Y36(Ee.m),e.Y36(se.BX),e.Y36(L.$A))},r.\u0275cmp=e.Xpm({type:r,selectors:[["cf-surcharge-modal"]],hostAttrs:[1,"md:w-full"],standalone:!0,features:[e.jDz],decls:21,vars:5,consts:[[1,"w-[400px]","bg-white","rounded-lg","md:w-full"],[1,"flex","justify-between","items-center","px-6","py-[13px]","md:hidden"],[1,"text-heading-sm","text-neutral-black"],["size","medium","icon","close",1,"text-neutral-gray-4","cursor-pointer",3,"click"],[1,"px-6","py-4","md:w-full","md:p-4","md:pt-5"],[1,"max-h-[500px]","overflow-y-auto",3,"formGroup"],[1,"flex","flex-col","gap-y-3"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"items-center","hidden","md:flex","mt-6","gap-x-4"],["cf-button","","size","medium","type","secondary",1,"bg-white",3,"click"],["size","small","icon","settings"],["cf-button","","size","medium",1,"hidden","justify-center","items-center","md:flex","w-full",3,"click"],[1,"flex","justify-between","items-center","py-4","px-6","md:hidden"],["cf-button","","size","medium","type","secondary","class","bg-white",3,"click",4,"ngIf"],["cf-button","","size","medium",3,"click"],[1,"w-full","h-10","flex","justify-between","border","border-neutral-gray-1","rounded"],[1,"w-[130px]","shrink-0","flex","gap-x-2","border-r","border-neutral-gray-1","py-2.5","px-4"],[1,"h-5","w-10","object-contain",3,"src"],[1,"text-body-md"],["size","medium",1,"pl-4",3,"placeholder","negative","formControl"],[1,"text-body-md-short","px-3","py-2"],["size","medium",3,"checked","checkChange"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._uU(3,"Ch\u1ec9nh ph\xed ph\u1ee5 thu"),e.qZA(),e.TgZ(4,"cf-icon",3),e.NdJ("click",function(){return i.onClose()}),e.qZA()(),e.TgZ(5,"div",4)(6,"form",5)(7,"div",6),e.YNc(8,Ot,9,5,"ng-container",7),e.YNc(9,Ut,3,1,"div",8),e.qZA()(),e.TgZ(10,"div",9)(11,"button",10),e.NdJ("click",function(){return i.gotoSettings()}),e._UZ(12,"cf-icon",11),e.qZA(),e.TgZ(13,"button",12),e.NdJ("click",function(){return i.onMobileSubmit()}),e._uU(14,"X\xe1c nh\u1eadn"),e.qZA()()(),e.TgZ(15,"div",13)(16,"div"),e.YNc(17,Yt,2,0,"button",14),e.qZA(),e.TgZ(18,"button",15),e.NdJ("click",function(){return i.onSubmit()}),e._uU(19," C\u1eadp nh\u1eadt "),e.qZA()()(),e.YNc(20,qt,1,0,"cf-spinner",8)),2&t&&(e.xp6(6),e.Q6J("formGroup",i.formGroup),e.xp6(2),e.Q6J("ngForOf",i.getSurchargesForms().controls),e.xp6(1),e.Q6J("ngIf",i.isUpdateSurchargeFee),e.xp6(8),e.Q6J("ngIf",i.isUpdateSurchargeFee),e.xp6(3),e.Q6J("ngIf",i.isLoading))},dependencies:[I.ez,I.sg,I.O5,B.u5,B._Y,B.JJ,B.JL,x.AxE,x.Sm8,J.N8,J.Xq,rt.j$,rt.lt,B.UX,B.oH,B.sg,Qe.u,z.OR],encapsulation:2}),r})();const Gt=["quotationGraphic"],jt=["quotationGraphicPDF"],st=function(r,l,t){return{listTicket:r,paddingBottomHeight:l,isShowHeader:t}};function $t(r,l){if(1&r&&(e.TgZ(0,"div",null,2),e.GkF(2,3),e.qZA()),2&r){const t=l.$implicit;e.oxw();const i=e.MAs(5);e.xp6(2),e.Q6J("ngTemplateOutlet",i)("ngTemplateOutletContext",e.kEZ(2,st,t.listTicket,t.paddingBottomHeight,t.isShowHeader))}}function Kt(r,l){if(1&r&&(e.TgZ(0,"div",null,4),e.GkF(2,3),e.qZA()),2&r){const t=l.$implicit;e.oxw();const i=e.MAs(5);e.xp6(2),e.Q6J("ngTemplateOutlet",i)("ngTemplateOutletContext",e.kEZ(2,st,t.listTicket,t.paddingBottomHeight,t.isShowHeader))}}function Vt(r,l){if(1&r&&e._UZ(0,"img",20),2&r){const t=e.oxw(3);e.Q6J("src",t.agentInfo.logoUrl,e.LSH)}}function zt(r,l){1&r&&(e.O4$(),e.TgZ(0,"svg",21),e._UZ(1,"path",22),e.TgZ(2,"defs")(3,"linearGradient",23),e._UZ(4,"stop",24)(5,"stop",25),e.qZA()()())}function Wt(r,l){if(1&r&&(e.TgZ(0,"div",26)(1,"div",27),e._uU(2,"\u0110\u1ecba ch\u1ec9:"),e.qZA(),e.TgZ(3,"div",28),e._uU(4),e.qZA()()),2&r){const t=e.oxw(3);e.xp6(4),e.Oqu(t.agentInfo.address)}}function Xt(r,l){if(1&r&&(e.TgZ(0,"div",26)(1,"div",27),e._uU(2,"Email:"),e.qZA(),e.TgZ(3,"div",28),e._uU(4),e.qZA()()),2&r){const t=e.oxw(3);e.xp6(4),e.Oqu(t.agentInfo.email)}}function ei(r,l){if(1&r&&(e.TgZ(0,"div",26)(1,"div",27),e._uU(2,"Website:"),e.qZA(),e.TgZ(3,"div",28),e._uU(4),e.qZA()()),2&r){const t=e.oxw(3);e.xp6(4),e.Oqu(t.agentInfo.website)}}function ti(r,l){if(1&r&&(e.TgZ(0,"div",26)(1,"div",27),e._uU(2,"Hotline:"),e.qZA(),e.TgZ(3,"div",28),e._uU(4),e.qZA()()),2&r){const t=e.oxw(3);e.xp6(4),e.Oqu(t.agentInfo.phone)}}function ii(r,l){if(1&r&&(e.TgZ(0,"div",11)(1,"div",12)(2,"div"),e.YNc(3,Vt,1,1,"img",13),e.YNc(4,zt,6,0,"svg",14),e.qZA(),e.TgZ(5,"div",15)(6,"div",16),e._uU(7,"Ph\xf2ng v\xe9"),e.qZA(),e.TgZ(8,"div",17),e._uU(9),e.qZA()()(),e.TgZ(10,"div",18),e.YNc(11,Wt,5,1,"div",19),e.YNc(12,Xt,5,1,"div",19),e.YNc(13,ei,5,1,"div",19),e.YNc(14,ti,5,1,"div",19),e.qZA()()),2&r){const t=e.oxw(2);e.xp6(3),e.Q6J("ngIf",t.agentInfo.logoUrl),e.xp6(1),e.Q6J("ngIf",!t.agentInfo.logoUrl),e.xp6(5),e.Oqu(t.agentInfo.displayName),e.xp6(2),e.Q6J("ngIf",t.agentInfo.address),e.xp6(1),e.Q6J("ngIf",t.agentInfo.email),e.xp6(1),e.Q6J("ngIf",t.agentInfo.website),e.xp6(1),e.Q6J("ngIf",t.agentInfo.phone)}}function ai(r,l){if(1&r&&(e.TgZ(0,"div",29)(1,"div",30)(2,"div",31),e._uU(3),e.qZA()(),e.TgZ(4,"div",32),e._uU(5),e.ALo(6,"date"),e.qZA()()),2&r){const t=e.oxw(2);e.xp6(3),e.AsE(" C\xe1c chuy\u1ebfn bay ch\u1eb7ng ",t.journey.startPointName," - ",t.journey.endPointName," "),e.xp6(2),e.hij(" ",e.xi3(6,3,t.journey.departDateQuotation,"EEEE, d MMMM, yyyy")," ")}}function ri(r,l){1&r&&(e.TgZ(0,"div",37),e._uU(1,"T\u1ed5ng chi ph\xed"),e.qZA())}function ni(r,l){if(1&r&&(e.TgZ(0,"div",33)(1,"div",34),e._uU(2,"H\xe3ng bay"),e.qZA(),e.TgZ(3,"div",35),e._uU(4,"C\u1ea5t c\xe1nh"),e.qZA(),e.TgZ(5,"div",35),e._uU(6,"H\u1ea1 c\xe1nh"),e.qZA(),e.TgZ(7,"div",35),e._uU(8,"Chuy\u1ebfn bay"),e.qZA(),e.TgZ(9,"div",35),e._uU(10,"S\u1ed1 \u0111i\u1ec3m d\u1eebng"),e.qZA(),e.YNc(11,ri,2,0,"div",36),e.qZA()),2&r){const t=e.oxw(2);e.xp6(11),e.Q6J("ngIf",!t.hiddenCharge)}}function oi(r,l){1&r&&(e.TgZ(0,"div",49),e._uU(1,"Bay th\u1eb3ng"),e.qZA())}function si(r,l){if(1&r&&(e.TgZ(0,"div"),e._uU(1),e.TgZ(2,"span",50),e._uU(3,"\u0111i\u1ec3m d\u1eebng"),e.qZA()()),2&r){const t=e.oxw().$implicit;e.xp6(1),e.hij("",t.stopStatus," ")}}function li(r,l){if(1&r&&(e.TgZ(0,"div",54),e._uU(1),e.ALo(2,"number"),e.qZA()),2&r){const t=e.oxw(2).$implicit;e.xp6(1),e.hij(" ",e.lcZ(2,1,t.netPrice+t.surcharge)," \u0111 ")}}function ci(r,l){if(1&r&&(e.TgZ(0,"div",54),e._uU(1),e.ALo(2,"number"),e.qZA()),2&r){const t=e.oxw(2).$implicit;e.xp6(1),e.hij(" ",e.lcZ(2,1,t.totalPrice+t.surcharge)," \u0111 ")}}function di(r,l){if(1&r&&(e.TgZ(0,"div",55),e._uU(1),e.qZA()),2&r){const t=e.oxw(2).$implicit;e.xp6(1),e.AsE("",t.cabin," (",t.fareClass,")")}}function ui(r,l){if(1&r&&(e.TgZ(0,"div",51),e.YNc(1,li,3,3,"div",52),e.YNc(2,ci,3,3,"div",52),e.YNc(3,di,2,2,"div",53),e.qZA()),2&r){const t=e.oxw().$implicit,i=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.showNetPrice),e.xp6(1),e.Q6J("ngIf",!t.showNetPrice),e.xp6(1),e.Q6J("ngIf",!i.isHiddenCabin)}}function hi(r,l){if(1&r&&(e.TgZ(0,"div",56),e._UZ(1,"cf-icon",57),e.TgZ(2,"span"),e._uU(3),e.qZA()()),2&r){const t=e.oxw().$implicit;e.xp6(3),e.hij("Li\xean danh (do ",t.operatingName," \u0111i\u1ec1u h\xe0nh)")}}function gi(r,l){if(1&r&&(e.TgZ(0,"div",38)(1,"div",39)(2,"div",40)(3,"div",41),e._UZ(4,"img",42)(5,"img",43),e.qZA(),e.TgZ(6,"div",44),e._uU(7),e.ALo(8,"date"),e.qZA(),e.TgZ(9,"div",44),e._uU(10),e.ALo(11,"date"),e.qZA(),e.TgZ(12,"div",44),e._uU(13),e.qZA(),e.TgZ(14,"div",44),e.YNc(15,oi,2,0,"div",45),e.YNc(16,si,4,1,"div",46),e.qZA(),e.YNc(17,ui,4,3,"div",47),e.qZA(),e.YNc(18,hi,4,1,"div",48),e.qZA()()),2&r){const t=l.$implicit,i=e.oxw(2);e.ekj("h-[64px]",!t.isJointBenture)("h-[88px]",t.isJointBenture),e.xp6(5),e.Q6J("src",t.airlineLogo,e.LSH),e.xp6(2),e.hij(" ",e.xi3(8,12,t.departure.localTime,"HH:mm")," "),e.xp6(3),e.hij(" ",e.xi3(11,15,t.arrival.localTime,"HH:mm")," "),e.xp6(3),e.hij(" ",t.flightNumber," "),e.xp6(2),e.Q6J("ngIf",0===t.stopStatus),e.xp6(1),e.Q6J("ngIf",0!==t.stopStatus),e.xp6(1),e.Q6J("ngIf",!i.hiddenCharge),e.xp6(1),e.Q6J("ngIf",t.isJointBenture)}}function pi(r,l){if(1&r&&(e.TgZ(0,"div",5),e.YNc(1,ii,15,7,"div",6),e.YNc(2,ai,7,6,"div",7),e.YNc(3,ni,12,1,"div",8),e.YNc(4,gi,19,18,"div",9),e._UZ(5,"div",10),e.qZA()),2&r){const t=l.listTicket,i=l.paddingBottomHeight,a=l.isShowHeader;e.xp6(1),e.Q6J("ngIf",a),e.xp6(1),e.Q6J("ngIf",a),e.xp6(1),e.Q6J("ngIf",a),e.xp6(1),e.Q6J("ngForOf",t),e.xp6(1),e.Udp("padding-bottom",i,"px")}}let mi=(()=>{class r{get listTicket(){return this._listTicket}set listTicket(t){this._listTicket=t,this.initImageListTicketGroup(),this.initPdfListTicketGroup()}constructor(t){this.hiddenCharge=!1,this.listTicketGroup=[],this.listPdfTicketGroup=[],this.A4_HEIGHT=1063,this.A4_PADDING_BOTTOM=16,this.HEADER_HEIGHT=285,this.CONTENT_HEIGHT=this.A4_HEIGHT-this.HEADER_HEIGHT-this.A4_PADDING_BOTTOM,this.PDF_CONTENT_HEIGHT=this.A4_HEIGHT-2*this.A4_PADDING_BOTTOM,this.ONE_BASIC_TICKET_HEIGHT=64,this.ONE_BENTURE_TICKET_HEIGHT=88,t.registerIcons([x.B2I])}initImageListTicketGroup(){this.listTicketGroup=[];let t=0,i=[];this.listTicket.forEach(a=>{let n=0;n=a.isJointBenture?this.ONE_BENTURE_TICKET_HEIGHT:this.ONE_BASIC_TICKET_HEIGHT,t+n<=this.CONTENT_HEIGHT?(i.push(a),t+=n):(this.listTicketGroup.push({listTicket:i.map(o=>o),paddingBottomHeight:this.CONTENT_HEIGHT-t,isShowHeader:!0}),i=[],t=n,i.push(a))}),i.length>0&&this.listTicketGroup.push({listTicket:i.map(a=>a),paddingBottomHeight:this.CONTENT_HEIGHT-t,isShowHeader:!0}),this.listTicketGroup.forEach(a=>{let n=301;a.listTicket.forEach(o=>{n+=o.isJointBenture?this.ONE_BENTURE_TICKET_HEIGHT:this.ONE_BASIC_TICKET_HEIGHT})})}initPdfListTicketGroup(){this.listPdfTicketGroup=[];let t=0,i=[];this.listTicket.forEach(a=>{let n=0;n=a.isJointBenture?this.ONE_BENTURE_TICKET_HEIGHT:this.ONE_BASIC_TICKET_HEIGHT,t+n<=(0==this.listPdfTicketGroup.length?this.CONTENT_HEIGHT:this.PDF_CONTENT_HEIGHT)?(i.push(a),t+=n):(this.listPdfTicketGroup.push({listTicket:i.map(o=>o),paddingBottomHeight:(0==this.listPdfTicketGroup.length?this.CONTENT_HEIGHT:this.PDF_CONTENT_HEIGHT)-t,isShowHeader:0==this.listPdfTicketGroup.length}),i=[],t=n,i.push(a))}),i.length>0&&this.listPdfTicketGroup.push({listTicket:i.map(a=>a),paddingBottomHeight:(0==this.listPdfTicketGroup.length?this.CONTENT_HEIGHT:this.PDF_CONTENT_HEIGHT)-t,isShowHeader:0==this.listPdfTicketGroup.length}),this.listPdfTicketGroup.forEach((a,n)=>{let o=0===n?301:32;a.listTicket.forEach(s=>{o+=s.isJointBenture?this.ONE_BENTURE_TICKET_HEIGHT:this.ONE_BASIC_TICKET_HEIGHT})})}getChildNodes(){}getNativeElement(){return this.quotationGraphic}getPDFNativeElement(){return this.quotationGraphicPDF}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(x.KNP))},r.\u0275cmp=e.Xpm({type:r,selectors:[["cf-quotation-graphic"]],viewQuery:function(t,i){if(1&t&&(e.Gf(Gt,5),e.Gf(jt,5)),2&t){let a;e.iGM(a=e.CRH())&&(i.quotationGraphic=a),e.iGM(a=e.CRH())&&(i.quotationGraphicPDF=a)}},inputs:{listTicket:"listTicket",journey:"journey",agentInfo:"agentInfo",isHiddenCabin:"isHiddenCabin",cabinName:"cabinName",hiddenCharge:"hiddenCharge"},standalone:!0,features:[e.jDz],decls:6,vars:2,consts:[[4,"ngFor","ngForOf"],["quotationTemplate",""],["quotationGraphic",""],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["quotationGraphicPDF",""],[1,"w-[752px]","bg-neutral-white","p-4","!whitespace-nowrap"],["class","w-full p-4 rounded bg-gradient-to-r from-[#013f51] from-10% via-[#006885] via-30% to-[#006885] to-90% flex items-center gap-x-8 mb-6 h-[132px]",4,"ngIf"],["class","w-full rounded-tl-lg rounded-tr-lg border border-b-0 border-neutral-gray-1 p-4",4,"ngIf"],["class","flex gap-x-[1px]",4,"ngIf"],["class","w-full  last:rounded-bl-lg last:rounded-br-lg",3,"h-[64px]","h-[88px]",4,"ngFor","ngForOf"],[1,"w-full"],[1,"w-full","p-4","rounded","bg-gradient-to-r","from-[#013f51]","from-10%","via-[#006885]","via-30%","to-[#006885]","to-90%","flex","items-center","gap-x-8","mb-6","h-[132px]"],[1,"flex","items-center","gap-x-3"],["class","w-10 h-10 object-cover rounded-full",3,"src",4,"ngIf"],["width","32","height","20","viewBox","0 0 32 20","fill","none","xmlns","http://www.w3.org/2000/svg",4,"ngIf"],[1,"flex","flex-col","gap-y-1","text-white"],[1,"text-body-sm","opacity-80"],[1,"text-heading-xs"],[1,"flex","flex-col","gap-y-1"],["class","flex gap-x-3",4,"ngIf"],[1,"w-10","h-10","object-cover","rounded-full",3,"src"],["width","32","height","20","viewBox","0 0 32 20","fill","none","xmlns","http://www.w3.org/2000/svg"],["fill-rule","evenodd","clip-rule","evenodd","d","M19.7391 0H22.0007H31.3757C31.9958 0 32.1782 0.406859 31.8134 0.924681C31.8134 0.924681 30.3543 2.84802 29.0775 4.21654C27.6549 5.69603 25.5391 7.43443 25.5391 7.43443C25.0649 7.84129 24.153 8.17418 23.5328 8.17418H21.9643H19.7026H12.4069H10.1453H0.770366C0.150235 8.17418 -0.0321566 7.76732 0.332627 7.2495C0.332627 7.2495 1.79176 5.32616 3.0685 3.95763C4.49115 2.47814 6.60689 0.739744 6.60689 0.739744C7.08111 0.332885 7.99307 0 8.6132 0H10.1818H12.4434H19.7391ZM19.5931 11.8258H21.8548H31.2297C31.8498 11.8258 32.0322 12.2327 31.6674 12.7505C31.6674 12.7505 30.2083 14.6739 28.9316 16.0424C27.5089 17.5219 25.3932 19.2603 25.3932 19.2603C24.919 19.6671 24.007 20 23.3869 20H21.8183H19.5566H12.261H9.99933H0.624402C0.0042704 20 -0.178121 19.5932 0.186662 19.0753C0.186662 19.0753 1.64579 17.152 2.92254 15.7835C4.34519 14.304 6.46093 12.5656 6.46093 12.5656C6.93515 12.1587 7.84711 11.8258 8.46724 11.8258H10.0358H12.2975H19.5931Z","fill","url(#paint0_linear_1633_21678)"],["id","paint0_linear_1633_21678","x1","16","y1","-4.91341e-07","x2","26.3657","y2","20.0517","gradientUnits","userSpaceOnUse"],["stop-color","#E03C31"],["offset","1","stop-color","#F6C543"],[1,"flex","gap-x-3"],[1,"w-[55px]","text-neutral-gray-1","text-espressive-md"],[1,"text-white","text-body-md","whitespace-nowrap"],[1,"w-full","rounded-tl-lg","rounded-tr-lg","border","border-b-0","border-neutral-gray-1","p-4"],[1,"flex","items-center","gap-x-4"],[1,"text-heading-sm","text-neutral-gray-6"],[1,"text-body-sm","text-secondary-3-4"],[1,"flex","gap-x-[1px]"],[1,"w-[88px]","bg-neutral-gray-2","text-express-sm","text-center","py-3"],[1,"w-[104px]","bg-neutral-gray-2","text-express-sm","text-center","py-3"],["class","flex-1 bg-neutral-gray-2 text-express-sm text-right py-3 pr-3",4,"ngIf"],[1,"flex-1","bg-neutral-gray-2","text-express-sm","text-right","py-3","pr-3"],[1,"w-full","last:rounded-bl-lg","last:rounded-br-lg"],[1,"border","border-neutral-gray-1","border-t-0"],[1,"flex"],[1,"w-[88px]","flex","justify-center","py-4"],["src","data:image/svg+xml",1,"hidden"],[1,"h-8","w-16","object-contain",3,"src"],[1,"w-[104px]","flex","justify-center","items-center","text-heading-sm","text-center","py-4"],["class","",4,"ngIf"],[4,"ngIf"],["class","text-right flex-1 flex flex-col justify-center py-4 pr-3",4,"ngIf"],["class","pb-2 px-3 text-body-sm text-neutral-gray-4 flex items-center gap-x-2",4,"ngIf"],[1,""],[1,"text-express-sm","text-neutral-gray-4"],[1,"text-right","flex-1","flex","flex-col","justify-center","py-4","pr-3"],["class","text-heading-sm",4,"ngIf"],["class","text-express-sm text-neutral-gray-6",4,"ngIf"],[1,"text-heading-sm"],[1,"text-express-sm","text-neutral-gray-6"],[1,"pb-2","px-3","text-body-sm","text-neutral-gray-4","flex","items-center","gap-x-2"],["icon","circle_information","size","small"]],template:function(t,i){1&t&&(e.TgZ(0,"div"),e.YNc(1,$t,3,6,"div",0),e.qZA(),e.TgZ(2,"div"),e.YNc(3,Kt,3,6,"div",0),e.qZA(),e.YNc(4,pi,6,6,"ng-template",null,1,e.W1O)),2&t&&(e.xp6(1),e.Q6J("ngForOf",i.listTicketGroup),e.xp6(2),e.Q6J("ngForOf",i.listPdfTicketGroup))},dependencies:[I.ez,I.sg,I.O5,I.tP,I.JJ,I.uU,x.AxE,x.Sm8],encapsulation:2,changeDetection:0}),r})();var fi=y(64425),_i=y(80529),lt=y(9381),vi=y(2225),Ti=y(50223);const yi=["quotationGraphicRef"];function Ci(r,l){if(1&r){const t=e.EpF();e.TgZ(0,"div",78)(1,"div",79),e._UZ(2,"cf-icon",80),e._uU(3," T\xf9y ch\u1ec9nh hi\u1ec3n th\u1ecb "),e.qZA(),e.TgZ(4,"div",34)(5,"cf-checkbox",81),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.onShowNetPrice())}),e._uU(6," Hi\u1ec3n th\u1ecb gi\xe1 Net "),e.qZA(),e.TgZ(7,"cf-checkbox",81),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.onHiddenFare())}),e._uU(8," \u1ea8n h\u1ea1ng gh\u1ebf "),e.qZA()()()}if(2&r){const t=e.oxw();e.xp6(5),e.Q6J("checked",t.isHiddenNetPrice),e.xp6(2),e.Q6J("checked",t.isHiddenCabin)}}function bi(r,l){if(1&r&&e._UZ(0,"img",82),2&r){const t=e.oxw();e.Q6J("src",t.agentInfo.logoUrl,e.LSH)}}function Si(r,l){1&r&&(e.O4$(),e.TgZ(0,"svg",83),e._UZ(1,"path",84),e.TgZ(2,"defs")(3,"linearGradient",85),e._UZ(4,"stop",86)(5,"stop",87),e.qZA()()())}function xi(r,l){if(1&r&&(e.TgZ(0,"div",88)(1,"div",89),e._uU(2,"\u0110\u1ecba ch\u1ec9:"),e.qZA(),e.TgZ(3,"div",90),e._uU(4),e.qZA()()),2&r){const t=e.oxw();e.xp6(4),e.Oqu(t.agentInfo.address)}}function Di(r,l){if(1&r&&(e.TgZ(0,"div",88)(1,"div",89),e._uU(2,"Email:"),e.qZA(),e.TgZ(3,"div",90),e._uU(4),e.qZA()()),2&r){const t=e.oxw();e.xp6(4),e.Oqu(t.agentInfo.email)}}function Fi(r,l){if(1&r&&(e.TgZ(0,"div",88)(1,"div",89),e._uU(2,"Website:"),e.qZA(),e.TgZ(3,"div",90),e._uU(4),e.qZA()()),2&r){const t=e.oxw();e.xp6(4),e.Oqu(t.agentInfo.website)}}function ki(r,l){if(1&r&&(e.TgZ(0,"div",88)(1,"div",89),e._uU(2,"Hotline:"),e.qZA(),e.TgZ(3,"div",90),e._uU(4),e.qZA()()),2&r){const t=e.oxw();e.xp6(4),e.Oqu(t.agentInfo.phone)}}function Pi(r,l){if(1&r){const t=e.EpF();e.TgZ(0,"button",91),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.onEditHeader())}),e._UZ(1,"cf-icon",92),e._uU(2," Ch\u1ec9nh s\u1eeda "),e.qZA()}}function Ii(r,l){if(1&r){const t=e.EpF();e.TgZ(0,"button",93),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.addonSurcharge())}),e._UZ(1,"cf-icon",66),e._uU(2," Ch\u1ec9nh ph\xed ph\u1ee5 thu "),e.qZA()}}function Ai(r,l){1&r&&(e.TgZ(0,"th",94),e._uU(1,"T\u1ed5ng chi ph\xed"),e.qZA())}function Ei(r,l){1&r&&(e.TgZ(0,"div",104),e._uU(1,"Bay th\u1eb3ng"),e.qZA())}function wi(r,l){if(1&r&&(e.TgZ(0,"div"),e._uU(1),e.TgZ(2,"span",105),e._uU(3,"\u0111i\u1ec3m d\u1eebng"),e.qZA()()),2&r){const t=e.oxw().$implicit;e.xp6(1),e.hij("",t.stopStatus," ")}}function Ni(r,l){if(1&r&&(e.TgZ(0,"div",109),e._uU(1),e.ALo(2,"number"),e.qZA()),2&r){const t=e.oxw(2).$implicit;e.xp6(1),e.hij(" ",e.lcZ(2,1,t.netPrice)," \u0111 ")}}function Zi(r,l){if(1&r&&(e.TgZ(0,"div",109),e._uU(1),e.ALo(2,"number"),e.qZA()),2&r){const t=e.oxw(2).$implicit;e.xp6(1),e.hij(" ",e.lcZ(2,1,t.totalPrice+(t.surcharge||0))," \u0111 ")}}function Mi(r,l){if(1&r&&(e.TgZ(0,"div",110),e._uU(1),e.qZA()),2&r){const t=e.oxw(2).$implicit;e.xp6(1),e.AsE(" ",t.cabin," (",t.fareClass,") ")}}function Ri(r,l){if(1&r&&(e.TgZ(0,"td",106)(1,"div",62),e.YNc(2,Ni,3,3,"div",107),e.YNc(3,Zi,3,3,"div",107),e.YNc(4,Mi,2,2,"div",108),e.qZA()()),2&r){const t=e.oxw().$implicit,i=e.oxw();e.xp6(2),e.Q6J("ngIf",t.showNetPrice),e.xp6(1),e.Q6J("ngIf",!t.showNetPrice),e.xp6(1),e.Q6J("ngIf",!i.isHiddenCabin)}}function Bi(r,l){if(1&r&&(e.TgZ(0,"tr",111)(1,"td",112)(2,"div",113),e._UZ(3,"cf-icon",80),e._uU(4),e.qZA()()()),2&r){const t=e.oxw().$implicit;e.xp6(4),e.hij(" Li\xean danh (do ",t.operatingName," \u0111i\u1ec1u h\xe0nh) ")}}const Li=function(r){return{"border-b border-neutral-gray-1":r}};function Qi(r,l){if(1&r){const t=e.EpF();e.TgZ(0,"tr",95)(1,"td",96)(2,"cf-checkbox",29),e.NdJ("checkChange",function(a){const o=e.CHM(t).$implicit,s=e.oxw();return e.KtG(s.onSelectedTicket(o,a))}),e.qZA()(),e.TgZ(3,"td",96),e._UZ(4,"img",97),e.qZA(),e.TgZ(5,"td",98)(6,"div",99),e._uU(7),e.ALo(8,"date"),e.qZA()(),e.TgZ(9,"td",98)(10,"div",99),e._uU(11),e.ALo(12,"date"),e.qZA()(),e.TgZ(13,"td",100),e._uU(14),e.qZA(),e.TgZ(15,"td",100),e.YNc(16,Ei,2,0,"div",101),e.YNc(17,wi,4,1,"div",40),e.qZA(),e.YNc(18,Ri,5,3,"td",102),e.qZA(),e.YNc(19,Bi,5,1,"tr",103)}if(2&r){const t=l.$implicit,i=e.oxw();e.Q6J("ngClass",e.VKq(16,Li,!t.isJointBenture)),e.xp6(2),e.Q6J("checked",t.selected),e.xp6(2),e.Q6J("src","assets/airline-logo/"+t.airline+".png",e.LSH),e.xp6(3),e.hij(" ",e.xi3(8,10,t.departure.localTime,"HH:mm")," "),e.xp6(4),e.hij(" ",e.xi3(12,13,t.arrival.localTime,"HH:mm")," "),e.xp6(3),e.hij(" ",t.flightNumber," "),e.xp6(2),e.Q6J("ngIf",0===t.stopStatus),e.xp6(1),e.Q6J("ngIf",0!==t.stopStatus),e.xp6(1),e.Q6J("ngIf",!i.hiddenCharge),e.xp6(1),e.Q6J("ngIf",t.isJointBenture)}}function Hi(r,l){1&r&&e._UZ(0,"cf-spinner")}function Ji(r,l){if(1&r&&e._UZ(0,"img",82),2&r){const t=e.oxw();e.Q6J("src",t.agentInfo.logoUrl,e.LSH)}}function Oi(r,l){1&r&&(e.O4$(),e.TgZ(0,"svg",114),e._UZ(1,"path",115),e.TgZ(2,"defs")(3,"linearGradient",116),e._UZ(4,"stop",86)(5,"stop",87),e.qZA()()())}function Ui(r,l){if(1&r){const t=e.EpF();e.TgZ(0,"div",117),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.onEditHeaderMobile())}),e._UZ(1,"cf-icon",118),e.TgZ(2,"div",119),e._uU(3," Ch\u1ec9nh s\u1eeda "),e.qZA()()}}function Yi(r,l){1&r&&(e.TgZ(0,"div",120),e._uU(1," \u0110\u1ecba ch\u1ec9: "),e.qZA())}function qi(r,l){1&r&&(e.TgZ(0,"div",120),e._uU(1," Email: "),e.qZA())}function Gi(r,l){1&r&&(e.TgZ(0,"div",120),e._uU(1," Website: "),e.qZA())}function ji(r,l){1&r&&(e.TgZ(0,"div",120),e._uU(1," Hotline: "),e.qZA())}function $i(r,l){if(1&r&&(e.TgZ(0,"div",121),e._uU(1),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.hij(" ",t.agentInfo.address," ")}}function Ki(r,l){if(1&r&&(e.TgZ(0,"div",122),e._uU(1),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.hij(" ",t.agentInfo.email," ")}}function Vi(r,l){if(1&r&&(e.TgZ(0,"div",122),e._uU(1),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.hij(" ",t.agentInfo.website," ")}}function zi(r,l){if(1&r&&(e.TgZ(0,"div",122),e._uU(1),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.hij(" ",t.agentInfo.phone," ")}}function Wi(r,l){1&r&&(e.TgZ(0,"div",132),e._uU(1,"Bay th\u1eb3ng"),e.qZA())}function Xi(r,l){if(1&r&&(e.TgZ(0,"div",132),e._uU(1),e.qZA()),2&r){const t=e.oxw(2).$implicit;e.xp6(1),e.hij(" ",t.stopStatus," \u0111i\u1ec3m d\u1eebng")}}function ea(r,l){if(1&r&&(e.TgZ(0,"div",148),e._UZ(1,"cf-icon",149),e.TgZ(2,"div",150),e._uU(3),e.qZA()()),2&r){const t=e.oxw(2).$implicit;e.xp6(3),e.hij(" Li\xean danh (do ",t.operatingName," \u0111i\u1ec1u h\xe0nh) ")}}function ta(r,l){if(1&r&&(e.TgZ(0,"div",151),e._uU(1),e.ALo(2,"replace"),e.ALo(3,"number"),e.qZA()),2&r){const t=e.oxw(2).$implicit;e.xp6(1),e.hij(" ",e.Dn7(2,1,e.lcZ(3,5,t.promotionalPrice),",",".")," \u0111")}}function ia(r,l){if(1&r&&(e.TgZ(0,"div",152),e._uU(1),e.ALo(2,"number"),e.qZA()),2&r){const t=e.oxw(2).$implicit;e.xp6(1),e.hij(" ",e.lcZ(2,1,t.netPrice)," \u0111")}}function aa(r,l){if(1&r&&(e.TgZ(0,"div",152),e._uU(1),e.ALo(2,"number"),e.qZA()),2&r){const t=e.oxw(2).$implicit;e.xp6(1),e.hij(" ",e.lcZ(2,1,t.totalPrice+(t.surcharge||0))," \u0111")}}function ra(r,l){if(1&r){const t=e.EpF();e.TgZ(0,"div",124)(1,"div",125)(2,"div",126)(3,"div",127),e._UZ(4,"img",128),e.TgZ(5,"div",129)(6,"div",130)(7,"div",131),e._uU(8),e.ALo(9,"date"),e.qZA(),e.TgZ(10,"div",132),e._uU(11),e.qZA()(),e.TgZ(12,"div",133)(13,"div",132),e._uU(14),e.qZA(),e.TgZ(15,"div",134),e._UZ(16,"div",135)(17,"div",136),e.qZA(),e.YNc(18,Wi,2,0,"div",137),e.YNc(19,Xi,2,1,"div",137),e.qZA(),e.TgZ(20,"div",130)(21,"div",131),e._uU(22),e.ALo(23,"date"),e.qZA(),e.TgZ(24,"div",132),e._uU(25),e.qZA()()()(),e.TgZ(26,"div",138)(27,"div",139),e._uU(28),e.qZA(),e._UZ(29,"div",140),e.TgZ(30,"div",141),e._uU(31),e.qZA()(),e.YNc(32,ea,4,1,"div",142),e.qZA(),e.TgZ(33,"div",143)(34,"div",144)(35,"cf-checkbox",145),e.NdJ("checkChange",function(a){e.CHM(t);const n=e.oxw().$implicit,o=e.oxw();return e.KtG(o.onSelectedTicket(n,a))}),e.qZA(),e.YNc(36,ta,4,7,"div",146),e.YNc(37,ia,3,3,"div",147),e.YNc(38,aa,3,3,"div",147),e.qZA()()()()}if(2&r){const t=e.oxw().$implicit;e.xp6(4),e.Q6J("src",t.mobileAirlineLogo,e.LSH),e.xp6(4),e.Oqu(e.xi3(9,16,t.startTime,"HH:mm")),e.xp6(3),e.Oqu(t.startPoint),e.xp6(3),e.Oqu(t.durationStr),e.xp6(4),e.Q6J("ngIf",0===t.stopStatus),e.xp6(1),e.Q6J("ngIf",t.stopStatus>0),e.xp6(3),e.Oqu(e.xi3(23,19,t.endTime,"HH:mm")),e.xp6(3),e.Oqu(t.endPoint),e.xp6(3),e.Oqu(t.operatingName),e.xp6(3),e.AsE("",t.cabinName," (",t.fareClass,") "),e.xp6(1),e.Q6J("ngIf",t.isJointBenture),e.xp6(3),e.Q6J("checked",t.selected),e.xp6(1),e.Q6J("ngIf",t.promotionalPrice),e.xp6(1),e.Q6J("ngIf",t.showNetPrice),e.xp6(1),e.Q6J("ngIf",!t.showNetPrice)}}function na(r,l){if(1&r&&(e.ynx(0),e.YNc(1,ra,39,22,"div",123),e.BQk()),2&r){const t=l.index,i=e.oxw();e.xp6(1),e.Q6J("ngIf",t<i.ticketInfiniteScrollCount)}}function oa(r,l){if(1&r){const t=e.EpF();e.TgZ(0,"div",153)(1,"cf-radio-group",154),e.NdJ("ngModelChange",function(a){e.CHM(t);const n=e.oxw();return e.KtG(n.formatType=a)}),e.TgZ(2,"cf-radio",37),e._uU(3,"PDF"),e.qZA(),e.TgZ(4,"cf-radio",37),e._uU(5,"\u1ea2nh JPEG"),e.qZA(),e.TgZ(6,"cf-radio",37),e._uU(7,"SMS"),e.qZA()(),e.TgZ(8,"button",155),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(),n=e.MAs(119),o=e.MAs(121);return e.KtG(a.onMobileShare(n,o))}),e._uU(9,"X\xe1c nh\u1eadn"),e.qZA()()}if(2&r){const t=e.oxw();e.xp6(1),e.Q6J("ngModel",t.formatType),e.xp6(1),e.Q6J("value","PDF"),e.xp6(2),e.Q6J("value","JPEG"),e.xp6(2),e.Q6J("value","SMS")}}function sa(r,l){1&r&&(e.TgZ(0,"div",158),e._uU(1,"L\u01b0u \xfd: Gi\u1edbi h\u1ea1n xu\u1ea5t h\xecnh l\xe0 10 h\xecnh"),e.qZA())}function la(r,l){if(1&r){const t=e.EpF();e.TgZ(0,"div",153)(1,"div",156),e._uU(2,"\u0110\xe3 x\u1eed l\xfd b\xe1o gi\xe1 th\xe0nh c\xf4ng"),e.qZA(),e.YNc(3,sa,2,0,"div",157),e.TgZ(4,"button",155),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.webShareCall())}),e._uU(5,"Chia s\u1ebb"),e.qZA()()}if(2&r){const t=e.oxw();e.xp6(3),e.Q6J("ngIf",t.isLimitImage)}}function ca(r,l){if(1&r){const t=e.EpF();e.TgZ(0,"div",153)(1,"div",156),e._uU(2,"\u0110\xe3 x\u1eed l\xfd b\xe1o gi\xe1 th\xe0nh c\xf4ng"),e.qZA(),e.TgZ(3,"button",155),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.webSharePDFCall())}),e._uU(4,"Chia s\u1ebb"),e.qZA()()}}function da(r,l){if(1&r&&(e.TgZ(0,"div",159),e._UZ(1,"cf-progress",160),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.Q6J("text","\u0110ang x\u1eed l\xfd")("percent",t.progressPercent)}}let we=(()=>{class r{constructor(t,i,a,n,o,s,d,u,g,c,h,p,v){var C;this.ref=i,this.bottomSheetData=a,this._bottomSheetService=n,this.clipboard=o,this.http=s,this._modal=d,this._toastService=u,this._mobileDetectService=g,this._generalService=c,this._permissionService=h,this._userService=p,this._urlToBase64=v,this.listTicket=[],this.listTicketSelected=[],this.listTicketSelectedLength=0,this.setOfChecked=new Set,this.hiddenCharge=!1,this.formatType="JPEG",this.isDowloading=!1,this.isMobileDownloading=!1,this.isCopied=!1,this.pageSize=25,this.pageSizeList=[{num:25},{num:50},{num:70},{num:100}],this.checked=!0,this.agentInfo={address:"193/25 Nguy\u1ec5n \u0110\xecnh Ch\xednh, P.11, Q.Ph\xfa Nhu\u1eadn, TP.HCM",email:"giacmobayre@gmail.com",website:"https://giacmobayre.vn",phone:"0915522425",phoneArea:"+84",displayName:"Gi\u1ea5c m\u01a1 bay r\u1ebb",logoUrl:"",footerAttention:""},this.isHiddenCabin=!1,this.isHiddenNetPrice=!1,this.isLoadBookingFace=this._permissionService.hasPermission(L.or.ViewInfoBookingFaceConfig),this.isLoadSurchargeFee=this._permissionService.hasPermission(L.or.ViewSurchargeFeeConfig),this.surchargeConfigs=[],this.listTicketDisplay=[],this.listProviderApplyGDS=["GDS","BSP","AIR_1G","ST","BZT","HG"],this.images=[],this.canvas=[],this.isLimitImage=!vt,this.progressImageMap=new Map,this.PROGRESS_DEFAULT=10,this.progressTotal=0,this.progressCurrent=0,this.progressPercent=this.PROGRESS_DEFAULT,this.sortChange=(b,F)=>this.listTicket,this.searchChange=(b,F)=>this.listTicket,this.TICKET_INFINITE_SCROLL_DEFAULT=10,this.TICKET_INFINITE_OFSET_INCREASE=10,this.ticketInfiniteScrollCount=this.TICKET_INFINITE_SCROLL_DEFAULT,t.registerIcons([x.UNF,x.B2I,x.oFb,x.Rcu,x.iYu]),this.listTicketDisplay=i?i.data.listTicketDisplay:a.listTicketDisplay,this.surcharges=[];let D=new Map;this.listTicketDisplay.forEach(b=>{this.listProviderApplyGDS.includes(b.provider)?D.set("GDS",{airline:"GDS",logo:"assets/icons/airline-default.svg",operatingName:b.operatingName,surchargePrice:0}):"FLY_ONE"===b.provider?D.set("LCC",{airline:"LCC",logo:"assets/icons/airline-default.svg",operatingName:b.operatingName,surchargePrice:0}):D.set(b.provider,{airline:b.provider,logo:"assets/airline-logo/"+b.provider+".png",operatingName:b.operatingName,surchargePrice:0})}),this.surcharges=[...D.values()];const m=localStorage.getItem("agentInfoConfig");m&&(this.agentInfo=JSON.parse(m));const k=localStorage.getItem("surchargeConfigs");k&&"undefined"!==k&&(this.surchargeConfigs=JSON.parse(k)),this.surcharges.forEach(b=>{let F;F=this.listProviderApplyGDS.includes(b.airline)?this.surchargeConfigs.find(P=>"GDS"===P.airline):this.surchargeConfigs.find("LCC"===b.airline?P=>"FLY_ONE"===P.airline:P=>P.airline===b.airline),F&&(b.surchargePrice=F.amount)}),this.listTicket=this.listTicketDisplay.filter(b=>b.segments.length).map(b=>{let F;return F=this.listProviderApplyGDS.includes(b.provider)?this.surchargeConfigs.find(P=>"GDS"===P.airline):this.surchargeConfigs.find("LCC"===b.provider?P=>"FLY_ONE"===P.airline:P=>P.airline===b.provider),Object.assign(Object.assign({},b),{surcharge:F?F.amount:0,isJointBenture:!["VN","QH","VJ","VU"].includes(b.operating),selected:!0})}),this.listTicketSelectedLength=this.listTicket.length,this.isLoadBookingFace&&this.getAgentInfo(),this.isLoadSurchargeFee&&this.getSurchargeFeeConfig(),this.hiddenCharge=i?i.data.hiddenCharge:a.hiddenCharge,this.journey=i?i.data.journey:a.journey,this.currentLeg=i?i.data.currentLeg:a.currentLeg,this.canEditHeader=i?i.data.canEditHeader:a.canEditHeader,this.isHiddenNetPrice=i?i.data.isHiddenNetPrice:a.isHiddenNetPrice,this.isHiddenCabin=i?i.data.isHiddenCabin:a.isHiddenCabin,this.currentUser=JSON.parse(null!==(C=localStorage.getItem("currentUser"))&&void 0!==C?C:"").data,this.updateListTicketSelected(),this.fileName=`baogia_${this.journey.startPoint}-${this.journey.endPoint}_${(0,I.p6)(this.journey.departDateQuotation,"ddMMyyyy","vi-VN")}`}optimizeAirlineLogo(){const t=new Map,i=this.listTicket.map(n=>({airline:n.airline,logo:`assets/airline-logo/${n.airline}_xsmall.png`})).filter((n,o,s)=>s.findIndex(d=>d.airline===n.airline)===o),a=i.map(n=>Ue("/"+n.logo,Ge(n.logo),{}));(0,Ae.D)(a).subscribe({next:n=>{for(let o=0;o<i.length;o++)t.set(i[o].airline,n[o]);this.listTicket.forEach(o=>{o.airlineLogoBase64=t.get(o.airline),o.airlineLogoBase64||(o.airlineLogoBase64=o.airlineLogo)})}})}getAgentInfo(){this._generalService.getBookingFaceConfig({sourceFlow:"SEARCH",bookingCode:""}).subscribe({next:i=>{i.success&&i.data&&(this.agentInfo=Object.assign({},i.data),(0,ne.t)(i.data,this.agentInfo)||localStorage.setItem("agentInfoConfig",JSON.stringify(this.agentInfo)),this.agentInfo.logoUrl&&this._urlToBase64.urlToBase64(`${this.agentInfo.logoUrl}?${(new Date).getTime()}`).subscribe(a=>{this.agentInfo.logoUrl=a},a=>{console.error("Error:",a)}))}})}getSurchargeFeeConfig(){this._generalService.getSurchargeFeeConfig().subscribe({next:t=>{t.success&&t.data&&((0,ne.t)(t.data,this.surchargeConfigs)||(localStorage.setItem("surchargeConfigs",JSON.stringify(t.data)),this.surchargeConfigs=t.data,this.surcharges.forEach(i=>{const a=this.surchargeConfigs.find(n=>n.airline===i.airline);a&&(i.surchargePrice=a.amount)}),this.listTicket.forEach(i=>{const a=this.surchargeConfigs.find(n=>n.airline===i.provider);i.surcharge=a?a.amount:0})))}})}allCheckSet(t){this.listTicket.forEach(i=>{i.selected=t}),this.updateListTicketSelected()}onClose(){this.ref.close(!1)}onSelectedTicket(t,i){t.selected=i,this.updateListTicketSelected()}updateListTicketSelected(){this.listTicketSelectedLength=this.listTicket.filter(t=>t.selected).length||0,this.checked=!this.listTicket.some(t=>!t.selected)}onFormatChange(t){this.formatType=t}onShare(t,i){if(this.listTicketSelected=this.listTicket.filter(a=>a.selected),this.listTicketSelected.length)switch(this.formatType){case"PDF":const a=this.quotationGraphicRef.getPDFNativeElement();this.exportPdf(a,i);break;case"JPEG":const n=this.quotationGraphicRef.getNativeElement();this.exportJpeg(n,t);break;case"SMS":this.exportSms()}else this._toastService.add({severity:"error",summary:"Th\u1ea5t b\u1ea1i",detail:"C\u1ea7n ch\u1ecdn \xedt nh\u1ea5t 1 chuy\u1ebfn bay \u0111\u1ec3 chia s\u1ebb.",sticky:!0})}onMobileOk(t){if(this.listTicketSelected=this.listTicket.filter(a=>a.selected),!this.listTicketSelected.length)return void this._toastService.add({severity:"error",summary:"Th\u1ea5t b\u1ea1i",detail:"C\u1ea7n ch\u1ecdn \xedt nh\u1ea5t 1 chuy\u1ebfn bay \u0111\u1ec3 chia s\u1ebb.",sticky:!0});const i=this._bottomSheetService.open(t,{headerTitle:"Ch\u1ecdn form chia s\u1ebb",rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4",leftButtonIcon:""});i.containerInstance._rightButtonClick.subscribe(a=>i.dismiss())}onMobileShare(t,i){this._bottomSheetService.dismiss(),this.onShare(t,i)}webShareCall(){(0,ie.D)(navigator.share({files:this.isLimitImage?this.images.filter((t,i)=>i<=9):this.images})).subscribe({next:t=>console.log(t),error:t=>console.log(t)})}webSharePDFCall(){console.log(this.pdf.type),(0,ie.D)(navigator.share({files:[this.pdf]})).subscribe({next:t=>console.log(t),error:t=>console.log(t)})}exportJpeg(t,i){var a=this;this._mobileDetectService.isMobile()?this.isMobileDownloading=!0:this.isDowloading=!0,setTimeout(()=>{const n=this._mobileDetectService.mobileSubject.value?.8:1,o=[];var s;(0,ie.D)(et(t.first.nativeElement,{includeFontSrc:["Roboto-Medium.ttf","Lexend.ttf","Roboto-Regular.ttf"]})).subscribe({next:(s=(0,H.Z)(function*(d){t.forEach((u,g)=>{o.push((0,at.P)(()=>(0,it.C0)(u.nativeElement,{width:752,height:1063,scale:n,font:{cssText:d},progress:(c,h)=>{a.caculateProgress(g,c,h,t.length)}})))}),(0,Ae.D)(o).subscribe({next:u=>{if(a.resetProgress(),a._mobileDetectService.mobileSubject.value)if(a.images=u.map((g,c)=>new File([g],`${a.fileName}${c}.png`,{type:g.type})),navigator.canShare)if(navigator.canShare({files:a.images})){const g=a._bottomSheetService.open(i,{headerTitle:"Chia s\u1ebb"});g.containerInstance._rightButtonClick.subscribe(c=>g.dismiss())}else a.saveZip(u);else a.saveZip(u);else 1===u.length?tt.saveAs(u[0],`${a.fileName}.jpeg`):a.saveZip(u);a._toastService.add({severity:"success",summary:"Th\xe0nh c\xf4ng",detail:"T\u1ea1o file b\xe1o gi\xe1 th\xe0nh c\xf4ng. Vui l\xf2ng ki\u1ec3m tra k\u1ebft qu\u1ea3.",sticky:!1}),a._mobileDetectService.isMobile()?a.isMobileDownloading=!1:a.isDowloading=!1,a.ref&&a.onClose()},error:u=>{a.resetProgress(),a._mobileDetectService.isMobile()?a.isMobileDownloading=!1:a.isDowloading=!1,a._toastService.add({severity:"error",summary:"Th\u1ea5t b\u1ea1i",detail:"T\u1ea1o file b\xe1o gi\xe1 th\u1ea5t b\u1ea1i. Vui l\xf2ng th\u1eed l\u1ea1i.",sticky:!0}),a.ref&&a.onClose()}})}),function(u){return s.apply(this,arguments)})})})}caculateProgress(t,i,a,n){if(this.progressImageMap.set(t,{current:i,total:a}),this.progressImageMap.size===n){this.progressTotal=0,this.progressCurrent=0,this.progressImageMap.forEach(s=>this.progressCurrent+=s.current),this.progressImageMap.forEach(s=>this.progressTotal+=s.total);const o=Math.floor(this.progressCurrent/this.progressTotal*100);o>this.PROGRESS_DEFAULT&&(this.progressPercent=o)}}resetProgress(){this.progressTotal=0,this.progressCurrent=0,this.progressPercent=this.PROGRESS_DEFAULT,this.progressImageMap.clear()}exportPdf(t,i){var a=this;this._mobileDetectService.isMobile()?this.isMobileDownloading=!0:this.isDowloading=!0,setTimeout(()=>{const o=[];var s;(0,ie.D)(et(t.first.nativeElement,{includeFontSrc:["Roboto-Medium.ttf","Lexend.ttf","Roboto-Regular.ttf"]})).subscribe({next:(s=(0,H.Z)(function*(d){t.forEach((u,g)=>{o.push((0,at.P)(()=>(0,it.E_)(u.nativeElement,{width:752,height:1063,scale:1,font:{cssText:d},progress:(c,h)=>{a.caculateProgress(g,c,h,t.length)}})))}),(0,Ae.D)(o).subscribe({next:u=>{a.resetProgress();const g=new Ht.ZP({orientation:"portrait",unit:"px",format:[752,1*a.quotationGraphicRef.A4_HEIGHT],compress:!0});if(u.forEach(function(){var c=(0,H.Z)(function*(h,p){g.addImage(h,"PNG",0,0,752,1*a.quotationGraphicRef.A4_HEIGHT,"","FAST"),p!==u.length-1&&g.addPage()});return function(h,p){return c.apply(this,arguments)}}()),a._mobileDetectService.mobileSubject.value){const c=g.output("blob");if(a.pdf=new File([c],`${a.fileName}.pdf`,{type:c.type}),navigator.canShare)if(navigator.canShare({files:[a.pdf]})){const h=a._bottomSheetService.open(i,{headerTitle:"Chia s\u1ebb"});h.containerInstance._rightButtonClick.subscribe(p=>h.dismiss())}else g.save(`${a.fileName}.pdf`);else g.save(`${a.fileName}.pdf`)}else g.save(`${a.fileName}.pdf`);a._toastService.add({severity:"success",summary:"Th\xe0nh c\xf4ng",detail:"T\u1ea1o file b\xe1o gi\xe1 th\xe0nh c\xf4ng. Vui l\xf2ng ki\u1ec3m tra k\u1ebft qu\u1ea3.",sticky:!1}),a._mobileDetectService.isMobile()?a.isMobileDownloading=!1:a.isDowloading=!1,a.ref&&a.onClose()},error:u=>{a.resetProgress(),a._mobileDetectService.isMobile()?a.isMobileDownloading=!1:a.isDowloading=!1,a._toastService.add({severity:"error",summary:"Th\u1ea5t b\u1ea1i",detail:"T\u1ea1o file b\xe1o gi\xe1 th\u1ea5t b\u1ea1i. Vui l\xf2ng th\u1eed l\u1ea1i.",sticky:!0})}})}),function(u){return s.apply(this,arguments)})})})}exportSms(){const t=this.proccessingSmsData();this.clipboard.copy(t),this._toastService.add({severity:"success",summary:"Th\xe0nh c\xf4ng",detail:"\u0110\xe3 copy th\xf4ng tin b\xe1o gi\xe1 th\xe0nh c\xf4ng.",sticky:!1})}proccessingSmsData(){const t={startPoint:this.journey.startPoint,startPointName:this.journey.startPointName,endPoint:this.journey.endPoint,endPointName:this.journey.endPointName,departDate:this.journey.departDate,flightOptions:this.listTicketSelected.map(a=>({flightNumber:a.segments.map(n=>n.airline+n.flightNumber).join(" -> "),departureTime:f(a.departure.localTime).format("HH:mm"),totalPrice:(a.showNetPrice?a.netPrice:a.totalPrice)+a.surcharge,checkedBag:a.checkedBag&&"Kh\xf4ng"!=a.checkedBag?`(${a.checkedBag})`:""}))};let i="";return i+=`C\xe1c chuy\u1ebfn bay t\u1eeb ${t.startPointName} (${t.startPoint}) -> ${t.endPointName} (${t.endPoint})\r\n`,i+=`${t.departDate}\r\n`,i+="(VJ: VietJet Air; QH: Bamboo Airways; VN: Vietnam Airlines; VU: Vietravel Airlines; VN6*: Pacific Airlines)\r\n",t.flightOptions.forEach(a=>{i+=`${a.flightNumber} \t${a.departureTime} \t${this.hiddenCharge?"":new Intl.NumberFormat("vi-VN").format(a.totalPrice)} ${a.checkedBag}\r\n`}),i}saveZip(t){if(!t)return;const i=new Jt,a=i.folder(this.fileName);t.forEach((n,o)=>{null==a||a.file(`${this.fileName}(${o+1}).jpeg`,n)}),i.generateAsync({type:"blob"}).then(n=>{tt.saveAs(n,`${this.fileName}.zip`)})}addonSurcharge(){this._modal.open(ot,{surcharges:this.surcharges,surchargeConfigs:this.surchargeConfigs}).afterClosed$.subscribe({next:i=>{if(i.data){this.surcharges=i.data;let a={};this.surcharges.forEach(n=>{a[n.airline]=n.surchargePrice}),this.listTicket=this.listTicket.map(n=>Object.assign(Object.assign({},n),{surcharge:this.listProviderApplyGDS.includes(n.provider)?a.GDS:"FLY_ONE"===n.provider?a.LCC:a[n.provider]})),this.listTicketSelected=this.listTicketSelected.map(n=>Object.assign(Object.assign({},n),{surcharge:this.listProviderApplyGDS.includes(n.provider)?a.GDS:"FLY_ONE"===n.provider?a.LCC:a[n.provider]}))}}})}addonSurchargeMobile(){const t=this._bottomSheetService.open(ot,{headerTitle:"Ch\u1ec9nh ph\xed ph\u1ee5 thu",rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4",data:{surcharges:this.surcharges,surchargeConfigs:this.surchargeConfigs}});t.containerInstance._rightButtonClick.subscribe(i=>t.dismiss()),t.afterDismissed().subscribe({next:i=>{if(i){this.surcharges=i;let a={};this.surcharges.forEach(n=>{a[n.airline]=n.surchargePrice}),this.listTicket=this.listTicket.map(n=>Object.assign(Object.assign({},n),{surcharge:this.listProviderApplyGDS.includes(n.provider)?a.GDS:a[n.provider]})),this.listTicketSelected=this.listTicketSelected.map(n=>Object.assign(Object.assign({},n),{surcharge:this.listProviderApplyGDS.includes(n.provider)?a.GDS:a[n.provider]}))}}})}onShowNetPrice(){this.isHiddenNetPrice=!this.isHiddenNetPrice,this.listTicket=this.listTicket.map(t=>Object.assign(Object.assign({},t),{showNetPrice:!t.showNetPrice}))}onHiddenFare(){this.isHiddenCabin=!this.isHiddenCabin}onEditHeader(){this._modal.open(E.W3,{agentInfo:this.agentInfo}).afterClosed$.subscribe({next:i=>{i.data&&(this.agentInfo=Object.assign(Object.assign({},this.agentInfo),{address:i.data.address,email:i.data.email,website:i.data.website,phone:i.data.phone}))}})}onEditHeaderMobile(){const t=this._bottomSheetService.open(E.W3,{headerTitle:"Ch\u1ec9nh s\u1eeda th\xf4ng tin header",rightButtonIcon:"",leftButtonIcon:"close",leftButtonIconClass:"text-neutral-gray-4",containerFullHeigh:!0,data:{agentInfo:this.agentInfo}});t.containerInstance._leftButtonClick.subscribe(i=>t.dismiss()),t.afterDismissed().subscribe(i=>{i&&(this.agentInfo=Object.assign(Object.assign({},this.agentInfo),{address:i.address,email:i.email,website:i.website,phone:i.phone}))})}onMobileScrollDown(){this.ticketInfiniteScrollCount+=this.TICKET_INFINITE_OFSET_INCREASE}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(x.KNP),e.Y36(K.gb,8),e.Y36(q.Rr,8),e.Y36(q.a2,8),e.Y36(fi.TU),e.Y36(_i.eN),e.Y36(K.oE),e.Y36(se.BX),e.Y36(lt.L),e.Y36(Ee.m),e.Y36(L.$A),e.Y36(vi.KD),e.Y36(Ti.B))},r.\u0275cmp=e.Xpm({type:r,selectors:[["quotation-modal"]],viewQuery:function(t,i){if(1&t&&e.Gf(yi,5),2&t){let a;e.iGM(a=e.CRH())&&(i.quotationGraphicRef=a.first)}},hostAttrs:[1,"md:w-full","relative"],standalone:!0,features:[e.jDz],decls:129,vars:66,consts:[[1,"w-[80vw]","h-[600px]","rounded-lg","bg-neutral-white","overflow-hidden","md:hidden"],[1,"w-full","h-full","flex","flex-col","max-h-[600px]"],[1,"flex","justify-between","items-center","px-6","py-[13px]","border-b","border-neutral-gray-1"],[1,"text-heading-sm","text-neutral-black"],["size","medium","icon","close",1,"text-neutral-gray-4","cursor-pointer",3,"click"],[1,"flex-auto","w-full","h-full","overflow-auto","py-4","px-6"],[1,"w-full","h-full","flex","flex-col","gap-y-6"],["class","flex justify-between",4,"ngIf"],[1,"w-full","p-4","rounded","bg-gradient-to-r","from-[#013f51]","from-10%","via-[#006885]","via-30%","to-[#006885]","to-90%","flex","justify-between","items-center","gap-x-8"],[1,"flex","items-center","gap-x-8"],[1,"flex","items-center","gap-x-3"],["class","w-10 h-10 object-cover rounded-full",3,"src",4,"ngIf"],["width","32","height","20","viewBox","0 0 32 20","fill","none","xmlns","http://www.w3.org/2000/svg",4,"ngIf"],[1,"flex","flex-col","gap-y-1","text-white"],[1,"text-body-sm","opacity-80"],[1,"text-heading-xs"],[1,"flex","flex-col","gap-y-1"],["class","flex gap-x-3",4,"ngIf"],["cf-button","","size","small","class","min-w-[114px] justify-center bg-white text-neutral-gray-6","type","secondary",3,"click",4,"ngIf"],[1,"bg-neutral-white","rounded-lg","shadow-cf-md"],[1,"p-4","flex","justify-between","items-center"],[1,"flex","items-center","gap-x-4"],[1,"text-neutral-gray-6","text-espressive-lg"],[1,"text-body-md","text-secondary-3-4","font-medium"],["cf-button","","type","secondary",3,"click",4,"ngIf"],[1,"",3,"fnSort","fnSearch","pageSizeList","listData","pageSize"],["managerTable",""],["cf-thead",""],["cf-th",""],["size","medium",3,"checked","checkChange"],["class","text-espressive-semibold-sm p-3 text-right",4,"ngIf"],["ngFor","",3,"ngForOf"],[1,"p-6"],[1,"flex","justify-between","items-center"],[1,"flex","gap-x-4"],[1,"text-body-lg"],[1,"flex","items-center","gap-x-8",3,"ngModel","ngModelChange"],["size","medium",3,"value"],["cf-button","","size","medium",3,"click"],["icon","export","size","small",1,"mr-2.5"],[4,"ngIf"],["infinite-scroll","",1,"hidden","md:flex","flex-col","p-4","w-full","gap-y-4","bg-neutral-gray-1","h-full","overflow-y-auto",3,"infiniteScrollDistance","infiniteScrollThrottle","scrollWindow","fromRoot","alwaysCallback","scrolled"],[1,"rounded","pt-3","pr-4","pb-3","pl-4","flex","flex-col","gap-4","items-start","justify-center","self-stretch","shrink-0","relative","w-full",2,"background","linear-gradient(90deg,rgba(0, 0, 0, 0.4) 0%,rgba(0, 0, 0, 0) 100%),linear-gradient(to left, #006885, #006885)"],[1,"flex","flex-row","gap-3","items-center","justify-start","self-stretch","shrink-0","relative"],[1,"flex","flex-row","gap-3.5","w-10","items-center","justify-start","shrink-0","h-5","relative"],["class","self-stretch flex-1 relative overflow-visible","width","32","height","20","viewBox","0 0 32 20","fill","none","xmlns","http://www.w3.org/2000/svg",4,"ngIf"],[1,"flex","flex-col","gap-1","items-start","justify-start","flex-1","relative"],[1,"text-neutral-white","opacity-80","text-left","relative","text-body-sm"],[1,"text-neutral-white","text-left","relative","text-heading-xs"],[1,"flex","flex-row","gap-0","items-start","justify-start","shrink-0","relative"],["class","bg-neutral-white rounded border-solid border-neutral-gray-3 border pt-2 pr-3 pb-2 pl-3 flex flex-row gap-2 items-center justify-center shrink-0 h-8 relative",3,"click",4,"ngIf"],[1,"flex","flex-row","gap-8","items-center","justify-start","self-stretch","shrink-0","relative"],[1,"flex","flex-row","gap-3","items-start","justify-start","shrink-0","relative","w-full"],[1,"flex","flex-col","gap-1","items-start","justify-start","shrink-0","relative"],["class","text-neutral-gray-2 text-left relative text-espressive-md-short",4,"ngIf"],[1,"flex","flex-col","gap-1","items-start","justify-start","shrink-0","relative","!flex-auto"],["class","text-neutral-white text-left relative text-body-md-short line-clamp-1",4,"ngIf"],["class","text-neutral-white text-left relative text-body-md-short",4,"ngIf"],[1,"flex","flex-col","gap-0","items-start","justify-start","self-stretch","shrink-0","relative"],[1,"flex","flex-row","gap-2","items-center","justify-start","self-stretch","shrink-0","relative"],[1,"text-neutral-gray-6","text-left","relative","text-heading-sm"],[1,"text-secondary-3-4","text-left","relative","self-stretch","text-espressive-md-short"],[1,"flex","flex-col"],[1,"flex","flex-row","gap-2","items-center","justify-start","shrink-0","w-full","relative"],[1,"text-neutral-gray-6-brandcolor","text-left","relative","flex-1","text-body-md-long"],["cf-button","","type","secondary","size","small",1,"bg-neutral-white",3,"click"],["icon","add","size","small",1,"mr-2.5"],[1,"flex","justify-between","items-center","mt-3"],[1,"flex","flex-col","gap-y-3","mt-3","pb-16"],[4,"ngFor","ngForOf"],["formatSelectBottomSheet",""],["mobileConfirmShare",""],["mobilePdfConfirmShare",""],[1,"hidden","md:flex","justify-end","items-center","p-4","fixed","bottom-0","right-0","w-full","bg-neutral-white","shadow-cf-lg",2,"-webkit-transform","translateZ(0)"],["cf-button","","size","medium",1,"w-full","justify-center",3,"click"],[1,"absolute","bottom-[10000px]",3,"listTicket","cabinName","isHiddenCabin","journey","hiddenCharge","agentInfo"],["quotationGraphicRef",""],["class","fixed top-0 left-0 w-screen !w-[100svw] h-screen !h-[100svh] flex justify-center items-center bg-neutral-white opacity-95",4,"ngIf"],[1,"flex","justify-between"],[1,"text-heading-sm","text-neutral-gray-6","flex","items-center","gap-x-2"],["icon","circle_information","size","small"],["size","medium",3,"checked","click"],[1,"w-10","h-10","object-cover","rounded-full",3,"src"],["width","32","height","20","viewBox","0 0 32 20","fill","none","xmlns","http://www.w3.org/2000/svg"],["fill-rule","evenodd","clip-rule","evenodd","d","M19.7391 0H22.0007H31.3757C31.9958 0 32.1782 0.406859 31.8134 0.924681C31.8134 0.924681 30.3543 2.84802 29.0775 4.21654C27.6549 5.69603 25.5391 7.43443 25.5391 7.43443C25.0649 7.84129 24.153 8.17418 23.5328 8.17418H21.9643H19.7026H12.4069H10.1453H0.770366C0.150235 8.17418 -0.0321566 7.76732 0.332627 7.2495C0.332627 7.2495 1.79176 5.32616 3.0685 3.95763C4.49115 2.47814 6.60689 0.739744 6.60689 0.739744C7.08111 0.332885 7.99307 0 8.6132 0H10.1818H12.4434H19.7391ZM19.5931 11.8258H21.8548H31.2297C31.8498 11.8258 32.0322 12.2327 31.6674 12.7505C31.6674 12.7505 30.2083 14.6739 28.9316 16.0424C27.5089 17.5219 25.3932 19.2603 25.3932 19.2603C24.919 19.6671 24.007 20 23.3869 20H21.8183H19.5566H12.261H9.99933H0.624402C0.0042704 20 -0.178121 19.5932 0.186662 19.0753C0.186662 19.0753 1.64579 17.152 2.92254 15.7835C4.34519 14.304 6.46093 12.5656 6.46093 12.5656C6.93515 12.1587 7.84711 11.8258 8.46724 11.8258H10.0358H12.2975H19.5931Z","fill","url(#paint0_linear_1633_21678)"],["id","paint0_linear_1633_21678","x1","16","y1","-4.91341e-07","x2","26.3657","y2","20.0517","gradientUnits","userSpaceOnUse"],["stop-color","#E03C31"],["offset","1","stop-color","#F6C543"],[1,"flex","gap-x-3"],[1,"w-[55px]","text-neutral-gray-1","text-espressive-md"],[1,"text-white","text-body-md"],["cf-button","","size","small","type","secondary",1,"min-w-[114px]","justify-center","bg-white","text-neutral-gray-6",3,"click"],["icon","edit_alt","size","small",1,"mr-2.5"],["cf-button","","type","secondary",3,"click"],[1,"text-espressive-semibold-sm","p-3","text-right"],[3,"ngClass"],[1,"py-2","px-3"],[1,"w-20","h-10","object-contain",3,"src"],[1,"py-2","px-3","text-body-sm"],[1,"text-heading-sm"],[1,"py-2","px-3","text-heading-sm"],["class","",4,"ngIf"],["class","py-2 px-3 text-right",4,"ngIf"],["class","border-b border-neutral-gray-1",4,"ngIf"],[1,""],[1,"text-espressive-sm","text-neutral-gray-4"],[1,"py-2","px-3","text-right"],["class","text-heading-md",4,"ngIf"],["class","text-express-sm text-neutral-gray-6",4,"ngIf"],[1,"text-heading-md"],[1,"text-express-sm","text-neutral-gray-6"],[1,"border-b","border-neutral-gray-1"],["colspan","7",1,"py-2","px-3.5"],[1,"text-body-sm","text-neutral-gray-4","flex","items-center","gap-x-3"],["width","32","height","20","viewBox","0 0 32 20","fill","none","xmlns","http://www.w3.org/2000/svg",1,"self-stretch","flex-1","relative","overflow-visible"],["fill-rule","evenodd","clip-rule","evenodd","d","M19.7391 0H22.0007H31.3757C31.9958 0 32.1782 0.406859 31.8134 0.924681C31.8134 0.924681 30.3543 2.84802 29.0775 4.21654C27.6549 5.69603 25.5391 7.43443 25.5391 7.43443C25.0649 7.84129 24.153 8.17418 23.5328 8.17418H21.9643H19.7026H12.4069H10.1453H0.770366C0.150235 8.17418 -0.0321566 7.76732 0.332627 7.2495C0.332627 7.2495 1.79176 5.32616 3.0685 3.95763C4.49115 2.47814 6.60689 0.739744 6.60689 0.739744C7.08111 0.332885 7.99307 0 8.6132 0H10.1818H12.4434H19.7391ZM19.5931 11.8248H21.8548H31.2297C31.8498 11.8248 32.0322 12.2317 31.6674 12.7495C31.6674 12.7495 30.2083 14.6728 28.9316 16.0414C27.5089 17.5209 25.3932 19.2593 25.3932 19.2593C24.919 19.6661 24.007 19.999 23.3869 19.999H21.8183H19.5566H12.261H9.99933H0.624402C0.00427041 19.999 -0.178121 19.5921 0.186662 19.0743C0.186662 19.0743 1.64579 17.151 2.92254 15.7825C4.34519 14.303 6.46093 12.5646 6.46093 12.5646C6.93515 12.1577 7.84711 11.8248 8.46724 11.8248H10.0358H12.2975H19.5931Z","fill","url(#paint0_linear_966_27592)"],["id","paint0_linear_966_27592","x1","16","y1","-4.91317e-07","x2","26.3648","y2","20.0511","gradientUnits","userSpaceOnUse"],[1,"bg-neutral-white","rounded","border-solid","border-neutral-gray-3","border","pt-2","pr-3","pb-2","pl-3","flex","flex-row","gap-2","items-center","justify-center","shrink-0","h-8","relative",3,"click"],["icon","edit_alt","size","small"],[1,"text-neutral-gray-6","text-left","relative","text-button-md"],[1,"text-neutral-gray-2","text-left","relative","text-espressive-md-short"],[1,"text-neutral-white","text-left","relative","text-body-md-short","line-clamp-1"],[1,"text-neutral-white","text-left","relative","text-body-md-short"],["class","bg-white rounded-[4px] flex flex-col shadow-md md:rounded-lg flex-shrink-0",4,"ngIf"],[1,"bg-white","rounded-[4px]","flex","flex-col","shadow-md","md:rounded-lg","flex-shrink-0"],[1,"flex"],[1,"flex","flex-col","justify-between","pt-8","pl-3","grow","w-full","md:pt-3","md:pb-3","md:gap-y-3","md:justify-start"],[1,"hidden","md:flex","gap-x-3","items-center"],[1,"w-[36px]","h-[36px]","object-contain",3,"src"],[1,"flex","gap-x-4","items-center"],[1,"flex","flex-col","items-center"],[1,"text-heading-xs","text-neutral-gray-6"],[1,"text-espressive-xs","text-neutral-gray-4"],[1,"flex","flex-col","items-center","gap-y-1"],[1,"flex","items-center","justify-center"],[1,"h-0","border-b","border-b-neutral-gray-4","w-[64px]"],[1,"w-1","h-1","border-[2px]","border-t-neutral-gray-4","border-r-neutral-gray-4","border-b-transparent","border-l-transparent","rotate-45"],["class","text-espressive-xs text-neutral-gray-4",4,"ngIf"],[1,"items-center","hidden","md:flex"],[1,"text-espressive-sm","text-neutral-gray-6","whitespace-nowrap"],[1,"border-r","border-r-neutral-gray-2","h-4","mx-1"],[1,"text-espressive-xs","text-neutral-gray-4","whitespace-nowrap"],["class","hidden text-espressive-sm text-secondary-3-4 md:flex gap-x-1 items-center",4,"ngIf"],[1,"flex-col","justify-between","py-3","pr-3","pl-2","border-l","border-neutral-gray-1","hidden","md:flex"],[1,"flex","flex-col","items-end","min-w-[82px]"],["size","medium",1,"mb-2","-mr-2",3,"checked","checkChange"],["class","visible line-through text-neutral-gray-4 text-body-sm whitespace-nowrap",4,"ngIf"],["class","text-heading-xs text-neutral-gray-6 whitespace-nowrap",4,"ngIf"],[1,"hidden","text-espressive-sm","text-secondary-3-4","md:flex","gap-x-1","items-center"],["icon","circle_information","size","small",1,"text-neutral-gray-4"],[1,"text-neutral-gray-4","text-left","relative","text-espressive-xs"],[1,"visible","line-through","text-neutral-gray-4","text-body-sm","whitespace-nowrap"],[1,"text-heading-xs","text-neutral-gray-6","whitespace-nowrap"],[1,"pt-5","p-4","flex","flex-col","w-full"],[1,"flex","flex-col","gap-y-4",3,"ngModel","ngModelChange"],["cf-button","",1,"w-full","justify-center","mt-6",3,"click"],[1,"flex","justify-center","text-body-md"],["class","flex justify-center text-body-sm",4,"ngIf"],[1,"flex","justify-center","text-body-sm"],[1,"fixed","top-0","left-0","w-screen","!w-[100svw]","h-screen","!h-[100svh]","flex","justify-center","items-center","bg-neutral-white","opacity-95"],[3,"text","percent"]],template:function(t,i){if(1&t){const a=e.EpF();e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),e._uU(4),e.qZA(),e.TgZ(5,"cf-icon",4),e.NdJ("click",function(){return i.onClose()}),e.qZA()(),e.TgZ(6,"div",5)(7,"div",6),e.YNc(8,Ci,9,2,"div",7),e.TgZ(9,"div",8)(10,"div",9)(11,"div",10)(12,"div"),e.YNc(13,bi,1,1,"img",11),e.YNc(14,Si,6,0,"svg",12),e.qZA(),e.TgZ(15,"div",13)(16,"div",14),e._uU(17,"Ph\xf2ng v\xe9"),e.qZA(),e.TgZ(18,"div",15),e._uU(19),e.qZA()()(),e.TgZ(20,"div",16),e.YNc(21,xi,5,1,"div",17),e.YNc(22,Di,5,1,"div",17),e.YNc(23,Fi,5,1,"div",17),e.YNc(24,ki,5,1,"div",17),e.qZA()(),e.TgZ(25,"div"),e.YNc(26,Pi,3,0,"button",18),e.qZA()(),e.TgZ(27,"div",19)(28,"div",20)(29,"div")(30,"div",21)(31,"div",22),e._uU(32),e.qZA()(),e.TgZ(33,"div",23),e._uU(34),e.ALo(35,"date"),e.qZA()(),e.YNc(36,Ii,3,0,"button",24),e.qZA(),e.TgZ(37,"cf-table",25,26)(39,"thead",27)(40,"th",28)(41,"cf-checkbox",29),e.NdJ("checkChange",function(o){return i.allCheckSet(o)}),e.qZA()(),e.TgZ(42,"th",28),e._uU(43,"H\xe3ng bay"),e.qZA(),e.TgZ(44,"th",28),e._uU(45,"C\u1ea5t c\xe1nh"),e.qZA(),e.TgZ(46,"th",28),e._uU(47,"H\u1ea1 c\xe1nh"),e.qZA(),e.TgZ(48,"th",28),e._uU(49,"Chuy\u1ebfn bay"),e.qZA(),e.TgZ(50,"th",28),e._uU(51,"S\u1ed1 \u0111i\u1ec3m d\u1eebng"),e.qZA(),e.YNc(52,Ai,2,0,"th",30),e.qZA(),e.TgZ(53,"tbody"),e.YNc(54,Qi,20,18,"ng-template",31),e.qZA()()()()(),e.TgZ(55,"div",32)(56,"div",33)(57,"div",34)(58,"div",35),e._uU(59,"\u0110\u1ecbnh d\u1ea1ng:"),e.qZA(),e.TgZ(60,"cf-radio-group",36),e.NdJ("ngModelChange",function(o){return i.formatType=o}),e.TgZ(61,"cf-radio",37),e._uU(62,"PDF"),e.qZA(),e.TgZ(63,"cf-radio",37),e._uU(64,"\u1ea2nh JPEG"),e.qZA(),e.TgZ(65,"cf-radio",37),e._uU(66,"SMS"),e.qZA()()(),e.TgZ(67,"button",38),e.NdJ("click",function(){return i.onShare()}),e._UZ(68,"cf-icon",39),e._uU(69," Ho\xe0n th\xe0nh "),e.qZA()()()()(),e.YNc(70,Hi,1,0,"cf-spinner",40),e.TgZ(71,"div",41),e.NdJ("scrolled",function(){return i.onMobileScrollDown()}),e.TgZ(72,"div",42)(73,"div",43)(74,"div",44),e.YNc(75,Ji,1,1,"img",11),e.YNc(76,Oi,6,0,"svg",45),e.qZA(),e.TgZ(77,"div",46)(78,"div",47),e._uU(79," Ph\xf2ng v\xe9 "),e.qZA(),e.TgZ(80,"div",48),e._uU(81),e.qZA()(),e.TgZ(82,"div",49),e.YNc(83,Ui,4,0,"div",50),e.qZA()(),e.TgZ(84,"div",51)(85,"div",52)(86,"div",53),e.YNc(87,Yi,2,0,"div",54),e.YNc(88,qi,2,0,"div",54),e.YNc(89,Gi,2,0,"div",54),e.YNc(90,ji,2,0,"div",54),e.qZA(),e.TgZ(91,"div",55),e.YNc(92,$i,2,1,"div",56),e.YNc(93,Ki,2,1,"div",57),e.YNc(94,Vi,2,1,"div",57),e.YNc(95,zi,2,1,"div",57),e.qZA()()()(),e.TgZ(96,"div",58)(97,"div",59)(98,"div",60),e._uU(99),e.qZA()(),e.TgZ(100,"div",61),e._uU(101),e.ALo(102,"date"),e.qZA()(),e.TgZ(103,"div",62)(104,"div",63)(105,"div",64),e._uU(106),e.qZA(),e.TgZ(107,"button",65),e.NdJ("click",function(){return i.addonSurchargeMobile()}),e._UZ(108,"cf-icon",66),e._uU(109," Ch\u1ec9nh ph\xed ph\u1ee5 thu "),e.qZA()(),e.TgZ(110,"div",67)(111,"div",64),e._uU(112),e.qZA(),e.TgZ(113,"cf-checkbox",29),e.NdJ("checkChange",function(o){return i.allCheckSet(o)}),e.qZA()(),e.TgZ(114,"div",68),e.YNc(115,na,2,1,"ng-container",69),e.qZA()(),e.YNc(116,oa,10,4,"ng-template",null,70,e.W1O),e.YNc(118,la,6,1,"ng-template",null,71,e.W1O),e.YNc(120,ca,5,0,"ng-template",null,72,e.W1O),e.qZA(),e.TgZ(122,"div",73)(123,"button",74),e.NdJ("click",function(){e.CHM(a);const o=e.MAs(117);return e.KtG(i.onMobileOk(o))}),e._uU(124," Ho\xe0n th\xe0nh "),e.qZA()(),e._UZ(125,"cf-quotation-graphic",75,76)(127,"cf-toast"),e.YNc(128,da,2,2,"div",77)}if(2&t){const a=e.MAs(38);e.xp6(4),e.lnq("Chia s\u1ebb c\xe1c chuy\u1ebfn bay ",i.journey.startPoint," - ",i.journey.endPoint,", ",i.journey.departDate,""),e.xp6(4),e.Q6J("ngIf",!i.hiddenCharge),e.xp6(5),e.Q6J("ngIf",i.agentInfo.logoUrl),e.xp6(1),e.Q6J("ngIf",!i.agentInfo.logoUrl),e.xp6(5),e.Oqu(i.agentInfo.displayName),e.xp6(2),e.Q6J("ngIf",i.agentInfo.address),e.xp6(1),e.Q6J("ngIf",i.agentInfo.email),e.xp6(1),e.Q6J("ngIf",i.agentInfo.website),e.xp6(1),e.Q6J("ngIf",i.agentInfo.phone),e.xp6(2),e.Q6J("ngIf",i.canEditHeader),e.xp6(6),e.AsE(" C\xe1c chuy\u1ebfn bay ch\u1eb7ng ",i.journey.startPointName," - ",i.journey.endPointName," "),e.xp6(2),e.hij(" ",e.xi3(35,60,i.journey.departDateQuotation,"EEEE, d MMMM, yyyy")," "),e.xp6(2),e.Q6J("ngIf",!i.hiddenCharge),e.xp6(1),e.Q6J("fnSort",i.sortChange)("fnSearch",i.searchChange)("pageSizeList",i.pageSizeList)("listData",i.listTicket)("pageSize",i.pageSize),e.xp6(4),e.Q6J("checked",i.checked),e.xp6(11),e.Q6J("ngIf",!i.hiddenCharge),e.xp6(2),e.Q6J("ngForOf",a.partOfdata),e.xp6(6),e.Q6J("ngModel",i.formatType),e.xp6(1),e.Q6J("value","PDF"),e.xp6(2),e.Q6J("value","JPEG"),e.xp6(2),e.Q6J("value","SMS"),e.xp6(5),e.Q6J("ngIf",i.isDowloading),e.xp6(1),e.Q6J("infiniteScrollDistance",2)("infiniteScrollThrottle",300)("scrollWindow",!1)("fromRoot",!0)("alwaysCallback",!0),e.xp6(4),e.Q6J("ngIf",i.agentInfo.logoUrl),e.xp6(1),e.Q6J("ngIf",!i.agentInfo.logoUrl),e.xp6(5),e.hij(" ",i.agentInfo.displayName," "),e.xp6(2),e.Q6J("ngIf",i.canEditHeader),e.xp6(4),e.Q6J("ngIf",i.agentInfo.address),e.xp6(1),e.Q6J("ngIf",i.agentInfo.email),e.xp6(1),e.Q6J("ngIf",i.agentInfo.website),e.xp6(1),e.Q6J("ngIf",i.agentInfo.phone),e.xp6(2),e.Q6J("ngIf",i.agentInfo.address),e.xp6(1),e.Q6J("ngIf",i.agentInfo.email),e.xp6(1),e.Q6J("ngIf",i.agentInfo.website),e.xp6(1),e.Q6J("ngIf",i.agentInfo.phone),e.xp6(4),e.AsE(" C\xe1c chuy\u1ebfn bay ch\u1eb7ng ",i.journey.startPointName," - ",i.journey.endPointName," "),e.xp6(2),e.hij(" ",e.xi3(102,63,i.journey.departDateQuotation,"EEEE, d MMMM, yyyy")," "),e.xp6(5),e.hij(" ",i.listTicket.length," k\u1ebft qu\u1ea3 "),e.xp6(6),e.hij("\u0110\xe3 ch\u1ecdn: ",i.listTicketSelectedLength,""),e.xp6(1),e.Q6J("checked",i.checked),e.xp6(2),e.Q6J("ngForOf",i.listTicket),e.xp6(10),e.Q6J("listTicket",i.listTicketSelected)("cabinName",i.cabinName)("isHiddenCabin",i.isHiddenCabin)("journey",i.journey)("hiddenCharge",i.hiddenCharge)("agentInfo",i.agentInfo),e.xp6(3),e.Q6J("ngIf",i.isMobileDownloading)}},dependencies:[I.ez,I.mk,I.sg,I.O5,I.JJ,I.uU,B.u5,B.JJ,B.On,x.AxE,x.Sm8,Qe.u,He.o,He.T,J.N8,J.Xq,z.OR,oe.rC,oe.E_,oe.zs,mi,se.hj,E.AS,W.Rq,W.Ry,_t],encapsulation:2}),r})();var ua=y(13138),ha=y(3803),ga=y(17997),pa=y(62733),ma=y(28490),fa=y(3401),_a=y(77492),va=y(46779),Ta=y(42678),ya=y(9497);const Ca=["mainScroll"];function ba(r,l){if(1&r){const t=e.EpF();e.TgZ(0,"button",48),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.researchFlight())}),e._UZ(1,"cf-icon",49),e.TgZ(2,"div",50),e._uU(3," T\xecm chuy\u1ebfn bay "),e.qZA()()}if(2&r){const t=e.oxw();e.Q6J("disabled",t.searchFlightLoading)}}function Sa(r,l){if(1&r){const t=e.EpF();e.TgZ(0,"div",51)(1,"div",52)(2,"div",53),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.addMultiRoute())}),e._UZ(3,"cf-icon",54),e.TgZ(4,"div",55),e._uU(5,"Th\xeam ch\u1eb7ng m\u1edbi"),e.qZA()(),e.TgZ(6,"div",56),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.removeAllDataMultiRoute())}),e._UZ(7,"cf-icon",57),e.TgZ(8,"div",58),e._uU(9,"X\xf3a t\u1ea5t c\u1ea3"),e.qZA()()(),e.TgZ(10,"button",59),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.researchFlight())}),e._UZ(11,"cf-icon",49),e.TgZ(12,"div",50),e._uU(13," T\xecm chuy\u1ebfn bay "),e.qZA()()()}if(2&r){const t=e.oxw();e.xp6(10),e.Q6J("disabled",t.searchFlightLoading)}}function xa(r,l){if(1&r&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"date"),e.qZA()),2&r){const t=e.oxw().$implicit;e.xp6(1),e.hij(" - ",e.xi3(2,1,t.toDate,"dd/MM"),"")}}function Da(r,l){1&r&&(e.TgZ(0,"span"),e._uU(1,"T\u1eeb "),e.qZA())}function Fa(r,l){if(1&r&&(e.TgZ(0,"span"),e.YNc(1,Da,2,0,"span",35),e._uU(2),e.ALo(3,"number"),e.qZA()),2&r){const t=e.oxw().$implicit,i=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.toDate&&i.flightTypeSearch===i.FlightTypeSearch.RoundTrip),e.xp6(1),e.hij("",e.lcZ(3,2,t.price)," \u0111")}}function ka(r,l){1&r&&(e.TgZ(0,"span"),e._uU(1,"Xem gi\xe1"),e.qZA())}function Pa(r,l){if(1&r&&(e.TgZ(0,"li"),e._uU(1),e.ALo(2,"number"),e.qZA()),2&r){const t=e.oxw(2).$implicit;e.xp6(1),e.AsE("Gi\xe1 r\u1ebb ",t.airlineMinPrice,": ",e.lcZ(2,2,t.price)," \u0111")}}function Ia(r,l){if(1&r&&(e.TgZ(0,"ul")(1,"li"),e._uU(2),e.qZA(),e.TgZ(3,"li"),e._uU(4),e.qZA(),e.YNc(5,Pa,3,4,"li",35),e.qZA()),2&r){const t=e.oxw().$implicit;e.xp6(2),e.Oqu(t.dayInfo.holiday),e.xp6(2),e.AsE("",t.dayInfo.dateFormat," (",t.dayInfo.lunarDate,")"),e.xp6(1),e.Q6J("ngIf",t.price)}}const ct=function(r,l){return{"bg-red-1":r,"opacity-50 pointer-events-none":l}},ae=function(r){return{"text-primary-1-4":r}};function Aa(r,l){if(1&r){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",67),e.NdJ("click",function(){const n=e.CHM(t).$implicit,o=e.oxw(2);return e.KtG(o.onSelectDateBar(n.key,n.fromDate,n.toDate))}),e.TgZ(2,"div",68)(3,"div",69)(4,"span"),e._uU(5),e.ALo(6,"date"),e.qZA(),e.YNc(7,xa,3,4,"span",35),e.qZA(),e.TgZ(8,"div",70),e.YNc(9,Fa,4,4,"span",35),e.YNc(10,ka,2,0,"span",35),e.qZA()()(),e.YNc(11,Ia,6,4,"ng-template",null,71,e.W1O),e.BQk()}if(2&r){const t=l.$implicit,i=e.MAs(12),a=e.oxw(2);e.xp6(1),e.Q6J("ngClass",e.WLB(13,ct,t.selected,!t.active||a.isprogress))("id",t.key)("cfTooltip",i)("placement","topCenter"),e.xp6(2),e.Q6J("ngClass",e.VKq(16,ae,t.selected)),e.xp6(2),e.Oqu(e.xi3(6,10,t.fromDate,"dd/MM")),e.xp6(2),e.Q6J("ngIf",t.toDate&&a.flightTypeSearch===a.FlightTypeSearch.RoundTrip),e.xp6(1),e.Q6J("ngClass",e.VKq(18,ae,t.selected)),e.xp6(1),e.Q6J("ngIf",t.price),e.xp6(1),e.Q6J("ngIf",!t.price)}}function Ea(r,l){if(1&r){const t=e.EpF();e.TgZ(0,"div",60)(1,"div",61)(2,"div",62),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.onPreviousDate())}),e._UZ(3,"cf-icon",63),e.qZA(),e.TgZ(4,"div",64),e.NdJ("scroll",function(a){e.CHM(t);const n=e.oxw();return e.KtG(n.onScrollMultiDateBar(a))}),e.YNc(5,Aa,13,20,"ng-container",65),e.qZA(),e.TgZ(6,"div",62),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.onNextDate())}),e._UZ(7,"cf-icon",66),e.qZA()()()}if(2&r){const t=e.oxw();e.xp6(5),e.Q6J("ngForOf",t.multiDateBar)}}function wa(r,l){if(1&r&&(e.TgZ(0,"div",72),e._UZ(1,"div",73),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.Udp("width",t.progress+"%")}}function Na(r,l){if(1&r){const t=e.EpF();e.TgZ(0,"app-sort-flight",74),e.NdJ("sortChange",function(a){e.CHM(t);const n=e.oxw();return e.KtG(n.onSortChange(a))}),e.qZA()}if(2&r){const t=e.oxw();e.Q6J("disableSort",t.searchFlightLoading)("sortDefault",t.sortDefault)}}function Za(r,l){if(1&r){const t=e.EpF();e.TgZ(0,"app-sort-flight-combo",75),e.NdJ("sortChange",function(a){e.CHM(t);const n=e.oxw();return e.KtG(n.onSortChangeCombo(a))}),e.qZA()}if(2&r){const t=e.oxw();e.Q6J("sortDefault",t.sortDefaultCombo)("tabDetail",t.tabComboDetail)}}function Ma(r,l){if(1&r){const t=e.EpF();e.TgZ(0,"app-switch-mode",76),e.NdJ("modeChange",function(a){e.CHM(t);const n=e.oxw();return e.KtG(n.modeChange(a))}),e.qZA()}if(2&r){const t=e.oxw();e.Q6J("modeView",t.currentMode)("disableAgencyMode",t.searchFlightLoading)}}function Ra(r,l){if(1&r&&(e.TgZ(0,"div",72),e._UZ(1,"div",73),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.Udp("width",t.progress+"%")}}function Ba(r,l){if(1&r&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"date"),e.qZA()),2&r){const t=e.oxw().$implicit;e.xp6(1),e.hij(" - ",e.xi3(2,1,t.toDate,"dd/MM"),"")}}function La(r,l){1&r&&(e.TgZ(0,"span"),e._uU(1,"T\u1eeb "),e.qZA())}function Qa(r,l){if(1&r&&(e.TgZ(0,"span"),e.YNc(1,La,2,0,"span",35),e._uU(2),e.ALo(3,"number"),e.qZA()),2&r){const t=e.oxw().$implicit,i=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.toDate&&i.flightTypeSearch===i.FlightTypeSearch.RoundTrip),e.xp6(1),e.hij("",e.lcZ(3,2,t.price)," \u0111")}}function Ha(r,l){1&r&&(e.TgZ(0,"span"),e._uU(1,"Xem gi\xe1"),e.qZA())}function Ja(r,l){if(1&r&&(e.TgZ(0,"li"),e._uU(1),e.ALo(2,"number"),e.qZA()),2&r){const t=e.oxw(2).$implicit;e.xp6(1),e.AsE("Gi\xe1 r\u1ebb ",t.airlineMinPrice,": ",e.lcZ(2,2,t.price)," \u0111")}}function Oa(r,l){if(1&r&&(e.TgZ(0,"ul")(1,"li"),e._uU(2),e.qZA(),e.TgZ(3,"li"),e._uU(4),e.qZA(),e.YNc(5,Ja,3,4,"li",35),e.qZA()),2&r){const t=e.oxw().$implicit;e.xp6(2),e.Oqu(t.dayInfo.holiday),e.xp6(2),e.AsE("",t.dayInfo.dateFormat," (",t.dayInfo.lunarDate,")"),e.xp6(1),e.Q6J("ngIf",t.price)}}function Ua(r,l){if(1&r){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",82),e.NdJ("click",function(){const n=e.CHM(t).$implicit,o=e.oxw(2);return e.KtG(o.onSelectDateBar(n.key,n.fromDate,n.toDate))}),e.TgZ(2,"div",68)(3,"div",69)(4,"span"),e._uU(5),e.ALo(6,"date"),e.qZA(),e.YNc(7,Ba,3,4,"span",35),e.qZA(),e.TgZ(8,"div",70),e.YNc(9,Qa,4,4,"span",35),e.YNc(10,Ha,2,0,"span",35),e.qZA()()(),e.YNc(11,Oa,6,4,"ng-template",null,71,e.W1O),e.BQk()}if(2&r){const t=l.$implicit,i=e.MAs(12),a=e.oxw(2);e.xp6(1),e.Q6J("ngClass",e.WLB(12,ct,t.selected,!t.active||a.isprogress))("id",t.key+"-mobile")("cfTooltip",i),e.xp6(2),e.Q6J("ngClass",e.VKq(15,ae,t.selected)),e.xp6(2),e.Oqu(e.xi3(6,9,t.fromDate,"dd/MM")),e.xp6(2),e.Q6J("ngIf",t.toDate&&a.flightTypeSearch===a.FlightTypeSearch.RoundTrip),e.xp6(1),e.Q6J("ngClass",e.VKq(17,ae,t.selected)),e.xp6(1),e.Q6J("ngIf",t.price),e.xp6(1),e.Q6J("ngIf",!t.price)}}function Ya(r,l){if(1&r){const t=e.EpF();e.TgZ(0,"div",77)(1,"div",78)(2,"div",79),e.NdJ("scroll",function(a){e.CHM(t);const n=e.oxw();return e.KtG(n.onScrollMultiDateBar(a))}),e.YNc(3,Ua,13,19,"ng-container",65),e.qZA()(),e.TgZ(4,"div",80),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.onDatePickerClick())}),e._UZ(5,"cf-icon",81),e.qZA()()}if(2&r){const t=e.oxw();e.xp6(3),e.Q6J("ngForOf",t.multiDateBar)}}function qa(r,l){if(1&r){const t=e.EpF();e.TgZ(0,"div",83),e._UZ(1,"cf-icon",84),e.TgZ(2,"div",85)(3,"div",86),e._uU(4,"Kh\xf4ng t\xecm th\u1ea5y c\xe1c chuy\u1ebfn bay QH - Bamboo Airways?"),e.qZA(),e.TgZ(5,"div",58),e._uU(6,"C\xf3 th\u1ec3 b\u1ea1n \u0111\xe3 nh\u1eadp m\xe3 khuy\u1ebfn m\xe3i kh\xf4ng h\u1ee3p l\u1ec7 \u0111\u1ed1i v\u1edbi h\xe3ng Bamboo Airways. Vui l\xf2ng ki\u1ec3m tra v\xe0 th\u1eed l\u1ea1i!"),e.qZA()(),e.TgZ(7,"cf-icon",87),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.isShowBambooPromotionError=!1)}),e.qZA()()}}function Ga(r,l){if(1&r&&(e.TgZ(0,"div",93)(1,"div",94),e._uU(2),e.qZA(),e.TgZ(3,"div",95)(4,"div",96),e._uU(5),e.qZA(),e.TgZ(6,"div",97),e._uU(7),e.qZA(),e.TgZ(8,"div",98),e._uU(9),e.qZA()()()),2&r){const t=l.active,i=e.oxw(),a=i.index,n=i.$implicit;e.xp6(1),e.ekj("!text-primary-2-4",t)("!bg-primary-2-1",t),e.xp6(1),e.hij(" ",a+1," "),e.xp6(3),e.AsE("",n.startPoint," - ",n.endPoint," "),e.xp6(2),e.hij(" ",n.departDate,""),e.xp6(2),e.hij(" ",n.mobileDepartDate,"")}}function ja(r,l){if(1&r&&(e.TgZ(0,"cf-tab",91),e.YNc(1,Ga,10,9,"ng-template",null,92,e.W1O),e.qZA()),2&r){const t=l.$implicit,i=e.MAs(2),a=e.oxw(2);e.Q6J("active",t.leg===a.currentLeg)("title",i)}}const $a=function(r,l,t){return{"!text-red-4 !bg-red-2":r,"rounded-r-md":l,"rounded-l-md":t}};function Ka(r,l){if(1&r){const t=e.EpF();e.TgZ(0,"div",102),e.NdJ("click",function(){const n=e.CHM(t).index,o=e.oxw(3);return e.KtG(o.tabChangeIndex(n))}),e.TgZ(1,"div",103),e._uU(2),e.qZA()()}if(2&r){const t=l.$implicit,i=l.index,a=e.oxw(3);e.Q6J("ngClass",e.kEZ(2,$a,t.leg===a.currentLeg,i,!i)),e.xp6(2),e.hij(" ",i?"Chi\u1ec1u v\u1ec1":"Chi\u1ec1u \u0111i"," ")}}function Va(r,l){if(1&r&&(e.TgZ(0,"div",99,100),e.YNc(2,Ka,3,6,"div",101),e.qZA()),2&r){const t=e.oxw(2);e.xp6(2),e.Q6J("ngForOf",t.tabData)}}function za(r,l){if(1&r){const t=e.EpF();e.ynx(0),e.TgZ(1,"cf-tabset",88),e.NdJ("selectedIndexChange",function(a){e.CHM(t);const n=e.oxw();return e.KtG(n.tabChangeIndex(a))}),e.YNc(2,ja,3,2,"cf-tab",89),e.qZA(),e.YNc(3,Va,3,1,"div",90),e.BQk()}if(2&r){const t=e.oxw();e.xp6(2),e.Q6J("ngForOf",t.tabData),e.xp6(1),e.Q6J("ngIf",!t.hasAirportInternational)}}function Wa(r,l){if(1&r){const t=e.EpF();e.TgZ(0,"app-sort-flight-combo",104),e.NdJ("sortChange",function(a){e.CHM(t);const n=e.oxw();return e.KtG(n.onSortChangeCombo(a))}),e.qZA()}if(2&r){const t=e.oxw();e.Q6J("sortDefault",t.sortDefaultCombo)("tabDetail",t.tabComboDetail)}}const dt=function(r){return{"text-neutral-gray-2":r}};function Xa(r,l){if(1&r){const t=e.EpF();e.TgZ(0,"button",109),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.onRegisterBookingHunter())}),e._UZ(1,"cf-icon",110),e.TgZ(2,"span"),e._uU(3,"S\u0103n v\xe9"),e.qZA()()}if(2&r){const t=e.oxw(2);e.Q6J("disabled",t.searchFlightLoading),e.xp6(1),e.Q6J("ngClass",e.VKq(2,dt,t.searchFlightLoading))}}function er(r,l){if(1&r){const t=e.EpF();e.TgZ(0,"button",109),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.onQuotation(a.currentLeg))}),e._UZ(1,"cf-icon",111),e.TgZ(2,"span"),e._uU(3,"B\xe1o gi\xe1"),e.qZA()()}if(2&r){const t=e.oxw(2);e.Q6J("disabled",t.searchFlightLoading),e.xp6(1),e.Q6J("ngClass",e.VKq(2,dt,t.searchFlightLoading))}}function tr(r,l){if(1&r){const t=e.EpF();e.TgZ(0,"div",105)(1,"app-switch-mode",76),e.NdJ("modeChange",function(a){e.CHM(t);const n=e.oxw();return e.KtG(n.modeChange(a))}),e.qZA(),e.TgZ(2,"div",106),e.YNc(3,Xa,4,4,"button",107),e.YNc(4,er,4,4,"button",107),e.TgZ(5,"app-sort-flight",108),e.NdJ("sortChange",function(a){e.CHM(t);const n=e.oxw();return e.KtG(n.onSortChange(a))}),e.qZA()()()}if(2&r){const t=e.oxw();e.xp6(1),e.Q6J("modeView",t.currentMode)("disableAgencyMode",t.searchFlightLoading),e.xp6(2),e.Q6J("ngIf",t.huntBookingFlag),e.xp6(1),e.Q6J("ngIf",t.showQuotation&&"retail"===t.currentMode),e.xp6(1),e.Q6J("sortDefault",t.sortDefault)("disableSort",t.searchFlightLoading)}}function ir(r,l){if(1&r){const t=e.EpF();e.TgZ(0,"ticket-item-combo",119),e.NdJ("ticketSelected",function(a){e.CHM(t);const n=e.oxw().$implicit,o=e.oxw(3);return e.KtG(o.chooseComboTicket(a,n))})("ticketComboShare",function(a){e.CHM(t);const n=e.oxw().$implicit,o=e.oxw(3);return e.KtG(o.onShareCombo(a,n))})("verifyFlight",function(a){e.CHM(t);const n=e.oxw(),o=n.$implicit,s=n.index,d=e.oxw(3);return e.KtG(d.onVerifyFlight(a,o,s))}),e.qZA()}if(2&r){const t=e.oxw().$implicit,i=e.oxw(3);e.Q6J("ticket",t)("listFareRule",i.listFareRule)("loading",i.isVerifyComboProgress)}}function ar(r,l){if(1&r&&(e.ynx(0),e.YNc(1,ir,1,3,"ticket-item-combo",118),e.BQk()),2&r){const t=l.$implicit,i=l.index,a=e.oxw(3);e.xp6(1),e.Q6J("ngIf",i<a.ticketInfiniteScrollCount&&!t.soldOut)}}function rr(r,l){1&r&&(e.ynx(0),e.TgZ(1,"div",120),e._UZ(2,"ticket-item-skeleton")(3,"ticket-item-skeleton")(4,"ticket-item-skeleton")(5,"ticket-item-skeleton"),e.qZA(),e.BQk())}function nr(r,l){1&r&&(e.TgZ(0,"div",121),e._uU(1,"C\xe1c chuy\u1ebfn bay h\u1ebft ch\u1ed7 "),e.qZA())}function or(r,l){if(1&r){const t=e.EpF();e.TgZ(0,"ticket-item-combo",123),e.NdJ("ticketComboShare",function(a){e.CHM(t);const n=e.oxw().$implicit,o=e.oxw(3);return e.KtG(o.onShareCombo(a,n))}),e.qZA()}if(2&r){const t=e.oxw().$implicit,i=e.oxw(3);e.Q6J("ticket",t)("listFareRule",i.listFareRule)}}function sr(r,l){if(1&r&&(e.ynx(0),e.YNc(1,or,1,2,"ticket-item-combo",122),e.BQk()),2&r){const t=l.$implicit,i=l.index,a=e.oxw(3);e.xp6(1),e.Q6J("ngIf",i<a.ticketInfiniteScrollCount&&t.soldOut)}}function lr(r,l){if(1&r){const t=e.EpF();e.TgZ(0,"div",115),e.NdJ("scrolled",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.onScrollDown())}),e.YNc(1,ar,2,1,"ng-container",116),e.YNc(2,rr,6,0,"ng-container",35),e.YNc(3,nr,2,0,"div",117),e.YNc(4,sr,2,1,"ng-container",116),e.qZA()}if(2&r){const t=e.oxw(2);e.Q6J("infiniteScrollDistance",1)("infiniteScrollThrottle",300)("infiniteScrollContainer",".main-scroll-bar")("scrollWindow",!1)("fromRoot",!0)("alwaysCallback",!0),e.xp6(1),e.Q6J("ngForOf",t.listTicketComboDisplay)("ngForTrackBy",t.ticketTrackByFn),e.xp6(1),e.Q6J("ngIf",t.searchFlightAllLoading),e.xp6(1),e.Q6J("ngIf",t.hasOutOfSeatComboDisplay()),e.xp6(1),e.Q6J("ngForOf",t.listTicketComboDisplay)("ngForTrackBy",t.ticketTrackByFn)}}function cr(r,l){1&r&&(e.ynx(0),e._UZ(1,"ticket-item-skeleton")(2,"ticket-item-skeleton")(3,"ticket-item-skeleton")(4,"ticket-item-skeleton"),e.BQk())}function dr(r,l){if(1&r){const t=e.EpF();e.TgZ(0,"div",126),e._UZ(1,"img",127),e.TgZ(2,"div",128),e._uU(3,"Kh\xf4ng c\xf3 chuy\u1ebfn bay n\xe0o ph\xf9 h\u1ee3p"),e.qZA(),e.TgZ(4,"div",129),e._uU(5," Vui l\xf2ng s\u1eeda \u0111\u1ed5i b\u1ed9 l\u1ecdc cho ph\xf9 h\u1ee3p ho\u1eb7c ch\u1ecdn n\xfat b\xean d\u01b0\u1edbi \u0111\u1ec3 h\u1ee7y vi\u1ec7c l\u1ecdc. "),e.qZA(),e.TgZ(6,"button",130),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(3);return e.KtG(a.onResetFilter())}),e._uU(7," H\u1ee7y l\u1ecdc chuy\u1ebfn bay "),e.qZA()()}2&r&&(e.xp6(6),e.Q6J("type","solid"))}function ur(r,l){if(1&r){const t=e.EpF();e.TgZ(0,"div",126),e._UZ(1,"img",127),e.TgZ(2,"div",128),e._uU(3,"Kh\xf4ng c\xf3 chuy\u1ebfn bay n\xe0o"),e.qZA(),e.TgZ(4,"div",132),e._uU(5," Vui l\xf2ng s\u1eeda \u0111\u1ed5i b\u1ed9 l\u1ecdc ho\u1eb7c thay \u0111\u1ed5i t\xecm ki\u1ebfm c\u1ee7a b\u1ea1n. "),e.qZA(),e.TgZ(6,"button",133),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(4),n=e.MAs(14);return e.KtG(a.onChangeSearch(n))}),e._UZ(7,"cf-icon",134),e._uU(8," Thay \u0111\u1ed5i t\xecm ki\u1ebfm "),e.qZA()()}2&r&&(e.xp6(6),e.Q6J("type","secondary"))}function hr(r,l){if(1&r&&e.YNc(0,ur,9,1,"div",131),2&r){const t=e.oxw(3);e.Q6J("ngIf",!t.searchFlightData.flightOptions.length)}}function gr(r,l){if(1&r&&(e.YNc(0,dr,8,1,"div",124),e.YNc(1,hr,1,1,"ng-template",null,125,e.W1O)),2&r){const t=e.MAs(2),i=e.oxw(2);e.Q6J("ngIf",!i.listTicketComboDisplay.length)("ngIfElse",t)}}function pr(r,l){if(1&r&&(e.ynx(0),e.YNc(1,lr,5,12,"div",112),e.YNc(2,cr,5,0,"ng-container",113),e.YNc(3,gr,3,2,"ng-template",null,114,e.W1O),e.BQk()),2&r){const t=e.MAs(4),i=e.oxw();e.xp6(1),e.Q6J("ngIf",!i.searchFlightLoading),e.xp6(1),e.Q6J("ngIf",i.searchFlightLoading)("ngIfElse",t)}}function mr(r,l){1&r&&(e.ynx(0),e.TgZ(1,"div",120),e._UZ(2,"ticket-item-skeleton")(3,"ticket-item-skeleton")(4,"ticket-item-skeleton")(5,"ticket-item-skeleton"),e.qZA(),e.BQk())}function fr(r,l){if(1&r){const t=e.EpF();e.TgZ(0,"div",126),e._UZ(1,"img",127),e.TgZ(2,"div",128),e._uU(3,"Kh\xf4ng c\xf3 chuy\u1ebfn bay n\xe0o"),e.qZA(),e.TgZ(4,"div",132),e._uU(5," Vui l\xf2ng s\u1eeda \u0111\u1ed5i b\u1ed9 l\u1ecdc ho\u1eb7c thay \u0111\u1ed5i t\xecm ki\u1ebfm c\u1ee7a b\u1ea1n. "),e.qZA(),e.TgZ(6,"button",133),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(3),n=e.MAs(14);return e.KtG(a.onChangeSearch(n))}),e._UZ(7,"cf-icon",134),e._uU(8," Thay \u0111\u1ed5i t\xecm ki\u1ebfm "),e.qZA()()}2&r&&(e.xp6(6),e.Q6J("type","secondary"))}function _r(r,l){if(1&r){const t=e.EpF();e.TgZ(0,"app-ticket-item",138),e.NdJ("onReselectClick",function(a){e.CHM(t);const n=e.oxw(7);return e.KtG(n.reselect(a))}),e.qZA()}if(2&r){const t=e.oxw().$implicit,i=e.oxw(6);e.Q6J("ticket",t)("listFareRule",i.listFareRule)("mobileSelected",!0)("listFareRuleClasses",i.listFareRuleClasses)}}function vr(r,l){if(1&r&&(e.ynx(0),e.YNc(1,_r,1,4,"app-ticket-item",137),e.BQk()),2&r){const t=l.$implicit,i=e.oxw(6);e.xp6(1),e.Q6J("ngIf",t&&t.leg===i.currentLeg)}}function Tr(r,l){if(1&r&&(e.ynx(0),e.YNc(1,vr,2,1,"ng-container",65),e.BQk()),2&r){const t=e.oxw(5);e.xp6(1),e.Q6J("ngForOf",t.listTicketDisplaySelectedMobile)}}function yr(r,l){if(1&r){const t=e.EpF();e.TgZ(0,"app-ticket-item",140),e.NdJ("ticketSelected",function(a){e.CHM(t);const n=e.oxw(6);return e.KtG(n.chooseTicket(a))}),e.qZA()}if(2&r){const t=e.oxw().$implicit,i=e.oxw(5);e.Q6J("ticket",t)("listFareRule",i.listFareRule)("listFareRuleClasses",i.listFareRuleClasses)}}function Cr(r,l){if(1&r&&(e.ynx(0),e.YNc(1,yr,1,3,"app-ticket-item",139),e.BQk()),2&r){const t=l.$implicit,i=l.index,a=e.oxw(5);e.xp6(1),e.Q6J("ngIf",i<a.ticketInfiniteScrollCount&&t.seatRemain>0)}}function br(r,l){1&r&&(e.ynx(0),e.TgZ(1,"div",120),e._UZ(2,"ticket-item-skeleton")(3,"ticket-item-skeleton")(4,"ticket-item-skeleton")(5,"ticket-item-skeleton"),e.qZA(),e.BQk())}function Sr(r,l){1&r&&(e.TgZ(0,"div",121),e._uU(1,"C\xe1c chuy\u1ebfn bay h\u1ebft ch\u1ed7"),e.qZA())}function xr(r,l){if(1&r){const t=e.EpF();e.TgZ(0,"app-ticket-item",140),e.NdJ("ticketSelected",function(a){e.CHM(t);const n=e.oxw(6);return e.KtG(n.chooseTicket(a))}),e.qZA()}if(2&r){const t=e.oxw().$implicit,i=e.oxw(5);e.Q6J("ticket",t)("listFareRule",i.listFareRule)("listFareRuleClasses",i.listFareRuleClasses)}}function Dr(r,l){if(1&r&&(e.ynx(0),e.YNc(1,xr,1,3,"app-ticket-item",139),e.BQk()),2&r){const t=l.$implicit,i=l.index,a=e.oxw(5);e.xp6(1),e.Q6J("ngIf",i<a.ticketInfiniteScrollCount&&0===t.seatRemain)}}function Fr(r,l){if(1&r){const t=e.EpF();e.TgZ(0,"div",115),e.NdJ("scrolled",function(){e.CHM(t);const a=e.oxw(4);return e.KtG(a.onScrollDown())}),e.YNc(1,Tr,2,1,"ng-container",35),e.YNc(2,Cr,2,1,"ng-container",116),e.YNc(3,br,6,0,"ng-container",35),e.YNc(4,Sr,2,0,"div",117),e.YNc(5,Dr,2,1,"ng-container",116),e.qZA()}if(2&r){const t=e.oxw(4);e.Q6J("infiniteScrollDistance",1)("infiniteScrollThrottle",300)("infiniteScrollContainer",".main-scroll-bar")("scrollWindow",!1)("fromRoot",!0)("alwaysCallback",!0),e.xp6(1),e.Q6J("ngIf",t.isMobile),e.xp6(1),e.Q6J("ngForOf",t.listTicketDisplay)("ngForTrackBy",t.ticketTrackByFn),e.xp6(1),e.Q6J("ngIf",t.searchFlightAllLoading),e.xp6(1),e.Q6J("ngIf",t.hasOutOfSeatDisplay()),e.xp6(1),e.Q6J("ngForOf",t.listTicketDisplay)("ngForTrackBy",t.ticketTrackByFn)}}function kr(r,l){if(1&r){const t=e.EpF();e.TgZ(0,"div",126),e._UZ(1,"img",127),e.TgZ(2,"div",128),e._uU(3,"Kh\xf4ng c\xf3 chuy\u1ebfn bay n\xe0o ph\xf9 h\u1ee3p"),e.qZA(),e.TgZ(4,"div",129),e._uU(5," Vui l\xf2ng s\u1eeda \u0111\u1ed5i b\u1ed9 l\u1ecdc cho ph\xf9 h\u1ee3p ho\u1eb7c ch\u1ecdn n\xfat b\xean d\u01b0\u1edbi \u0111\u1ec3 h\u1ee7y vi\u1ec7c l\u1ecdc. "),e.qZA(),e.TgZ(6,"button",130),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(4);return e.KtG(a.onResetFilter())}),e._uU(7," H\u1ee7y l\u1ecdc chuy\u1ebfn bay "),e.qZA()()}2&r&&(e.xp6(6),e.Q6J("type","solid"))}function Pr(r,l){if(1&r&&(e.YNc(0,Fr,6,13,"div",112),e.YNc(1,kr,8,1,"div",131)),2&r){const t=e.oxw(3);e.Q6J("ngIf",t.listTicketDisplay.length),e.xp6(1),e.Q6J("ngIf",!t.listTicketDisplay.length)}}function Ir(r,l){if(1&r&&(e.YNc(0,fr,9,1,"div",124),e.YNc(1,Pr,2,2,"ng-template",null,136,e.W1O)),2&r){const t=e.MAs(2),i=e.oxw(2);e.Q6J("ngIf",i.isSearchRetailEmpty)("ngIfElse",t)}}function Ar(r,l){if(1&r&&(e.ynx(0),e.YNc(1,mr,6,0,"ng-container",113),e.YNc(2,Ir,3,2,"ng-template",null,135,e.W1O),e.BQk()),2&r){const t=e.MAs(3),i=e.oxw();e.xp6(1),e.Q6J("ngIf",i.searchFlightLoading)("ngIfElse",t)}}function Er(r,l){1&r&&(e.ynx(0),e.TgZ(1,"div",120),e._UZ(2,"ticket-item-skeleton")(3,"ticket-item-skeleton")(4,"ticket-item-skeleton")(5,"ticket-item-skeleton"),e.qZA(),e.BQk())}function wr(r,l){if(1&r){const t=e.EpF();e.TgZ(0,"div",126),e._UZ(1,"img",127),e.TgZ(2,"div",128),e._uU(3,"Kh\xf4ng c\xf3 chuy\u1ebfn bay n\xe0o"),e.qZA(),e.TgZ(4,"div",132),e._uU(5," Vui l\xf2ng s\u1eeda \u0111\u1ed5i b\u1ed9 l\u1ecdc ho\u1eb7c thay \u0111\u1ed5i t\xecm ki\u1ebfm c\u1ee7a b\u1ea1n. "),e.qZA(),e.TgZ(6,"button",133),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(3),n=e.MAs(14);return e.KtG(a.onChangeSearch(n))}),e._UZ(7,"cf-icon",134),e._uU(8," Thay \u0111\u1ed5i t\xecm ki\u1ebfm "),e.qZA()()}2&r&&(e.xp6(6),e.Q6J("type","secondary"))}function Nr(r,l){if(1&r){const t=e.EpF();e.TgZ(0,"agent-ticket-item",144),e.NdJ("onReselectClick",function(a){e.CHM(t);const n=e.oxw(6);return e.KtG(n.reselect(a))})("ticketSelected",function(a){e.CHM(t);const n=e.oxw(6);return e.KtG(n.chooseAgentTicket(a))}),e.qZA()}if(2&r){const t=e.oxw().$implicit,i=e.oxw(5);e.Q6J("ticket",t)("listFareRule",i.listFareRule)("mobileSelected",!0)("listFareRuleClasses",i.listFareRuleClasses)("hasAirportInternational",i.hasAirportInternational)}}function Zr(r,l){if(1&r&&(e.ynx(0),e.YNc(1,Nr,1,5,"agent-ticket-item",143),e.BQk()),2&r){const t=l.$implicit,i=e.oxw(5);e.xp6(1),e.Q6J("ngIf",t&&t.leg===i.currentLeg)}}function Mr(r,l){if(1&r&&(e.ynx(0),e.YNc(1,Zr,2,1,"ng-container",65),e.BQk()),2&r){const t=e.oxw(4);e.xp6(1),e.Q6J("ngForOf",t.listTicketDisplaySelectedAgentMobile)}}function Rr(r,l){if(1&r){const t=e.EpF();e.TgZ(0,"agent-ticket-item",146),e.NdJ("ticketSelected",function(a){e.CHM(t);const n=e.oxw(6);return e.KtG(n.chooseAgentTicket(a))}),e.qZA()}if(2&r){const t=e.oxw().$implicit,i=e.oxw(5);e.Q6J("ticket",t)("listFareRule",i.listFareRule)("listFareRuleClasses",i.listFareRuleClasses)("hasAirportInternational",i.hasAirportInternational)}}function Br(r,l){if(1&r&&(e.ynx(0),e.YNc(1,Rr,1,4,"agent-ticket-item",145),e.BQk()),2&r){const t=l.$implicit,i=l.index,a=e.oxw(5);e.xp6(1),e.Q6J("ngIf",i<a.ticketInfiniteScrollCount&&!a.hasOutOfSeatAgentDisplay(t))}}function Lr(r,l){1&r&&(e.TgZ(0,"div",121),e._uU(1,"C\xe1c chuy\u1ebfn bay h\u1ebft ch\u1ed7"),e.qZA())}function Qr(r,l){if(1&r){const t=e.EpF();e.TgZ(0,"agent-ticket-item",146),e.NdJ("ticketSelected",function(a){e.CHM(t);const n=e.oxw(6);return e.KtG(n.chooseAgentTicket(a))}),e.qZA()}if(2&r){const t=e.oxw().$implicit,i=e.oxw(5);e.Q6J("ticket",t)("listFareRule",i.listFareRule)("listFareRuleClasses",i.listFareRuleClasses)("hasAirportInternational",i.hasAirportInternational)}}function Hr(r,l){if(1&r&&(e.ynx(0),e.YNc(1,Qr,1,4,"agent-ticket-item",145),e.BQk()),2&r){const t=l.$implicit,i=l.index,a=e.oxw(5);e.xp6(1),e.Q6J("ngIf",i<a.ticketInfiniteScrollCount&&a.hasOutOfSeatAgentDisplay(t))}}function Jr(r,l){if(1&r){const t=e.EpF();e.TgZ(0,"div",115),e.NdJ("scrolled",function(){e.CHM(t);const a=e.oxw(4);return e.KtG(a.onScrollDown())}),e.YNc(1,Br,2,1,"ng-container",116),e.YNc(2,Lr,2,0,"div",117),e.YNc(3,Hr,2,1,"ng-container",116),e.qZA()}if(2&r){const t=e.oxw(4);e.Q6J("infiniteScrollDistance",1)("infiniteScrollThrottle",300)("infiniteScrollContainer",".main-scroll-bar")("scrollWindow",!1)("fromRoot",!0)("alwaysCallback",!0),e.xp6(1),e.Q6J("ngForOf",t.listTicketAgentDisplay)("ngForTrackBy",t.ticketTrackByFn),e.xp6(1),e.Q6J("ngIf",t.hasOutOfSeatAgentDisplay()),e.xp6(1),e.Q6J("ngForOf",t.listTicketAgentDisplay)("ngForTrackBy",t.ticketTrackByFn)}}function Or(r,l){if(1&r){const t=e.EpF();e.TgZ(0,"div",126),e._UZ(1,"img",127),e.TgZ(2,"div",128),e._uU(3,"Kh\xf4ng c\xf3 chuy\u1ebfn bay n\xe0o ph\xf9 h\u1ee3p"),e.qZA(),e.TgZ(4,"div",129),e._uU(5," Vui l\xf2ng s\u1eeda \u0111\u1ed5i b\u1ed9 l\u1ecdc cho ph\xf9 h\u1ee3p ho\u1eb7c ch\u1ecdn n\xfat b\xean d\u01b0\u1edbi \u0111\u1ec3 h\u1ee7y vi\u1ec7c l\u1ecdc. "),e.qZA(),e.TgZ(6,"button",130),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(4);return e.KtG(a.onResetFilter())}),e._uU(7," H\u1ee7y l\u1ecdc chuy\u1ebfn bay "),e.qZA()()}2&r&&(e.xp6(6),e.Q6J("type","solid"))}function Ur(r,l){if(1&r&&(e.YNc(0,Mr,2,1,"ng-container",35),e.YNc(1,Jr,4,11,"div",112),e.YNc(2,Or,8,1,"div",131)),2&r){const t=e.oxw(3);e.Q6J("ngIf",t.isMobile),e.xp6(1),e.Q6J("ngIf",t.listTicketAgentDisplay.length),e.xp6(1),e.Q6J("ngIf",!t.listTicketAgentDisplay.length)}}function Yr(r,l){if(1&r&&(e.YNc(0,wr,9,1,"div",124),e.YNc(1,Ur,3,3,"ng-template",null,142,e.W1O)),2&r){const t=e.MAs(2),i=e.oxw(2);e.Q6J("ngIf",i.isSearchAgentEmpty)("ngIfElse",t)}}function qr(r,l){if(1&r&&(e.ynx(0),e.YNc(1,Er,6,0,"ng-container",113),e.YNc(2,Yr,3,2,"ng-template",null,141,e.W1O),e.BQk()),2&r){const t=e.MAs(3),i=e.oxw();e.xp6(1),e.Q6J("ngIf",i.searchFlightAgentLoading)("ngIfElse",t)}}function Gr(r,l){if(1&r){const t=e.EpF();e.TgZ(0,"cf-icon",147),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.onShare())}),e.qZA()}}function jr(r,l){if(1&r&&(e.TgZ(0,"div",43)(1,"div",44),e._uU(2,"T\u1ed5ng chi ph\xed:"),e.qZA(),e.TgZ(3,"div",148),e._uU(4),e.ALo(5,"replace"),e.ALo(6,"number"),e.qZA()()),2&r){const t=e.oxw();e.xp6(4),e.hij(" ",e.Dn7(5,1,e.lcZ(6,5,t.totalPrice+(t.totalPrice?t.totalSurcharge:0)||0),",",".")," \u0111 ")}}let $r=(()=>{class r{constructor(t,i,a,n,o,s,d,u,g,c,h,p,v,C,D,m,k,b,F){var P;this._dataProvider=t,this._ticketSelectedDataProvider=i,this._searchFlightService=a,this._flightDataService=n,this._locationDataService=o,this.cfIconRegister=s,this._router=d,this._modal=u,this._searchInputService=g,this._permissionService=c,this._mobileDetectService=h,this._bottomSheetService=p,this._eventLogService=v,this._userService=C,this._requestDataService=D,this._systemService=m,this._searchMinFareDataProvider=k,this._cdr=b,this._generalService=F,this.tabData=[],this.tabComboDetail={cheapest:{price:0,durationStr:""},best:{price:0,durationStr:""},fastest:{price:0,durationStr:""}},this.listTicketSelected=[],this.ticketSelectedNumber=0,this.totalSurcharge=0,this.currentMode="retail",this.searchFlightLoading=!1,this.searchFlightAllLoading=!1,this.searchFlightAgentLoading=!1,this.searchFlightEmpty=!1,this.isSearchRetailEmpty=!1,this.isSearchAgentEmpty=!1,this.ticketDisplayState=new Be.X({showNetPrice:!1,showSalePrice:!1,hideFareClass:!1,showDuration:!0,showTotalComboPrice:!1,showDiscountFare:!0,showSurchargeFare:!1}),this.destroy$=new mt.x,this.currentLeg=0,this.lastLeg=0,this.listTicket=[],this.listTicketAgent=[],this.listTicketCombo=[],this.airlineList=[],this.fareclassList=[],this.selectedFare={value:""},this.planModelList=[],this.departureTimeList=[],this.arrivalTimeList=[],this.departTimeComboList=[],this.arriveTimeComboList=[],this.departTimeList=[],this.arriveTimeList=[],this.bookingSystemList=[],this.minFareClss="",this.numberOfPassenger={adult:0,child:0,infant:0},this.sortDefault="min_price",this.sortState="min_price",this.sortDefaultCombo="best",this.sortStateCombo="best",this.isFirstTake=!0,this.showQuotation=this._permissionService.hasPermission(L.or.CreateFlightTicketQuote),this.showSharedFlight=this._permissionService.hasPermission(L.or.CanShareFlightSelected),this.isShowBambooPromotionError=!1,this.TICKET_INFINITE_SCROLL_DEFAULT=10,this.TICKET_INFINITE_OFSET_INCREASE=10,this.ticketInfiniteScrollCount=this.TICKET_INFINITE_SCROLL_DEFAULT,this.canEditHeader=this._permissionService.hasPermission(L.or.EditShareFlightSelectedHeader),this.huntBookingFlag=this._permissionService.hasPermission(L.or.CanMonitorHuntFareTicket),this.isShareFlight=!1,this.isHiddenTotalCharge=!1,this.durationFilter=[0,50],this.minDuration=0,this.maxDuration=50,this.priceFilter=[0,0],this.minPrice=0,this.maxPrice=0,this.filterStateInit={showAirline:[],direct:this._searchInputService.isDirectFlight,oneRoute:!1,moreRoute:!1,departTime:[],arriveTime:[],timeTypeFilter:"DEPART",fareclass:[],bookingSystem:[],plane:[],comboTime:{departStartTime:{from:0,to:1440},arriveStartTime:{from:0,to:1440},departEndTime:{from:0,to:1440},arriveEndTime:{from:0,to:1440}},comboDuration:{from:0,to:100},comboPrice:{from:void 0,to:void 0},lccFare:!1,ndcFare:!1,privateFare:!1},this.isMobile=!1,this.progress=0,this.isprogress=!1,this.hoursDifferenceAllowed=3,this.isVerifyComboProgress=!1,this.totalPriceCombo=0,this.hasAirportInternational=!1,this.discountPercentageDetail=new Map,this.searchMinFaresResult=[],this.listDateSearchMinFares=[],this.multiDateBar=[],this.firstCheckExpireTime=!0,this.currentDateType="DEPART",this.surchargeConfigs=[],this.FlightTypeSearch=M.jX,this.flightTypeSearch=M.jX.RoundTrip,this.multiFilghtType=M.jX.MultiWay,this.previousScrollLeft=0,this.itemWidth=114,this.scrollAmount=3*this.itemWidth,s.registerIcons([x.bHT,x.D5L,x.TM4,x.gll,x.TOh,x.KYu,x.tLH,x.IIV,x.gEm,x.D7,x.a04,x.Xlt,x.$S,x.okA,x.B2I,x.s5C,x._hx,x.YvC,x.YwC,x.rJw,x.toh,x.wvd]),g.patchForm(),this.onSurchargeSearch=(null===(P=this._generalService.getAgentConfig())||void 0===P?void 0:P.onSurchargeSearch)||!1,this.ticketDisplayState.next(Object.assign(Object.assign({},this.ticketDisplayState.value),{showSurchargeFare:this.onSurchargeSearch})),this.getSurchargeFeeConfig(),this.initMinFareOption(),this.initDateSearchMinFare(),this.generateRangeDateBar(),k.searchMinFareData&&k.searchMinFareData.length>0&&(this.searchMinFaresResult=k.searchMinFareData||[],this.searchMinFaresResult.forEach(A=>{A.data instanceof Map||(A.data=new Map(Object.entries(A.data)))}),this.mappingMinFares(0))}ngAfterViewInit(){setTimeout(()=>{const i=f(this._dataProvider.searchInputData.journey[0].departDate).format("YYYY-MM-DD");this.scrollDate(i)},0)}scrollDate(t){let i;i=this._mobileDetectService.isMobile()?document.getElementById(t+"-mobile"):document.getElementById(t),i&&i.scrollIntoView({behavior:"smooth",block:"nearest",inline:"center"})}ngOnInit(){this.hasAirportInternational=this._searchInputService.hasAirportInternational,this.checkMobile(),this.ticketFilterState=new Be.X(this.filterStateInit),this.ticketDisplayState.pipe((0,Le.R)(this.destroy$)).subscribe({next:()=>this.loadTicketDisplay()}),this.ticketFilterState.pipe((0,Le.R)(this.destroy$)).subscribe({next:()=>{"combo"===this.currentMode?this.loadComboTicketFilter():this.loadTicketFilter()}}),this.bindingTypeSearch(),this.loadNumberOfPassenger(),this.searchFlight(),this.loadTabData(),this.loadTicketSelectedData(),this._searchInputService.navigateDatepicker$.subscribe({next:t=>{t&&this.onNavigateDatepicker(t)}})}getSurchargeFeeConfig(){this._generalService.getSurchargeFeeConfig().subscribe({next:t=>{t.success&&t.data&&((0,ne.t)(t.data,this.surchargeConfigs)||(localStorage.setItem("surchargeConfigs",JSON.stringify(t.data)),this.surchargeConfigs=t.data))}})}initMinFareOption(){this.minFareOptionConfig={minPrice:new Map,airlineMinPrice:[{airline:T.QK.VJ,airlineName:"Vietjet Air",color:"#E03C31",selected:!0},{airline:T.QK.VN,airlineName:"Vietnam Airlines",color:"#2E5EAA",selected:!0},{airline:T.QK.VU,airlineName:"Vietravel Airlines",color:"#FCB40A",selected:!0},{airline:T.QK.QH,airlineName:"Bamboo Airways",color:"#07A35D",selected:!0}],isRangeMinFare:"ROUND_TRIP"===this._searchInputService.flightType,showMinPrice:!0,showLunarDate:!0}}initDateSearchMinFare(t=new Date){this.listDateSearchMinFares=[];const i=f(t).format("YYYY-MM-DD"),a=f(t).add(1,"month").startOf("month").format("YYYY-MM-DD");this.listDateSearchMinFares.push(i),this.listDateSearchMinFares.push(a)}startProgressBar(){this.isprogress=!0,this.interval=setInterval(()=>{if(this.progress<99){const t=25*Math.random();this.progress+=t,this.progress>100&&(this.progress=99)}else clearInterval(this.interval)},1500)}ngOnDestroy(){this._searchInputService.reset(),this.destroy$.next(),this.destroy$.complete(),this.clearTimer(),this._searchMinFareDataProvider.removeSearchMinFareData()}checkMobile(){this._mobileDetectService.mobileSubject.subscribe(t=>this.isMobile=t)}modeChange(t){this.currentMode=t,this.ticketInfiniteScrollCount=this.TICKET_INFINITE_SCROLL_DEFAULT}initMultiSystem(t){this.bookingSystemList=t.has(T.QK.GDS)||t.has(T.QK.BSP)||t.has(T.QK.AIR_1G)?[{code:"DOMESTIC",name:"C\xe1c h\xe3ng n\u1ed9i \u0111\u1ecba",isActive:!1,isDisable:!1},{code:T.QK.BSP,name:"H\u1ec7 th\u1ed1ng 1A",isActive:!1,isDisable:!1},{code:T.QK.AIR_1G,name:"H\u1ec7 th\u1ed1ng 1G",isActive:!1,isDisable:!1},{code:T.QK.FLY_ONE,name:"C\xe1c h\xe3ng LCC",isActive:!1,isDisable:!1},{code:T.QK.BZT,name:"H\u1ec7 th\u1ed1ng BZT",isActive:!1,isDisable:!1},{code:T.QK.ST,name:"H\u1ec7 th\u1ed1ng ST",isActive:!1,isDisable:!1},{code:T.QK.HG,name:"H\u1ec7 th\u1ed1ng HG",isActive:!1,isDisable:!1}]:[]}initFilterAirline(){var t,i,a;let n=[{name:"Early Morning",code:"early_morning",start:"00:00",end:"06:00",isActive:!1,disable:!1,startTime:0,endTime:360,totalAvailable:0},{name:"Morning",code:"morning",start:"06:00",end:"12:00",isActive:!1,disable:!1,startTime:360,endTime:720,totalAvailable:0},{name:"Afternoon",code:"afternoon",start:"12:00",end:"18:00",isActive:!1,disable:!1,startTime:720,endTime:1080,totalAvailable:0},{name:"Evening",code:"evening",start:"18:00",end:"24:00",isActive:!1,disable:!1,startTime:1080,endTime:1440,totalAvailable:0},{name:"T\xf9y ch\u1ecdn",code:"custom",start:"00:00",end:"23:59",isActive:!1,disable:!1,startTime:0,endTime:1439,totalAvailable:0}],o=[{name:"Early Morning",code:"early_morning",start:"00:00",end:"06:00",isActive:!1,disable:!1,startTime:0,endTime:360,totalAvailable:0},{name:"Morning",code:"morning",start:"06:00",end:"12:00",isActive:!1,disable:!1,startTime:360,endTime:720,totalAvailable:0},{name:"Afternoon",code:"afternoon",start:"12:00",end:"18:00",isActive:!1,disable:!1,startTime:720,endTime:1080,totalAvailable:0},{name:"Evening",code:"evening",start:"18:00",end:"24:00",isActive:!1,disable:!1,startTime:1080,endTime:1440,totalAvailable:0},{name:"T\xf9y ch\u1ecdn",code:"custom",start:"00:00",end:"23:59",isActive:!1,disable:!1,startTime:0,endTime:1439,totalAvailable:0}],s=[];null!==(t=this.searchFlightData.flightOptions)&&void 0!==t&&t.length&&"COMBO"!==this.searchFlightData.flightOptions[0].type&&(s=this.searchFlightData.flightOptions.flatMap(h=>h.journeys).map(h=>({airline:h.airline,airlineName:h.airlineName})).filter((h,p,v)=>v.findIndex(C=>C.airline===h.airline)===p));let d=new Map,u=Number.MAX_SAFE_INTEGER,g=new Set,c=new Map;!(null===(i=this.searchFlightData.flightOptions)||void 0===i)&&i.length&&this.searchFlightData.flightOptions.forEach(h=>{g.add(h.provider),"COMBO"!==this.searchFlightData.flightOptions[0].type&&h.journeys.forEach(p=>p.fareOptions.forEach(v=>{v.fareInfos.forEach(C=>{var D,m,k,b,F,P,A;v.getTotalAmount()<u&&(u=v.getTotalAmount(),C.cabin&&!(null===(D=C.cabin)||void 0===D)&&D.name&&(this.minFareClss=C.cabin.name.toUpperCase())),d.set(null===(k=null===(m=C.cabin)||void 0===m?void 0:m.name)||void 0===k?void 0:k.toUpperCase(),Object.assign(Object.assign({},C.cabin),{description:null===(F=null===(b=C.cabin)||void 0===b?void 0:b.description)||void 0===F?void 0:F.toUpperCase(),name:null===(A=null===(P=C.cabin)||void 0===P?void 0:P.name)||void 0===A?void 0:A.toUpperCase(),isActive:!1,isDisable:!1}))}),p.segments.forEach(C=>{C.modelAirplane&&c.set(C.modelAirplane,{code:C.modelAirplane,name:C.modelAirplaneName||C.modelAirplane,isActive:!1,isDisable:!1})}),n.forEach(C=>{const D=f(p.departure.localTime).toDate(),m=60*D.getHours()+D.getMinutes();m>=C.startTime&&m<=C.endTime&&(C.totalAvailable=++C.totalAvailable)}),o.forEach(C=>{const D=f(p.arrival.localTime).toDate(),m=60*D.getHours()+D.getMinutes();m>=C.startTime&&m<=C.endTime&&(C.totalAvailable=++C.totalAvailable)})}))}),this.initMultiSystem(g),this.fareclassList=[...d.values()].filter(h=>h.name).map(h=>h),this.selectedFare.value=(null===(a=this.fareclassList.find(h=>h.isActive))||void 0===a?void 0:a.name)||"",this.planModelList=[...c.values()],this.departureTimeList=this._dataProvider.searchInputData.journey.map(h=>[...n.map(p=>(0===p.totalAvailable&&(p.disable=!0),Object.assign({},p)))]),this.arrivalTimeList=this._dataProvider.searchInputData.journey.map(h=>[...o.map(p=>(0===p.totalAvailable&&(p.disable=!0),Object.assign({},p)))]),this._dataProvider.searchInputData.journey.length>1&&(this.departTimeComboList=this._dataProvider.searchInputData.journey.map(h=>({departCode:`${this._locationDataService.getCityNameByCode(h.startPoint)} (${h.startPoint})`,departTime:h.departDate})),this.departTimeList=[this.departTimeComboList[this.currentLeg]],this.arriveTimeComboList=this._dataProvider.searchInputData.journey.reverse().map(h=>({departCode:`${this._locationDataService.getCityNameByCode(h.startPoint)} (${h.startPoint})`,departTime:h.departDate})),this.arriveTimeList=[this.arriveTimeComboList[this.currentLeg]]),1===this._dataProvider.searchInputData.journey.length&&(this.departTimeComboList=this._dataProvider.searchInputData.journey.map(h=>({departCode:`${this._locationDataService.getCityNameByCode(h.startPoint)} (${h.startPoint})`,departTime:h.departDate})),this.arriveTimeComboList=this._dataProvider.searchInputData.journey.map(h=>({departCode:`${this._locationDataService.getCityNameByCode(h.endPoint)} (${h.endPoint})`,departTime:h.departDate}))),this.airlineList=s.map(h=>({code:h.airline,name:h.airlineName||h.airline,actived:!1})),this.airlineList.filter(h=>h.actived).length===this.airlineList.length?this.airlineList.forEach(h=>h.actived=!1):0!==this.airlineList.filter(h=>h.actived).length&&this.ticketFilterState.next(Object.assign(Object.assign({},this.ticketFilterState.value),{showAirline:this.airlineList.filter(h=>h.actived).map(h=>h.code)}))}initComboFilter(){var t,i;let a=new Set;null===(t=this.searchFlightData.flightOptions)||void 0===t||t.forEach(s=>{a.add(s.provider)}),this.initMultiSystem(a);let n=[];n=null===(i=this.searchFlightData.flightOptions)||void 0===i?void 0:i.flatMap(s=>s.comboInfo).flatMap(s=>[{airline:s.departJourneys[0].airline,airlineName:s.departJourneys[0].airlineName},{airline:s.arriveJourneys[0].airline,airlineName:s.arriveJourneys[0].airlineName}]).filter((s,d,u)=>u.findIndex(g=>g.airline===s.airline)===d),this.airlineList=n.map(s=>({code:s.airline,name:s.airlineName||s.airline,actived:!1})),this.departTimeComboList=this._dataProvider.searchInputData.journey.map(s=>({departCode:`${this._locationDataService.getCityNameByCode(s.startPoint)} (${s.startPoint})`,departTime:s.departDate})),this.arriveTimeComboList=this._dataProvider.searchInputData.journey.reverse().map(s=>({departCode:`${this._locationDataService.getCityNameByCode(s.startPoint)} (${s.startPoint})`,departTime:s.departDate}));const o=this.listTicketCombo.map(s=>s.departOptions[0].totalPrice+s.arriveOptions[0].totalPrice);this.priceFilter=[Math.min(...o),Math.max(...o)],this.minPrice=this.priceFilter[0],this.maxPrice=this.priceFilter[1]}checkQHPromotionError(){this.isShowBambooPromotionError=!(this.airlineList.find(t=>"QH"===t.code)||!this._dataProvider.searchInputData.promotion.find(t=>"QH"===t.airline)||!this._dataProvider.searchInputData.journey.find(t=>t.airline.includes("QH")||t.airline.includes("qh")))}filterChange(t){this.ticketFilterState.next(Object.assign(Object.assign({},this.ticketFilterState.value),t))}displayChange(t){this.ticketDisplayState.next(Object.assign(Object.assign({},this.ticketDisplayState.value),t))}loadNumberOfPassenger(){this.numberOfPassenger={adult:this._dataProvider.searchInputData.adult,child:this._dataProvider.searchInputData.child,infant:this._dataProvider.searchInputData.infant}}onScrollDown(){this.ticketInfiniteScrollCount+=this.TICKET_INFINITE_OFSET_INCREASE}loadTabData(){this.tabData=this._dataProvider.searchInputData.journey.map((t,i)=>({startPoint:t.startPoint,endPoint:t.endPoint,departDate:(0,I.p6)(t.departDate,"EEEE","vi-VN")+", ng\xe0y "+(0,I.p6)(t.departDate,"dd/MM/yyyy","vi-VN"),departDateQuotation:t.departDate,mobileDepartDate:(0,I.p6)(t.departDate,"EEEEEE-dd/MM","vi-VN"),active:0===i,leg:i})),this.lastLeg=this.tabData.length-1,this.currentLeg>this.lastLeg&&(this.currentLeg=this.lastLeg)}loadTicketSelectedData(){this.listTicketSelected=this._dataProvider.searchInputData.journey.map((t,i)=>({startPoint:this._locationDataService.getCityNameByCode(t.startPoint),endPoint:this._locationDataService.getCityNameByCode(t.endPoint),departDate:(0,I.p6)(t.departDate,"EEEE, dd/MM/yyyy","vi-VN"),startCode:t.startPoint,endCode:t.endPoint,airlineLogo:"",provider:"",airline:"",airlineName:"",operating:"",operatingName:"",flight:"",startTime:new Date((new Date).setHours(0,0,0,0)),endTime:new Date((new Date).setHours(0,0,0,0)),startTerminal:"",endTerminal:"",expireTime:(new Date).getMilliseconds(),duration:"",highlight:0===i,selected:!1,actived:!1,numOfStop:0,totalPrice:0,totalDiscountFarePrice:0,hasDiscountFare:!1,showDiscountFare:!1,journeyKey:"",journeyFareClass:"",fareOptionKey:"",lccFare:!1,sessionId:"",segments:[],bookingType:"b2c",leg:i,isHiddenTotalCharge:!1,bagCharge:0,seatCharge:0,surcharge:0,showSurchargeFare:!1,comboRefs:[]})),this.listTicketDisplaySelectedMobile=this._dataProvider.searchInputData.journey.map(t=>{}),this.listTicketDisplaySelectedAgentMobile=this._dataProvider.searchInputData.journey.map(t=>{})}tabChangeIndex(t){this.currentLeg=t,this.autoInactivePreview(),this.departTimeList=[this.departTimeComboList[this.currentLeg]],this.arriveTimeList=[this.arriveTimeComboList[this.currentLeg]],this.loadTicketFilter()}chooseTicket(t){const i=()=>{this.listTicketSelected[t.leg].airlineLogo=t.airlineLogo,this.listTicketSelected[t.leg].provider=t.provider,this.listTicketSelected[t.leg].airline=t.airline,this.listTicketSelected[t.leg].airlineName=t.airlineName,this.listTicketSelected[t.leg].operating=t.operating,this.listTicketSelected[t.leg].operatingName=t.operatingName,this.listTicketSelected[t.leg].flight=t.flightNumber,this.listTicketSelected[t.leg].startTime=t.startTime,this.listTicketSelected[t.leg].endTime=t.endTime,this.listTicketSelected[t.leg].startTerminal=t.startTerminal,this.listTicketSelected[t.leg].endTerminal=t.endTerminal,this.listTicketSelected[t.leg].duration=t.durationStr,this.listTicketSelected[t.leg].expireTime=t.expireTime,this.listTicketSelected[t.leg].numOfStop=t.stopStatus,this.listTicketSelected[t.leg].selected=!0,this.listTicketSelected[t.leg].bookingType="b2c",this.listTicketSelected[t.leg].totalPrice=t.ticketDetail.totalCharge,this.listTicketSelected[t.leg].totalDiscountFarePrice=t.ticketDetail.totallDiscountFareCharge,this.listTicketSelected[t.leg].hasDiscountFare=t.hasDiscountFare,this.listTicketSelected[t.leg].sessionId=t.sessionKey||"",this.listTicketSelected[t.leg].journeyKey=t.journeyKey,this.listTicketSelected[t.leg].journeyFareClass=t.journeyFareClass,this.listTicketSelected[t.leg].lccFare=t.lccFare,this.listTicketSelected[t.leg].fareOptionKey=t.fareOptionKey,this.listTicketSelected[t.leg].segments=t.segments,this.listTicketSelected[t.leg].actived=!0,this.listTicketSelected[t.leg].leg=t.leg,this.listTicketSelected[t.leg].ticketPrice=t.ticketDetail,this.listTicketSelected[t.leg].fareRule=this.listFareRule.find(a=>{var n,o;return a.airline===t.airline&&(null===(n=a.fareClass)||void 0===n?void 0:n.toLowerCase())===(null===(o=t.fareType)||void 0===o?void 0:o.toLowerCase())})||null,this.listTicketSelected[t.leg].handBag=t.handBag,this.listTicketSelected[t.leg].checkedBag=t.checkedBag,this.listTicketSelected[t.leg].isHiddenTotalCharge=0===t.ticketDetail.totalCharge&&"VN"===t.airline&&"agency"===this.currentMode,this.listTicketSelected[t.leg].surcharge=t.surCharge,this.listTicketSelected[t.leg].showSurchargeFare=t.showSurchargeFare,this.listTicketDisplaySelectedMobile[t.leg]=t,this.caculateTotalPrice(),this.caculateTicketSelectedNumber(),this.moveToNextJourney(),this.checkShareFlight(),this.showTotalCharge()};if(this.listTicketSelected[t.leg].journeyKey)if(this.listTicketSelected[this.currentLeg].journeyKey)this.reselect(t.leg),i();else{const{startTime:a,endTime:n}=this.listTicketSelected[t.leg];this.listTicketSelected[t.leg].startTime=t.startTime,this.listTicketSelected[t.leg].endTime=t.endTime;for(const[o,s]of this.listTicketSelected.entries())if(o>0){const d=this.listTicketSelected[o-1];if((s.startTime.getTime()-d.endTime.getTime())/36e5<=this.hoursDifferenceAllowed)return this._modal.open(E.bK,{}),this.listTicketSelected[t.leg].startTime=a,void(this.listTicketSelected[t.leg].endTime=n);i()}}else i();this.isMobile&&this.tabScrollEl&&this.listTicketSelected.findIndex(a=>!a.selected)&&this.tabScrollEl.nativeElement.scrollIntoView({behavior:"smooth",block:"center"})}checkShareFlight(){var t;this.isShareFlight=null===(t=this.listTicketSelected)||void 0===t?void 0:t.some(i=>i.segments.length)}autoInactivePreview(){this.listTicketSelected.forEach(t=>{t.highlight=t.leg===this.currentLeg,t.actived=!!t.journeyKey})}convertComboTicketToTicketSelectedVM(t,i,a){const n=Re.cloneDeep(this.listTicketSelected[i]);return n.airlineLogo=t.airlineLogo,n.provider=t.provider,n.airline=t.airline,n.airlineName=t.airlineName,n.flight=t.flightNumber,n.startCode=t.startPoint,n.startPoint=t.startPointName,n.endCode=t.endPoint,n.endPoint=t.endPointName,n.startTime=t.departureDate,n.endTime=t.returnDate,n.startTerminal=t.startTerminal,n.endTerminal=t.endTerminal,n.expireTime=t.expireTime,n.duration=t.durationStr,n.numOfStop=t.numOfStop,n.selected=!0,n.bookingType="combo",n.totalPrice=t.ticketPrice.totalCharge,n.totalDiscountFarePrice=t.ticketPrice.totallDiscountFareCharge,n.hasDiscountFare=a.hasDiscountFare,n.journeyKey=t.journeyKey,n.fareOptionKey=t.fareOptionKey,n.actived=!0,n.leg=i,n.ticketPrice=t.ticketPrice,n.fareRule={airline:t.airline,fareClass:"VN"===t.airline?t.fareClass||"":t.fareType||"",rules:[]},n.handBag=t.handBaggage||"",n.checkedBag=t.checkedBaggage||"",n.isHiddenTotalCharge=!1,n.journeyFareClass=t.journeyFareClass||"",n.sessionId="",n.segments=t.segments.map(o=>({segmentKey:o.key,fareType:o.fareType,fareClass:o.fareClass,airline:o.airline,airlineName:o.airlineName,airlineLogo:this._flightDataService.getAirlineLogoByCode(o.airline),operating:o.operating,operatingName:o.operatingName,mobileAirlineLogo:o.mobileAirlineLogo,jetCode:o.modelAirplane,startCode:o.startPoint,endCode:o.endPoint,startPoint:o.startPointName,endPoint:o.endPointName,departDate:o.startDate,arrivalDate:o.endDate,startTerminal:o.startTerminal,endTerminal:o.endTerminal,flightNumber:o.flightNumber,modelAirplane:o.modelAirplane,modelAirplaneName:o.modelAirplaneName,stopPoint:o.stopPoint,duration:"",handBag:o.handBaggage,checkedBag:o.checkedBaggage})),n.comboRefs=t.comboRefs,n}chooseComboTicket(t,i){var a;const n=null===(a=t[0].comboRefs)||void 0===a?void 0:a.find(o=>o.key===t[1].fareOptionKey);t.forEach((o,s)=>{this.listTicketSelected[s]=this.convertComboTicketToTicketSelectedVM(o,s,i),this.listTicketSelected[s].sessionId=(null==n?void 0:n.sessionId)||""}),this.caculateTotalPrice(),this.moveToNextJourney()}chooseAgentTicket(t){var i,a;this.listTicketSelected[t.leg].airlineLogo=t.airlineLogo,this.listTicketSelected[t.leg].provider=t.provider,this.listTicketSelected[t.leg].airline=t.airline,this.listTicketSelected[t.leg].airlineName=t.airlineName,this.listTicketSelected[t.leg].operating=t.operating,this.listTicketSelected[t.leg].operatingName=t.operatingName,this.listTicketSelected[t.leg].flight=t.segmentsDisplay[0].flightNumber,this.listTicketSelected[t.leg].startTime=t.departure.localTime,this.listTicketSelected[t.leg].endTime=t.arrival.localTime,this.listTicketSelected[t.leg].expireTime=t.expireTime,this.listTicketSelected[t.leg].duration=t.durationStr,this.listTicketSelected[t.leg].numOfStop=t.numOfStop,this.listTicketSelected[t.leg].ticketPrice=t.ticketDetail,this.listTicketSelected[t.leg].selected=!0,this.listTicketSelected[t.leg].bookingType="b2b",this.listTicketSelected[t.leg].fareRule=t.fareRule,this.listTicketSelected[t.leg].journeyFareClass=(null===(i=null==t?void 0:t.fareRule)||void 0===i?void 0:i.fareClass)||"";const n=t.segmentsDisplay.flatMap(o=>{var s;const d=o.fareClasses.find(u=>u.isSelected);return d?(this.listTicketSelected[t.leg].ticketPrice=d.ticketPriceDetail,(null===(s=d.ticketPriceDetail)||void 0===s?void 0:s.totalCharge)||0):0}).reduce((o,s)=>o+s,0);this.listTicketSelected[t.leg].totalPrice=n,this.listTicketSelected[t.leg].journeyKey=t.journeyKey,this.listTicketSelected[t.leg].isHiddenTotalCharge=0===n&&"VN"===t.airline&&"agency"===this.currentMode,this.listTicketSelected[t.leg].fareOptionKey=null===(a=t.segmentsDisplay[0].fareClasses.find(o=>o.isSelected))||void 0===a?void 0:a.fareOptionKey,this.listTicketSelected[t.leg].segments=t.segmentDetails.map((o,s)=>{var d,u,g,c;return{segmentKey:o.segmentKey,fareClass:"VJ"===t.airline||"QH"===t.airline?null===(d=t.segmentsDisplay[0].fareClasses.find(h=>h.isSelected))||void 0===d?void 0:d.fareClass:null===(u=t.segmentsDisplay[s].fareClasses.find(h=>h.isSelected))||void 0===u?void 0:u.fareClass,fareType:"VJ"===t.airline||"QH"===t.airline?null===(g=t.segmentsDisplay[0].fareClasses.find(h=>h.isSelected))||void 0===g?void 0:g.fareType:null===(c=t.segmentsDisplay[s].fareClasses.find(h=>h.isSelected))||void 0===c?void 0:c.fareType,airline:o.airline,airlineName:o.airlineName,airlineLogo:this._flightDataService.getAirlineLogoByCode(o.airline),operating:o.operating,operatingName:o.operatingName,jetCode:o.jetCode,startCode:o.startCode,endCode:o.endCode,startPoint:o.startPoint,endPoint:o.endPoint,departDate:o.departDate,arrivalDate:o.arrivalDate,startTerminal:o.startTerminal,endTerminal:o.endTerminal,flightNumber:o.flightNumber,modelAirplane:o.modelAirplane,modelAirplaneName:o.modelAirplaneName,stopPoint:o.stopPoint,duration:o.durationStr,handBag:o.handBag||"",checkedBag:o.checkedBag||""}}),this.listTicketDisplaySelectedAgentMobile[t.leg]=t,this.autoInactivePreview(),this.caculateTotalPrice(),this.caculateTicketSelectedNumber(),this.moveToNextJourney(),this.showTotalCharge(),this.checkShareFlight()}showTotalCharge(){this.isHiddenTotalCharge=this.listTicketSelected.some(t=>t.isHiddenTotalCharge)}reselect(t){this.listTicketSelected[t].airlineLogo="",this.listTicketSelected[t].airline="",this.listTicketSelected[t].journeyKey="",this.listTicketSelected[t].flight="",this.listTicketSelected[t].startTime=new Date,this.listTicketSelected[t].endTime=new Date,this.listTicketSelected[t].duration="",this.listTicketSelected[t].numOfStop=-1,this.listTicketSelected[t].selected=!1,this.listTicketSelected[t].totalPrice=0,this.listTicketSelected[t].segments=[],this.listTicketSelected[t].isHiddenTotalCharge=!1,this.listTicketDisplaySelectedMobile[t]=void 0,this.listTicketDisplaySelectedAgentMobile[t]=void 0,this.tabChangeIndex(t),this.caculateTotalPrice(),this.caculateTicketSelectedNumber(),this.checkShareFlight(),this.showTotalCharge(),this.ticketInfiniteScrollCount+=1}caculateTotalPrice(){var t,i;this.totalPrice=this.listTicketSelected.map(a=>a.totalPrice).reduce((a,n)=>a+n),this.totalDiscountFareCharge=this.listTicketSelected.map(a=>a.totalDiscountFarePrice).reduce((a,n)=>a+n),this.totalPriceCombo=(null===(i=null===(t=this.listTicketSelected[0].comboRefs)||void 0===t?void 0:t.find(a=>a.key===this.listTicketSelected[1].fareOptionKey))||void 0===i?void 0:i.totalAllPaxPriceCombo)||0,this.totalSurcharge=this.listTicketSelected.reduce((a,n)=>a+n.surcharge*(this.numberOfPassenger.adult+this.numberOfPassenger.child),0)}caculateTicketSelectedNumber(){this.ticketSelectedNumber=this.listTicketSelected.filter(t=>t.selected).length}moveToNextJourney(){const t=this.listTicketSelected.findIndex(i=>!i.selected);if(-1==t)if(this.isMobile){const i=this.listTicketSelected.some(n=>n.provider.toUpperCase()===T.QK.IVS),a=this._bottomSheetService.open(E.GM,{headerTitle:"X\xe1c nh\u1eadn chuy\u1ebfn bay \u0111\xe3 ch\u1ecdn",rightButtonIcon:"close",leftButtonIcon:"share",containerFullHeigh:!0,rightButtonIconClass:"text-neutral-gray-4",data:{ticketsSelected:this.listTicketSelected,totalPrice:this.totalPrice,totalPriceCombo:this.totalPriceCombo,hasIVSProvider:i}});a.containerInstance._leftButtonClick.subscribe(n=>{const o=this._bottomSheetService.open(E.eP,{headerTitle:"Chia s\u1ebb c\xe1c chuy\u1ebfn bay l\u1ef1a ch\u1ecdn",leftButtonIcon:"",leftButtonIconClass:"text-neutral-gray-4",rightButtonIcon:"close",containerFullHeigh:!0,data:{ticketsSelected:this.listTicketSelected,canEditHeader:this.canEditHeader,totalPrice:this.listTicketSelected.map(s=>s.totalPrice).reduce((s,d)=>s+d),isHiddenTotalCharge:this.isHiddenTotalCharge}});o.containerInstance._rightButtonClick.subscribe(s=>o.dismiss())}),a.afterDismissed().subscribe(n=>{n?(this._ticketSelectedDataProvider.ticketSelectedData=this.listTicketSelected,this._eventLogService.captureConfirmFlyBook(),this._router.navigate(["/admin/passenger-info"])):(this._eventLogService.captureConfirmFlyCancle(),"combo"===this.currentMode?(this.reselect(0),this.reselect(1)):this.reselect(this.currentLeg),this.checkShareFlight())})}else{const i=this.listTicketSelected.some(n=>n.provider.toUpperCase()===T.QK.IVS);this._modal.open(E.u9,{ticketsSelected:this.listTicketSelected,totalPrice:this.totalPrice,totalPriceCombo:this.totalPriceCombo,totalDiscountFareCharge:this.totalDiscountFareCharge,enabledBooking:[L.or.CanBookingFlightTicket,L.or.CanIssuedFlightTicket].some(n=>this._permissionService.hasPermission(n)),showSharedFlight:this.showSharedFlight,hasIVSProvider:i}).afterClosed$.subscribe({next:n=>{"backdropClick"===n.type||0==n.data?(this._eventLogService.captureConfirmFlyCancle(),"combo"===this.currentMode?(this.reselect(0),this.reselect(1)):this.reselect(this.currentLeg),this.checkShareFlight()):(this._ticketSelectedDataProvider.ticketSelectedData=this.listTicketSelected,this._eventLogService.captureConfirmFlyBook(),this._router.navigate(["/admin/passenger-info"]))}})}else this.tabChangeIndex(t)}searchFlight(){this.searchFlightData=new re.Vw,this.listTicket=[],this.listTicketDisplay=[],this._systemService.isFeatureEnabled(T.Ke.Web_Features_Search_SeparateSearch_Enable)?this.separateSearchFlight():this.searchAllFlight()}searchAllFlight(){var t,i,a,n;this._mobileDetectService.collapseSidebarSubject.next(!0),this.startProgressBar();const o=this._dataProvider.searchInputData.promotion.find(u=>"VJ"===u.airline),s=this._dataProvider.searchInputData.promotion.find(u=>"QH"===u.airline),d=this._dataProvider.searchInputData.promotion.find(u=>"VN"===u.airline);this.isSearchRetailEmpty=!1,this.searchFlightLoading=!0,this._searchFlightService.searchFlight({agentPromotion:this._dataProvider.searchInputData.agentPromotion,adultCount:this.numberOfPassenger.adult,childCount:this.numberOfPassenger.child,infantCount:this.numberOfPassenger.infant,promoCodeVJ:o?o.code:"",promoCodeQH:s?s.code:"",promoCodeVN:d?d.code:"",flightsRequest:this._dataProvider.searchInputData.journey.map((u,g)=>({providers:u.airline,startPoint:u.startPoint,leg:g,endPoint:u.endPoint,departDate:(0,I.p6)(u.departDate,"yyyy-MM-dd","vi-VN")})),cabin:(null===(i=null===(t=this._searchInputService.cabinList)||void 0===t?void 0:t.find(u=>u.actived))||void 0===i?void 0:i.value)||"",paxType:(null===(n=null===(a=this._searchInputService.paxTypeList)||void 0===a?void 0:a.find(u=>u.actived))||void 0===n?void 0:n.value)||""},this._dataProvider.searchInputData.type).pipe((0,X.x)(()=>{this.progress=100,setTimeout(()=>{this.isprogress=!1},1e3),this.searchFlightLoading=!1})).subscribe({next:u=>{var g,c,h,p,v,C,D,m,k;this.searchFlightData=u.data,!(null===(g=u.data)||void 0===g)&&g.discountPercentageDetail&&(this.discountPercentageDetail=new Map(Object.entries(null===(c=u.data)||void 0===c?void 0:c.discountPercentageDetail))),null!==(h=this.searchFlightData)&&void 0!==h&&h.flightOptions&&u.success&&null!==(p=this.searchFlightData)&&void 0!==p&&p.flightOptions.length||(this.isSearchRetailEmpty=!0),!(null===(v=this.searchFlightData)||void 0===v)&&v.flightOptions&&!(null===(C=this.searchFlightData)||void 0===C)&&C.flightOptions.length&&"COMBO"===(null===(D=this.searchFlightData)||void 0===D?void 0:D.flightOptions[0].type)&&(this.currentMode="combo"),this.listFareRule=null===(m=u.data)||void 0===m?void 0:m.fareRules,this.listFareRuleClasses=null===(k=u.data)||void 0===k?void 0:k.fareRuleClasses;try{this.convertAllTicket()}catch(b){console.log(b),this._searchFlightService.sendErrorDataSearch(JSON.stringify(u),b.message+b.stack,this._userService.currentUserSubject.value.data.displayName).subscribe({next:()=>console.log("Send error data success"),error(F){console.log("Send error data fail")}})}this.loadTicketDisplay(),"combo"===this.currentMode?this.initComboFilter():this.initFilterAirline(),this.checkQHPromotionError(),this.loadTicketFilter(),this.loadComboTicketFilter(),this.initTicketExpireTimer()},error:()=>{this.isSearchRetailEmpty=!0}})}separateSearchFlight(){var t,i,a,n;this._mobileDetectService.collapseSidebarSubject.next(!0),this.searchFlightData&&(this.searchFlightData.flightOptions=[]),this.firstCheckExpireTime=!0,this.startProgressBar();const o=this._dataProvider.searchInputData.promotion.find(v=>"VJ"===v.airline),s=this._dataProvider.searchInputData.promotion.find(v=>"QH"===v.airline),d=this._dataProvider.searchInputData.promotion.find(v=>"VN"===v.airline);this.isSearchRetailEmpty=!1,this.searchFlightLoading=!0,this.searchFlightAllLoading=!0;const c={agentPromotion:this._dataProvider.searchInputData.agentPromotion,adultCount:this.numberOfPassenger.adult,childCount:this.numberOfPassenger.child,infantCount:this.numberOfPassenger.infant,promoCodeVJ:o?o.code:"",promoCodeQH:s?s.code:"",promoCodeVN:d?d.code:"",flightsRequest:this._dataProvider.searchInputData.journey.map((v,C)=>({providers:v.airline,startPoint:v.startPoint,leg:C,endPoint:v.endPoint,departDate:(0,I.p6)(v.departDate,"yyyy-MM-dd","vi-VN")})),cabin:(null===(i=null===(t=this._searchInputService.cabinList)||void 0===t?void 0:t.find(v=>v.actived))||void 0===i?void 0:i.value)||"",paxType:(null===(n=null===(a=this._searchInputService.paxTypeList)||void 0===a?void 0:a.find(v=>v.actived))||void 0===n?void 0:n.value)||""},h=this.callApiSearch(c,["VN","FLY_ONE","GDS","BSP","AIR_1G","BZT","ST","HG"],this._dataProvider.searchInputData.type),p=this.callApiSearch(c,["VJ","QH","VU"],this._dataProvider.searchInputData.type);(0,ft.T)(h,p).pipe((0,X.x)(()=>{this.progress=100,setTimeout(()=>{this.isprogress=!1},1e3),this.searchFlightLoading=!1,this.searchFlightAllLoading=!1})).subscribe({next:v=>{v&&this.handleSearchResponse(v)},error:()=>{this.isSearchRetailEmpty=!0}})}callApiSearch(t,i,a){var n,o;const s=structuredClone(t),d=(null===(o=null===(n=s.flightsRequest[0].providers.split(","))||void 0===n?void 0:n.filter(u=>i.includes(u)))||void 0===o?void 0:o.join(","))||"";return s.flightsRequest.forEach(u=>{u.providers=d}),null!=d&&d.length?this._searchFlightService.searchFlight(s,a):(0,U.of)(null)}handleSearchResponse(t){var i,a,n,o,s,d,u,g,c,h,p,v;this.searchFlightData=Object.assign(Object.assign({},t.data),{flightOptions:[...(null===(i=this.searchFlightData)||void 0===i?void 0:i.flightOptions)||[],...(null===(a=t.data)||void 0===a?void 0:a.flightOptions)||[]]}),!(null===(n=this.searchFlightData)||void 0===n)&&n.flightOptions.length&&(this.searchFlightLoading=!1),!(null===(o=t.data)||void 0===o)&&o.discountPercentageDetail&&(this.discountPercentageDetail=new Map(Object.entries(null===(s=t.data)||void 0===s?void 0:s.discountPercentageDetail))),null!==(d=this.searchFlightData)&&void 0!==d&&d.flightOptions&&t.success&&null!==(u=this.searchFlightData)&&void 0!==u&&u.flightOptions.length||(this.isSearchRetailEmpty=!0),!(null===(g=this.searchFlightData)||void 0===g)&&g.flightOptions&&!(null===(c=this.searchFlightData)||void 0===c)&&c.flightOptions.length&&"COMBO"===(null===(h=this.searchFlightData)||void 0===h?void 0:h.flightOptions[0].type)&&(this.currentMode="combo"),this.listFareRule=null===(p=t.data)||void 0===p?void 0:p.fareRules,this.listFareRuleClasses=null===(v=t.data)||void 0===v?void 0:v.fareRuleClasses;try{this.isSearchRetailEmpty=!1,this.convertAllTicket()}catch(C){this._searchFlightService.sendErrorDataSearch(JSON.stringify(t),C.message+C.stack,this._userService.currentUserSubject.value.data.displayName).subscribe({next:()=>console.log("Send error data success"),error(D){console.log("Send error data fail")}})}this.loadTicketDisplay(),"combo"===this.currentMode?this.initComboFilter():this.initFilterAirline(),this.checkQHPromotionError(),this.loadTicketFilter(),this.loadComboTicketFilter(),this.firstCheckExpireTime&&(this.initTicketExpireTimer(),this.firstCheckExpireTime=!1),this._cdr.detectChanges()}getDiscountPercentConfig(t){let i;return this.discountPercentageDetail.has(t)&&(i=this.discountPercentageDetail.get(t)),i}syncDelayPoint(t){for(let i=0;i<t.length-1;i++)t[i+1].delay=t[i].delay,t[i].delay=0;return t}convertAllTicket(){var t,i,a;if(this.searchFlightData)if("combo"!==this.currentMode){let n=0;this.listTicket=null===(t=this.searchFlightData.flightOptions)||void 0===t?void 0:t.flatMap(o=>o.journeys.flatMap(s=>{if(!s.fareOptions)return[];["VN"].includes(null==o?void 0:o.provider)&&"VN"===s.airline&&(s.segments=this.syncDelayPoint(s.segments));const d=s.fareOptions.map(c=>{var h,p,v,C,D,m,k,b,F,P,A,Q;n++;let w={handBag:"",checkedBag:""},_="";["VN"].includes(null==o?void 0:o.provider)&&"VN"===s.airline&&c.comboRefKey===c.key&&c.comboRefs&&c.comboRefs.length&&(_=c.comboRefs[0].sessionId,c.fareAmountBreakdowns=c.comboRefs[0].fareAmountBreakdowns),this._searchInputService.checkProvider(o.provider,T.QK.BSP)||this._searchInputService.checkProvider(o.provider,T.QK.AIR_1G)||this._searchInputService.checkProvider(o.provider,T.QK.VN)&&this.hasAirportInternational||this._searchInputService.checkProvider(o.provider,T.QK.ST)||this._searchInputService.checkProvider(o.provider,T.QK.BZT)||this._searchInputService.checkProvider(o.provider,T.QK.HG)?(w.handBag=(null===(h=c.fareInfos[0])||void 0===h?void 0:h.carryOnBags)||"",w.checkedBag=(null===(p=c.fareInfos[0])||void 0===p?void 0:p.checkedBags)||""):w=this.getFareRuleClass(s.airline,c.fareInfos[0].fareClass,null===(v=c.fareInfos[0].fareType)||void 0===v?void 0:v.code);const N=this.getDiscountPercentConfig(c.key);let Z=0;return this.surchargeConfigs&&this.surchargeConfigs.length&&(Z=[T.QK.BSP,T.QK.AIR_1G,T.QK.BZT,T.QK.ST,T.QK.HG].includes(null==o?void 0:o.provider)?(null===(C=this.surchargeConfigs.find(S=>"GDS"===S.airline))||void 0===C?void 0:C.amount)||0:(null===(D=this.surchargeConfigs.find(S=>S.airline===(null==o?void 0:o.provider)))||void 0===D?void 0:D.amount)||0),{indexForTracking:n,sessionKey:_,provider:o.provider,airline:s.airline,airlineLogo:this._flightDataService.getAirlineLogoByCode(s.operating),mobileAirlineLogo:["VJ","VN","QH"].includes(s.operating)?"assets/airline-logo/"+s.operating+"_small.png":"assets/airline-logo/"+s.operating+".png",airlineName:s.airlineName,flightNumber:`${s.airline} ${s.segments[0].flightNumber}`,operating:s.operating,operatingName:s.operatingName,stopStatus:s.numOfStops,duration:s.duration,durationStr:s.getDurationString(),startPoint:s.departure.airport.code,endPoint:s.arrival.airport.code,startTime:f(s.departure.localTime).toDate(),endTime:f(s.arrival.localTime).toDate(),startTerminal:s.segments[0].departure.airport.terminal?`T${s.segments[0].departure.airport.terminal}`:"",endTerminal:(()=>{var S;const Ne=1===s.segments.length?s.segments[0].arrival.airport.terminal:null===(S=s.segments[s.segments.length-1])||void 0===S?void 0:S.arrival.airport.terminal;return Ne?`T${Ne}`:""})(),expireTime:s.expireTime,surCharge:Z,totalPrice:c.getTotalAmount(),get totalDiscountFarePrice(){return this.totalPrice-c.getDiscountByBaseFare("ADULT",s.airline,N&&N.adtPercentage||0,N&&N.adtAmount||0)},netPrice:c.getNetAmount(this.numberOfPassenger.adult,this.numberOfPassenger.child),serviceFee:c.getServiceFee(),promotionalPrice:0!==c.getDiscount()?c.getTotalAmount()+c.getDiscount():void 0,currency:c.currency?c.currency.code:"VN\u0110",fareClass:c.fareInfos[0].fareClass,fareType:null===(m=c.fareInfos[0].fareType)||void 0===m?void 0:m.code,journeyFareClass:c.journeyFareClass,handBag:R(w.handBag)?w.handBag:"",checkedBag:R(w.checkedBag)?w.checkedBag:"",seatRemain:c.fareInfos[0].seatRemain,cabin:null===(k=c.fareInfos[0].cabin)||void 0===k?void 0:k.description,cabinName:(null===(F=null===(b=c.fareInfos[0].cabin)||void 0===b?void 0:b.name)||void 0===F?void 0:F.toLowerCase())||"null",isLowestFare:!1,isLowestFareAvailable:!1,leg:s.leg,departure:{scheduleTime:f(1e3*s.departure.scheduleTime).toDate(),airport:s.departure.airport.code,localTime:f(s.departure.localTime).toDate()},arrival:{scheduleTime:f(1e3*s.arrival.scheduleTime).toDate(),airport:s.arrival.airport.code,localTime:f(s.arrival.localTime).toDate()},journeyKey:s.key,fareOptionKey:c.key,segments:s.segments.map((S,Ne)=>{var Ze;const ut=S.getDelayString();return{segmentKey:S.key,fareClass:c.fareInfos[0].fareClass,fareType:(null===(Ze=c.fareInfos[0].fareType)||void 0===Ze?void 0:Ze.description)||"",airline:S.airline,airlineName:S.airlineName,mobileAirlineLogo:["VJ","VN","QH"].includes(S.operating)?"assets/airline-logo/"+S.operating+"_small.png":"assets/airline-logo/"+S.operating+".png",operating:S.operating,operatingName:S.operatingName,airlineLogo:this._flightDataService.getAirlineLogoByCode(S.operating),jetCode:"N/A",startCode:S.departure.airport.code,endCode:S.arrival.airport.code,startPoint:this._locationDataService.getCityNameByCode(S.departure.airport.code),endPoint:this._locationDataService.getCityNameByCode(S.arrival.airport.code),departDate:f(S.departure.localTime).toDate(),arrivalDate:f(S.arrival.localTime).toDate(),startTerminal:S.departure.airport.terminal?`T${S.departure.airport.terminal}`:"",endTerminal:S.arrival.airport.terminal?`T${S.arrival.airport.terminal}`:"",flightNumber:S.flightNumber,duration:S.getDurationString(),modelAirplane:S.modelAirplane,modelAirplaneName:S.modelAirplaneName,delay:S.getDelayString(),stopPoint:ut?`D\u1eebng t\u1ea1i: ${this._locationDataService.getAirportNameByCode(S.departure.airport.code)} (${S.departure.airport.code}). Th\u1eddi gian d\u1eebng: ${ut}`:"",handBag:R(w.handBag)?w.handBag:"",checkedBag:R(w.checkedBag)?w.checkedBag:""}}),showSalePrice:this.ticketDisplayState.value.showSalePrice,showNetPrice:this.ticketDisplayState.value.showNetPrice,showSurchargeFare:this.ticketDisplayState.value.showSurchargeFare,hasDiscountFare:!!N,showDiscountFare:this.ticketDisplayState.value.showDiscountFare,hideFareClass:this.ticketDisplayState.value.hideFareClass,showDuration:this.ticketDisplayState.value.showDuration,ticketDetail:this.getTicketDetail(c,s.airline,N),lccFare:c.lccFare,ndcFare:c.ndcFare,privateFare:c.privateFare,refundableFare:c.refundableFare,vfrFare:c.vfrFare,vfrFareLaborVisa:c.vfrFareLaborVisa,vfrFareWithRelations:c.vfrFareWithRelations,paxType:null!==(Q=null===(A=null===(P=this._dataProvider.searchInputData)||void 0===P?void 0:P.journey[0])||void 0===A?void 0:A.paxType)&&void 0!==Q?Q:"",ndcTimeLimit$:c.ndcFare?c.ndcTimeLimitCountDown$():(0,U.of)(0),isDisabledTicket$:c.ndcFare?c.ndcTimeLimitCountDown$().pipe((0,j.d)(0),(0,$.U)(S=>S<6e4)):(0,U.of)(!1),food:!1}}),u=Re.groupBy(d,"cabinName");for(const c of Object.keys(u)){const p=Math.min(...u[c].map(v=>v.totalPrice));d.filter(v=>v.cabinName===c).forEach(v=>{v.isLowestFare=v.totalPrice===p})}const g=Math.min(...d.filter(c=>c.seatRemain).map(c=>c.totalPrice));return d.forEach(c=>{c.isLowestFareAvailable=c.totalPrice===g}),d})).sort((o,s)=>o.totalPrice-s.totalPrice).sort((o,s)=>o.stopStatus-s.stopStatus),this.listTicketAgent=null===(i=this.searchFlightData.flightOptions)||void 0===i?void 0:i.filter(o=>!["GDS"].includes(o.provider)).flatMap((o,s)=>this.convertAgentTicket(o,s)).sort((o,s)=>o.numOfStop-s.numOfStop)}else this.listTicketCombo=null===(a=this.searchFlightData.flightOptions)||void 0===a?void 0:a.filter(n=>n.comboInfo.arriveJourneys[0].fareOptions).map((n,o)=>this.convertComboTicket(n,o))}convertComboTicket(t,i){var a,n;let d,o={handBag:"",checkedBag:""},s=0,u=1,g=!1;if(this.surchargeConfigs&&this.surchargeConfigs.length&&([T.QK.BSP,T.QK.AIR_1G,T.QK.BZT,T.QK.ST,T.QK.HG].includes(null==t?void 0:t.provider)?(d=this.surchargeConfigs.find(c=>"GDS"===c.airline),u="ROUND_TRIP"===(null==d?void 0:d.applyType)?2:1,s=d?d.amount:0,g=!0):(d=this.surchargeConfigs.find(c=>c.airline===(null==t?void 0:t.provider)),u=2,s=d?d.amount:0)),"GDS"===t.provider)return{indexForTracking:i,provider:t.provider,showSurchargeFare:this.ticketDisplayState.value.showSurchargeFare,surCharge:s,showTotalPrice:this.ticketDisplayState.value.showTotalComboPrice,departOptions:t.comboInfo.departJourneys.map((c,h)=>{var p,v,C;const D=this.getDiscountPercentConfig(c.fareOptions[0].key);return{selected:0===h,airline:c.airline,airlineLogo:this._flightDataService.getAirlineLogoByCode(c.airline),operating:c.operating,operatingName:c.operatingName,mobileAirlineLogo:["VJ","VN","QH"].includes(c.airline)?"assets/airline-logo/"+c.airline+"_small.png":"assets/airline-logo/"+c.airline+".png",airlineName:c.airlineName,departureDate:f(c.departure.localTime).toDate(),returnDate:f(c.arrival.localTime).toDate(),durationStr:c.getDurationString(),duration:c.duration,startPoint:c.departure.airport.code,startPointName:this._locationDataService.getCityNameByCode(c.departure.airport.code),endPointName:this._locationDataService.getCityNameByCode(c.arrival.airport.code),endPoint:c.arrival.airport.code,startTerminal:"",endTerminal:"",expireTime:c.expireTime,flightNumber:`${c.airline} ${c.segments[0].flightNumber}`,surcharge:s,surchargeAllPax:s*(this.numberOfPassenger.adult+this.numberOfPassenger.child),totalPrice:c.fareOptions[0].getTotalAmount(),totalDiscountFarePrice:0,totalAllPaxPrice:c.fareOptions[0].getTotalAmountAllPax(this.numberOfPassenger.adult,this.numberOfPassenger.child),stops:c.getStopList().map(m=>Object.assign(Object.assign({},m),{country:this._locationDataService.getCityNameByCode(m.airport)})),numOfStop:c.numOfStops,stopOvernight:c.stopOvernight,returnDateTooltip:"H\u1ea1 c\xe1nh ng\xe0y "+(0,I.p6)(new Date(c.arrival.localTime),"dd/MM/yyyy","vi-VN"),ticketPrice:this.getTicketDetail(c.fareOptions[0],c.airline,D),provider:t.provider,fareOptionKey:c.fareOptions[0].key,journeyKey:c.key,comboRefs:[],segments:c.segments.map((m,k)=>{var b,F,P;const A=m.getDelayString();return{airline:m.airline,airlineSystem:m.airline,airlineName:m.airlineName,airlineLogo:this._flightDataService.getAirlineLogoByCode(m.airline),operating:m.operating,operatingName:m.operatingName,mobileAirlineLogo:["VJ","VN","QH"].includes(m.airline)?"assets/airline-logo/"+m.airline+"_small.png":"assets/airline-logo/"+m.airline+".png",flightNumber:`${m.flightNumber}`,startDate:f(m.departure.localTime).toDate(),startPoint:m.departure.airport.code,startPointName:this._locationDataService.getCityNameByCode(m.departure.airport.code),endDate:f(m.arrival.localTime).toDate(),endPoint:m.arrival.airport.code,endPointName:this._locationDataService.getCityNameByCode(m.arrival.airport.code),startTerminal:null!==(F=null===(b=m.departure)||void 0===b?void 0:b.airport)&&void 0!==F&&F.terminal?`T${m.departure.airport.terminal}`:"",endTerminal:m.arrival.airport.terminal?`T${m.arrival.airport.terminal}`:"",rules:[],modelAirplane:m.modelAirplane,modelAirplaneName:m.modelAirplaneName,key:m.key,durationStr:m.getDurationString(),delay:A,stopPoint:A?`D\u1eebng t\u1ea1i: ${this._locationDataService.getAirportNameByCode(m.departure.airport.code)} (${m.departure.airport.code}). Th\u1eddi gian d\u1eebng: ${A}`:"",fareClass:c.fareOptions[0].fareInfos[k].fareClass,fareType:null===(P=c.fareOptions[0].fareInfos[k].fareType)||void 0===P?void 0:P.description,handBaggage:R(o.handBag)?o.handBag:"",checkedBaggage:R(o.checkedBag)?o.checkedBag:"",food:!1}}),lccFare:c.fareOptions[0].lccFare,ndcFare:c.fareOptions[0].ndcFare,privateFare:c.fareOptions[0].privateFare,refundableFare:c.fareOptions[0].refundableFare,vfrFare:c.fareOptions[0].vfrFare,vfrFareLaborVisa:c.fareOptions[0].vfrFareLaborVisa,vfrFareWithRelations:c.fareOptions[0].vfrFareWithRelations,ndcTimeLimit$:c.fareOptions[0].ndcFare?c.fareOptions[0].ndcTimeLimitCountDown$():(0,U.of)(0),isDisabledTicket$:c.fareOptions[0].ndcFare?c.fareOptions[0].ndcTimeLimitCountDown$().pipe((0,j.d)(0),(0,$.U)(m=>m<6e4)):(0,U.of)(!1),paxType:null!==(C=null===(v=null===(p=this._dataProvider.searchInputData)||void 0===p?void 0:p.journey[0])||void 0===v?void 0:v.paxType)&&void 0!==C?C:"",handBaggage:R(o.handBag)?o.handBag:"",checkedBaggage:R(o.checkedBag)?o.checkedBag:"",food:!1}}),arriveOptions:t.comboInfo.arriveJourneys.map((c,h)=>{var p,v,C;const D=this.getDiscountPercentConfig(c.fareOptions[0].key);return{selected:0===h,airline:c.airline,airlineLogo:this._flightDataService.getAirlineLogoByCode(c.airline),operating:c.operating,operatingName:c.operatingName,mobileAirlineLogo:["VJ","VN","QH"].includes(c.airline)?"assets/airline-logo/"+c.airline+"_small.png":"assets/airline-logo/"+c.airline+".png",airlineName:c.airlineName,departureDate:f(c.departure.localTime).toDate(),returnDate:f(c.arrival.localTime).toDate(),durationStr:c.getDurationString(),duration:c.duration,startPoint:c.departure.airport.code,startPointName:this._locationDataService.getCityNameByCode(c.departure.airport.code),endPointName:this._locationDataService.getCityNameByCode(c.arrival.airport.code),endPoint:c.arrival.airport.code,startTerminal:"",endTerminal:"",expireTime:c.expireTime,flightNumber:`${c.airline} ${c.segments[0].flightNumber}`,surcharge:0,surchargeAllPax:0,totalPrice:0,totalDiscountFarePrice:0,totalAllPaxPrice:0,stops:c.getStopList().map(m=>Object.assign(Object.assign({},m),{country:this._locationDataService.getCityNameByCode(m.airport)})),numOfStop:c.numOfStops,stopOvernight:c.stopOvernight,returnDateTooltip:"H\u1ea1 c\xe1nh ng\xe0y "+(0,I.p6)(new Date(c.arrival.localTime),"dd/MM/yyyy","vi-VN"),ticketPrice:this.getTicketDetail(new re.YY,c.airline,D),provider:t.provider,fareOptionKey:c.fareOptions[0].key,journeyKey:c.key,comboRefs:[],segments:c.segments.map((m,k)=>{var b,F,P,A,Q;const w=m.getDelayString();return{airline:m.airline,airlineSystem:m.airline,airlineName:m.airlineName,airlineLogo:this._flightDataService.getAirlineLogoByCode(m.airline),operating:m.operating,operatingName:m.operatingName,mobileAirlineLogo:["VJ","VN","QH"].includes(m.airline)?"assets/airline-logo/"+m.airline+"_small.png":"assets/airline-logo/"+m.airline+".png",flightNumber:`${m.flightNumber}`,startDate:f(m.departure.localTime).toDate(),startPoint:m.departure.airport.code,startPointName:this._locationDataService.getCityNameByCode(m.departure.airport.code),endDate:f(m.arrival.localTime).toDate(),endPoint:m.arrival.airport.code,endPointName:this._locationDataService.getCityNameByCode(m.arrival.airport.code),startTerminal:null!==(F=null===(b=m.departure)||void 0===b?void 0:b.airport)&&void 0!==F&&F.terminal?`T${m.departure.airport.terminal}`:"",endTerminal:null!==(A=null===(P=m.arrival)||void 0===P?void 0:P.airport)&&void 0!==A&&A.terminal?`T${m.arrival.airport.terminal}`:"",rules:[],modelAirplane:m.modelAirplane,modelAirplaneName:m.modelAirplaneName,key:m.key,durationStr:m.getDurationString(),delay:w,stopPoint:w?`D\u1eebng t\u1ea1i: ${this._locationDataService.getAirportNameByCode(m.departure.airport.code)} (${m.departure.airport.code}). Th\u1eddi gian d\u1eebng: ${w}`:"",fareClass:c.fareOptions[0].fareInfos[k].fareClass,fareType:null===(Q=c.fareOptions[0].fareInfos[k].fareType)||void 0===Q?void 0:Q.description,handBaggage:R(o.handBag)?o.handBag:"",checkedBaggage:R(o.checkedBag)?o.checkedBag:"",food:!1}}),lccFare:c.fareOptions[0].lccFare,ndcFare:c.fareOptions[0].ndcFare,privateFare:c.fareOptions[0].privateFare,refundableFare:c.fareOptions[0].refundableFare,vfrFare:c.fareOptions[0].vfrFare,vfrFareLaborVisa:c.fareOptions[0].vfrFareLaborVisa,vfrFareWithRelations:c.fareOptions[0].vfrFareWithRelations,paxType:null!==(C=null===(v=null===(p=this._dataProvider.searchInputData)||void 0===p?void 0:p.journey[0])||void 0===v?void 0:v.paxType)&&void 0!==C?C:"",ndcTimeLimit$:c.fareOptions[0].ndcFare?c.fareOptions[0].ndcTimeLimitCountDown$():(0,U.of)(0),isDisabledTicket$:c.fareOptions[0].ndcFare?c.fareOptions[0].ndcTimeLimitCountDown$().pipe((0,j.d)(0),(0,$.U)(m=>m<6e4)):(0,U.of)(!1),verifyState:"UNCHECKED",handBaggage:R(o.handBag)?o.handBag:"",checkedBaggage:R(o.checkedBag)?o.checkedBag:"",food:!1}}),score:t.comboInfo.score,bestChoice:t.comboInfo.bestChoice,fastest:t.comboInfo.fastest,cheapest:t.comboInfo.cheapest,soldOut:!1,hasDiscountFare:!1,showDiscountFare:this.ticketDisplayState.value.showDiscountFare};{const c=t.comboInfo.departJourneys[0].fareOptions.every(p=>!p.fareInfos[0].seatRemain)||t.comboInfo.arriveJourneys[0].fareOptions.every(p=>!p.fareInfos[0].seatRemain);this._searchInputService.checkProvider(t.provider,T.QK.VN)&&"VN"===t.comboInfo.departJourneys[0].airline&&(t.comboInfo.departJourneys[0].segments=this.syncDelayPoint(t.comboInfo.departJourneys[0].segments)),this._searchInputService.checkProvider(t.provider,T.QK.VN)&&"VN"===t.comboInfo.arriveJourneys[0].airline&&(t.comboInfo.arriveJourneys[0].segments=this.syncDelayPoint(t.comboInfo.arriveJourneys[0].segments));const h=this.getDiscountPercentConfig(null===(n=null===(a=t.comboInfo.lowestComboOption)||void 0===a?void 0:a.lowestDepartOption)||void 0===n?void 0:n.fareOptionKey);return{indexForTracking:i,provider:t.provider,showSurchargeFare:this.ticketDisplayState.value.showSurchargeFare,surCharge:s*u,showTotalPrice:this.ticketDisplayState.value.showTotalComboPrice,hasDiscountFare:!!h,showDiscountFare:this.ticketDisplayState.value.showDiscountFare,departOptions:t.comboInfo.departJourneys[0].fareOptions.map((p,v)=>{var C,D,m,k,b,F,P,A,Q,w;return this._searchInputService.checkProvider(t.provider,T.QK.BSP)||this._searchInputService.checkProvider(t.provider,T.QK.AIR_1G)||this._searchInputService.checkProvider(t.provider,T.QK.VN)&&this.hasAirportInternational||this._searchInputService.checkProvider(t.provider,T.QK.ST)||this._searchInputService.checkProvider(t.provider,T.QK.BZT)?(o.handBag=(null===(C=p.fareInfos[0])||void 0===C?void 0:C.carryOnBags)||"",o.checkedBag=(null===(D=p.fareInfos[0])||void 0===D?void 0:D.checkedBags)||""):o=this.getFareRuleClass(t.comboInfo.departJourneys[0].airline,p.fareInfos[0].fareClass,null===(m=p.fareInfos[0].fareType)||void 0===m?void 0:m.code),{selected:0===v,airline:t.comboInfo.departJourneys[0].airline,airlineLogo:this._flightDataService.getAirlineLogoByCode(t.comboInfo.departJourneys[0].airline),operating:t.comboInfo.departJourneys[0].operating,operatingName:t.comboInfo.departJourneys[0].operatingName,mobileAirlineLogo:["VJ","VN","QH"].includes(t.comboInfo.departJourneys[0].airline)?"assets/airline-logo/"+t.comboInfo.departJourneys[0].airline+"_small.png":"assets/airline-logo/"+t.comboInfo.departJourneys[0].airline+".png",airlineName:t.comboInfo.departJourneys[0].airlineName,departureDate:f(t.comboInfo.departJourneys[0].departure.localTime).toDate(),returnDate:f(t.comboInfo.departJourneys[0].arrival.localTime).toDate(),durationStr:t.comboInfo.departJourneys[0].getDurationString(),duration:t.comboInfo.departJourneys[0].duration,startPoint:t.comboInfo.departJourneys[0].departure.airport.code,startPointName:this._locationDataService.getCityNameByCode(t.comboInfo.departJourneys[0].departure.airport.code),endPointName:this._locationDataService.getCityNameByCode(t.comboInfo.departJourneys[0].arrival.airport.code),endPoint:t.comboInfo.departJourneys[0].arrival.airport.code,startTerminal:t.comboInfo.departJourneys[0].segments[0].departure.airport.terminal?`T${t.comboInfo.departJourneys[0].segments[0].departure.airport.terminal}`:"",endTerminal:(()=>{var _;const N=1===t.comboInfo.departJourneys[0].segments.length?t.comboInfo.departJourneys[0].segments[0].arrival.airport.terminal:null===(_=t.comboInfo.departJourneys[0].segments[t.comboInfo.departJourneys[0].segments.length-1])||void 0===_?void 0:_.arrival.airport.terminal;return N?`T${N}`:""})(),expireTime:t.comboInfo.departJourneys[0].expireTime,flightNumber:`${t.comboInfo.departJourneys[0].airline} ${t.comboInfo.departJourneys[0].segments[0].flightNumber}`,surcharge:g?0:s,surchargeAllPax:s*(this.numberOfPassenger.adult+this.numberOfPassenger.child),totalPrice:p.getTotalAmount(),totalDiscountFarePrice:p.getTotalAmount()-p.getDiscountByBaseFare("ADULT",t.comboInfo.departJourneys[0].airline,h&&h.adtPercentage||0,h&&h.adtAmount||0),totalAllPaxPrice:p.getTotalAmountAllPax(this.numberOfPassenger.adult,this.numberOfPassenger.child),stops:t.comboInfo.departJourneys[0].getStopList().map(_=>Object.assign(Object.assign({},_),{country:this._locationDataService.getCityNameByCode(_.airport)})),numOfStop:t.comboInfo.departJourneys[0].numOfStops,stopOvernight:t.comboInfo.departJourneys[0].stopOvernight,fareClass:p.fareInfos[0].fareClass,fareType:null===(k=p.fareInfos[0].fareType)||void 0===k?void 0:k.code,seatRemain:p.fareInfos[0].seatRemain,journeyFareClass:p.journeyFareClass,cabin:null===(b=p.fareInfos[0].cabin)||void 0===b?void 0:b.code,cabinName:null===(P=null===(F=p.fareInfos[0].cabin)||void 0===F?void 0:F.name)||void 0===P?void 0:P.toLowerCase(),returnDateTooltip:"H\u1ea1 c\xe1nh ng\xe0y "+(0,I.p6)(new Date(t.comboInfo.departJourneys[0].arrival.localTime),"dd/MM/yyyy","vi-VN"),ticketPrice:this.getTicketDetail(p,t.comboInfo.departJourneys[0].airline,h),provider:t.provider,fareOptionKey:p.key,journeyKey:t.comboInfo.departJourneys[0].key,comboRefKey:p.comboRefKey,comboRefs:t.comboInfo.arriveJourneys[0].fareOptions.map(_=>{var N;const Z=null===(N=p.comboRefs)||void 0===N?void 0:N.find(S=>S.key[0]===_.key);return{key:_.key,sessionId:Z?Z.sessionId:"",verifyState:Z&&Z.sessionId?"CHECKED":"UNCHECKED",totalPriceCombo:Z?Z.getTotalAmount():0,totalAllPaxPriceCombo:Z?Z.getTotalAmountAllPax(this.numberOfPassenger.adult,this.numberOfPassenger.child):0,ticketPrice:Z?this.getTicketDetail(Z,t.comboInfo.departJourneys[0].airline,h):null}}),segments:t.comboInfo.departJourneys[0].segments.map((_,N)=>{var Z;const S=_.getDelayString();return{airline:_.airline,airlineSystem:_.airline,airlineName:_.airlineName,airlineLogo:this._flightDataService.getAirlineLogoByCode(_.airline),operating:_.operating,operatingName:_.operatingName,mobileAirlineLogo:["VJ","VN","QH"].includes(_.airline)?"assets/airline-logo/"+_.airline+"_small.png":"assets/airline-logo/"+_.airline+".png",flightNumber:`${_.flightNumber}`,startDate:f(_.departure.localTime).toDate(),startPoint:_.departure.airport.code,startPointName:this._locationDataService.getCityNameByCode(_.departure.airport.code),endDate:f(_.arrival.localTime).toDate(),endPoint:_.arrival.airport.code,endPointName:this._locationDataService.getCityNameByCode(_.arrival.airport.code),startTerminal:_.departure.airport.terminal?`T${_.departure.airport.terminal}`:"",endTerminal:_.arrival.airport.terminal?`T${_.arrival.airport.terminal}`:"",rules:[],modelAirplane:_.modelAirplane,modelAirplaneName:_.modelAirplaneName,key:_.key,durationStr:_.getDurationString(),delay:S,stopPoint:S?`D\u1eebng t\u1ea1i: ${this._locationDataService.getAirportNameByCode(_.departure.airport.code)} (${_.departure.airport.code}). Th\u1eddi gian d\u1eebng: ${S}`:"",fareClass:p.fareInfos[N].fareClass,fareType:null===(Z=p.fareInfos[N].fareType)||void 0===Z?void 0:Z.description,handBaggage:R(o.handBag)?o.handBag:"",checkedBaggage:R(o.checkedBag)?o.checkedBag:"",food:!1}}),lccFare:p.lccFare,ndcFare:p.ndcFare,privateFare:p.privateFare,refundableFare:p.refundableFare,vfrFare:p.vfrFare,vfrFareLaborVisa:p.vfrFareLaborVisa,vfrFareWithRelations:p.vfrFareWithRelations,ndcTimeLimit$:p.ndcFare?p.ndcTimeLimitCountDown$():(0,U.of)(0),isDisabledTicket$:p.ndcFare?p.ndcTimeLimitCountDown$().pipe((0,j.d)(0),(0,$.U)(_=>_<6e4)):(0,U.of)(!1),paxType:null!==(w=null===(Q=null===(A=this._dataProvider.searchInputData)||void 0===A?void 0:A.journey[0])||void 0===Q?void 0:Q.paxType)&&void 0!==w?w:"",handBaggage:R(o.handBag)?o.handBag:"",checkedBaggage:R(o.checkedBag)?o.checkedBag:"",food:!1}}),arriveOptions:t.comboInfo.arriveJourneys[0].fareOptions.map((p,v)=>{var C,D,m,k,b,F,P,A,Q,w;return this._searchInputService.checkProvider(t.provider,T.QK.BSP)||this._searchInputService.checkProvider(t.provider,T.QK.AIR_1G)||this._searchInputService.checkProvider(t.provider,T.QK.VN)&&this.hasAirportInternational||this._searchInputService.checkProvider(t.provider,T.QK.ST)||this._searchInputService.checkProvider(t.provider,T.QK.BZT)?(o.handBag=(null===(C=p.fareInfos[0])||void 0===C?void 0:C.carryOnBags)||"",o.checkedBag=(null===(D=p.fareInfos[0])||void 0===D?void 0:D.checkedBags)||""):o=this.getFareRuleClass(t.comboInfo.departJourneys[0].airline,p.fareInfos[0].fareClass,null===(m=p.fareInfos[0].fareType)||void 0===m?void 0:m.code),{selected:0===v,airline:t.comboInfo.arriveJourneys[0].airline,airlineLogo:this._flightDataService.getAirlineLogoByCode(t.comboInfo.arriveJourneys[0].airline),operating:t.comboInfo.arriveJourneys[0].operating,operatingName:t.comboInfo.arriveJourneys[0].operatingName,mobileAirlineLogo:["VJ","VN","QH"].includes(t.comboInfo.arriveJourneys[0].airline)?"assets/airline-logo/"+t.comboInfo.arriveJourneys[0].airline+"_small.png":"assets/airline-logo/"+t.comboInfo.arriveJourneys[0].airline+".png",airlineName:t.comboInfo.arriveJourneys[0].airlineName,departureDate:f(t.comboInfo.arriveJourneys[0].departure.localTime).toDate(),returnDate:f(t.comboInfo.arriveJourneys[0].arrival.localTime).toDate(),durationStr:t.comboInfo.arriveJourneys[0].getDurationString(),duration:t.comboInfo.arriveJourneys[0].duration,startPoint:t.comboInfo.arriveJourneys[0].departure.airport.code,startPointName:this._locationDataService.getCityNameByCode(t.comboInfo.arriveJourneys[0].departure.airport.code),endPointName:this._locationDataService.getCityNameByCode(t.comboInfo.arriveJourneys[0].arrival.airport.code),endPoint:t.comboInfo.arriveJourneys[0].arrival.airport.code,startTerminal:t.comboInfo.arriveJourneys[0].segments[0].departure.airport.terminal?`T${t.comboInfo.arriveJourneys[0].segments[0].departure.airport.terminal}`:"",endTerminal:(()=>{var _;const N=1===t.comboInfo.arriveJourneys[0].segments.length?t.comboInfo.arriveJourneys[0].segments[0].arrival.airport.terminal:null===(_=t.comboInfo.arriveJourneys[0].segments[t.comboInfo.arriveJourneys[0].segments.length-1])||void 0===_?void 0:_.arrival.airport.terminal;return N?`T${N}`:""})(),expireTime:t.comboInfo.arriveJourneys[0].expireTime,flightNumber:`${t.comboInfo.arriveJourneys[0].airline} ${t.comboInfo.arriveJourneys[0].segments[0].flightNumber}`,surcharge:g?s*u:s,surchargeAllPax:s*(this.numberOfPassenger.adult+this.numberOfPassenger.child),totalPrice:p.getTotalAmount(),totalDiscountFarePrice:p.getTotalAmount()-p.getDiscountByBaseFare("ADULT",t.comboInfo.departJourneys[0].airline,h&&h.adtPercentage||0,h&&h.adtAmount||0),totalAllPaxPrice:p.getTotalAmountAllPax(this.numberOfPassenger.adult,this.numberOfPassenger.child),stops:t.comboInfo.arriveJourneys[0].getStopList().map(_=>Object.assign(Object.assign({},_),{country:this._locationDataService.getCityNameByCode(_.airport)})),numOfStop:t.comboInfo.arriveJourneys[0].numOfStops,stopOvernight:t.comboInfo.arriveJourneys[0].stopOvernight,fareClass:p.fareInfos[0].fareClass,fareType:null===(k=p.fareInfos[0].fareType)||void 0===k?void 0:k.code,seatRemain:p.fareInfos[0].seatRemain,journeyFareClass:p.journeyFareClass,cabin:null===(b=p.fareInfos[0].cabin)||void 0===b?void 0:b.code,cabinName:null===(P=null===(F=p.fareInfos[0].cabin)||void 0===F?void 0:F.name)||void 0===P?void 0:P.toLowerCase(),returnDateTooltip:"H\u1ea1 c\xe1nh ng\xe0y "+(0,I.p6)(new Date(t.comboInfo.arriveJourneys[0].arrival.localTime),"dd/MM/yyyy","vi-VN"),ticketPrice:this.getTicketDetail(p,t.comboInfo.arriveJourneys[0].airline,h),provider:t.provider,fareOptionKey:p.key,journeyKey:t.comboInfo.arriveJourneys[0].key,comboRefKey:p.comboRefKey,comboRefs:[],segments:t.comboInfo.arriveJourneys[0].segments.map((_,N)=>{var Z;const S=_.getDelayString();return{airline:_.airline,airlineSystem:_.airline,airlineName:_.airlineName,airlineLogo:this._flightDataService.getAirlineLogoByCode(_.airline),operating:_.operating,operatingName:_.operatingName,mobileAirlineLogo:["VJ","VN","QH"].includes(_.airline)?"assets/airline-logo/"+_.airline+"_small.png":"assets/airline-logo/"+_.airline+".png",flightNumber:`${_.flightNumber}`,startDate:f(_.departure.localTime).toDate(),startPoint:_.departure.airport.code,startPointName:this._locationDataService.getCityNameByCode(_.departure.airport.code),endDate:f(_.arrival.localTime).toDate(),endPoint:_.arrival.airport.code,endPointName:this._locationDataService.getCityNameByCode(_.arrival.airport.code),startTerminal:_.departure.airport.terminal?`T${_.departure.airport.terminal}`:"",endTerminal:_.arrival.airport.terminal?`T${_.arrival.airport.terminal}`:"",rules:[],modelAirplane:_.modelAirplane,modelAirplaneName:_.modelAirplaneName,key:_.key,durationStr:_.getDurationString(),delay:S,stopPoint:S?`D\u1eebng t\u1ea1i: ${this._locationDataService.getAirportNameByCode(_.departure.airport.code)} (${_.departure.airport.code}). Th\u1eddi gian d\u1eebng: ${S}`:"",fareClass:p.fareInfos[N].fareClass,fareType:null===(Z=p.fareInfos[N].fareType)||void 0===Z?void 0:Z.description,handBaggage:R(o.handBag)?o.handBag:"",checkedBaggage:R(o.checkedBag)?o.checkedBag:"",food:!1}}),lccFare:p.lccFare,ndcFare:p.ndcFare,privateFare:p.privateFare,refundableFare:p.refundableFare,vfrFare:p.vfrFare,vfrFareLaborVisa:p.vfrFareLaborVisa,vfrFareWithRelations:p.vfrFareWithRelations,ndcTimeLimit$:p.ndcFare?p.ndcTimeLimitCountDown$():(0,U.of)(0),isDisabledTicket$:p.ndcFare?p.ndcTimeLimitCountDown$().pipe((0,j.d)(0),(0,$.U)(_=>_<6e4)):(0,U.of)(!1),paxType:null!==(w=null===(Q=null===(A=this._dataProvider.searchInputData)||void 0===A?void 0:A.journey[0])||void 0===Q?void 0:Q.paxType)&&void 0!==w?w:"",handBaggage:R(o.handBag)?o.handBag:"",checkedBaggage:R(o.checkedBag)?o.checkedBag:"",food:!1}}),score:t.comboInfo.score,bestChoice:t.comboInfo.bestChoice,fastest:t.comboInfo.fastest,cheapest:t.comboInfo.cheapest,soldOut:c}}}convertAgentTicket(t,i,a=""){return t.journeys.flatMap((n,o)=>(t.provider===T.QK.VN&&"VN"===n.airline&&(n.segments=this.syncDelayPoint(n.segments)),{indexForTracking:`${a}_${i}_${o}`,provider:t.provider,airline:n.airline,airlineName:this._flightDataService.getAirlineNameByCode(n.airline),airlineLogo:this._flightDataService.getAirlineLogoByCode(n.airline),mobileAirlineLogo:["VJ","VN","QH"].includes(n.airline)?"assets/airline-logo/"+n.airline+"_small.png":"assets/airline-logo/"+n.airline+".png",operating:n.operating,operatingName:n.operatingName,flightNumber:`${n.airline} ${n.segments[0].flightNumber}`,departure:{scheduleTime:f(1e3*n.departure.scheduleTime).toDate(),airport:n.departure.airport.code,localTime:f(n.departure.localTime).toDate()},arrival:{scheduleTime:f(1e3*n.arrival.scheduleTime).toDate(),airport:n.arrival.airport.code,localTime:f(n.arrival.localTime).toDate()},startPoint:n.departure.airport.code,endPoint:n.arrival.airport.code,duration:n.duration,expireTime:n.expireTime,durationStr:n.getDurationString(),numOfStop:n.numOfStops,numberOfSegment:n.segments.length,leg:n.leg,journeyKey:n.key,lookupSeatReamin:"VN"===n.airline,fareRule:this.listFareRule.find(s=>s.airline===n.airline)||null,segmentDetails:n.segments.map((s,d,u)=>{var g,c;const h=s.getDelayString();return{segmentKey:s.key,airline:s.airline,airlineName:this._flightDataService.getAirlineNameByCode(s.airline),airlineLogo:this._flightDataService.getAirlineLogoByCode(n.airline),mobileAirlineLogo:["VJ","VN","QH"].includes(s.airline)?"assets/airline-logo/"+s.airline+"_small.png":"assets/airline-logo/"+s.airline+".png",jetCode:"N/A",startCode:s.departure.airport.code,endCode:s.arrival.airport.code,startPoint:this._locationDataService.getCityNameByCode(s.departure.airport.code),endPoint:this._locationDataService.getCityNameByCode(s.arrival.airport.code),departDate:f(s.departure.localTime).toDate(),arrivalDate:f(s.arrival.localTime).toDate(),startTerminal:null!==(c=null===(g=s.departure)||void 0===g?void 0:g.airport)&&void 0!==c&&c.terminal?`T${s.departure.airport.terminal}`:"",endTerminal:s.arrival.airport.terminal?`T${s.arrival.airport.terminal}`:"",flightNumber:s.flightNumber,duration:s.duration,durationStr:s.getDurationString(),modelAirplane:s.modelAirplane,modelAirplaneName:s.modelAirplaneName,operating:s.operating,operatingName:s.operatingName,handBag:"",checkedBag:"",stopPoint:h?`D\u1eebng t\u1ea1i: ${this._locationDataService.getAirportNameByCode(s.departure.airport.code)} (${s.departure.airport.code}). Th\u1eddi gian d\u1eebng: ${h}`:""}}),segmentsDisplay:n.segments.map(s=>({airline:s.airline,airlineLogo:this._flightDataService.getAirlineLogoByCode(s.airline),flightNumber:`${s.airline} ${s.flightNumber}`,jetCode:"N/A",operating:s.operating,startPoint:s.departure.airport.code,endPoint:s.arrival.airport.code,segmentKey:s.key,fareClasses:n.fareOptions.map(d=>{var u;const g=this.getDiscountPercentConfig(d.key||"");return{totalPrice:d.getTotalAmount(),isExistPrice:!0,currency:d.currency?d.currency.code:"VN\u0110",segmentIndex:s.index,fareType:null===(u=d.fareInfos[0].fareType)||void 0===u?void 0:u.description,seatRemain:d.fareInfos[0].seatRemain,fareClass:d.fareInfos[0].fareClass,isSelected:!1,fareOptionKey:d.key,ticketPriceDetail:this.getTicketDetail(d,n.airline,g)}}),departure:{scheduleTime:f(1e3*s.departure.scheduleTime).toDate(),airport:s.departure.airport.code,localTime:f(s.departure.localTime).toDate()},arrival:{scheduleTime:f(1e3*s.arrival.scheduleTime).toDate(),airport:s.arrival.airport.code,localTime:f(s.arrival.localTime).toDate()}}))}))}ticketTrackByFn(t,i){return i.indexForTracking}getRandomInt(t,i){return Math.floor(Math.random()*(i-t+1)+t)}loadTicketDisplay(){this.loadClientTicketDisplay(),this.loadAgentTicketDisplay(),this.loadComboTicketDisplay()}loadClientTicketDisplay(){var t;this.listTicketDisplay=(null!==(t=this.listTicketDisplay)&&void 0!==t&&t.length?this.listTicketDisplay:[]).filter(i=>i.leg===this.currentLeg).map(i=>Object.assign(Object.assign({},i),{showSalePrice:this.ticketDisplayState.value.showSalePrice,showNetPrice:this.ticketDisplayState.value.showNetPrice,showSurchargeFare:this.ticketDisplayState.value.showSurchargeFare,hideFareClass:this.ticketDisplayState.value.hideFareClass,showDuration:this.ticketDisplayState.value.showDuration,showDiscountFare:this.ticketDisplayState.value.showDiscountFare})),this.processSort()}loadAgentTicketDisplay(){this.listTicketAgentDisplay=this.listTicketAgent}loadComboTicketDisplay(){this.listTicketComboDisplay=(this.listTicketComboDisplay?this.listTicketComboDisplay:[]).map(t=>Object.assign(Object.assign({},t),{showSurchargeFare:this.ticketDisplayState.value.showSurchargeFare,showDiscountFare:this.ticketDisplayState.value.showDiscountFare,showTotalPrice:this.ticketDisplayState.value.showTotalComboPrice})),this.loadTabDataCombo(),this.processSortCombo()}loadTabDataCombo(){if(0===this.listTicketCombo.length)return;const t=this.listTicketCombo.sort((n,o)=>n.departOptions[0].duration+n.arriveOptions[0].duration-(o.departOptions[0].duration+o.arriveOptions[0].duration))[0];this.tabComboDetail.fastest.price=t.departOptions[0].totalPrice+t.arriveOptions[0].totalPrice,this.tabComboDetail.fastest.durationStr=t.departOptions[0].durationStr;const i=this.listTicketCombo.sort((n,o)=>n.departOptions[0].totalPrice+n.arriveOptions[0].totalPrice-(o.departOptions[0].totalPrice+o.arriveOptions[0].totalPrice))[0];this.tabComboDetail.cheapest.price=i.departOptions[0].totalPrice+i.arriveOptions[0].totalPrice,this.tabComboDetail.cheapest.durationStr=i.departOptions[0].durationStr;const a=this.listTicketCombo.sort((n,o)=>o.score-n.score)[0];this.tabComboDetail.best.price=a.departOptions[0].totalPrice+a.arriveOptions[0].totalPrice,this.tabComboDetail.best.durationStr=a.departOptions[0].durationStr}loadTicketFilter(){this.listTicketDisplay=this.listTicket.filter(t=>t.leg===this.currentLeg).filter(t=>!(!(this.ticketFilterState.value.lccFare&&t.lccFare||this.ticketFilterState.value.ndcFare&&t.ndcFare||this.ticketFilterState.value.privateFare&&t.privateFare)&&(this.ticketFilterState.value.lccFare||this.ticketFilterState.value.ndcFare||this.ticketFilterState.value.privateFare))).filter(t=>0===this.ticketFilterState.value.showAirline.length||this.ticketFilterState.value.showAirline.includes(t.airline)).filter(t=>!!(!this.ticketFilterState.value.direct&&!this.ticketFilterState.value.oneRoute&&!this.ticketFilterState.value.moreRoute||this.ticketFilterState.value.direct&&0===t.stopStatus||this.ticketFilterState.value.oneRoute&&1===t.stopStatus||this.ticketFilterState.value.moreRoute&&t.stopStatus>1)).filter(t=>{var i,a;if(t.leg===this.currentLeg){if("DEPART"===this.ticketFilterState.value.timeTypeFilter){if(null===(i=this.ticketFilterState.value.departTime[this.currentLeg])||void 0===i||!i.length)return!0;if(this.ticketFilterState.value.departTime[this.currentLeg].every(o=>{const s=60*t.departure.localTime.getHours()+t.departure.localTime.getMinutes();return s<o.from||s>o.to}))return!1}if("ARRIVE"===this.ticketFilterState.value.timeTypeFilter){if(null===(a=this.ticketFilterState.value.arriveTime[this.currentLeg])||void 0===a||!a.length)return!0;if(this.ticketFilterState.value.arriveTime[this.currentLeg].every(o=>{const s=60*t.arrival.localTime.getHours()+t.arrival.localTime.getMinutes();return s<o.from||s>o.to}))return!1}}return!0}).filter(t=>{var i,a;return t.seatRemain?this.ticketFilterState.value.fareclass.length>0&&"GDS"!==t.provider?this.ticketFilterState.value.fareclass.indexOf(null===(i=t.cabinName)||void 0===i?void 0:i.toUpperCase())>=0&&t.isLowestFare:null!==(a=this.ticketFilterState.value.fareclass)&&void 0!==a&&a.length||"GDS"===t.provider?t.isLowestFare:t.isLowestFareAvailable:t}).filter(t=>!(this.ticketFilterState.value.plane.length>0)||t.segments.map(i=>this.ticketFilterState.value.plane.indexOf(i.modelAirplaneName)>=0).reduce((i,a)=>i||a,!1)).filter(t=>!(this.ticketFilterState.value.bookingSystem.length>0)||this.ticketFilterState.value.bookingSystem.map(i=>{var a;return"DOMESTIC"===i?[T.QK.VN,T.QK.VJ,T.QK.QH,T.QK.VU].includes(null===(a=t.provider)||void 0===a?void 0:a.toUpperCase()):i===t.provider}).reduce((i,a)=>i||a,!1)).map(t=>Object.assign(Object.assign({},t),{showSalePrice:this.ticketDisplayState.value.showSalePrice,showNetPrice:this.ticketDisplayState.value.showNetPrice,showSurchargeFare:this.ticketDisplayState.value.showSurchargeFare,hideFareClass:this.ticketDisplayState.value.hideFareClass,showDuration:this.ticketDisplayState.value.showDuration,showDiscountFare:this.ticketDisplayState.value.showDiscountFare,showTotalComboPrice:this.ticketDisplayState.value.showTotalComboPrice})),this.listTicketAgentDisplay=this.listTicketAgent.filter(t=>t.leg===this.currentLeg).filter(t=>{const i=this.airlineList.map(a=>a.code.toLocaleLowerCase());return 0===i.length||i.includes(t.airline.toLowerCase())}).filter(t=>0===this.ticketFilterState.value.showAirline.length||this.ticketFilterState.value.showAirline.includes(t.airline)).filter(t=>!!(!this.ticketFilterState.value.direct&&!this.ticketFilterState.value.oneRoute&&!this.ticketFilterState.value.moreRoute||this.ticketFilterState.value.direct&&0===t.numOfStop||this.ticketFilterState.value.oneRoute&&1===t.numOfStop||this.ticketFilterState.value.moreRoute&&t.numOfStop>1)).filter(t=>{var i,a;if("DEPART"===this.ticketFilterState.value.timeTypeFilter){if(null===(i=this.ticketFilterState.value.departTime[this.currentLeg])||void 0===i||!i.length)return!0;if(this.ticketFilterState.value.departTime[this.currentLeg].every(o=>{const s=60*t.departure.localTime.getHours()+t.departure.localTime.getMinutes();return s<o.from||s>o.to}))return!1}if("ARRIVE"===this.ticketFilterState.value.timeTypeFilter){if(null===(a=this.ticketFilterState.value.arriveTime[this.currentLeg])||void 0===a||!a.length)return!0;if(this.ticketFilterState.value.arriveTime[this.currentLeg].every(o=>{const s=60*t.arrival.localTime.getHours()+t.arrival.localTime.getMinutes();return s<o.from||s>o.to}))return!1}return!0}).filter(t=>{if(!this.ticketFilterState.value.plane.length)return!0;const i=t.segmentDetails.map(n=>n.modelAirplaneName);return!!this.ticketFilterState.value.plane.some(n=>i.includes(n))}),this.listTicketAgentDisplay=[...this.listTicketAgentDisplay],this.processSort(),this.ticketInfiniteScrollCount=this.TICKET_INFINITE_SCROLL_DEFAULT}loadComboTicketFilter(){this.listTicketComboDisplay=this.listTicketCombo.filter(t=>!(!(this.ticketFilterState.value.lccFare&&t.departOptions[0].lccFare||t.arriveOptions[0].lccFare)&&this.ticketFilterState.value.lccFare)).filter(t=>!(!(this.ticketFilterState.value.ndcFare&&t.departOptions[0].ndcFare||t.arriveOptions[0].ndcFare)&&this.ticketFilterState.value.ndcFare)).filter(t=>!(!(this.ticketFilterState.value.privateFare&&t.departOptions[0].privateFare||t.arriveOptions[0].privateFare)&&this.ticketFilterState.value.privateFare)).filter(t=>0===this.ticketFilterState.value.showAirline.length||this.ticketFilterState.value.showAirline.includes(t.departOptions[0].airline)||this.ticketFilterState.value.showAirline.includes(t.arriveOptions[0].airline)).filter(t=>!!(!this.ticketFilterState.value.direct&&!this.ticketFilterState.value.oneRoute&&!this.ticketFilterState.value.moreRoute||this.ticketFilterState.value.direct&&0===t.departOptions[0].numOfStop&&0===t.arriveOptions[0].numOfStop||this.ticketFilterState.value.oneRoute&&1===t.departOptions[0].numOfStop&&1===t.arriveOptions[0].numOfStop||this.ticketFilterState.value.moreRoute&&t.departOptions[0].numOfStop>1&&t.arriveOptions[0].numOfStop>1)).filter(t=>{const i=60*t.departOptions[0].departureDate.getHours()+t.departOptions[0].departureDate.getMinutes(),a=60*t.arriveOptions[0].departureDate.getHours()+t.arriveOptions[0].departureDate.getMinutes(),n=60*t.departOptions[0].returnDate.getHours()+t.departOptions[0].returnDate.getMinutes(),o=60*t.arriveOptions[0].returnDate.getHours()+t.arriveOptions[0].returnDate.getMinutes();return!(i<this.ticketFilterState.value.comboTime.departStartTime.from||i>this.ticketFilterState.value.comboTime.departStartTime.to||a<this.ticketFilterState.value.comboTime.arriveStartTime.from||a>this.ticketFilterState.value.comboTime.arriveStartTime.to||n<this.ticketFilterState.value.comboTime.departEndTime.from||n>this.ticketFilterState.value.comboTime.departEndTime.to||o<this.ticketFilterState.value.comboTime.arriveEndTime.from||o>this.ticketFilterState.value.comboTime.arriveEndTime.to)}).filter(t=>{const i=t.departOptions[0].duration,a=t.arriveOptions[0].duration,n=60*this.ticketFilterState.value.comboDuration.from,o=60*this.ticketFilterState.value.comboDuration.to;return!(i<n||i>o||a<n||a>o)}).filter(t=>!(this.ticketFilterState.value.bookingSystem.length>0)||this.ticketFilterState.value.bookingSystem.map(i=>{var a;return"DOMESTIC"===i?[T.QK.VN,T.QK.VJ,T.QK.QH,T.QK.VU].includes(null===(a=t.provider)||void 0===a?void 0:a.toUpperCase()):i===t.provider}).reduce((i,a)=>i||a,!1)).filter(t=>{if(this.ticketFilterState.value.comboPrice.from&&this.ticketFilterState.value.comboPrice.to){const i=t.departOptions[0].totalPrice+t.arriveOptions[0].totalPrice;return i>=this.ticketFilterState.value.comboPrice.from&&i<=this.ticketFilterState.value.comboPrice.to}return!0}),this.listTicketComboDisplay=[...this.listTicketComboDisplay],this.processSortCombo(),this.ticketInfiniteScrollCount=this.TICKET_INFINITE_SCROLL_DEFAULT}bindingTypeSearch(){switch(this._searchInputService.flightType){case"ONE_WAY":this.flightTypeSearch=M.jX.OneWay,this.minFareOptionConfig=Object.assign(Object.assign({},this.minFareOptionConfig),{isRangeMinFare:!1});break;case"ROUND_TRIP":this.flightTypeSearch=M.jX.RoundTrip,this.minFareOptionConfig=Object.assign(Object.assign({},this.minFareOptionConfig),{isRangeMinFare:!0});break;case"MULTI_WAY":this.flightTypeSearch=M.jX.MultiWay}}numberOfPassengerChange(t){this._searchInputService.numberOfPassengerChange(t),this._searchInputService.suggestPromotion()}airlineFilterChange(t){this._searchInputService.airlineFilterChange(t)}cabinChange(t){this._searchInputService.cabinChange(t)}paxTypeChange(t){this._searchInputService.paxTypeChange(t)}onChangeInputSearch(t){this._searchInputService.suggestPromotion(),this._searchInputService.checkInternationalFlight(),this.updateDateSearchMinFare(t)}updateDateSearchMinFare(t){var i;"AIRPORT"===t&&(this.minFareOptionConfig.minPrice=new Map,this.minFareOptionConfig=Object.assign({},this.minFareOptionConfig),this.listDateSearchMinFares=[]);let n=[],o=new Date;if(o=null===(i=this._searchInputService.searchInputForm.value[0])||void 0===i?void 0:i.departDate,!o&&!this.minFareOptionConfig.minPrice.size&&(this.initDateSearchMinFare(),n=this.listDateSearchMinFares),o){const s=f(new Date(o.getFullYear(),o.getMonth())).format("YYYY-MM-DD");((s,d)=>{const u=s.getFullYear(),g=d.getFullYear(),c=s.getMonth();return 12*(g-u)+(d.getMonth()-c)})(new Date,o)>2?n.push(s):this.generateRangeDateSearchMinFare(s).forEach(u=>{this.listDateSearchMinFares.includes(u)||n.push(u)})}n&&n.length&&this.searchMinFaresApi(n)}onDateTypeChange(t){this.currentDateType=t,"DEPART"===t&&this.mappingMinFares(0),"ARRIVE"===t&&this.mappingMinFares(1)}searchMinFaresApi(t){const i=this._searchInputService.getSearchInputData();if(i.startPoint&&i.endPoint){let a=[];this.flightTypeSearch===M.jX.OneWay&&(a=t.map(n=>({departDate:f(new Date(n)).format("YYYY-MM-DD"),endPoint:i.endPoint,leg:0,providers:`${T.QK.VJ},${T.QK.VN},${T.QK.VU},${T.QK.QH}`,startPoint:i.startPoint}))),this.flightTypeSearch===M.jX.RoundTrip&&(a=t.map(n=>({departDate:f(new Date(n)).format("YYYY-MM-DD"),endPoint:i.endPoint,leg:0,providers:`${T.QK.VJ},${T.QK.VN},${T.QK.VU},${T.QK.QH}`,startPoint:i.startPoint})),a.push(...t.map(n=>({departDate:f(new Date(n)).format("YYYY-MM-DD"),endPoint:i.startPoint,leg:1,providers:`${T.QK.VJ},${T.QK.VN},${T.QK.VU},${T.QK.QH}`,startPoint:i.endPoint})))),this._searchFlightService.searchMinFare(a).subscribe({next:n=>{"OK"===n.status&&(n.data.length?(n.data.forEach(o=>{const s=this.searchMinFaresResult.find(d=>d.leg===o.leg);s?Object.entries(o.data).forEach(d=>{s.data.set(d[0],d[1])}):this.searchMinFaresResult.push(Object.assign(Object.assign({},o),{data:new Map(Object.entries(o.data))}))}),this._searchMinFareDataProvider.searchMinFareData=this.searchMinFaresResult,this.mappingMinFares(a[0].leg)):this.minFareOptionConfig=Object.assign({},this.minFareOptionConfig),this._searchInputService.minFareChange$.next(this.minFareOptionConfig))}})}}onNavigateDatepicker(t){let i=[];i.push(t);const a=f(t).subtract(1,"month");a.month()===(new Date).getMonth()?i.push(f(new Date).format("YYYY-MM-DD")):i.push(a.format("YYYY-MM-DD"));let n=[];if("ARRIVE"===this.currentDateType){const o=this.searchMinFaresResult.find(s=>1===s.leg);n=o?Array.from(null==o?void 0:o.data.keys()):[]}i=i.filter(o=>!this.listDateSearchMinFares.includes(o)||!n.includes(o)),i.forEach(o=>{(!this.listDateSearchMinFares.includes(o)||!n.includes(o))&&(this.listDateSearchMinFares.push(o),this.searchMinFaresApi([o]))})}generateRangeDateSearchMinFare(t,i=""){const a=f(i||new Date),n=f(t),o=[];o.push(a.format("YYYY-MM-DD"));const s=a.clone().add(1,"month").startOf("month");for(;s.isBefore(n)||s.isSame(n,"month");)o.push(s.format("YYYY-MM-DD")),s.add(1,"month");return o}onToggleAirline(t){t&&this.mappingMinFares()}mappingMinFares(t=0){if(this.searchMinFaresCurrentLegResult=this.searchMinFaresResult.find(i=>i.leg===t),this.searchMinFaresCurrentLegResult){this.minFareOptionConfig.minPrice=new Map;const i=this.minFareOptionConfig.airlineMinPrice.filter(a=>a.selected).map(a=>a.airline);this.searchMinFaresCurrentLegResult.data.forEach((a,n)=>{const o=a.filter(u=>i.includes(u.key)),s=o.length?o.reduce((u,g)=>g.value<u.value?g:u):null,d=s?this.minFareOptionConfig.airlineMinPrice.find(u=>u.airline===s.key):null;this.minFareOptionConfig.minPrice.set(n,s?{price:Math.ceil((s.value+(s.serviceFee||0))/1e3),serviceFee:(null==s?void 0:s.serviceFee)||0,originPrice:(null==s?void 0:s.value)||0,airline:(null==d?void 0:d.airline)||s.key,airlineName:(null==d?void 0:d.airlineName)||s.key,color:(null==d?void 0:d.color)||""}:null)}),this.minFareOptionConfig=Object.assign({},this.minFareOptionConfig)}this.mappingMinFareMultiDateBar()}mappingMinFareMultiDateBar(){this.multiDateBar.forEach(t=>t.price=0),this.searchMinFaresResult.forEach(t=>{const i=Object.assign(Object.assign({},this.minFareOptionConfig),{minPrice:new Map}),a=this._searchInputService.airlineFilters.filter(o=>o.actived).map(o=>o.value),n=this.minFareOptionConfig.airlineMinPrice.filter(o=>a.includes(o.airline)).map(o=>o.airline);t.data.forEach((o,s)=>{const d=o.filter(c=>n.includes(c.key)),u=d.length?d.reduce((c,h)=>h.value<c.value?h:c):null,g=u?this.minFareOptionConfig.airlineMinPrice.find(c=>c.airline===u.key):null;i.minPrice.set(s,u?{price:Math.ceil((u.value+(u.serviceFee||0))/1e3),serviceFee:(null==u?void 0:u.serviceFee)||0,originPrice:(null==u?void 0:u.value)||0,airline:(null==g?void 0:g.airline)||u.key,airlineName:(null==g?void 0:g.airlineName)||u.key,color:(null==g?void 0:g.color)||""}:null)}),this.multiDateBar&&this.multiDateBar.length&&this.multiDateBar.forEach(o=>{const s=1===t.leg?f(o.toDate).format("YYYY-MM-DD"):o.key;if(i.minPrice.has(s)){const d=i.minPrice.get(s);o.price+=((null==d?void 0:d.originPrice)||0)+((null==d?void 0:d.serviceFee)||0)}})})}addMultiRoute(){this._searchInputService.addMultiRoute()}removeRoute(t){this._searchInputService.removeRoute(t)}removeAllDataMultiRoute(){this._searchInputService.removeAllDataMultiRoute()}flightTypeChange(t){switch(this.flightTypeSearch=t,t){case M.jX.OneWay:this._searchInputService.flightTypeChange("ONE_WAY"),this.currentDateType="DEPART";break;case M.jX.RoundTrip:this._searchInputService.flightTypeChange("ROUND_TRIP"),this.currentDateType="ARRIVE";break;case M.jX.MultiWay:this._searchInputService.flightTypeChange("MULTI_WAY")}}researchFlight(){let t;this.progress=1,this.totalPrice=0,t=this.flightTypeSearch===M.jX.OneWay?"ONE_WAY":this.flightTypeSearch===M.jX.RoundTrip?"ROUND_TRIP":"MULTI_WAY",this._searchInputService.prepareRequestFlight(t)&&(this.handleLowestPriceResearch(),this.ticketInfiniteScrollCount=this.TICKET_INFINITE_SCROLL_DEFAULT,this.airlineList=[],this.bookingSystemList=[],this.isFirstTake=!0,this.tabData=[],this.modeChange("retail"),this.bindingTypeSearch(),this.loadNumberOfPassenger(),this.onResetFilter(),this.searchFlight(),this.loadTabData(),this.loadTicketSelectedData(),this.resetOptionFilters(),this.checkShareFlight(),this.hasAirportInternational=this._searchInputService.hasAirportInternational)}onQuotation(t){let i=this.tabData[this.currentLeg];i=Object.assign(Object.assign({},i),{startPoint:i.startPoint,startPointName:this._locationDataService.getCityNameByCode(i.startPoint),endPoint:i.endPoint,endPointName:this._locationDataService.getCityNameByCode(i.endPoint)}),this._modal.open(we,{isHiddenNetPrice:this.ticketDisplayState.value.showNetPrice,isHiddenCabin:this.ticketDisplayState.value.hideFareClass,listTicketDisplay:this.listTicketDisplay.filter(a=>a.seatRemain>0),journey:i,currentLeg:t,canEditHeader:this._permissionService.hasPermission(L.or.EditFlightTicketQuoteHeader)})}onMobileQuotation(t){let i=this.tabData[this.currentLeg];i=Object.assign(Object.assign({},i),{startPoint:i.startPoint,startPointName:this._locationDataService.getCityNameByCode(i.startPoint),endPoint:i.endPoint,endPointName:this._locationDataService.getCityNameByCode(i.endPoint)});const a=this._bottomSheetService.open(we,{headerTitle:"Chia s\u1ebb c\xe1c chuy\u1ebfn bay l\u1ef1a ch\u1ecdn",leftButtonIcon:"close",leftButtonIconClass:"text-neutral-gray-4",rightButtonIcon:"",containerFullHeigh:!0,data:{isHiddenNetPrice:this.ticketDisplayState.value.showNetPrice,isHiddenCabin:this.ticketDisplayState.value.hideFareClass,listTicketDisplay:this.listTicketDisplay.filter(n=>n.seatRemain>0),journey:i,currentLeg:t,canEditHeader:this._permissionService.hasPermission(L.or.EditFlightTicketQuoteHeader)}});a.containerInstance._leftButtonClick.subscribe(n=>a.dismiss())}getTicketDetail(t,i,a){const n=[];if(this.numberOfPassenger.adult){const s=t.getTotalAmountByType("ADULT")*this.numberOfPassenger.adult,d=s?t.getDiscountByBaseFare("ADULT",i,a&&a.adtPercentage||0,a&&a.adtAmount||0):(null==a?void 0:a.adtAmount)||0,u=a?s-(d||0)*this.numberOfPassenger.adult:0,g={type:"Ng\u01b0\u1eddi l\u1edbn (ADT)",quantity:this.numberOfPassenger.adult,baseFare:t.getBaseFare("ADULT",i),taxFee:t.getSurCharge("ADULT",i),serviceFee:t.getServiceFee(),discountAmount:d,totalFare:s,totalDiscountFare:u};n.push(g)}if(this.numberOfPassenger.child){const s=t.getTotalAmountByType("CHILD")*this.numberOfPassenger.child,d=s?t.getDiscountByBaseFare("CHILD",i,a&&a.chdPercentage||0,a&&a.chdAmount||0):(null==a?void 0:a.chdAmount)||0,u=a?s-(d||0)*this.numberOfPassenger.child:0,g={type:"Tr\u1ebb em (CHD)",quantity:this.numberOfPassenger.child,baseFare:t.getBaseFare("CHILD",i),taxFee:t.getSurCharge("CHILD",i),serviceFee:0,discountAmount:d,totalFare:s,totalDiscountFare:u};n.push(g)}if(this.numberOfPassenger.infant){const s=t.getTotalAmountByType("INFANT")*this.numberOfPassenger.infant,d=s?t.getDiscountByBaseFare("INFANT",i,a&&a.infPercentage||0,a&&a.infAmount||0):(null==a?void 0:a.infAmount)||0,u=a?s-(d||0)*this.numberOfPassenger.infant:0,g={type:"Em b\xe9 (INF)",quantity:this.numberOfPassenger.infant,baseFare:t.getBaseFare("INFANT",i),taxFee:t.getSurCharge("INFANT",i),serviceFee:0,discountAmount:d,totalFare:s,totalDiscountFare:u};n.push(g)}return{totalCharge:n.reduce((s,d)=>s+d.totalFare,0),totallDiscountFareCharge:a&&(a.adtPercentage>0||a.adtAmount>0)?n.reduce((s,d)=>s+d.totalDiscountFare,0):0,details:n}}onShowDetailInfo(t){const i=this.listTicketSelected[t],a={airline:i.airline,airlineName:i.airlineName,airlineLogo:i.airlineLogo,provider:i.provider,journeyKey:i.journeyKey,operating:i.operating,operatingName:i.operatingName,flightNumber:i.flight,journeyName:`Chuy\u1ebfn bay: ${i.startPoint} - ${i.endPoint}`,numOfStop:i.numOfStop,departureDate:f(i.startTime).format("HH:mm DD/MM/YYYY"),startPoint:i.startCode,startPointName:i.startPoint,endPoint:i.endCode,endPointName:i.endPoint,startTerminal:i.startTerminal,endTerminal:i.endTerminal,price:i.totalPrice,showSurchargeFare:i.showSurchargeFare,surcharge:i.surcharge,handBag:"Kh\xf4ng",segments:i.segments.map((n,o)=>({airline:n.airline,airlineSystem:n.airline,airlineName:n.airlineName,airlineLogo:n.airlineLogo,operating:n.operating,operatingName:n.operatingName,mobileAirlineLogo:["VJ","VN","QH"].includes(n.operating)?"assets/airline-logo/"+n.operating+"_small.png":"assets/airline-logo/"+n.operating+".png",flightNumber:n.airline+n.flightNumber,startTime:f(n.departDate).format("HH:mm"),startDate:f(n.departDate).format("DD/MM/YYYY"),startPoint:n.startCode,startPointName:n.startPoint,startAirport:this._locationDataService.getAirportNameByCode(n.startPoint),endTime:f(n.arrivalDate).format("HH:mm"),endDate:f(n.arrivalDate).format("DD/MM/YYYY"),endPoint:n.endCode,endPointName:n.endPoint,startTerminal:n.startTerminal,endTerminal:n.endTerminal,endAirport:this._locationDataService.getAirportNameByCode(n.endPoint),stopPoint:n.stopPoint,modelAirplane:n.modelAirplane,rules:[{name:"Th\u1eddi gian bay",value:n.duration},{name:"Lo\u1ea1i m\xe1y bay",value:n.modelAirplane},{name:"H\u1ea1ng ch\u1ed7",value:(n.fareType||"")+(n.fareClass?`(${n.fareClass})`:"N/A")},{name:"H\xe0nh l\xfd k\xfd g\u1eedi",value:i.checkedBag||"N/A"},{name:"H\xe0nh l\xfd x\xe1ch tay",value:i.handBag||"N/A"}]})),ticketPrice:i.ticketPrice,fareRule:i.fareRule};this.isMobile?this._bottomSheetService.open(E._8,{containerFullHeigh:!0,headerTitle:"Th\xf4ng tin chuy\u1ebfn bay",leftButtonIcon:"arrow_left",rightButtonIcon:"",data:{hasDiscountFare:i.hasDiscountFare}}):this._modal.open(E.Zk,{flightInfo:a,hasDiscountFare:i.hasDiscountFare})}getFareRuleClass(t,i,a){let n;n=["QH","VJ","VU"].includes(t)&&!this.hasAirportInternational?this.listFareRuleClasses.find(d=>{var u;return t===d.airline&&(null==a?void 0:a.toLocaleUpperCase())===(null===(u=d.fareClass)||void 0===u?void 0:u.toLocaleUpperCase())})||null:["VN"].includes(t)?this.listFareRuleClasses.find(d=>{var u;return t===d.airline&&(null==i?void 0:i.toLocaleUpperCase())===(null===(u=d.fareClass)||void 0===u?void 0:u.toLocaleUpperCase())})||null:{airline:t,fareClass:i,rules:[{name:"H\xe0nh l\xfd x\xe1ch tay",value:"",cate:"HAND_BAGGAGE"},{name:"H\xe0nh l\xfd k\xfd g\u1eedi",value:"",cate:"CHECKED_BAGGAGE"}]};const o=(null==n?void 0:n.rules.find(d=>"HAND_BAGGAGE"===d.cate))||null,s=(null==n?void 0:n.rules.find(d=>"CHECKED_BAGGAGE"===d.cate))||null;return{handBag:(null==o?void 0:o.value)||"",checkedBag:(null==s?void 0:s.value)||""}}onSortChange(t){this.sortState=t,this.processSort(),this.ticketInfiniteScrollCount=this.TICKET_INFINITE_SCROLL_DEFAULT}onSortChangeCombo(t){this.sortStateCombo=t,this.processSortCombo(),this.ticketInfiniteScrollCount=this.TICKET_INFINITE_SCROLL_DEFAULT}processSort(){var t,i;switch(this.sortState){case"min_price":this.listTicketDisplay.sort(this.ticketDisplayState.value.showNetPrice?(a,n)=>a.netPrice-n.netPrice:(a,n)=>(a.totalDiscountFarePrice||a.totalPrice)-(n.totalDiscountFarePrice||n.totalPrice));break;case"max_price":this.listTicketDisplay.sort(this.ticketDisplayState.value.showNetPrice?(a,n)=>n.netPrice-a.netPrice:(a,n)=>(n.totalDiscountFarePrice||n.totalPrice)-(a.totalDiscountFarePrice||a.totalPrice));break;case"min_flight":this.listTicketDisplay.sort((a,n)=>a.duration-n.duration),this.listTicketAgentDisplay.sort((a,n)=>a.duration-n.duration);break;case"max_flight":this.listTicketDisplay.sort((a,n)=>n.duration-a.duration),this.listTicketAgentDisplay.sort((a,n)=>n.duration-a.duration);break;case"earliest_departure":this.listTicketDisplay.sort((a,n)=>a.departure.localTime.getTime()-n.departure.localTime.getTime()),this.listTicketAgentDisplay.sort((a,n)=>a.departure.localTime.getTime()-n.departure.localTime.getTime());break;case"late_departure":this.listTicketDisplay.sort((a,n)=>n.departure.localTime.getTime()-a.departure.localTime.getTime()),this.listTicketAgentDisplay.sort((a,n)=>n.departure.localTime.getTime()-a.departure.localTime.getTime());break;case"earliest_arrival":this.listTicketDisplay.sort((a,n)=>a.arrival.localTime.getTime()-n.arrival.localTime.getTime()),this.listTicketAgentDisplay.sort((a,n)=>a.arrival.localTime.getTime()-n.arrival.localTime.getTime());break;case"late_arrival":this.listTicketDisplay.sort((a,n)=>n.arrival.localTime.getTime()-a.arrival.localTime.getTime()),this.listTicketAgentDisplay.sort((a,n)=>n.arrival.localTime.getTime()-a.arrival.localTime.getTime())}null===(t=this.listTicketDisplay)||void 0===t||t.sort((a,n)=>Number(0===a.seatRemain)-Number(0===n.seatRemain)),null===(i=this.listTicketAgentDisplay)||void 0===i||i.sort((a,n)=>{const o=a.segmentsDisplay.some(d=>d.fareClasses.every(u=>!u.seatRemain))?0:1;return(n.segmentsDisplay.some(d=>d.fareClasses.every(u=>!u.seatRemain))?0:1)-o})}processSortCombo(){const t=this.listTicketComboDisplay.filter(a=>-1!==a.indexForTracking),i=this.listTicketComboDisplay.filter(a=>-1===a.indexForTracking);switch(this.sortStateCombo){case"min_price":t.sort((a,n)=>a.departOptions[0].totalPrice+a.arriveOptions[0].totalPrice-(n.departOptions[0].totalPrice+n.arriveOptions[0].totalPrice));break;case"max_price":t.sort((a,n)=>n.departOptions[0].totalPrice+n.arriveOptions[0].totalPrice-(a.departOptions[0].totalPrice+a.arriveOptions[0].totalPrice));break;case"best":t.sort((a,n)=>n.score-a.score);break;case"fastest":t.sort((a,n)=>a.departOptions[0].duration+a.arriveOptions[0].duration-(n.departOptions[0].duration+n.arriveOptions[0].duration));break;case"max_flight":t.sort((a,n)=>n.departOptions[0].duration+n.arriveOptions[0].duration-(a.departOptions[0].duration+a.arriveOptions[0].duration));break;case"earliest_departure":t.sort((a,n)=>a.departOptions[0].departureDate.getTime()-n.departOptions[0].departureDate.getTime());break;case"late_departure":t.sort((a,n)=>n.departOptions[0].departureDate.getTime()-a.departOptions[0].departureDate.getTime());break;case"earliest_arrival":t.sort((a,n)=>a.arriveOptions[0].departureDate.getTime()-n.arriveOptions[0].departureDate.getTime());break;case"late_arrival":t.sort((a,n)=>n.arriveOptions[0].departureDate.getTime()-a.arriveOptions[0].departureDate.getTime())}this.listTicketComboDisplay=[...t,...i]}onShare(){this._modal.open(E.eP,{ticketsSelected:this.listTicketSelected.filter(t=>t.journeyKey),canEditHeader:this.canEditHeader,totalPrice:this.totalPrice,totalPriceCombo:this.totalPriceCombo,isHiddenTotalCharge:this.isHiddenTotalCharge})}onShareCombo(t,i){var a,n;const o=t.map((d,u)=>this.convertComboTicketToTicketSelectedVM(d,u,i)),s=o.map(d=>d.totalPrice).reduce((d,u)=>d+u)||0;if(this.totalPriceCombo=(null===(n=null===(a=o[0].comboRefs)||void 0===a?void 0:a.find(d=>d.key===o[1].fareOptionKey))||void 0===n?void 0:n.totalAllPaxPriceCombo)||0,this.isMobile){const d=this._bottomSheetService.open(E.eP,{headerTitle:"Chia s\u1ebb c\xe1c chuy\u1ebfn bay l\u1ef1a ch\u1ecdn",leftButtonIcon:"close",leftButtonIconClass:"text-neutral-gray-4",rightButtonIcon:"",containerFullHeigh:!0,data:{ticketsSelected:o,canEditHeader:this.canEditHeader,totalPrice:o.map(u=>u.totalPrice).reduce((u,g)=>u+g),totalPriceCombo:this.totalPriceCombo,isHiddenTotalCharge:this.isHiddenTotalCharge}});d.containerInstance._leftButtonClick.subscribe(u=>d.dismiss())}else this._modal.open(E.eP,{ticketsSelected:o,canEditHeader:this.canEditHeader,totalPrice:s,totalPriceCombo:this.totalPriceCombo,isHiddenTotalCharge:this.isHiddenTotalCharge})}onChangeSearch(t){t.focusFirstStartPoint()}onResetFilter(){this.ticketFilterState.next(Object.assign(Object.assign({},this.filterStateInit),{direct:this._searchInputService.isDirectFlight}))}resetOptionFilters(){this.fareclassList=[],this.selectedFare.value=""}initTicketExpireTimer(){var t,i,a;this.clearTimer();let n=Number.MAX_SAFE_INTEGER;0!==(null===(t=this.searchFlightData.flightOptions)||void 0===t?void 0:t.length)&&(null!==(i=this.searchFlightData.flightOptions)&&void 0!==i&&i.length&&"COMBO"!==this.searchFlightData.flightOptions[0].type?this.searchFlightData.flightOptions.forEach(o=>{o.journeys.forEach(s=>{s.expireTime<n&&(n=s.expireTime)})}):!(null===(a=this.searchFlightData.flightOptions)||void 0===a)&&a.length&&"COMBO"===this.searchFlightData.flightOptions[0].type&&this.searchFlightData.flightOptions.forEach(o=>{o.comboInfo.arriveJourneys.forEach(s=>{s.expireTime<n&&(n=s.expireTime)}),o.comboInfo.departJourneys.forEach(s=>{s.expireTime<n&&(n=s.expireTime)})}),n&&n!==Number.MAX_SAFE_INTEGER&&this._systemService.getCurrentTimeEpoch().subscribe({next:o=>{"OK"===o.status&&(this.ticketExpireTimer=setTimeout(()=>{this._modal.open(z.V0,{title:"C\u1eadp nh\u1eadt th\xf4ng tin m\u1edbi nh\u1ea5t",body:"Th\u1eed l\u1ea1i k\u1ebft qu\u1ea3 t\xecm ki\u1ebfm v\u1edbi th\xf4ng tin, chi ph\xed v\xe0 ch\u1ed7 tr\u1ed1ng m\u1edbi nh\u1ea5t.",okText:"T\u1ea3i l\u1ea1i",hasCancel:!1}).afterClosed$.subscribe({next:d=>{d.data&&this.researchFlight()}})},1e3*(n-o.data.timeStamp)))}}))}clearTimer(){clearTimeout(this.ticketExpireTimer)}hasOutOfSeatDisplay(){return this.listTicketDisplay.some(t=>0===t.seatRemain)}hasOutOfSeatComboDisplay(){return this.listTicketComboDisplay.some(t=>t.soldOut)}hasOutOfSeatAgentDisplay(t){return t?t.segmentsDisplay.some(i=>i.fareClasses.every(a=>!a.seatRemain)):this.listTicketAgentDisplay.some(i=>i.segmentsDisplay.some(a=>a.fareClasses.every(n=>!n.seatRemain)))}onRegisterBookingHunter(){this._requestDataService.sourceEvent="SEARCH_RESULT",this._router.navigate(["admin/request-booking-hunter"],{state:{isEntryPointSearch:!0}})}onVerifyFlight(t,i,a){var n,o;if("CHECKED"===((null===(n=t[0].comboRefs.find(g=>g.key===t[1].fareOptionKey))||void 0===n?void 0:n.verifyState)||"UNCHECKED"))return;const d=null===(o=t[0].comboRefs)||void 0===o?void 0:o.find(g=>g.key===t[1].fareOptionKey);d&&(d.verifyState="IN_PROGRESS"),this.isVerifyComboProgress=!0;const u={flights:t.map(g=>({fareOptionKey:g.fareOptionKey,journeyKey:g.journeyKey,serviceFeeInfo:null})),provider:t[0].provider,checkMinPrice:!1};this._searchFlightService.verifyFlightCombo(u).pipe((0,X.x)(()=>this.isVerifyComboProgress=!1)).subscribe({next:g=>{if("OK"===g.status){const c=g.data[0].comboRefs.find(p=>p.key[0]===(null==d?void 0:d.key));c&&(g.data[1].fareAmountBreakdowns=null==c?void 0:c.fareAmountBreakdowns),d&&(d.sessionId=(null==c?void 0:c.sessionId)||"",d.verifyState="CHECKED",d.totalPriceCombo=(null==c?void 0:c.getTotalAmount())||0,d.totalAllPaxPriceCombo=(null==c?void 0:c.getTotalAmountAllPax(this.numberOfPassenger.adult,this.numberOfPassenger.child))||0,d.ticketPrice=c?this.getTicketDetail(c,t[0].airline):null,this.listTicketComboDisplay[a]=Object.assign({},this.listTicketComboDisplay[a]))}else d&&(d.verifyState="FAIL")},error:()=>{d&&(d.verifyState="INVALID")}})}handleLowestPriceResearch(){var t,i;const a=this._dataProvider.searchInputData.journey[0].departDate,n=f(a).format("YYYY-MM-DD");if(this.multiDateBar.findIndex(s=>s.key===n)<0&&(n>this.multiDateBar[this.multiDateBar.length-1].key&&this.addDateBar(a),n<this.multiDateBar[0].key&&this.subtractDateBar()),this.multiDateBar.forEach(s=>{s.selected=n===s.key,s.active=s.key>=f(new Date).format("YYYY-MM-DD")}),"ROUND_TRIP"===this._searchInputService.flightType){const s=null===(t=this._dataProvider.searchInputData.journey[1])||void 0===t?void 0:t.departDate;if(s){const d=null===(i=this._dataProvider.searchInputData.journey[0])||void 0===i?void 0:i.departDate,u=f(d),c=f(s).diff(u,"days");this.multiDateBar.forEach(h=>{h.toDate=f(h.fromDate).add(c,"days").toDate()})}}this.mappingMinFareMultiDateBar(),setTimeout(()=>{this.scrollDate(n)},0)}mappingMinFareMultiBar(){let t=new Map;this._searchMinFareDataProvider&&this._searchMinFareDataProvider.searchMinFareData&&this._searchMinFareDataProvider.searchMinFareData[0]&&(this.multiDateBar.forEach(i=>i.price=0),this._searchMinFareDataProvider.searchMinFareData.forEach(i=>{t=new Map(Object.entries(i.data)),t&&this.multiDateBar.forEach(a=>{if(t.has(a.key)){const n=t.get(a.key);if(n){const o=n.length?n.reduce((s,d)=>d.value<s.value?d:s):null;a.price+=o.value+((null==o?void 0:o.serviceFee)||0)}}})}))}generateRangeDateBar(){var t;let i;if(this.multiDateBar=[],this._searchMinFareDataProvider.searchMinFareData&&this._searchMinFareDataProvider.searchMinFareData[0]&&(i=new Map(Object.entries(this._searchMinFareDataProvider.searchMinFareData[0].data))),"ONE_WAY"===this._searchInputService.flightType){const a=this._dataProvider.searchInputData.journey[0].departDate;this.getDaysInMonth(new Date(a)).forEach(o=>{const s=f(o).format("YYYY-MM-DD"),d=s===f(a).format("YYYY-MM-DD"),u=s>=f(new Date).format("YYYY-MM-DD"),g=(0,Y.$j)(o);if(i&&i.has(s)){const c=i.get(s),h=c.length?c.reduce((p,v)=>v.value<p.value?v:p):null;this.multiDateBar.push(h?{key:f(o).format("YYYY-MM-DD"),fromDate:o,toDate:null,price:(null==h?void 0:h.value)||0,airlineMinPrice:(null==h?void 0:h.key)||"",active:u,selected:d,dayInfo:{holiday:g.holiday,lunarDate:`ng\xe0y ${g.lunarDate.date}/${g.lunarDate.month} \xe2m l\u1ecbch`,dateFormat:g.dateFormat}}:{key:f(o).format("YYYY-MM-DD"),fromDate:o,toDate:null,price:0,airlineMinPrice:"",active:u,selected:d,dayInfo:{holiday:g.holiday,lunarDate:`ng\xe0y ${g.lunarDate.date}/${g.lunarDate.month} \xe2m l\u1ecbch`,dateFormat:g.dateFormat}})}else this.multiDateBar.push({key:f(o).format("YYYY-MM-DD"),fromDate:o,toDate:null,price:0,airlineMinPrice:"",active:u,selected:d,dayInfo:{holiday:g.holiday,lunarDate:`ng\xe0y ${g.lunarDate.date}/${g.lunarDate.month} \xe2m l\u1ecbch`,dateFormat:g.dateFormat}})})}else{const a=this._dataProvider.searchInputData.journey[0].departDate,n=null===(t=this._dataProvider.searchInputData.journey[1])||void 0===t?void 0:t.departDate,o=f(a),d=f(n).diff(o,"days");this.getDaysInMonth(new Date(a)).forEach(g=>{const c=f(g).format("YYYY-MM-DD"),h=c===f(a).format("YYYY-MM-DD"),p=c>=f(new Date).format("YYYY-MM-DD"),v=(0,Y.$j)(g);if(i&&i.has(c)){const C=i.get(c),D=C.length?C.reduce((m,k)=>k.value<m.value?k:m):null;this.multiDateBar.push(D?{key:f(g).format("YYYY-MM-DD"),fromDate:g,toDate:f(g).add(d,"days").toDate(),price:null==D?void 0:D.value,airlineMinPrice:(null==D?void 0:D.key)||"",active:p,selected:h,dayInfo:{holiday:v.holiday,lunarDate:`ng\xe0y ${v.lunarDate.date}/${v.lunarDate.month} \xe2m l\u1ecbch`,dateFormat:v.dateFormat}}:{key:f(g).format("YYYY-MM-DD"),fromDate:g,toDate:f(g).add(d,"days").toDate(),price:0,airlineMinPrice:"",active:p,selected:h,dayInfo:{holiday:v.holiday,lunarDate:`ng\xe0y ${v.lunarDate.date}/${v.lunarDate.month} \xe2m l\u1ecbch`,dateFormat:v.dateFormat}})}else this.multiDateBar.push({key:f(g).format("YYYY-MM-DD"),fromDate:g,toDate:f(g).add(d,"days").toDate(),price:0,airlineMinPrice:"",active:p,selected:h,dayInfo:{holiday:v.holiday,lunarDate:`ng\xe0y ${v.lunarDate.date}/${v.lunarDate.month} \xe2m l\u1ecbch`,dateFormat:v.dateFormat}})})}}getDaysInMonth(t){const i=t.getFullYear(),a=t.getMonth(),n=f(new Date(i,a,1)).subtract(6,"days").toDate(),o=f(new Date(i,a+2,0)).add(6,"days").toDate();let s=[];for(let d=n;d<=o;d.setDate(d.getDate()+1))d>=new Date&&s.push(new Date(d));return s}onPreviousDate(){this.addScrollElement("PREVIOUS"),this.mappingMinFareMultiBar();const t=document.querySelector("#mutli-date-bar");t&&t.scrollBy({left:-this.scrollAmount,behavior:"smooth"})}onNextDate(){this.addScrollElement("NEXT"),this.mappingMinFareMultiBar();const t=document.querySelector("#mutli-date-bar");t&&t.scrollBy({left:this.scrollAmount,behavior:"smooth"})}onScrollMultiDateBar(t){const a=t.target.scrollLeft;a>=this.previousScrollLeft?(this.addScrollElement("NEXT"),this.mappingMinFareMultiBar()):a<this.previousScrollLeft&&(this.addScrollElement("PREVIOUS"),this.mappingMinFareMultiBar()),this.previousScrollLeft=a}addScrollElement(t){let i;if(i=this._mobileDetectService.isMobile()?document.querySelector("#mutli-date-bar-mobile"):document.querySelector("#mutli-date-bar"),"NEXT"===t){const a=null==i?void 0:i.scrollLeft,n=null==i?void 0:i.scrollWidth,o=null==i?void 0:i.clientWidth;a&&n&&o&&a+o>=n-6*this.itemWidth&&this.addDateBar()}"PREVIOUS"===t&&i&&i.scrollLeft<=6*this.itemWidth&&this.subtractDateBar()}subtractDateBar(t){const i=this.multiDateBar[0].fromDate,a=this.multiDateBar[0].toDate;let n=12;if(t){const o=new Date(i).getTime()-new Date(t).getTime();o>0&&(n+=Math.ceil(Math.abs(o)/864e5))}for(let o=1;o<=n;o++){const s=f(i).subtract(o,"days").toDate(),d=(0,Y.$j)(s),u={key:f(i).subtract(o,"days").format("YYYY-MM-DD"),fromDate:s,toDate:a?f(a).subtract(o,"days").toDate():null,price:0,airlineMinPrice:"",active:!0,selected:!1,dayInfo:{holiday:d.holiday,lunarDate:`ng\xe0y ${d.lunarDate.date}/${d.lunarDate.month} \xe2m l\u1ecbch`,dateFormat:d.dateFormat}};if(u.key<f(new Date).format("YYYY-MM-DD"))break;this.multiDateBar.unshift(Object.assign(Object.assign({},u),{active:u.key>=f(new Date).format("YYYY-MM-DD")}))}}addDateBar(t){const i=this.multiDateBar[this.multiDateBar.length-1].fromDate,a=this.multiDateBar[this.multiDateBar.length-1].toDate;let n=12;if(t){const o=new Date(t).getTime()-new Date(i).getTime();o>0&&(n+=Math.ceil(Math.abs(o)/864e5))}for(let o=1;o<=n;o++){const s=f(i).add(o,"days").toDate(),d=(0,Y.$j)(s);this.multiDateBar.push({key:f(i).add(o,"days").format("YYYY-MM-DD"),fromDate:s,toDate:a?f(a).add(o,"days").toDate():null,price:0,airlineMinPrice:"",active:!0,selected:!1,dayInfo:{holiday:d.holiday,lunarDate:`ng\xe0y ${d.lunarDate.date}/${d.lunarDate.month} \xe2m l\u1ecbch`,dateFormat:d.dateFormat}})}}onSelectDateBar(t,i,a){this.multiDateBar.forEach(s=>{s.selected=s.key===t}),this.scrollDate(t);const n=this._dataProvider.searchInputData.journey,o=[];this._searchInputService.searchInputForm.at(0).controls.departDate.setValue(i),n.forEach(s=>{0===s.leg&&(s.departDate=i)}),o.push(i),this.flightTypeSearch===M.jX.RoundTrip&&a&&(this._searchInputService.searchInputForm.at(0).controls.returnDate.setValue(a),n.forEach(s=>{1===s.leg&&(s.departDate=a)}),o.push(a)),this._dataProvider.searchInputData=Object.assign(Object.assign({},this._dataProvider.searchInputData),{journey:n}),this._searchInputService.selectedDateBar$.next(o),this.researchFlight()}onDatePickerClick(){if(this._mobileDetectService.mobileSubject.value){const t=this._bottomSheetService.open(E.Mp,{headerTitle:"T\xf9y ch\u1ec9nh th\u1eddi gian",leftButtonIcon:"close",leftButtonIconClass:"text-neutral-gray-4",rightButtonIcon:"",containerFullHeigh:!0,data:{formArray:this._searchInputService.searchInputForm,minFareOptionConfig:this.minFareOptionConfig}});t.containerInstance._leftButtonClick.subscribe(i=>t.dismiss()),t.afterDismissed().subscribe({next:i=>{var a,n;if(i){this.researchFlight();const o=[],s=this._searchInputService.searchInputForm.at(0).value.departDate;o.push(s);const d=null===(n=null===(a=this._searchInputService.searchInputForm.at(0))||void 0===a?void 0:a.value)||void 0===n?void 0:n.returnDate;d&&o.push(d),this._searchInputService.selectedDateBar$.next(o)}}})}}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(ua.R),e.Y36(ha.h),e.Y36(re.t7),e.Y36(pa.G),e.Y36(ma._),e.Y36(x.KNP),e.Y36(nt.F0),e.Y36(K.oE),e.Y36(fa.vQ),e.Y36(L.$A),e.Y36(lt.L),e.Y36(q.a2),e.Y36(_a.x),e.Y36(va.r),e.Y36(Ta.FH),e.Y36(ya.o),e.Y36(ga.W),e.Y36(e.sBO),e.Y36(Ee.m))},r.\u0275cmp=e.Xpm({type:r,selectors:[["search-flight-result-page"]],viewQuery:function(t,i){if(1&t&&e.Gf(Ca,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tabScrollEl=a.first)}},standalone:!0,features:[e.jDz],decls:55,vars:82,consts:[[1,"h-full","w-full","flex","flex-col"],[1,"bg-neutral-white","shadow-cf-md","md:hidden"],[1,"py-4","px-[30px]","w-full"],[1,"flex","items-center","justify-between","mb-4"],[3,"flightType","flightTypeSearchChange"],[1,"flex","items-center","justify-end","gap-x-4"],[3,"adultNumber","childNumber","infantNumber","numberOfPassengerChange"],[3,"airlineList","airlineFilterChange"],[3,"promotionGroupList"],[3,"cabinList","actived","cabinChange"],[3,"paxTypeList","actived","paxTypeChange"],[1,"flex","gap-x-2"],[1,"grow",3,"formArray","minFareOptionConfig","removeRoute","dataChange","toggleAirline","dateTypeChange","navigateDatepicker"],["searchFlightEl",""],["cf-button","","size","medium","class","w-[168px] !py-[7px] !h-auto !max-h-14","type","secondary",3,"disabled","click",4,"ngIf"],["class","flex items-center justify-between mb-[9px]",4,"ngIf"],["class","w-full border-t border-t-neutral-gray-1",4,"ngIf"],["class","h-1 w-full",4,"ngIf"],[1,"flex-col","w-full","hidden","md:flex","sticky","top-0","z-[5]"],[1,"px-4","pt-3","pb-2","hidden","md:block","bg-white"],[3,"currentMode","onReseachFlight","onFlightTypeChange","onQuotation"],[1,"pl-4","pt-0","hidden","md:block","bg-white","shadow-cf-md"],[1,"flex","items-center","gap-x-2","overflow-y-auto","pr-4","pb-3"],[3,"disableSort","sortDefault","sortChange",4,"ngIf"],[3,"sortDefault","tabDetail","sortChange",4,"ngIf"],[3,"currentMode","airlineList","hasAirportInternational","ticketFilter","ticketDisplay","fareclassList","planeModelList","selectedFare","departureTimeList","arrivalTimeList","durationFilter","minDuration","maxDuration","departTimeComboList","arriveTimeComboList","minFareClss","priceFilter","minPrice","maxPrice","bookingSystemList","ticketFilterChange","ticketDisplayChange"],[3,"modeView","disableAgencyMode","modeChange",4,"ngIf"],[3,"airlineList","ticketFilter","ticketFilterChange"],[3,"ticketFilter","ticketFilterChange"],["class","w-full border-t border-t-neutral-gray-1 overflow-hidden bg-neutral-white hidden md:flex",4,"ngIf"],[1,"flex-auto","h-full","flex","py-6","px-[30px]","md:p-4"],[1,"w-[222px]","pr-[30px]","flex-shrink-0","md:hidden"],[3,"currentMode","airlineList","hasAirportInternational","ticketFilter","ticketDisplay","fareclassList","planeModelList","departureTimeList","minFareClss","priceFilter","minPrice","maxPrice","leg","departTimeComboList","arriveTimeComboList","durationFilter","minDuration","maxDuration","bookingSystemList","selectedFare","arrivalTimeList","ticketFilterChange","ticketDisplayChange"],[1,"flex","flex-col","grow","gap-y-6","md:gap-y-3","md:w-full"],["class","py-3 px-4 flex items-center gap-x-2 bg-functional-1-1 rounded",4,"ngIf"],[4,"ngIf"],["class","md:hidden",3,"sortDefault","tabDetail","sortChange",4,"ngIf"],[1,"flex","flex-nowrap","gap-x-4","md:gap-x-0"],[1,"flex","flex-col","grow","gap-y-4","md:w-full"],["class","flex justify-between items-center md:hidden",4,"ngIf"],[1,"flex","flex-col","gap-y-3","md:mb-16"],[1,"mt-[56px]","w-[302px]","flex-shrink-0","rounded","h-fit","md:hidden","sticky","top-0"],[1,"bg-neutral-white"],[1,"flex","justify-between","items-center","py-3","px-4"],[1,"text-espressive-sm","text-neutral-black"],["class","cursor-pointer","icon","share","size","small",3,"click",4,"ngIf"],[3,"ticketsSelected","reselect","showDetail"],["class","flex justify-between items-center py-3 px-4",4,"ngIf"],["cf-button","","size","medium","type","secondary",1,"w-[168px]","!py-[7px]","!h-auto","!max-h-14",3,"disabled","click"],["icon","search","size","small",1,"mr-2.5"],[1,"whitespace-nowrap"],[1,"flex","items-center","justify-between","mb-[9px]"],[1,"flex","items-center","gap-x-10","mt-[19px]"],[1,"flex","items-center","text-secondary-1-5","cursor-pointer",3,"click"],["icon","plus","size","small",1,"mr-2.5"],[1,"text-heading-xs"],[1,"flex","items-center","text-neutral-black","cursor-pointer",3,"click"],["icon","rotate_left","size","small",1,"mr-2.5"],[1,"text-body-md"],["cf-button","","size","medium","type","secondary",1,"w-[168px]","mt-[25px]","!max-h-14",3,"disabled","click"],[1,"w-full","border-t","border-t-neutral-gray-1"],[1,"flex","items-center"],[1,"p-4","cursor-pointer",3,"click"],["size","medium","icon","chevron_left"],["id","mutli-date-bar",1,"flex","items-center","overflow-auto","no-scrollbar",3,"scroll"],[4,"ngFor","ngForOf"],["size","medium","icon","chevron_right"],[1,"group","py-2","cursor-pointer",3,"ngClass","id","cfTooltip","placement","click"],[1,"h-10","border-l","border-l-neutral-gray-2","flex","flex-col","items-center","justify-center","min-w-[114px]","py-4"],[1,"text-body-md-short",3,"ngClass"],[1,"text-body-sm","text-neutral-gray-4",3,"ngClass"],["dateBarTemplate",""],[1,"h-1","w-full"],[1,"h-1","bg-primary-1-4","transition-all","ease-out","duration-1000"],[3,"disableSort","sortDefault","sortChange"],[3,"sortDefault","tabDetail","sortChange"],[3,"modeView","disableAgencyMode","modeChange"],[1,"w-full","border-t","border-t-neutral-gray-1","overflow-hidden","bg-neutral-white","hidden","md:flex"],[1,"flex","items-center","overflow-auto"],["id","mutli-date-bar-mobile",1,"flex","items-center","overflow-auto","no-scrollbar",3,"scroll"],[1,"p-4","cursor-pointer","flex","justify-center","items-center","shadow-cf-lg",3,"click"],["size","medium","icon","calendar"],[1,"group","py-2","cursor-pointer",3,"ngClass","id","cfTooltip","click"],[1,"py-3","px-4","flex","items-center","gap-x-2","bg-functional-1-1","rounded"],["icon","circle_information","size","small",1,"text-functional-1-3"],[1,"flex","flex-col","grow","text-neutral-gray-6"],[1,"text-espressive-md"],["size","small","icon","close",1,"text-neutral-gray-4","cursor-pointer",3,"click"],[1,"md:overflow-y-auto","md:hidden",3,"selectedIndexChange"],["class","w-1/4 grow-0 md:w-fit",3,"active","title",4,"ngFor","ngForOf"],["class","flex-1 rounded-md h-fit mb-3 md:flex hidden bg-white divide-solid divide-x divide-neutral-gray-1 ",4,"ngIf"],[1,"w-1/4","grow-0","md:w-fit",3,"active","title"],["titleTemplate",""],[1,"flex","gap-x-4","items-center","md:-mx-1","md:-my-1.5"],[1,"flex","justify-center","items-center","w-8","h-8","rounded-full","bg-neutral-gray-1","text-neutral-gray-4","text-heading-sm","md:w-6","md:h-6","md:text-espressive-sm"],[1,"flex","flex-col"],[1,"text-heading-sm","whitespace-nowrap"],[1,"text-body-sm","md:hidden","text-neutral-gray-5","whitespace-nowrap"],[1,"text-body-sm","hidden","md:block","text-neutral-gray-5","whitespace-nowrap"],[1,"flex-1","rounded-md","h-fit","mb-3","md:flex","hidden","bg-white","divide-solid","divide-x","divide-neutral-gray-1"],["mainScroll",""],["class"," flex flex-col flex-1  py-[6px] relative cursor-pointer justify-center items-center bg-white text-gray-6",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"flex","flex-col","flex-1","py-[6px]","relative","cursor-pointer","justify-center","items-center","bg-white","text-gray-6",3,"ngClass","click"],[1,"font-bold","text-body-lg"],[1,"md:hidden",3,"sortDefault","tabDetail","sortChange"],[1,"flex","justify-between","items-center","md:hidden"],[1,"flex","gap-x-3"],["cf-button","","size","medium","type","secondary","class","bg-white flex gap-x-2",3,"disabled","click",4,"ngIf"],[1,"md:hidden",3,"sortDefault","disableSort","sortChange"],["cf-button","","size","medium","type","secondary",1,"bg-white","flex","gap-x-2",3,"disabled","click"],["icon","ticket","size","small",1,"text-heading-xs","text-neutral-black","mr-1.5",3,"ngClass"],["icon","document","size","small",1,"text-heading-xs","text-neutral-black","mr-1.5",3,"ngClass"],["class","flex flex-col gap-y-3","infinite-scroll","",3,"infiniteScrollDistance","infiniteScrollThrottle","infiniteScrollContainer","scrollWindow","fromRoot","alwaysCallback","scrolled",4,"ngIf"],[4,"ngIf","ngIfElse"],["elseLoadingTemp",""],["infinite-scroll","",1,"flex","flex-col","gap-y-3",3,"infiniteScrollDistance","infiniteScrollThrottle","infiniteScrollContainer","scrollWindow","fromRoot","alwaysCallback","scrolled"],[4,"ngFor","ngForOf","ngForTrackBy"],["class","text-heading-md",4,"ngIf"],[3,"ticket","listFareRule","loading","ticketSelected","ticketComboShare","verifyFlight",4,"ngIf"],[3,"ticket","listFareRule","loading","ticketSelected","ticketComboShare","verifyFlight"],[1,"min-w-[676px]","md:min-w-fit","flex","flex-col","gap-y-3"],[1,"text-heading-md"],[3,"ticket","listFareRule","ticketComboShare",4,"ngIf"],[3,"ticket","listFareRule","ticketComboShare"],["class","empty flex items-center mt-20 flex-col",4,"ngIf","ngIfElse"],["elseEmptyTemp",""],[1,"empty","flex","items-center","mt-20","flex-col"],["src","assets/images/empty_result.png","alt","empty",1,"w-[160px]","h-160px","object-contain"],[1,"text-heading-md","mt-[30px]"],[1,"text-body-md","mt-2","text-center"],["cf-button","","color","primary-1","size","medium",1,"w-[200px]","mt-6","justify-center",3,"type","click"],["class","empty flex items-center mt-20 flex-col",4,"ngIf"],[1,"text-body-md","mt-2"],["cf-button","","size","medium",1,"w-[200px]","mt-6","justify-center","bg-white",3,"type","click"],["icon","search","size","small",1,"mr-2"],["elseSearchFlightTemplate",""],["elseSearchResultsTemplate",""],[3,"ticket","listFareRule","mobileSelected","listFareRuleClasses","onReselectClick",4,"ngIf"],[3,"ticket","listFareRule","mobileSelected","listFareRuleClasses","onReselectClick"],[3,"ticket","listFareRule","listFareRuleClasses","ticketSelected",4,"ngIf"],[3,"ticket","listFareRule","listFareRuleClasses","ticketSelected"],["elseSearchFlightAgentTemp",""],["elseSearchResultsAgentTemp",""],[3,"ticket","listFareRule","mobileSelected","listFareRuleClasses","hasAirportInternational","onReselectClick","ticketSelected",4,"ngIf"],[3,"ticket","listFareRule","mobileSelected","listFareRuleClasses","hasAirportInternational","onReselectClick","ticketSelected"],[3,"ticket","listFareRule","listFareRuleClasses","hasAirportInternational","ticketSelected",4,"ngIf"],[3,"ticket","listFareRule","listFareRuleClasses","hasAirportInternational","ticketSelected"],["icon","share","size","small",1,"cursor-pointer",3,"click"],[1,"text-heading-md","text-neutral-black"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div")(5,"cf-flight-type-selector",4),e.NdJ("flightTypeSearchChange",function(n){return i.flightTypeChange(n)}),e.qZA()(),e.TgZ(6,"div",5)(7,"cf-number-of-passenger",6),e.NdJ("numberOfPassengerChange",function(n){return i.numberOfPassengerChange(n)}),e.qZA(),e.TgZ(8,"cf-airline-filter",7),e.NdJ("airlineFilterChange",function(n){return i.airlineFilterChange(n)}),e.qZA(),e._UZ(9,"cf-voucher-selector",8),e.TgZ(10,"cf-cabin-selector",9),e.NdJ("cabinChange",function(n){return i.cabinChange(n)}),e.qZA(),e.TgZ(11,"cf-pax-type-selector",10),e.NdJ("paxTypeChange",function(n){return i.paxTypeChange(n)}),e.qZA()()(),e.TgZ(12,"div",11)(13,"cf-search-flight-input",12,13),e.NdJ("removeRoute",function(n){return i.removeRoute(n)})("dataChange",function(n){return i.onChangeInputSearch(n)})("toggleAirline",function(n){return i.onToggleAirline(n)})("dateTypeChange",function(n){return i.onDateTypeChange(n)})("navigateDatepicker",function(n){return i.onNavigateDatepicker(n)}),e.qZA(),e.YNc(15,ba,4,1,"button",14),e.qZA(),e.YNc(16,Sa,14,1,"div",15),e.qZA(),e.YNc(17,Ea,8,1,"div",16),e.YNc(18,wa,2,2,"div",17),e.qZA(),e.TgZ(19,"div",18)(20,"div",19)(21,"mobile-search-input",20),e.NdJ("onReseachFlight",function(){return i.researchFlight()})("onFlightTypeChange",function(n){return i.flightTypeChange(n)})("onQuotation",function(){return i.onMobileQuotation(i.currentLeg)}),e.qZA()(),e.TgZ(22,"div",21)(23,"div",22),e.YNc(24,Na,1,2,"app-sort-flight",23),e.YNc(25,Za,1,2,"app-sort-flight-combo",24),e.TgZ(26,"filter-flight",25),e.NdJ("ticketFilterChange",function(n){return i.filterChange(n)})("ticketDisplayChange",function(n){return i.displayChange(n)}),e.qZA(),e.YNc(27,Ma,1,2,"app-switch-mode",26),e.TgZ(28,"airline-filter-bottom-sheet",27),e.NdJ("ticketFilterChange",function(n){return i.filterChange(n)}),e.qZA(),e.TgZ(29,"stop-number-filter-bottom-sheet",28),e.NdJ("ticketFilterChange",function(n){return i.filterChange(n)}),e.qZA()()(),e.YNc(30,Ra,2,2,"div",17),e.qZA(),e.YNc(31,Ya,6,1,"div",29),e.TgZ(32,"div",30)(33,"div",31)(34,"filter-flight",32),e.NdJ("ticketFilterChange",function(n){return i.filterChange(n)})("ticketDisplayChange",function(n){return i.displayChange(n)}),e.qZA()(),e.TgZ(35,"div",33),e.YNc(36,qa,8,0,"div",34),e.YNc(37,za,4,2,"ng-container",35),e.YNc(38,Wa,1,2,"app-sort-flight-combo",36),e.TgZ(39,"div",37)(40,"div",38),e.YNc(41,tr,6,6,"div",39),e.TgZ(42,"div",40),e.YNc(43,pr,5,3,"ng-container",35),e.YNc(44,Ar,4,2,"ng-container",35),e.YNc(45,qr,4,2,"ng-container",35),e.qZA()(),e.TgZ(46,"div",41)(47,"div",42)(48,"div",43)(49,"div",44),e._uU(50,"Chuy\u1ebfn bay c\u1ee7a b\u1ea1n"),e.qZA(),e.YNc(51,Gr,1,0,"cf-icon",45),e.qZA(),e.TgZ(52,"div")(53,"ticket-selected",46),e.NdJ("reselect",function(n){return i.reselect(n)})("showDetail",function(n){return i.onShowDetailInfo(n)}),e.qZA()(),e.YNc(54,jr,7,7,"div",47),e.qZA()()()()()()),2&t&&(e.xp6(5),e.Q6J("flightType",i.flightTypeSearch),e.xp6(2),e.Q6J("adultNumber",i._searchInputService.numberOfPassenger.adult)("childNumber",i._searchInputService.numberOfPassenger.child)("infantNumber",i._searchInputService.numberOfPassenger.infant),e.xp6(1),e.Q6J("airlineList",i._searchInputService.airlineFilters),e.xp6(1),e.Q6J("promotionGroupList",i._searchInputService.promotionGroupFilters),e.xp6(1),e.Q6J("cabinList",i._searchInputService.cabinList)("actived",i._searchInputService.hasAirportInternational),e.xp6(1),e.Q6J("paxTypeList",i._searchInputService.paxTypeList)("actived",i._searchInputService.hasAirportInternational),e.xp6(2),e.Q6J("formArray",i._searchInputService.searchInputForm)("minFareOptionConfig",i.minFareOptionConfig),e.xp6(2),e.Q6J("ngIf",i.flightTypeSearch!==i.multiFilghtType),e.xp6(1),e.Q6J("ngIf",i.flightTypeSearch===i.multiFilghtType),e.xp6(1),e.Q6J("ngIf",i.multiDateBar.length&&i.minFareOptionConfig),e.xp6(1),e.Q6J("ngIf",i.isprogress),e.xp6(3),e.Q6J("currentMode",i.currentMode),e.xp6(3),e.Q6J("ngIf","combo"!==i.currentMode),e.xp6(1),e.Q6J("ngIf","combo"===i.currentMode),e.xp6(1),e.Q6J("currentMode",i.currentMode)("airlineList",i.airlineList)("hasAirportInternational",i.hasAirportInternational)("ticketFilter",i.ticketFilterState.value)("ticketDisplay",i.ticketDisplayState.value)("fareclassList",i.fareclassList)("planeModelList",i.planModelList)("selectedFare",i.selectedFare)("departureTimeList",i.departureTimeList)("arrivalTimeList",i.arrivalTimeList)("durationFilter",i.durationFilter)("minDuration",i.minDuration)("maxDuration",i.maxDuration)("departTimeComboList",i.departTimeComboList)("arriveTimeComboList",i.arriveTimeComboList)("minFareClss",i.minFareClss)("priceFilter",i.priceFilter)("minPrice",i.minPrice)("maxPrice",i.maxPrice)("bookingSystemList",i.bookingSystemList)("priceFilter",i.priceFilter),e.xp6(1),e.Q6J("ngIf","combo"!==i.currentMode),e.xp6(1),e.Q6J("airlineList",i.airlineList)("ticketFilter",i.ticketFilterState.value),e.xp6(1),e.Q6J("ticketFilter",i.ticketFilterState.value),e.xp6(1),e.Q6J("ngIf",i.isprogress),e.xp6(1),e.Q6J("ngIf",i.multiDateBar.length&&i.minFareOptionConfig),e.xp6(3),e.Q6J("currentMode",i.currentMode)("airlineList",i.airlineList)("hasAirportInternational",i.hasAirportInternational)("ticketFilter",i.ticketFilterState.value)("ticketDisplay",i.ticketDisplayState.value)("fareclassList",i.fareclassList)("planeModelList",i.planModelList)("departureTimeList",i.departureTimeList)("minFareClss",i.minFareClss)("priceFilter",i.priceFilter)("minPrice",i.minPrice)("maxPrice",i.maxPrice)("leg",i.currentLeg)("departTimeComboList",i.departTimeComboList)("arriveTimeComboList",i.arriveTimeComboList)("priceFilter",i.priceFilter)("durationFilter",i.durationFilter)("minDuration",i.minDuration)("maxDuration",i.maxDuration)("bookingSystemList",i.bookingSystemList)("selectedFare",i.selectedFare)("arrivalTimeList",i.arrivalTimeList),e.xp6(1),e.ekj("!gap-y-4","combo"===i.currentMode),e.xp6(1),e.Q6J("ngIf",i.isShowBambooPromotionError),e.xp6(1),e.Q6J("ngIf",i.tabData.length>1&&"combo"!==i.currentMode),e.xp6(1),e.Q6J("ngIf","combo"===i.currentMode),e.xp6(3),e.Q6J("ngIf","combo"!==i.currentMode),e.xp6(2),e.Q6J("ngIf","combo"===i.currentMode),e.xp6(1),e.Q6J("ngIf","retail"===i.currentMode),e.xp6(1),e.Q6J("ngIf","agency"===i.currentMode),e.xp6(1),e.ekj("!mt-0","combo"===i.currentMode),e.xp6(5),e.Q6J("ngIf",i.showSharedFlight&&i.isShareFlight),e.xp6(2),e.Q6J("ticketsSelected",i.listTicketSelected),e.xp6(1),e.Q6J("ngIf",!i.isHiddenTotalCharge))},dependencies:[J.N8,J.Xq,Me.Q,Me.F,E.qx,I.ez,I.mk,I.sg,I.O5,I.JJ,I.uU,E.ZZ,E.kx,E.Vz,E.AS,x.AxE,x.Sm8,E.bM,E.IA,M.DA,M.z6,M.h4,M.uX,M.t3,B.u5,B.UX,W.Rq,W.Ry,pt.MobileSearchInputComponent,E.m0,E.a7,E.wv,E.wH,E.Fr,M.qB,M.P_,gt.Lk],encapsulation:2}),r})()},3803:(ht,V,y)=>{y.d(V,{h:()=>B});var I=y(94650);let B=(()=>{class J{get ticketSelectedData(){return JSON.parse(sessionStorage.getItem("ticketSelectedData"))}set ticketSelectedData(x){sessionStorage.setItem("ticketSelectedData",JSON.stringify(x))}}return J.\u0275fac=function(x){return new(x||J)},J.\u0275prov=I.Yz7({token:J,factory:J.\u0275fac,providedIn:"root"}),J})()}}]);