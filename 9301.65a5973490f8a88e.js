"use strict";(self.webpackChunkcheapflightclient=self.webpackChunkcheapflightclient||[]).push([[9301],{89301:(Ji,Ze,C)=>{C.r(Ze),C.d(Ze,{BookingDetailPageComponent:()=>ji});var I=C(36895),Ne=C(10908),W=C(83700),Oe=C(87683),B=C(72506),Je=C(44143),Ve=C(4688),He=C(76331),Fe=C(40529),ee=C(82908),D=C(18058),p=C(67534),Z=C(6703),Me=C(99251),te=C(89319),Ye=C(26655),$e=C(44890),Le=C(95911),E=C(88001),f=C(40899),Qe=C(89701),Ge=C(64190),H=C(53820),Ue=C(94333),ie=C(44586),ne=C(52013),e=C(94650);let ze=(()=>{class s{constructor(t){this.actionChange=new e.vpe,t.registerIcons([B.esH,B.UNF])}onActionChange(t){this.actionChange.emit(t)}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(B.KNP))},s.\u0275cmp=e.Xpm({type:s,selectors:[["suggest-register-order"]],outputs:{actionChange:"actionChange"},standalone:!0,features:[e.jDz],decls:33,vars:0,consts:[[1,"w-[288px]","h-auto","fixed","bottom-[30px]","right-[30px]","p-4","rounded","shadow-cf-info-card","bg-neutral-gray-6","text-white","md:hidden"],[1,"flex","gap-x-4","justify-between","items-start"],[1,"flex","justify-between","items-start","gap-x-2"],["icon","search","size","medium"],[1,"flex","flex-col","gap-y-4"],[1,"flex","flex-col","gap-y-1"],[1,"text-express-md"],[1,"text-body-md-short"],["cf-button","","size","medium","type","secondary",1,"!w-fit","bg-neutral-white",3,"click"],["icon","close","size","small",3,"click"],[1,"hidden","md:block","w-full","h-auto","p-4","rounded","shadow-cf-info-card","bg-functional-1-1"],["width","24","height","24","viewBox","0 0 24 24","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12Z","fill","#845D9C"],["d","M12 6.25C12.4142 6.25 12.75 6.58579 12.75 7V7.00999C12.75 7.42421 12.4142 7.75999 12 7.75999C11.5858 7.75999 11.25 7.42421 11.25 7.00999V7C11.25 6.58579 11.5858 6.25 12 6.25Z","fill","white"],["d","M12 9.25003C12.4142 9.25003 12.75 9.58582 12.75 10L12.75 17C12.75 17.4142 12.4142 17.75 12 17.75C11.5858 17.75 11.25 17.4142 11.25 17V10C11.25 9.58582 11.5858 9.25003 12 9.25003Z","fill","white"],["cf-button","","size","medium",1,"!w-fit",3,"click"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div"),e._UZ(4,"cf-icon",3),e.qZA(),e.TgZ(5,"div",4)(6,"div",5)(7,"div",6),e._uU(8,"Canh v\xe9 r\u1ebb \u0111\u1ec3 t\u0103ng l\u1ee3i nhu\u1eadn"),e.qZA(),e.TgZ(9,"div",7),e._uU(10,"T\u1ef1 \u0111\u1ed9ng canh v\xe9 r\u1ebb h\u01a1n \u0111\u1eb7t ch\u1ed7 hi\u1ec7n t\u1ea1i v\xe0 nh\u1eadn c\u1eadp nh\u1eadt khi gi\xe1 t\u0103ng."),e.qZA()(),e.TgZ(11,"button",8),e.NdJ("click",function(){return n.onActionChange("register_order")}),e._uU(12," Canh v\xe9 ngay "),e.qZA()()(),e.TgZ(13,"div")(14,"cf-icon",9),e.NdJ("click",function(){return n.onActionChange("close")}),e.qZA()()()(),e.TgZ(15,"div",10)(16,"div",1)(17,"div",2)(18,"div"),e.O4$(),e.TgZ(19,"svg",11),e._UZ(20,"path",12)(21,"path",13)(22,"path",14),e.qZA()(),e.kcU(),e.TgZ(23,"div",4)(24,"div",5)(25,"div",6),e._uU(26,"Canh v\xe9 r\u1ebb \u0111\u1ec3 t\u0103ng l\u1ee3i nhu\u1eadn"),e.qZA(),e.TgZ(27,"div",7),e._uU(28,"T\u1ef1 \u0111\u1ed9ng canh v\xe9 r\u1ebb h\u01a1n \u0111\u1eb7t ch\u1ed7 hi\u1ec7n t\u1ea1i v\xe0 nh\u1eadn c\u1eadp nh\u1eadt khi gi\xe1 t\u0103ng."),e.qZA()(),e.TgZ(29,"button",15),e.NdJ("click",function(){return n.onActionChange("register_order")}),e._uU(30," Canh v\xe9 ngay "),e.qZA()()(),e.TgZ(31,"div")(32,"cf-icon",9),e.NdJ("click",function(){return n.onActionChange("close")}),e.qZA()()()())},dependencies:[I.ez,B.AxE,B.Sm8,W.N8,W.Xq],encapsulation:2}),s})();var qe=C(50494),S=C(15439),A=C(28746),N=C(17414),we=C(82761),Xe=C(62733),We=C(28490),et=C(97579),tt=C(58273),it=C(62331),nt=C(64425),Re=C(9381),ot=C(70800),at=C(77492),st=C(78533),rt=C(27849),lt=C(9497),ct=C(40105);function dt(s,d){1&s&&(e.TgZ(0,"cf-label",39),e._uU(1," PNR \u0111ang m\u1edf "),e.qZA()),2&s&&e.Q6J("color","green")}function ht(s,d){1&s&&(e.TgZ(0,"cf-label",39),e._uU(1," PNR \u0111\xe3 kh\xf3a "),e.qZA()),2&s&&e.Q6J("color","red")}function ut(s,d){if(1&s&&(e.TgZ(0,"div"),e.YNc(1,dt,2,1,"cf-label",38),e.YNc(2,ht,2,1,"cf-label",38),e.qZA()),2&s){const t=e.oxw(4);e.xp6(1),e.Q6J("ngIf",!t.isLockPnr),e.xp6(1),e.Q6J("ngIf",t.isLockPnr)}}function gt(s,d){if(1&s){const t=e.EpF();e.TgZ(0,"div",40),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(4);return e.KtG(i.onLockPnr())}),e.TgZ(1,"div",41),e._uU(2,"Kh\xf3a PNR"),e.qZA(),e._UZ(3,"cf-switch",42),e.qZA()}if(2&s){const t=e.oxw(4);e.xp6(3),e.Q6J("checked",t.isLockPnr)("color","#E03C31")}}function pt(s,d){if(1&s&&(e.TgZ(0,"div",36),e.YNc(1,ut,3,2,"div",17),e.YNc(2,gt,4,2,"div",37),e.qZA()),2&s){const t=e.oxw(3);e.xp6(1),e.Q6J("ngIf",t.isShowStatusLock),e.xp6(1),e.Q6J("ngIf",t.canLockPnr)}}function mt(s,d){if(1&s&&(e.TgZ(0,"div",33)(1,"div",8)(2,"div",9),e._UZ(3,"div",10),e.TgZ(4,"div",11),e._uU(5,"Th\xf4ng tin h\xe0nh kh\xe1ch"),e.qZA()(),e.YNc(6,pt,3,2,"div",34),e.qZA(),e._UZ(7,"booking-passenger-info",35),e.qZA()),2&s){const t=e.oxw(2);e.xp6(6),e.Q6J("ngIf",!t.isPreviewPnr),e.xp6(1),e.Q6J("passengerInfos",t.passengerInfos)}}function _t(s,d){if(1&s){const t=e.EpF();e.TgZ(0,"button",43),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.onRefreshPnr())}),e.O4$(),e.TgZ(1,"svg",44),e._UZ(2,"path",45),e.qZA(),e._uU(3," L\xe0m m\u1edbi d\u1eef li\u1ec7u "),e.qZA()}}function vt(s,d){1&s&&(e.TgZ(0,"div",46)(1,"span",47),e._uU(2," H\u1ec7 th\u1ed1ng ph\xe1t hi\u1ec7n c\xf3 chuy\u1ebfn bay v\u1edbi t\xecnh tr\u1ea1ng ch\u1ed7 HL (trong danh s\xe1ch ch\u1edd), \u0111\u1ea1i l\xfd l\u01b0u \xfd ch\u1ee7 \u0111\u1ed9ng theo d\xf5i & x\u1eed l\xfd. "),e.qZA()())}const Ke=function(){return["BOOKED","ISSUED"]};function ft(s,d){if(1&s){const t=e.EpF();e.TgZ(0,"booking-detail",48),e.NdJ("actionChange",function(i){const a=e.CHM(t).$implicit,r=e.oxw(2);return e.KtG(r.onActionChange(i,a))}),e.qZA()}if(2&s){const t=d.$implicit,n=e.oxw(2);e.Q6J("isShowMore",!0)("bookingDetail",t)("isBooked",e.DdM(4,Ke).includes(t.status))("hasDiscountFare",n.hasDiscountFare)}}function bt(s,d){if(1&s&&(e.TgZ(0,"tr")(1,"td",56),e._UZ(2,"img",57),e.qZA(),e.TgZ(3,"td",56),e._uU(4),e.qZA(),e.TgZ(5,"td",56),e._uU(6),e.qZA(),e.TgZ(7,"td",56),e._uU(8),e.qZA(),e.TgZ(9,"td",56),e._uU(10),e.qZA(),e.TgZ(11,"td",56),e._uU(12),e.ALo(13,"number"),e.qZA()()),2&s){const t=d.$implicit;e.xp6(2),e.Q6J("src",t.airlineLogo,e.LSH),e.xp6(2),e.Oqu(t.flight),e.xp6(2),e.Oqu(t.departDate),e.xp6(2),e.Oqu(t.passengerName),e.xp6(2),e.Oqu(t.serviceName),e.xp6(2),e.Oqu(e.lcZ(13,6,t.totalCharge))}}function Ct(s,d){if(1&s&&(e.TgZ(0,"div",49)(1,"div",50)(2,"span",51),e._uU(3,"H\xe0nh l\xfd & d\u1ecbch v\u1ee5 b\u1ed5 sung"),e.qZA()(),e.TgZ(4,"div")(5,"table",52)(6,"thead")(7,"tr",53)(8,"th",54),e._uU(9,"H\xe3ng bay"),e.qZA(),e.TgZ(10,"th",54),e._uU(11,"Chuy\u1ebfn bay"),e.qZA(),e.TgZ(12,"th",54),e._uU(13,"Ng\xe0y \u0111i"),e.qZA(),e.TgZ(14,"th",54),e._uU(15,"H\xe0nh kh\xe1ch"),e.qZA(),e.TgZ(16,"th",54),e._uU(17,"T\xean d\u1ecbch v\u1ee5"),e.qZA(),e.TgZ(18,"th",54),e._uU(19,"T\u1ed5ng gi\xe1"),e.qZA()()(),e.TgZ(20,"tbody"),e.YNc(21,bt,14,8,"tr",55),e.qZA()()()()),2&s){const t=e.oxw(2);e.xp6(21),e.Q6J("ngForOf",t.listBaggage)}}function Tt(s,d){if(1&s&&(e.TgZ(0,"tr")(1,"td",56),e._UZ(2,"img",57),e.qZA(),e.TgZ(3,"td",56),e._uU(4),e.qZA(),e.TgZ(5,"td",56),e._uU(6),e.qZA(),e.TgZ(7,"td",56),e._uU(8),e.qZA(),e.TgZ(9,"td",56),e._uU(10),e.qZA(),e.TgZ(11,"td",59),e._uU(12),e.ALo(13,"number"),e.qZA()()),2&s){const t=d.$implicit;e.xp6(2),e.Q6J("src",t.airlineLogo,e.LSH),e.xp6(2),e.Oqu(t.flight),e.xp6(2),e.Oqu(t.departDate),e.xp6(2),e.Oqu(t.passengerName),e.xp6(2),e.Oqu(t.serviceName),e.xp6(2),e.Oqu(e.lcZ(13,6,t.totalCharge))}}function kt(s,d){if(1&s&&(e.TgZ(0,"div",49)(1,"div",50)(2,"span",51),e._uU(3,"D\u1ecbch v\u1ee5"),e.qZA()(),e.TgZ(4,"div")(5,"table",52)(6,"thead")(7,"tr",53)(8,"th",54),e._uU(9,"H\xe3ng bay"),e.qZA(),e.TgZ(10,"th",54),e._uU(11,"Chuy\u1ebfn bay"),e.qZA(),e.TgZ(12,"th",54),e._uU(13,"Ng\xe0y \u0111i"),e.qZA(),e.TgZ(14,"th",54),e._uU(15,"H\xe0nh kh\xe1ch"),e.qZA(),e.TgZ(16,"th",54),e._uU(17,"T\xean d\u1ecbch v\u1ee5"),e.qZA(),e.TgZ(18,"th",58),e._uU(19,"T\u1ed5ng gi\xe1"),e.qZA()()(),e.TgZ(20,"tbody"),e.YNc(21,Tt,14,8,"tr",55),e.qZA()()()()),2&s){const t=e.oxw(2);e.xp6(21),e.Q6J("ngForOf",t.listService)}}function xt(s,d){if(1&s&&(e.TgZ(0,"tr")(1,"td",56),e._uU(2),e.qZA(),e.TgZ(3,"td",56),e._uU(4),e.qZA(),e.TgZ(5,"td",59),e._uU(6),e.ALo(7,"number"),e.qZA()()),2&s){const t=d.$implicit;e.xp6(2),e.Oqu(t.chargeTypeName),e.xp6(2),e.Oqu(t.description),e.xp6(2),e.Oqu(e.lcZ(7,3,t.totalCharge))}}function yt(s,d){if(1&s&&(e.TgZ(0,"div",49)(1,"div",50)(2,"span",51),e._uU(3,"D\u1ecbch v\u1ee5 kh\xe1c"),e.qZA()(),e.TgZ(4,"div")(5,"table",52)(6,"thead")(7,"tr",53)(8,"th",54),e._uU(9,"Lo\u1ea1i ph\xed"),e.qZA(),e.TgZ(10,"th",54),e._uU(11,"M\xf4 t\u1ea3"),e.qZA(),e.TgZ(12,"th",58),e._uU(13,"S\u1ed1 ti\u1ec1n"),e.qZA()()(),e.TgZ(14,"tbody"),e.YNc(15,xt,8,5,"tr",55),e.qZA()()()()),2&s){const t=e.oxw(2);e.xp6(15),e.Q6J("ngForOf",t.listOtherCharge)}}function Dt(s,d){if(1&s&&(e.TgZ(0,"tr")(1,"td",56)(2,"div",60),e._UZ(3,"img",61),e.TgZ(4,"div"),e._uU(5),e.qZA()()(),e.TgZ(6,"td",56),e._uU(7),e.qZA(),e.TgZ(8,"td",56),e._uU(9),e.qZA(),e.TgZ(10,"td",56),e._uU(11),e.qZA()()),2&s){const t=d.$implicit,n=e.oxw(3);e.xp6(3),e.Q6J("src",t.airlineLogo,e.LSH),e.xp6(2),e.AsE("",t.startPoint," - ",t.endPoint,""),e.xp6(2),e.hij(" ",n.hasAdtPax?t.fareClass+" - "+t.fareBasis:"-"," "),e.xp6(2),e.hij(" ",n.hasChdPax?t.fareClass+" - "+t.fareBasis:"-"," "),e.xp6(2),e.hij(" ",n.hasInfPax?t.fareClass+" - "+t.fareBasis:"-"," ")}}function Bt(s,d){if(1&s&&(e.TgZ(0,"div",49)(1,"div",50)(2,"span",51),e._uU(3,"H\u1ea1ng ch\u1ed7 - Fare Basis"),e.qZA()(),e.TgZ(4,"div")(5,"table",52)(6,"thead")(7,"tr",53)(8,"th",54),e._uU(9,"Ch\u1eb7ng bay"),e.qZA(),e.TgZ(10,"th",54),e._uU(11,"Ng\u01b0\u1eddi l\u1edbn (ADT)"),e.qZA(),e.TgZ(12,"th",54),e._uU(13,"Tr\u1ebb em (CHD)"),e.qZA(),e.TgZ(14,"th",54),e._uU(15,"Em b\xe9 (INF)"),e.qZA()()(),e.TgZ(16,"tbody"),e.YNc(17,Dt,12,6,"tr",55),e.qZA()()()()),2&s){const t=e.oxw(2);e.xp6(17),e.Q6J("ngForOf",t.fareBasisInfos)}}function Et(s,d){1&s&&e._UZ(0,"th",54)}function At(s,d){if(1&s&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&s){const t=e.oxw().$implicit;e.xp6(1),e.hij("(",t.status,")")}}function It(s,d){if(1&s){const t=e.EpF();e.TgZ(0,"td",56)(1,"a",65),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit,o=e.oxw(3);return e.KtG(o.onShowTicketInfo(i))}),e._uU(2," Xem chi ti\u1ebft "),e.qZA()()}}function St(s,d){if(1&s&&(e.TgZ(0,"tr")(1,"td",56)(2,"div",63),e._uU(3),e.YNc(4,At,2,1,"span",17),e.qZA()(),e.TgZ(5,"td",56),e._uU(6),e.qZA(),e.TgZ(7,"td",56),e._uU(8),e.qZA(),e.TgZ(9,"td",56),e._uU(10),e.qZA(),e.TgZ(11,"td",56),e._uU(12),e.qZA(),e.YNc(13,It,3,0,"td",64),e.qZA()),2&s){const t=d.$implicit;e.xp6(3),e.hij(" ",t.ticketNumber," "),e.xp6(1),e.Q6J("ngIf","VOID"===t.status),e.xp6(2),e.Oqu(t.journeyName),e.xp6(2),e.Oqu(t.bookingCode),e.xp6(2),e.Oqu(t.passengerName),e.xp6(2),e.Oqu(t.airline),e.xp6(1),e.Q6J("ngIf",t.isDetail)}}function Pt(s,d){if(1&s&&(e.TgZ(0,"div",49)(1,"div",50)(2,"span",51),e._uU(3,"S\u1ed1 v\xe9"),e.qZA()(),e.TgZ(4,"div")(5,"table",52)(6,"thead")(7,"tr",53)(8,"th",54),e._uU(9,"S\u1ed1 v\xe9"),e.qZA(),e.TgZ(10,"th",54),e._uU(11,"H\xe0nh tr\xecnh"),e.qZA(),e.TgZ(12,"th",54),e._uU(13,"M\xe3 \u0111\u1eb7t ch\u1ed7"),e.qZA(),e.TgZ(14,"th",54),e._uU(15,"H\xe0nh kh\xe1ch"),e.qZA(),e.TgZ(16,"th",54),e._uU(17,"H\xe3ng"),e.qZA(),e.YNc(18,Et,1,0,"th",62),e.qZA()(),e.TgZ(19,"tbody"),e.YNc(20,St,14,7,"tr",55),e.qZA()()()()),2&s){const t=e.oxw(2);e.xp6(18),e.Q6J("ngIf","QH"!==t.listTicketInfo[0].airline),e.xp6(2),e.Q6J("ngForOf",t.listTicketInfo)}}function Zt(s,d){if(1&s){const t=e.EpF();e.TgZ(0,"div")(1,"button",43),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(3);return e.KtG(i.getFareRule())}),e._uU(2," \u0110i\u1ec1u ki\u1ec7n gi\xe1 v\xe9 "),e.qZA()()}}function Nt(s,d){if(1&s&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"replace"),e.ALo(3,"number"),e.qZA()),2&s){const t=e.oxw(3);e.xp6(1),e.hij(" ",e.Dn7(2,1,e.lcZ(3,5,t.totalDiscountFareCharge),",",".")," \u0111 ")}}function Ot(s,d){if(1&s&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"replace"),e.ALo(3,"number"),e.qZA()),2&s){const t=e.oxw(3);e.xp6(1),e.hij("",e.Dn7(2,1,e.lcZ(3,5,t.totalPrice),",",".")||"N/A"," \u0111")}}function Ft(s,d){if(1&s){const t=e.EpF();e.TgZ(0,"div",71)(1,"div",77),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(3);return e.KtG(i.onShowIdentityReservation())}),e.TgZ(2,"div"),e._uU(3,"B\u1ea3o l\u01b0u \u0111\u1ecbnh danh"),e.qZA(),e._UZ(4,"cf-icon",78),e.qZA(),e.TgZ(5,"div",79),e._uU(6),e.ALo(7,"replace"),e.ALo(8,"number"),e.qZA()()}if(2&s){const t=e.oxw(3);e.xp6(6),e.hij("",e.Dn7(7,1,e.lcZ(8,5,t.creditShellTotal),",",".")," \u0111")}}function Mt(s,d){if(1&s&&(e.TgZ(0,"div")(1,"div",66)(2,"div",67),e._UZ(3,"div",10),e.TgZ(4,"div",11),e._uU(5,"T\u1ed5ng chi ph\xed h\xe0nh tr\xecnh"),e.qZA()(),e.YNc(6,Zt,3,0,"div",17),e.qZA(),e.TgZ(7,"div",68),e._UZ(8,"price-detail",69),e.TgZ(9,"div",70)(10,"div",71)(11,"div",72),e._uU(12,"T\u1ed5ng chi ph\xed"),e.qZA(),e.TgZ(13,"div",73),e.YNc(14,Nt,4,7,"span",74),e.YNc(15,Ot,4,7,"ng-template",null,75,e.W1O),e.qZA()(),e.YNc(17,Ft,9,7,"div",76),e.qZA()()()),2&s){const t=e.MAs(16),n=e.oxw(2);e.xp6(6),e.Q6J("ngIf",n.hasInternationalFlight),e.xp6(2),e.Q6J("priceDetail",n.priceDetail)("hasDiscountFare",n.hasDiscountFare),e.xp6(6),e.Q6J("ngIf",n.totalDiscountFareCharge&&n.hasDiscountFare)("ngIfElse",t),e.xp6(3),e.Q6J("ngIf",0!==n.creditShellTotal)}}function Lt(s,d){1&s&&(e.TgZ(0,"div",80),e._UZ(1,"cf-icon",81),e.TgZ(2,"div")(3,"div",82),e._uU(4,"L\u01b0u \xfd:"),e.qZA(),e.TgZ(5,"ul",83)(6,"li",84),e._uU(7," Gi\xe1 v\xe9 c\xf3 th\u1ec3 thay \u0111\u1ed5i t\xf9y theo th\u1eddi \u0111i\u1ec3m \u0111\u1eb7t v\xe9, t\u1ef7 gi\xe1 v\xe0 ch\xednh s\xe1ch c\u1ee7a h\xe3ng h\xe0ng kh\xf4ng. \u0110\u1ea1i l\xfd ch\xfa \xfd ki\u1ec3m tra l\u1ea1i gi\xe1 v\xe9 m\u1edbi nh\u1ea5t t\u1ea1i b\u01b0\u1edbc Xu\u1ea5t v\xe9"),e.qZA(),e.TgZ(8,"li",84),e._uU(9,"H\xe0nh tr\xecnh kh\u1edfi h\xe0nh ngo\xe0i Vi\u1ec7t Nam ch\u1ec9 \u0111\u01b0\u1ee3c b\u1ea3o \u0111\u1ea3m gi\xe1 t\u1ea1i th\u1eddi \u0111i\u1ec3m \u0111\u1eb7t v\xe9 "),e.qZA()()()())}function Ut(s,d){if(1&s){const t=e.EpF();e.TgZ(0,"div")(1,"div",67),e._UZ(2,"div",10),e.TgZ(3,"div",11),e._uU(4,"Canh v\xe9 r\u1ebb"),e.qZA()(),e.TgZ(5,"div",85)(6,"table",52)(7,"thead")(8,"tr",53)(9,"th",86),e._uU(10,"Ng\u01b0\u1eddi th\u1ef1c hi\u1ec7n"),e.qZA(),e.TgZ(11,"th",86),e._uU(12,"Ng\xe0y y\xeau c\u1ea7u"),e.qZA(),e.TgZ(13,"th",86),e._uU(14,"PNR m\u1edbi"),e.qZA(),e.TgZ(15,"th",86),e._uU(16,"Tr\u1ea1ng th\xe1i"),e.qZA(),e._UZ(17,"th"),e.qZA()(),e.TgZ(18,"tbody")(19,"tr")(20,"td",87),e._uU(21),e.qZA(),e.TgZ(22,"td",87),e._uU(23),e.qZA(),e.TgZ(24,"td",88)(25,"a",89),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.gotoBookingDetail(i.monitorOrderInfo.airline,i.monitorOrderInfo.pnr))}),e._uU(26),e.qZA()(),e.TgZ(27,"td",88)(28,"label",90),e._uU(29),e.qZA()(),e.TgZ(30,"td",88)(31,"a",89),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.onOrderDetail(i.monitorOrderInfo.orderId))}),e._uU(32,"Chi ti\u1ebft"),e.qZA()()()()()()()}if(2&s){const t=e.oxw(2);e.xp6(21),e.Oqu(t.monitorOrderInfo.userAction),e.xp6(2),e.Oqu(t.monitorOrderInfo.timeCreate),e.xp6(3),e.Oqu(t.monitorOrderInfo.pnr||"-"),e.xp6(2),e.Tol(t.monitorOrderInfo.stateLabel.style),e.xp6(1),e.Oqu(null==t.monitorOrderInfo.stateLabel?null:t.monitorOrderInfo.stateLabel.name)}}function qt(s,d){if(1&s){const t=e.EpF();e.TgZ(0,"div",24,91),e.NdJ("click",function(){e.CHM(t);const i=e.MAs(1),o=e.oxw(2);return e.KtG(o.mobileTabChange("TOTAL_PRICE",i))}),e._uU(2," T\u1ed5ng chi ph\xed "),e.qZA()}if(2&s){const t=e.oxw(2);e.ekj("text-secondary-3-4","TOTAL_PRICE"===t.mobileTabMode)("!border-secondary-3-4","TOTAL_PRICE"===t.mobileTabMode)("bg-secondary-3-1","TOTAL_PRICE"===t.mobileTabMode)}}function wt(s,d){if(1&s){const t=e.EpF();e.TgZ(0,"div",24,92),e.NdJ("click",function(){e.CHM(t);const i=e.MAs(1),o=e.oxw(2);return e.KtG(o.mobileTabChange("CREDIT_SHELL",i))}),e._uU(2," B\u1ea3o l\u01b0u \u0111\u1ecbnh danh "),e.qZA()}if(2&s){const t=e.oxw(2);e.ekj("text-secondary-3-4","CREDIT_SHELL"===t.mobileTabMode)("!border-secondary-3-4","CREDIT_SHELL"===t.mobileTabMode)("bg-secondary-3-1","CREDIT_SHELL"===t.mobileTabMode)}}function Rt(s,d){if(1&s){const t=e.EpF();e.TgZ(0,"div",24,93),e.NdJ("click",function(){e.CHM(t);const i=e.MAs(1),o=e.oxw(2);return e.KtG(o.mobileTabChange("FARE_RULE",i))}),e._uU(2," \u0110i\u1ec1u ki\u1ec7n gi\xe1 v\xe9 "),e.qZA()}if(2&s){const t=e.oxw(2);e.ekj("text-secondary-3-4","FARE_RULE"===t.mobileTabMode)("!border-secondary-3-4","FARE_RULE"===t.mobileTabMode)("bg-secondary-3-1","FARE_RULE"===t.mobileTabMode)}}function Kt(s,d){if(1&s){const t=e.EpF();e.TgZ(0,"div",24,94),e.NdJ("click",function(){e.CHM(t);const i=e.MAs(1),o=e.oxw(2);return e.KtG(o.mobileTabChange("TICKET_FACE",i))}),e._uU(2," M\u1eb7t v\xe9 "),e.qZA()}if(2&s){const t=e.oxw(2);e.ekj("text-secondary-3-4","TICKET_FACE"===t.mobileTabMode)("!border-secondary-3-4","TICKET_FACE"===t.mobileTabMode)("bg-secondary-3-1","TICKET_FACE"===t.mobileTabMode)}}function jt(s,d){if(1&s){const t=e.EpF();e.TgZ(0,"div",24,95),e.NdJ("click",function(){e.CHM(t);const i=e.MAs(1),o=e.oxw(2);return e.KtG(o.mobileTabChange("TICKET_NUMBER",i))}),e._uU(2," S\u1ed1 v\xe9 "),e.qZA()}if(2&s){const t=e.oxw(2);e.ekj("text-secondary-3-4","TICKET_NUMBER"===t.mobileTabMode)("!border-secondary-3-4","TICKET_NUMBER"===t.mobileTabMode)("bg-secondary-3-1","TICKET_NUMBER"===t.mobileTabMode)}}function Jt(s,d){if(1&s){const t=e.EpF();e.TgZ(0,"div",24,96),e.NdJ("click",function(){e.CHM(t);const i=e.MAs(1),o=e.oxw(2);return e.KtG(o.mobileTabChange("REMARK",i))}),e._uU(2," Remark "),e.qZA()}if(2&s){const t=e.oxw(2);e.ekj("text-secondary-3-4","REMARK"===t.mobileTabMode)("!border-secondary-3-4","REMARK"===t.mobileTabMode)("bg-secondary-3-1","REMARK"===t.mobileTabMode)}}function Vt(s,d){if(1&s){const t=e.EpF();e.TgZ(0,"div",24,97),e.NdJ("click",function(){e.CHM(t);const i=e.MAs(1),o=e.oxw(2);return e.KtG(o.mobileTabChange("LOWFARE",i))}),e._uU(2," Canh v\xe9 r\u1ebb "),e.qZA()}if(2&s){const t=e.oxw(2);e.ekj("text-secondary-3-4","LOWFARE"===t.mobileTabMode)("!border-secondary-3-4","LOWFARE"===t.mobileTabMode)("bg-secondary-3-1","LOWFARE"===t.mobileTabMode)}}function Ht(s,d){if(1&s){const t=e.EpF();e.TgZ(0,"div",24,98),e.NdJ("click",function(){e.CHM(t);const i=e.MAs(1),o=e.oxw(2);return e.KtG(o.mobileTabChange("HISTORY",i))}),e._uU(2," L\u1ecbch s\u1eed "),e.qZA()}if(2&s){const t=e.oxw(2);e.ekj("text-secondary-3-4","HISTORY"===t.mobileTabMode)("!border-secondary-3-4","HISTORY"===t.mobileTabMode)("bg-secondary-3-1","HISTORY"===t.mobileTabMode)}}function Yt(s,d){if(1&s){const t=e.EpF();e.TgZ(0,"suggest-register-order",99),e.NdJ("actionChange",function(i){e.CHM(t);const o=e.oxw(2);return e.KtG(o.onChangeSuggest(i))}),e.qZA()}}function $t(s,d){if(1&s){const t=e.EpF();e.TgZ(0,"div",104)(1,"button",43),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(3);return e.KtG(i.onRefreshPnr())}),e.O4$(),e.TgZ(2,"svg",44),e._UZ(3,"path",45),e.qZA(),e._uU(4," L\xe0m m\u1edbi d\u1eef li\u1ec7u "),e.qZA()()}}function Qt(s,d){1&s&&(e.TgZ(0,"cf-label",39),e._uU(1," PNR \u0111ang m\u1edf "),e.qZA()),2&s&&e.Q6J("color","green")}function Gt(s,d){1&s&&(e.TgZ(0,"cf-label",39),e._uU(1," PNR \u0111\xe3 kh\xf3a "),e.qZA()),2&s&&e.Q6J("color","red")}function zt(s,d){if(1&s&&(e.TgZ(0,"div"),e.YNc(1,Qt,2,1,"cf-label",38),e.YNc(2,Gt,2,1,"cf-label",38),e.qZA()),2&s){const t=e.oxw(4);e.xp6(1),e.Q6J("ngIf",!t.isLockPnr),e.xp6(1),e.Q6J("ngIf",t.isLockPnr)}}function Xt(s,d){if(1&s){const t=e.EpF();e.TgZ(0,"div",40),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(4);return e.KtG(i.onLockPnr())}),e.TgZ(1,"div",41),e._uU(2,"Kh\xf3a PNR"),e.qZA(),e._UZ(3,"cf-switch",42),e.qZA()}if(2&s){const t=e.oxw(4);e.xp6(3),e.Q6J("checked",t.isLockPnr)("color","#E03C31")}}function Wt(s,d){if(1&s&&(e.TgZ(0,"div",36),e.YNc(1,zt,3,2,"div",17),e.YNc(2,Xt,4,2,"div",37),e.qZA()),2&s){const t=e.oxw(3);e.xp6(1),e.Q6J("ngIf",t.isShowStatusLock),e.xp6(1),e.Q6J("ngIf",t.canLockPnr)}}function ei(s,d){if(1&s){const t=e.EpF();e.TgZ(0,"booking-detail-mobile",105),e.NdJ("onDetailClick",function(){const o=e.CHM(t).$implicit,a=e.oxw(3);return e.KtG(a.mobileDetailClick(o))})("actionChange",function(i){const a=e.CHM(t).$implicit,r=e.oxw(3);return e.KtG(r.onActionChange(i,a))}),e.qZA()}2&s&&e.Q6J("bookingDetail",d.$implicit)}function ti(s,d){1&s&&(e.TgZ(0,"div",110),e._uU(1,"H\xe0nh l\xfd & d\u1ecbch v\u1ee5 b\u1ed5 sung"),e.qZA())}function ii(s,d){if(1&s&&(e.TgZ(0,"div",111)(1,"div",112)(2,"div",113),e._uU(3,"H\xe3ng bay"),e.qZA(),e.TgZ(4,"div",114),e._uU(5),e.qZA()(),e.TgZ(6,"div",112)(7,"div",113),e._uU(8,"H\xe0nh kh\xe1ch"),e.qZA(),e.TgZ(9,"div",114),e._uU(10),e.qZA()(),e.TgZ(11,"div",112)(12,"div",113),e._uU(13,"Chuy\u1ebfn bay"),e.qZA(),e.TgZ(14,"div",114),e._uU(15),e.qZA()(),e.TgZ(16,"div",112)(17,"div",113),e._uU(18,"Ng\xe0y \u0111i"),e.qZA(),e.TgZ(19,"div",114),e._uU(20),e.qZA()(),e.TgZ(21,"div",112)(22,"div",113),e._uU(23,"T\xean d\u1ecbch v\u1ee5"),e.qZA(),e.TgZ(24,"div",114),e._uU(25),e.qZA()(),e.TgZ(26,"div",112)(27,"div",113),e._uU(28,"T\u1ed5ng gi\xe1"),e.qZA(),e.TgZ(29,"div",114),e._uU(30),e.ALo(31,"replace"),e.ALo(32,"number"),e.qZA()()()),2&s){const t=d.$implicit;e.xp6(5),e.Oqu(t.airlineName),e.xp6(5),e.Oqu(t.passengerName),e.xp6(5),e.Oqu(t.flight),e.xp6(5),e.Oqu(t.departDate),e.xp6(5),e.Oqu(t.serviceName),e.xp6(5),e.hij("",e.Dn7(31,6,e.lcZ(32,10,t.totalCharge),",","."),"\u0111")}}function ni(s,d){if(1&s&&(e.TgZ(0,"div",106)(1,"cf-collapse",106)(2,"cf-collapse-panel",107),e.YNc(3,ti,2,0,"ng-template",null,108,e.W1O),e.YNc(5,ii,33,12,"div",109),e.qZA()()()),2&s){const t=e.MAs(4),n=e.oxw(3);e.xp6(2),e.Q6J("title",t)("active",!1)("contentClass","!p-0 bg-transparent")("panelClass","!p-3 bg-neutral-white rounded-lg"),e.xp6(3),e.Q6J("ngForOf",n.listBaggage)}}function oi(s,d){1&s&&(e.TgZ(0,"div",110),e._uU(1,"D\u1ecbch v\u1ee5"),e.qZA())}function ai(s,d){if(1&s&&(e.TgZ(0,"div",111)(1,"div",112)(2,"div",113),e._uU(3,"H\xe3ng bay"),e.qZA(),e.TgZ(4,"div",114),e._uU(5),e.qZA()(),e.TgZ(6,"div",112)(7,"div",113),e._uU(8,"H\xe0nh kh\xe1ch"),e.qZA(),e.TgZ(9,"div",114),e._uU(10),e.qZA()(),e.TgZ(11,"div",112)(12,"div",113),e._uU(13,"Chuy\u1ebfn bay"),e.qZA(),e.TgZ(14,"div",114),e._uU(15),e.qZA()(),e.TgZ(16,"div",112)(17,"div",113),e._uU(18,"Ng\xe0y \u0111i"),e.qZA(),e.TgZ(19,"div",114),e._uU(20),e.qZA()(),e.TgZ(21,"div",112)(22,"div",113),e._uU(23,"T\xean d\u1ecbch v\u1ee5"),e.qZA(),e.TgZ(24,"div",114),e._uU(25),e.qZA()(),e.TgZ(26,"div",112)(27,"div",113),e._uU(28,"T\u1ed5ng gi\xe1"),e.qZA(),e.TgZ(29,"div",114),e._uU(30),e.ALo(31,"replace"),e.ALo(32,"number"),e.qZA()()()),2&s){const t=d.$implicit;e.xp6(5),e.Oqu(t.airlineName),e.xp6(5),e.Oqu(t.passengerName),e.xp6(5),e.Oqu(t.flight),e.xp6(5),e.Oqu(t.departDate),e.xp6(5),e.Oqu(t.serviceName),e.xp6(5),e.hij("",e.Dn7(31,6,e.lcZ(32,10,t.totalCharge),",","."),"\u0111")}}function si(s,d){if(1&s&&(e.TgZ(0,"div",106)(1,"cf-collapse",106)(2,"cf-collapse-panel",107),e.YNc(3,oi,2,0,"ng-template",null,108,e.W1O),e.YNc(5,ai,33,12,"div",109),e.qZA()()()),2&s){const t=e.MAs(4),n=e.oxw(3);e.xp6(2),e.Q6J("title",t)("active",!1)("contentClass","!p-0 bg-transparent")("panelClass","!p-3 bg-neutral-white rounded-lg"),e.xp6(3),e.Q6J("ngForOf",n.listService)}}function ri(s,d){1&s&&(e.TgZ(0,"div",110),e._uU(1,"Canh v\xe9 r\u1ebb"),e.qZA())}function li(s,d){if(1&s){const t=e.EpF();e.TgZ(0,"div",106)(1,"cf-collapse",106)(2,"cf-collapse-panel",107),e.YNc(3,ri,2,0,"ng-template",null,108,e.W1O),e.TgZ(5,"div",111)(6,"div",112)(7,"div",113),e._uU(8,"Ng\u01b0\u1eddi th\u1ef1c hi\u1ec7n"),e.qZA(),e.TgZ(9,"div",114),e._uU(10),e.qZA()(),e.TgZ(11,"div",112)(12,"div",113),e._uU(13,"Ng\xe0y y\xeau c\u1ea7u"),e.qZA(),e.TgZ(14,"div",114),e._uU(15),e.qZA()(),e.TgZ(16,"div",112)(17,"div",113),e._uU(18,"PNR m\u1edbi"),e.qZA(),e.TgZ(19,"a",89),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(3);return e.KtG(i.gotoBookingDetail(i.monitorOrderInfo.airline,i.monitorOrderInfo.pnr))}),e._uU(20),e.qZA()(),e.TgZ(21,"div",112)(22,"div",113),e._uU(23,"Tr\u1ea1ng th\xe1i"),e.qZA(),e.TgZ(24,"label",90),e._uU(25),e.qZA()(),e.TgZ(26,"div",115),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(3);return e.KtG(i.onOrderDetail(i.monitorOrderInfo.orderId))}),e.TgZ(27,"span"),e._uU(28,"Chi ti\u1ebft"),e.qZA()()()()()()}if(2&s){const t=e.MAs(4),n=e.oxw(3);e.xp6(2),e.Q6J("title",t)("active",!1)("contentClass","!p-0 bg-transparent")("panelClass","!p-3 bg-neutral-white rounded-lg"),e.xp6(8),e.Oqu(n.monitorOrderInfo.userAction),e.xp6(5),e.Oqu(n.monitorOrderInfo.timeCreate),e.xp6(5),e.Oqu(n.monitorOrderInfo.pnr||"-"),e.xp6(4),e.Tol(n.monitorOrderInfo.stateLabel.style),e.xp6(1),e.Oqu(null==n.monitorOrderInfo.stateLabel?null:n.monitorOrderInfo.stateLabel.name)}}function ci(s,d){if(1&s&&(e.TgZ(0,"div",100)(1,"div",66),e.YNc(2,$t,5,0,"div",101),e.YNc(3,Wt,3,2,"div",34),e.qZA(),e.YNc(4,ei,1,1,"booking-detail-mobile",102),e.YNc(5,ni,6,5,"div",103),e.YNc(6,si,6,5,"div",103),e.YNc(7,li,29,10,"div",103),e.qZA()),2&s){const t=e.oxw(2);e.xp6(2),e.Q6J("ngIf",t.isRefreshPnr&&t.has1AProvider),e.xp6(1),e.Q6J("ngIf",!t.isPreviewPnr),e.xp6(1),e.Q6J("ngForOf",t.bookingDetails),e.xp6(1),e.Q6J("ngIf",t.hasBaggageSelected),e.xp6(1),e.Q6J("ngIf",t.hasSeatSelected),e.xp6(1),e.Q6J("ngIf",t.isMonitorOrderInfo)}}function di(s,d){if(1&s&&(e.TgZ(0,"div",117)(1,"div",112)(2,"div",113),e._uU(3,"H\xe0nh kh\xe1ch"),e.qZA(),e.TgZ(4,"div",114),e._uU(5),e.qZA()(),e.TgZ(6,"div",112)(7,"div",113),e._uU(8,"Lo\u1ea1i h\xe0nh kh\xe1ch"),e.qZA(),e.TgZ(9,"div",114),e._uU(10),e.qZA()(),e.TgZ(11,"div",112)(12,"div",113),e._uU(13,"Ng\xe0y sinh"),e.qZA(),e.TgZ(14,"div",114),e._uU(15),e.qZA()(),e.TgZ(16,"div",112)(17,"div",113),e._uU(18,"Gi\u1edbi t\xednh"),e.qZA(),e.TgZ(19,"div",114),e._uU(20),e.qZA()(),e.TgZ(21,"div",112)(22,"div",113),e._uU(23,"Th\u1ebb B\xf4ng Sen V\xe0ng"),e.qZA(),e.TgZ(24,"div",114),e._uU(25),e.qZA()()()),2&s){const t=d.$implicit;e.xp6(5),e.Oqu((null==t?null:t.name)||"N/A"),e.xp6(5),e.Oqu((null==t?null:t.type)||"N/A"),e.xp6(5),e.Oqu((null==t?null:t.birthday)||"N/A"),e.xp6(5),e.Oqu((null==t?null:t.sex)||"N/A"),e.xp6(5),e.Oqu((null==t?null:t.membershipNumber)||"N/A")}}function hi(s,d){if(1&s&&(e.TgZ(0,"div",100)(1,"div",110),e._uU(2,"Th\xf4ng tin kh\xe1ch h\xe0ng"),e.qZA(),e.YNc(3,di,26,5,"div",116),e.TgZ(4,"div",110),e._uU(5,"Th\xf4ng tin li\xean h\u1ec7"),e.qZA(),e.TgZ(6,"div",117)(7,"div",112)(8,"div",113),e._uU(9,"M\xe3 v\xf9ng"),e.qZA(),e.TgZ(10,"div",114),e._uU(11,"+84"),e.qZA()(),e.TgZ(12,"div",112)(13,"div",113),e._uU(14,"S\u1ed1 \u0111i\u1ec7n tho\u1ea1i"),e.qZA(),e.TgZ(15,"div",114),e._uU(16),e.qZA()(),e.TgZ(17,"div",112)(18,"div",113),e._uU(19,"Email"),e.qZA(),e.TgZ(20,"div",114),e._uU(21),e.qZA()()()()),2&s){const t=e.oxw(2);e.xp6(3),e.Q6J("ngForOf",t.passengerInfos),e.xp6(13),e.Oqu((null==t.bookingContact?null:t.bookingContact.phone)||"N/A"),e.xp6(5),e.Oqu((null==t.bookingContact?null:t.bookingContact.email)||"N/A")}}function ui(s,d){if(1&s&&(e.TgZ(0,"div",112)(1,"div",113),e._uU(2,"Chi\u1ebft kh\u1ea5u"),e.qZA(),e.TgZ(3,"div",119),e._uU(4),e.ALo(5,"replace"),e.ALo(6,"number"),e.qZA()()),2&s){const t=e.oxw().$implicit;e.xp6(4),e.hij(" ",e.Dn7(5,1,e.lcZ(6,5,t.discountAmount),",","."),"\u0111 ")}}function gi(s,d){if(1&s&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"replace"),e.ALo(3,"number"),e.qZA()),2&s){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",e.Dn7(2,1,e.lcZ(3,5,t.totalDiscountFarePrice),",",".")," ")}}function pi(s,d){if(1&s&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"replace"),e.ALo(3,"number"),e.qZA()),2&s){const t=e.oxw().$implicit;e.xp6(1),e.Oqu(e.Dn7(2,1,e.lcZ(3,5,t.total),",",".")||"N/A")}}function mi(s,d){if(1&s&&(e.TgZ(0,"div",117)(1,"div",112)(2,"div",113),e._uU(3,"H\xe0nh kh\xe1ch"),e.qZA(),e.TgZ(4,"div",114),e._uU(5),e.qZA()(),e.TgZ(6,"div",112)(7,"div",113),e._uU(8,"Lo\u1ea1i kh\xe1ch"),e.qZA(),e.TgZ(9,"div",114),e._uU(10),e.qZA()(),e.TgZ(11,"div",112)(12,"div",113),e._uU(13,"Gi\xe1 v\xe9"),e.qZA(),e.TgZ(14,"div",114),e._uU(15),e.ALo(16,"replace"),e.ALo(17,"number"),e.qZA()(),e.TgZ(18,"div",112)(19,"div",113),e._uU(20,"Thu\u1ebf ph\xed"),e.qZA(),e.TgZ(21,"div",114),e._uU(22),e.ALo(23,"replace"),e.ALo(24,"number"),e.qZA()(),e.YNc(25,ui,7,7,"div",118),e.TgZ(26,"div",112)(27,"div",113),e._uU(28,"T\u1ed5ng gi\xe1"),e.qZA(),e.TgZ(29,"div",114),e.YNc(30,gi,4,7,"span",74),e.YNc(31,pi,4,7,"ng-template",null,75,e.W1O),e.qZA()()()),2&s){const t=d.$implicit,n=e.MAs(32),i=e.oxw(3);e.xp6(5),e.Oqu(t.name),e.xp6(5),e.Oqu(t.type),e.xp6(5),e.hij("",e.Dn7(16,7,e.lcZ(17,11,t.base),",","."),"\u0111 "),e.xp6(7),e.hij("",e.Dn7(23,13,e.lcZ(24,17,t.tax),",","."),"\u0111"),e.xp6(3),e.Q6J("ngIf",i.hasDiscountFare),e.xp6(5),e.Q6J("ngIf",t.discountAmount&&i.hasDiscountFare)("ngIfElse",n)}}function _i(s,d){if(1&s&&(e.TgZ(0,"div",100),e.YNc(1,mi,33,19,"div",116),e.qZA()),2&s){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",null==t.priceDetail?null:t.priceDetail.passengers)}}function vi(s,d){if(1&s&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"replace"),e.ALo(3,"number"),e.qZA()),2&s){const t=e.oxw(3);e.xp6(1),e.hij(" ",e.Dn7(2,1,e.lcZ(3,5,t.totalDiscountFareCharge),",",".")," \u0111 ")}}function fi(s,d){if(1&s&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"replace"),e.ALo(3,"number"),e.qZA()),2&s){const t=e.oxw(3);e.xp6(1),e.hij(" ",e.Dn7(2,1,e.lcZ(3,5,t.totalPrice),",",".")," \u0111 ")}}function bi(s,d){1&s&&e._UZ(0,"cf-icon",127)}function Ci(s,d){1&s&&e._UZ(0,"cf-icon",128)}function Ti(s,d){if(1&s&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"replace"),e.ALo(3,"number"),e.qZA()),2&s){const t=e.oxw(4);e.xp6(1),e.hij(" ",e.Dn7(2,1,e.lcZ(3,5,t.priceDetail.totalDiscountBasePrice),",",".")," \u0111")}}function ki(s,d){if(1&s&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"replace"),e.ALo(3,"number"),e.qZA()),2&s){const t=e.oxw(4);e.xp6(1),e.hij(" ",e.Dn7(2,1,e.lcZ(3,5,t.priceDetail.totalBasePrice),",",".")," \u0111")}}function xi(s,d){if(1&s&&(e.TgZ(0,"div",129)(1,"div",130)(2,"div",131)(3,"div",132)(4,"div",133),e._uU(5," Gi\xe1 v\xe9 m\xe1y bay "),e.qZA(),e.TgZ(6,"div",133),e._uU(7," D\u1ecbch v\u1ee5 c\u1ed9ng th\xeam "),e.qZA(),e.TgZ(8,"div",133),e._uU(9," Ph\xed d\u1ecbch v\u1ee5 "),e.qZA()()(),e.TgZ(10,"div",134)(11,"div",135),e.YNc(12,Ti,4,7,"span",17),e.YNc(13,ki,4,7,"span",17),e.qZA(),e.TgZ(14,"div",135),e._uU(15),e.ALo(16,"replace"),e.ALo(17,"number"),e.qZA(),e.TgZ(18,"div",135),e._uU(19),e.ALo(20,"replace"),e.ALo(21,"number"),e.qZA()()()()),2&s){const t=e.oxw(3);e.xp6(12),e.Q6J("ngIf",t.priceDetail.totalDiscountBasePrice),e.xp6(1),e.Q6J("ngIf",!t.priceDetail.totalDiscountBasePrice),e.xp6(2),e.hij(" ",e.Dn7(16,4,e.lcZ(17,8,(t.priceDetail.totalAddonService||0)+(t.priceDetail.totalOthersCharge||0)),",",".")," \u0111 "),e.xp6(4),e.hij(" ",e.Dn7(20,10,e.lcZ(21,14,t.priceDetail.totalServiceFee),",",".")," \u0111 ")}}function yi(s,d){if(1&s){const t=e.EpF();e.TgZ(0,"div",120),e.NdJ("click",function(){e.CHM(t);const i=e.MAs(12),o=e.oxw(2);return e.KtG(o.togglePriceBottomSheet(i))}),e.TgZ(1,"div",121)(2,"div",121)(3,"div",122),e._uU(4," T\u1ed5ng chi ph\xed: "),e.qZA(),e.TgZ(5,"div",123),e.YNc(6,vi,4,7,"span",74),e.YNc(7,fi,4,7,"ng-template",null,75,e.W1O),e.qZA()(),e.YNc(9,bi,1,0,"cf-icon",124),e.YNc(10,Ci,1,0,"cf-icon",125),e.qZA(),e.YNc(11,xi,22,16,"ng-template",null,126,e.W1O),e.qZA()}if(2&s){const t=e.MAs(8),n=e.oxw(2);e.ekj("z-1000",n.zIndexPriceIncrease),e.xp6(6),e.Q6J("ngIf",n.totalDiscountFareCharge&&n.hasDiscountFare)("ngIfElse",t),e.xp6(3),e.Q6J("ngIf",!n.isShowTotalPriceBts),e.xp6(1),e.Q6J("ngIf",n.isShowTotalPriceBts)}}function Di(s,d){if(1&s&&(e.TgZ(0,"div",117)(1,"div",112)(2,"div",113),e._uU(3,"H\xe0nh kh\xe1ch"),e.qZA(),e.TgZ(4,"div",114),e._uU(5),e.qZA()(),e.TgZ(6,"div",112)(7,"div",113),e._uU(8,"Lo\u1ea1i kh\xe1ch"),e.qZA(),e.TgZ(9,"div",114),e._uU(10),e.qZA()(),e.TgZ(11,"div",112)(12,"div",113),e._uU(13,"T\u1ed5ng b\u1ea3o l\u01b0u"),e.qZA(),e.TgZ(14,"div",114),e._uU(15),e.ALo(16,"replace"),e.ALo(17,"number"),e.qZA()()()),2&s){const t=d.$implicit;e.xp6(5),e.Oqu(t.name),e.xp6(5),e.Oqu(t.type),e.xp6(5),e.hij("",e.Dn7(16,3,e.lcZ(17,7,t.price),",","."),"\u0111 ")}}function Bi(s,d){if(1&s&&(e.TgZ(0,"div",100)(1,"div",136)(2,"div",117)(3,"div",112)(4,"div",137),e._uU(5,"M\xe3 \u0111\u1eb7t ch\u1ed7"),e.qZA(),e.TgZ(6,"div",114),e._uU(7),e.qZA()(),e.TgZ(8,"div",112)(9,"div",137),e._uU(10,"Ng\xe0y h\u1ebft h\u1ea1n b\u1ea3o l\u01b0u"),e.qZA(),e.TgZ(11,"div",114),e._uU(12),e.ALo(13,"date"),e.qZA()()(),e.YNc(14,Di,18,9,"div",116),e.qZA()()),2&s){const t=e.oxw(2);e.xp6(7),e.Oqu(t.identityReservationInfo.pnr),e.xp6(5),e.Oqu(e.xi3(13,3,t.identityReservationInfo.expirationDate,"dd/MM/yyyy")),e.xp6(2),e.Q6J("ngForOf",t.identityReservationInfo.passengers)}}function Ei(s,d){if(1&s&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"replace"),e.ALo(3,"number"),e.qZA()),2&s){const t=e.oxw(3);e.xp6(1),e.hij(" ",e.Dn7(2,1,e.lcZ(3,5,t.creditShellTotal),",",".")," \u0111 ")}}function Ai(s,d){if(1&s&&(e.TgZ(0,"div",138)(1,"div",121)(2,"div",121)(3,"div",122),e._uU(4," T\u1ed5ng chi ph\xed: "),e.qZA(),e.TgZ(5,"div",123),e.YNc(6,Ei,4,7,"div",17),e.qZA()()()()),2&s){const t=e.oxw(2);e.ekj("z-1000",t.zIndexPriceIncrease),e.xp6(6),e.Q6J("ngIf",0!==t.creditShellTotal)}}function Ii(s,d){if(1&s&&(e.TgZ(0,"div",100),e._UZ(1,"fare-rule-modal",139),e.qZA()),2&s){const t=e.oxw(2);e.xp6(1),e.Q6J("fareRuleBsp",t.fareRuleBsp)}}function Si(s,d){if(1&s){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",140)(2,"div",141),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(3);return e.KtG(i.onShare())}),e._UZ(3,"cf-icon",142),e.TgZ(4,"div",143),e._uU(5," Sao ch\xe9p "),e.qZA()(),e._UZ(6,"booking-text-origin",144),e.qZA(),e.BQk()}if(2&s){const t=d.$implicit;e.xp6(6),e.Q6J("bookingText",t)}}function Pi(s,d){if(1&s&&(e.TgZ(0,"div",100),e.YNc(1,Si,7,1,"ng-container",55),e.qZA()),2&s){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",t.listBookingText)}}function Zi(s,d){if(1&s&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&s){const t=e.oxw().$implicit;e.xp6(1),e.hij("(",t.status,")")}}function Ni(s,d){if(1&s){const t=e.EpF();e.TgZ(0,"div",117)(1,"div",112)(2,"div",113),e._uU(3,"S\u1ed1 v\xe9"),e.qZA(),e.TgZ(4,"div",114),e._uU(5),e.YNc(6,Zi,2,1,"span",17),e.qZA()(),e.TgZ(7,"div",112)(8,"div",113),e._uU(9,"H\xe0nh tr\xecnh"),e.qZA(),e.TgZ(10,"div",114),e._uU(11),e.qZA()(),e.TgZ(12,"div",112)(13,"div",113),e._uU(14,"M\xe3 \u0111\u1eb7t ch\u1ed7"),e.qZA(),e.TgZ(15,"div",114),e._uU(16),e.qZA()(),e.TgZ(17,"div",112)(18,"div",113),e._uU(19,"H\xe0nh kh\xe1ch"),e.qZA(),e.TgZ(20,"div",114),e._uU(21),e.qZA()(),e.TgZ(22,"div",112)(23,"div",113),e._uU(24,"H\xe3ng"),e.qZA(),e.TgZ(25,"div",114),e._uU(26),e.qZA()(),e.TgZ(27,"div",115),e.NdJ("click",function(){const o=e.CHM(t).$implicit,a=e.oxw(3);return e.KtG(a.onShowTicketInfo(o))}),e._uU(28," Chi ti\u1ebft "),e.qZA()()}if(2&s){const t=d.$implicit;e.xp6(5),e.hij("",t.ticketNumber," "),e.xp6(1),e.Q6J("ngIf","VOID"===t.status),e.xp6(5),e.Oqu(t.journeyName),e.xp6(5),e.hij("",t.bookingCode," "),e.xp6(5),e.Oqu(t.passengerName),e.xp6(5),e.hij("",t.airline," ")}}function Oi(s,d){if(1&s&&(e.TgZ(0,"div",100),e.YNc(1,Ni,29,6,"div",116),e.qZA()),2&s){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",t.listTicketInfo)}}function Fi(s,d){if(1&s&&(e.TgZ(0,"div",100),e._UZ(1,"remark-booking-page",21),e.qZA()),2&s){const t=e.oxw(2);e.xp6(1),e.Q6J("listBookingCode",t.listBookingCode)}}function Mi(s,d){if(1&s){const t=e.EpF();e.TgZ(0,"div",111)(1,"div",112)(2,"div",113),e._uU(3,"Ng\u01b0\u1eddi th\u1ef1c hi\u1ec7n"),e.qZA(),e.TgZ(4,"div",114),e._uU(5),e.qZA()(),e.TgZ(6,"div",112)(7,"div",113),e._uU(8,"Ng\xe0y y\xeau c\u1ea7u"),e.qZA(),e.TgZ(9,"div",114),e._uU(10),e.qZA()(),e.TgZ(11,"div",112)(12,"div",113),e._uU(13,"PNR m\u1edbi"),e.qZA(),e.TgZ(14,"a",89),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(3);return e.KtG(i.gotoBookingDetail(i.monitorOrderInfo.airline,i.monitorOrderInfo.pnr))}),e._uU(15),e.qZA()(),e.TgZ(16,"div",112)(17,"div",113),e._uU(18,"Tr\u1ea1ng th\xe1i"),e.qZA(),e.TgZ(19,"label",90),e._uU(20),e.qZA()(),e.TgZ(21,"div",115),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(3);return e.KtG(i.onOrderDetail(i.monitorOrderInfo.orderId))}),e.TgZ(22,"span"),e._uU(23,"Chi ti\u1ebft"),e.qZA()()()}if(2&s){const t=e.oxw(3);e.xp6(5),e.Oqu(t.monitorOrderInfo.userAction),e.xp6(5),e.Oqu(t.monitorOrderInfo.timeCreate),e.xp6(5),e.Oqu(t.monitorOrderInfo.pnr||"-"),e.xp6(4),e.Tol(t.monitorOrderInfo.stateLabel.style),e.xp6(1),e.Oqu(null==t.monitorOrderInfo.stateLabel?null:t.monitorOrderInfo.stateLabel.name)}}function Li(s,d){if(1&s&&(e.TgZ(0,"div",100),e.YNc(1,Mi,24,6,"div",145),e.qZA()),2&s){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.isMonitorOrderInfo)}}function Ui(s,d){if(1&s){const t=e.EpF();e.TgZ(0,"suggest-register-order",146),e.NdJ("actionChange",function(i){e.CHM(t);const o=e.oxw(2);return e.KtG(o.onChangeSuggest(i))}),e.qZA()}}const qi=function(s){return{"bg-[#FFF4F3]":s}};function wi(s,d){if(1&s){const t=e.EpF();e.TgZ(0,"div",4)(1,"div",5),e.YNc(2,mt,8,2,"div",6),e.TgZ(3,"div",7)(4,"div",8)(5,"div",9),e._UZ(6,"div",10),e.TgZ(7,"div",11),e._uU(8,"Chi ti\u1ebft \u0111\u1eb7t ch\u1ed7"),e.qZA()(),e.YNc(9,_t,4,0,"button",12),e.qZA(),e.YNc(10,vt,3,0,"div",13),e.TgZ(11,"div",14),e.YNc(12,ft,1,5,"booking-detail",15),e.qZA()(),e.YNc(13,Ct,22,1,"div",16),e.YNc(14,kt,22,1,"div",16),e.YNc(15,yt,16,1,"div",16),e.YNc(16,Bt,18,1,"div",16),e.YNc(17,Pt,21,2,"div",16),e.YNc(18,Mt,18,6,"div",17),e.YNc(19,Lt,10,0,"div",18),e.YNc(20,Ut,33,6,"div",17),e.qZA(),e.TgZ(21,"div",19)(22,"cf-booking-text",20),e.NdJ("actionShare",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.onShare())})("modeChange",function(i){e.CHM(t);const o=e.oxw();return e.KtG(o.changeModeBookingText(i))}),e.qZA(),e._UZ(23,"remark-booking-page",21),e.qZA(),e.TgZ(24,"div",22)(25,"div",23)(26,"div",24,25),e.NdJ("click",function(){e.CHM(t);const i=e.MAs(27),o=e.oxw();return e.KtG(o.mobileTabChange("BOOKING_DETAIL",i))}),e._uU(28," Chi ti\u1ebft \u0111\u1eb7t ch\u1ed7 "),e.qZA(),e.TgZ(29,"div",24,26),e.NdJ("click",function(){e.CHM(t);const i=e.MAs(30),o=e.oxw();return e.KtG(o.mobileTabChange("PAX_INFO",i))}),e._uU(31," Th\xf4ng tin h\xe0nh kh\xe1ch "),e.qZA(),e.YNc(32,qt,3,6,"div",27),e.YNc(33,wt,3,6,"div",27),e.YNc(34,Rt,3,6,"div",27),e.YNc(35,Kt,3,6,"div",27),e.YNc(36,jt,3,6,"div",27),e.YNc(37,Jt,3,6,"div",27),e.YNc(38,Vt,3,6,"div",27),e.YNc(39,Ht,3,6,"div",27),e.qZA(),e.YNc(40,Yt,1,0,"suggest-register-order",28),e.YNc(41,ci,8,6,"div",29),e.YNc(42,hi,22,3,"div",29),e.YNc(43,_i,2,1,"div",29),e.YNc(44,yi,13,6,"div",30),e.YNc(45,Bi,15,6,"div",29),e.YNc(46,Ai,7,3,"div",31),e.YNc(47,Ii,2,1,"div",29),e.YNc(48,Pi,2,1,"div",29),e.YNc(49,Oi,2,1,"div",29),e.YNc(50,Fi,2,1,"div",29),e.YNc(51,Li,2,1,"div",29),e.qZA(),e.YNc(52,Ui,1,0,"suggest-register-order",32),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("ngClass",e.VKq(51,qi,!t.isPreviewPnr&&t.isShowStatusLock)),e.xp6(2),e.Q6J("ngIf",t.isSuccess),e.xp6(7),e.Q6J("ngIf",t.isRefreshPnr&&t.has1AProvider),e.xp6(1),e.Q6J("ngIf",t.hasWaitlistBooking),e.xp6(2),e.Q6J("ngForOf",t.bookingDetails),e.xp6(1),e.Q6J("ngIf",t.hasBaggageSelected),e.xp6(1),e.Q6J("ngIf",t.hasSeatSelected),e.xp6(1),e.Q6J("ngIf",null==t.listOtherCharge?null:t.listOtherCharge.length),e.xp6(1),e.Q6J("ngIf",t.hasInternationalFlight&&t.fareBasisInfos&&(null==t.fareBasisInfos[0]?null:t.fareBasisInfos[0].fareClass)&&(null==t.fareBasisInfos[0]?null:t.fareBasisInfos[0].fareBasis)&&"CANCEL"!==t.bookingDetails[0].status),e.xp6(1),e.Q6J("ngIf",t.listTicketInfo.length&&"VJ"!==t.listTicketInfo[0].airline),e.xp6(1),e.Q6J("ngIf",t.isSuccess&&t.totalPrice&&e.DdM(53,Ke).includes(t.bookingDetails[0].status)),e.xp6(1),e.Q6J("ngIf",t.hasInternationalFlight&&"CANCEL"!==t.bookingDetails[0].status),e.xp6(1),e.Q6J("ngIf",t.isMonitorOrderInfo),e.xp6(2),e.Q6J("listBookingText",t.listBookingText)("modeBookingText",t.modeBookingText)("bookingContact",t.bookingContact)("listBookingTextExplain",t.listBookingTextExplain),e.xp6(1),e.Q6J("listBookingCode",t.listBookingCode),e.xp6(3),e.ekj("text-secondary-3-4","BOOKING_DETAIL"===t.mobileTabMode)("!border-secondary-3-4","BOOKING_DETAIL"===t.mobileTabMode)("bg-secondary-3-1","BOOKING_DETAIL"===t.mobileTabMode),e.xp6(3),e.ekj("text-secondary-3-4","PAX_INFO"===t.mobileTabMode)("!border-secondary-3-4","PAX_INFO"===t.mobileTabMode)("bg-secondary-3-1","PAX_INFO"===t.mobileTabMode),e.xp6(3),e.Q6J("ngIf",t.isShowBookingInfo),e.xp6(1),e.Q6J("ngIf",0!==t.creditShellTotal),e.xp6(1),e.Q6J("ngIf",t.isShowBookingInfo&&t.hasInternationalFlight),e.xp6(1),e.Q6J("ngIf",t.isShowBookingInfo),e.xp6(1),e.Q6J("ngIf",t.isShowBookingInfo),e.xp6(1),e.Q6J("ngIf",t.isShowBookingInfo),e.xp6(1),e.Q6J("ngIf",t.isShowBookingInfo),e.xp6(1),e.Q6J("ngIf",t.isShowBookingInfo),e.xp6(1),e.Q6J("ngIf",t.isOpenSuggest),e.xp6(1),e.Q6J("ngIf","BOOKING_DETAIL"===t.mobileTabMode),e.xp6(1),e.Q6J("ngIf","PAX_INFO"===t.mobileTabMode),e.xp6(1),e.Q6J("ngIf","TOTAL_PRICE"===t.mobileTabMode),e.xp6(1),e.Q6J("ngIf","TOTAL_PRICE"===t.mobileTabMode),e.xp6(1),e.Q6J("ngIf","CREDIT_SHELL"===t.mobileTabMode),e.xp6(1),e.Q6J("ngIf","CREDIT_SHELL"===t.mobileTabMode),e.xp6(1),e.Q6J("ngIf","FARE_RULE"===t.mobileTabMode),e.xp6(1),e.Q6J("ngIf","TICKET_FACE"===t.mobileTabMode),e.xp6(1),e.Q6J("ngIf","TICKET_NUMBER"===t.mobileTabMode),e.xp6(1),e.Q6J("ngIf","REMARK"===t.mobileTabMode),e.xp6(1),e.Q6J("ngIf","LOWFARE"===t.mobileTabMode),e.xp6(1),e.Q6J("ngIf",!t.isLockPnr&&t.isOpenSuggest)}}function Ri(s,d){if(1&s){const t=e.EpF();e.TgZ(0,"div",147)(1,"div",148)(2,"div"),e._UZ(3,"img",149),e.qZA(),e.TgZ(4,"div",150)(5,"div",151),e._uU(6,"R\u1ea5t ti\u1ebfc, \u0111\xe3 c\xf3 l\u1ed7i x\u1ea3y ra"),e.qZA(),e.TgZ(7,"div",47)(8,"p"),e._uU(9),e.qZA()()(),e.TgZ(10,"div",152)(11,"button",153),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.getBookingDetail())}),e._UZ(12,"cf-icon",154),e._uU(13," Th\u1eed l\u1ea1i "),e.qZA()()()()}if(2&s){const t=e.oxw();e.xp6(9),e.hij("",t.messageError,". Vui l\xf2ng ki\u1ec3m tra v\xe0 th\u1eed l\u1ea1i sau")}}function Ki(s,d){1&s&&(e.TgZ(0,"div",155),e._UZ(1,"cf-spinner"),e.qZA())}let ji=(()=>{class s{constructor(t,n,i,o,a,r,c,b,u,h,l,m,k,g,y,P,$,Q,G,z,X){this.route=t,this._bookingDetailService=n,this._cfRegister=i,this._flightDataService=o,this._modal=a,this._locationDataService=r,this._manageBookingService=c,this._toastService=b,this.clipboard=u,this._permissionService=h,this._bottomSheetService=l,this._mobileDetectService=m,this._ticketLowFareService=k,this._route=g,this._eventLogService=y,this._sockerService=P,this._requestReroutingService=$,this._detectMobileService=Q,this._systemService=G,this._searchFlightService=z,this.location=X,this.passengerInfos=[],this.bookingDetails=[],this.isSuccess=!1,this.isLoading=!1,this.dataBaggageInput=[],this.hasBaggageSelected=!1,this.dataSeatInput=[],this.hasSeatSelected=!1,this.listBaggage=[],this.listService=[],this.listOtherCharge=[],this.listJourneyBasic=[],this.listAction=[],this.listBookingText=[],this.listBookingTextExplain=[],this.modeBookingText="explain",this.isCopied=!1,this.listTicketInfo=[],this.actionOption=[{value:"booking_detail",name:"M\u1edf booking",icon:"external_link",enabled:[f.or.ViewAllFlightBookingDetail,f.or.ViewOwnFlightBookingDetail].some(T=>this._permissionService.hasPermission(T))},{value:"void",name:"Void v\xe9",icon:"coupon_slash",enabled:[f.or.CanVoidFlightTicket].some(T=>this._permissionService.hasPermission(T))},{value:"issue",name:"Xu\u1ea5t v\xe9",icon:"grouping",enabled:[f.or.CanIssuedFlightTicket].some(T=>this._permissionService.hasPermission(T))},{value:"boarding_pass",name:"M\u1eb7t v\xe9",icon:"coupon",enabled:[f.or.CreateFlightTicketFace].some(T=>this._permissionService.hasPermission(T))},{value:"addon_baggage",name:"Th\xeam h\xe0nh l\xfd",icon:"",enabled:[f.or.CanAddonFlightBaggage].some(T=>this._permissionService.hasPermission(T))},{value:"addon_seat",name:"Th\xeam ch\u1ed7 ng\u1ed3i",icon:"",enabled:[f.or.CanAddonFlightSeat].some(T=>this._permissionService.hasPermission(T))},{value:"register_order",name:"Canh v\xe9 r\u1ebb",icon:"price_down",enabled:this._permissionService.hasPermission(f.or.CanMonitorLowFareTicket)},{value:"add_journey",name:"Th\xeam h\xe0nh tr\xecnh",icon:"",enabled:[f.or.CanAddFlightJourney].some(T=>this._permissionService.hasPermission(T))},{value:"rerouting",name:"\u0110\u1ed5i h\xe0nh tr\xecnh",icon:"",enabled:[f.or.CanUpdateFlightJourney].some(T=>this._permissionService.hasPermission(T))},{value:"delete_segments",name:"H\u1ee7y h\xe0nh tr\xecnh",icon:"delete",enabled:this._permissionService.hasPermission(f.or.CanDeleteFlightSegment)},{value:"delete_each_journey",name:"H\u1ee7y h\xe0nh tr\xecnh",icon:"delete",enabled:[f.or.CanDeleteFlightSegment].some(T=>this._permissionService.hasPermission(T))},{value:"cancel_booking",name:"H\u1ee7y h\xe0nh tr\xecnh",icon:"delete",enabled:[f.or.CancelBookingBSP,f.or.CancelBookingAIR_1G,f.or.CancelBookingBZT].some(T=>this._permissionService.hasPermission(T))},{value:"send_email",name:"G\u1eedi email",icon:"email",enabled:[f.or.CanSendEmail].some(T=>this._permissionService.hasPermission(T))},{value:"separate_passengers",name:"T\xe1ch h\xe0nh kh\xe1ch",icon:"",enabled:[f.or.CanSplitPassengerVJ,f.or.CanSplitPassengerVN,f.or.CanSplitPassengerQH].some(T=>this._permissionService.hasPermission(T))},{value:"update_pax_info",name:"S\u1eeda h\xe0nh kh\xe1ch",icon:"",enabled:[f.or.CanUpdatePaxInfoVJ].some(T=>this._permissionService.hasPermission(T))},{value:"check_in_online",name:"Check in",icon:"",enabled:!0},{value:"open_audit_log",name:"Ki\u1ec3m to\xe1n \u0111\u1eb7t ch\u1ed7",icon:"",enabled:[f.or.CanViewAuditLogVJ].some(T=>this._permissionService.hasPermission(T))},{value:"snapshot_pnr",name:"Xem snapshot",icon:"",enabled:[f.or.CanLockPNR].some(T=>this._permissionService.hasPermission(T))&&this._permissionService.isBooker()},{value:"rebook_pnr",name:"Rebook PNR",icon:"",enabled:[f.or.CanRebookPNRVJ,f.or.CanRebookPNRVN].some(T=>this._permissionService.hasPermission(T))},{value:"update_membership",name:"Th\xeam th\u1ebb BSV",icon:"",enabled:[f.or.CanAddMemberShip].some(T=>this._permissionService.hasPermission(T))},{value:"add_infant",name:"Th\xeam em b\xe9",icon:"",enabled:!0},{value:"recalculate_price",name:"T\xednh l\u1ea1i gi\xe1",icon:"",enabled:!0},{value:"calculate_fare",name:"L\u1ea5y gi\xe1 th\u1ea5p nh\u1ea5t",icon:"",enabled:[f.or.CalculateFare].some(T=>this._permissionService.hasPermission(T))},{value:"other",name:"Kh\xe1c",icon:"options_vertical",enabled:[f.or.CanAddonFlightSeat,f.or.CanAddonFlightBaggage].some(T=>this._permissionService.hasPermission(T)),items:[{value:"addon_baggage",name:"Th\xeam h\xe0nh l\xfd",icon:"",enabled:[f.or.CanAddonFlightBaggage].some(T=>this._permissionService.hasPermission(T))},{value:"addon_seat",name:"Th\xeam ch\u1ed7 ng\u1ed3i",icon:"",enabled:[f.or.CanAddonFlightSeat].some(T=>this._permissionService.hasPermission(T))}]}],this.listBookingCode=[],this.isShowRemark=!this._permissionService.isVNAccount(),this.messageError="",this.maxBag=10,this.zIndexPriceIncrease=!1,this.mobileTabMode="BOOKING_DETAIL",this.isOpenSuggest=!1,this.isMonitorOrderInfo=!1,this.MODIFY_TYPE=ee.Io,this.includePrice=!1,this.isShowBookingInfo=!1,this.hasInternationalFlight=!1,this.has1AProvider=!1,this.fareBasisInfos=[],this.hasAdtPax=!1,this.hasChdPax=!1,this.hasInfPax=!1,this.hasDiscountFare=!1,this.isRefreshPnr=this._permissionService.hasPermission(f.or.CanRefreshPnr),this.isLockPnr=!1,this.canLockPnr=!1,this.isShowStatusLock=this._permissionService.isAgent1()&&!this._permissionService.hasPermission(f.or.CanLockPNR),this.isPreviewPnr=!1,this.isShowTotalPriceBts=!1,this.hasWaitlistBooking=!1,this.DATE_ENABLE_LOGIC_MMB_VJ=E.BK,i.registerIcons([B.xgX,B.Ey$,B.tLH,B.xbi,B.NYs,B.Hge,B.n78,B.fqi,B.esH,B.cnj,B.$f3,B.gW0]),this.bookingCode=t.snapshot.params.bookingCode,this.airline=t.snapshot.params.airline,this.modifyType=history.state.modifyType,this.includePrice=history.state.includePrice,this.location.replaceState(this.location.path(),"",{})}ngOnInit(){const t=this.route.snapshot.queryParams,n=t.type;this.provider=t.provider,n&&"preview"===n&&this.provider?(this.isPreviewPnr=!0,this.getSnapshotPnr()):this.route.params.subscribe(i=>{this.bookingCode=i.bookingCode,this.airline=i.airline,this.getBookingDetail()}),this.handleSocketTimoutEvent()}handleSocketTimoutEvent(){const n=this._permissionService.getCurrentUser().userId;this._sockerService.timeoutEvent$.subscribe({next:i=>{this.refTimoutModal&&this.refTimoutModal.close(),this.refTimoutBts&&this.refTimoutBts.dismiss(),i.receiverId===n&&(this._toastService.add({severity:"success",summary:"Xu\u1ea5t v\xe9 th\xe0nh c\xf4ng",detail:"M\xe3 \u0111\u1eb7t ch\u1ed7 \u0111\xe3 \u0111\u01b0\u1ee3c xu\u1ea5t v\xe9 th\xe0nh c\xf4ng!",sticky:!1}),this.getBookingDetail())}})}getBookingDetail(t=!1,n=!1){this.isLoading=!0,this._bookingDetailService.getBookingDetail(this.bookingCode,this.airline,t,n).pipe((0,A.x)(()=>this.isLoading=!1)).subscribe({next:i=>{var o;if("OK"===i.status)t&&this._toastService.add({severity:"success",summary:"Th\xe0nh c\xf4ng",detail:"C\u1eadp nh\u1eadt tr\u1ea1ng th\xe1i m\u1edbi nh\u1ea5t c\u1ee7a v\xe9 th\xe0nh c\xf4ng.",sticky:!1}),n&&this._toastService.add({severity:"success",summary:"Th\xe0nh c\xf4ng",detail:"Gi\xe1 v\xe9 m\u1edbi nh\u1ea5t \u0111\xe3 \u0111\u01b0\u1ee3c c\u1eadp nh\u1eadt, vui l\xf2ng ki\u1ec3m tra l\u1ea1i.",sticky:!1}),this.handleBoookingDetailResult(i);else if(this.isSuccess=!1,t)this._toastService.add({severity:"error",summary:"Th\u1ea5t b\u1ea1i",detail:"C\u1eadp nh\u1eadt tr\u1ea1ng th\xe1i v\xe9 th\u1ea5t b\u1ea1i. Vui l\xf2ng li\xean h\u1ec7 Booker \u0111\u1ec3 \u0111\u01b0\u1ee3c h\u1ed7 tr\u1ee3.",sticky:!0});else{const a=null!==(o=i.objectError.errorDescription.vi)&&void 0!==o?o:i.objectError.errorDescription.en;this.messageError=a,this._toastService.add({severity:"error",summary:"Xem chi ti\u1ebft th\u1ea5t b\u1ea1i",detail:a,sticky:!0})}},error:()=>{this.isSuccess=!1,t?this._toastService.add({severity:"error",summary:"Th\u1ea5t b\u1ea1i",detail:"C\u1eadp nh\u1eadt tr\u1ea1ng th\xe1i v\xe9 th\u1ea5t b\u1ea1i. Vui l\xf2ng li\xean h\u1ec7 Booker \u0111\u1ec3 \u0111\u01b0\u1ee3c h\u1ed7 tr\u1ee3.",sticky:!0}):this.messageError="\u0110\xe3 c\xf3 l\u1ed7i x\u1ea3y ra trong qu\xe1 tr\xednh th\u1ef1c hi\u1ec7n h\xe0nh \u0111\u1ed9ng n\xe0y"}})}handleBoookingDetailResult(t){var n,i,o;this.isLockPnr="LOCKED"===t.data.stateLockPnr,this.isShowBookingInfo=["BOOKED","ISSUED"].includes(t.data.state),this.checkModifyBooking(),!this.isLockPnr&&this.checkSuggestRegisterOrder(),this.isSuccess=!0,this.bookingDetailResult=t,this.discountPercentage=t.data.discountPercentage,this.hasDiscountFare=!!this.discountPercentage,this.listBookingCode=[{bookingCode:t.data.bookingCode}],this.hasInternationalFlight=["BSP","AIR_1G","BZT","ST"].includes((null===(n=t.data.provider)||void 0===n?void 0:n.toUpperCase())||""),this.has1AProvider=["BSP"].includes((null===(i=t.data.provider)||void 0===i?void 0:i.toUpperCase())||""),this.canLockPnr=this._permissionService.hasPermission(f.or.CanLockPNR)&&["BOOKED","ISSUED","CANCEL","VOID"].includes(t.data.state)&&["VN","QH","BSP","AIR_1G"].includes((null===(o=t.data.provider)||void 0===o?void 0:o.toUpperCase())||""),this.hasWaitlistBooking=t.data.journeys.flatMap(a=>a.segments).some(a=>{var r;return"HL"===(null===(r=a.bookedInfo)||void 0===r?void 0:r.status)}),this.initPassenger(),this.initCreditShellPrice(),this.initBookingDetail(),this.creditShellTotal&&this.initIdentityReservationInfo(),this.checkMultiJourney(),this.listBaggage=[],this.mappingJourneyBasic(),this._getSeatCharge(),this._getBaggageCharge(),this.getOtherCharge(),this.initPriceDetail(),this.initTotalPrice(),this.getBookingContact(),this.getBooingText(),this.getListTicketInfo(),this.getFareBasis()}initCreditShellPrice(){this.creditShellTotal=this.bookingDetailResult.data.creditShell?this.bookingDetailResult.data.creditShell.paxShellBreakDown.map(t=>t.refund.charge.total).reduce((t,n)=>t+n,0):0}initIdentityReservationInfo(){const t=this.bookingDetailResult.data.creditShell;this.identityReservationInfo={pnr:t.bookingCode,expirationDate:void 0,passengers:t.paxShellBreakDown.map(n=>{let i="";switch(n.type){case"ADULT":i="ADT";break;case"CHILD":i="CHD";break;case"INFANT":i="INF"}return{name:n.lastName+" "+n.firstName,type:i,price:n.refund.charge.total}})}}checkModifyBooking(){if(this.modifyType===ee.Io.UPDATE_JOURNEY)if(this.modifyType=ee.Io.NONE,this._detectMobileService.isMobile()){const t=this._bottomSheetService.open(p.Q4,{headerTitle:"D\u1ecbch v\u1ee5 c\u1ed9ng th\xeam",rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4",data:{title:"",body:"H\xe0nh l\xfd v\xe0 gh\u1ebf ng\u1ed3i \u0111\xe3 mua c\xf3 th\u1ec3 s\u1ebd kh\xf4ng t\u1ef1 \u0111\u1ed9ng th\xeam v\xe0o h\xe0nh tr\xecnh m\u1edbi. \u0110\u1ea1i l\xfd vui l\xf2ng t\u1ef1 ki\u1ec3m tra l\u1ea1i.",okText:"\u0110\xf3ng",cancelText:"",hasIcon:!0,status:"info"}});t.containerInstance._rightButtonClick.subscribe(()=>{t.dismiss()})}else this._modal.open(p.V0,{title:"D\u1ecbch v\u1ee5 c\u1ed9ng th\xeam",body:"H\xe0nh l\xfd v\xe0 gh\u1ebf ng\u1ed3i \u0111\xe3 mua c\xf3 th\u1ec3 s\u1ebd kh\xf4ng t\u1ef1 \u0111\u1ed9ng th\xeam v\xe0o h\xe0nh tr\xecnh m\u1edbi. \u0110\u1ea1i l\xfd vui l\xf2ng t\u1ef1 ki\u1ec3m tra l\u1ea1i.",okText:"\u0110\xf3ng",hasCancel:!1})}checkSuggestRegisterOrder(){this._ticketLowFareService.canMonitorLowFare({airline:this.airline,pnr:this.bookingCode}).subscribe({next:n=>{"OK"===n.status&&(n.data.monitorOrderInfo?(this.monitorOrderInfo={orderId:n.data.monitorOrderInfo.orderId,pnr:n.data.monitorOrderInfo.pnr,airline:n.data.monitorOrderInfo.airline,state:n.data.monitorOrderInfo.state,stateLabel:this.getSateLabel(n.data.monitorOrderInfo.state),timeCreate:n.data.monitorOrderInfo.timeCreate?S(n.data.monitorOrderInfo.timeCreate).format("HH:mm DD/MM/YYYY"):"",userAction:n.data.monitorOrderInfo.userActionInfo.name},this.isMonitorOrderInfo=!0):this.isMonitorOrderInfo=!1,n.data.canSuggestMonitor.enable&&this.handleShowSuggest())}})}getSateLabel(t){switch(t){case H.b.CREATE:case H.b.IN_PROCESS:return{name:"\u0110ang canh v\xe9",style:"text-secondary-7-5 bg-secondary-7-1"};case H.b.IN_PROCESS_PRICE_UP:return{name:"Gi\xe1 \u0111\xe3 t\u0103ng",style:"text-primary-1-4 bg-primary-7-1"};case H.b.COMPLETED:return{name:"\u0110\xe3 canh v\xe9 r\u1ebb",style:"text-secondary-5-3 bg-secondary-5-1"};case H.b.CANCEL:return{name:"\u0110\xe3 b\u1ecb h\u1ee7y",style:"text-neutral-white bg-[#00000099]"};case H.b.EXPIRED:return{name:"\u0110\xe3 h\u1ebft h\u1ea1n",style:"text-neutral-gray-6 bg-neutral-gray-2"};default:return{name:"",style:""}}}handleShowSuggest(){this.isOpenSuggest=!0,setTimeout(()=>{this.isOpenSuggest=!1},3e4)}getBookingContact(){this.bookingContact=this.bookingDetailResult.data.bookingContact}getBooingText(){var t;this.listBookingText=[Object.assign(Object.assign({},this.bookingDetailResult.data.bookingText),{segmentTexts:"CANCEL"!=this.bookingDetailResult.data.state?this.bookingDetailResult.data.bookingText.segmentTexts:[],airline:this.bookingDetailResult.data.airline,totalPrice:"CANCEL"!=this.bookingDetailResult.data.state?new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format((null===(t=this.bookingDetailResult.data.bookingText)||void 0===t?void 0:t.totalPrice)||0):"",timeLimit:this.bookingDetails[0].timeHoldBooking||""})];const n=this.bookingDetailResult.data.bookingTextExplain;n&&(this.listBookingTextExplain=[Object.assign(Object.assign({},n),{segmentTexts:"CANCEL"!=this.bookingDetailResult.data.state?n.segmentTexts:[],bags:"CANCEL"!=this.bookingDetailResult.data.state?n.bags:[],seatCharge:"CANCEL"!=this.bookingDetailResult.data.state?n.seatCharge:[],ssrCharge:"CANCEL"!=this.bookingDetailResult.data.state?n.ssrCharge:[],totalCharge:"CANCEL"!=this.bookingDetailResult.data.state?n.totalCharge:"",totalPrice:"CANCEL"!=this.bookingDetailResult.data.state?n.totalPrice:0})],this.bookingTextExplain=this.getExplaneText())}initPassenger(){var t,n;this.passengerInfos=(null===(t=this.bookingDetailResult.data.passengers)||void 0===t?void 0:t.map(i=>("ADT"===i.getType()&&(this.hasAdtPax=!0),"CHD"===i.getType()&&(this.hasChdPax=!0),"INF"===i.getType()&&(this.hasInfPax=!0),{name:i.getName(),type:i.getType(),sex:i.getGender(),birthday:i.getBirthday(),membershipNumber:i.membershipNumber||""})))||[],this.passengers=(null===(n=this.bookingDetailResult.data.passengers)||void 0===n?void 0:n.map(i=>({name:i.getName(),type:i.type,typeName:i.getType(),key:i.key})))||[]}syncDelayPoint(t){for(let n=0;n<t.length-1;n++)t[n+1].delay=t[n].delay,t[n].delay=0;return t}checkMultiJourney(){const t=this.bookingDetailResult.data.journeys;return t.length>2||t.length>1&&!(t[0].departure.airport.code==t[1].arrival.airport.code&&t[0].arrival.airport.code===t[1].departure.airport.code)}initBookingDetail(){var t,n,i,o,a,r,c,b,u,h,l,m,k,g,y,P,$,Q,G,z,X,T,oe,ae,se,re;const _=this.bookingDetailResult.data;this.listAction.push(_.getAction()),_.journeys.forEach(v=>{_.provider===E.QK.VN&&"VN"===v.airline&&(v.segments=this.syncDelayPoint(v.segments))}),this.bookingDetails=[{agentId:_.agentId||"N/A",coOwnerId:_.coOwnerId||"N/A",bookingCode:_.bookingCode||"N/A",holdLimitTime:(null===(t=_.bookingTextExplain)||void 0===t?void 0:t.holdLimitTime)||"N/A",provider:_.provider||"",supplier:_.supplier||"",bookingCodeDisplay:_.bookingCode||"N/A",airline:_.airline||"N/A",airlineLogo:this._flightDataService.getAirlineLogoByCode((null===(n=_.journeys[0])||void 0===n?void 0:n.operating)||_.airline),mobileAirlineLogo:["VJ","VN","QH"].includes((null===(i=_.journeys[0])||void 0===i?void 0:i.operating)||_.airline)?"assets/airline-logo/"+((null===(o=_.journeys[0])||void 0===o?void 0:o.operating)||_.airline)+"_small.png":"assets/airline-logo/"+((null===(a=_.journeys[0])||void 0===a?void 0:a.operating)||_.airline)+".png",airlineName:["VJ","VN","QH"].includes(_.airline)?this._flightDataService.getAirlineSystemNameByCode(_.airline):_.airlineName,airlineSystem:_.airline||"N/A",startPoint:null!==(c=null===(r=_.journeys[0])||void 0===r?void 0:r.departure.airport.code)&&void 0!==c?c:"N/A",endPoint:1===_.journeys.length?null===(b=_.journeys[0])||void 0===b?void 0:b.arrival.airport.code:null===(u=_.journeys[_.journeys.length-1])||void 0===u?void 0:u.departure.airport.code,status:_.state,issued:_.issued||!1,statusText:_.getStatusText(),statusDesc:"N/A",caCode:"N/A",timeHoldBooking:null!==(h=_.bookDetail)&&void 0!==h&&h.timeHoldBooking?new Date(_.bookDetail.timeHoldBooking):null,timeHoldPricing:null!==(l=_.bookDetail)&&void 0!==l&&l.timeKeepPrice?new Date(_.bookDetail.timeKeepPrice):null,tourCode:"N/A",totalFare:null!==(m=_.fareCharges)&&void 0!==m&&m.total?_.fareCharges.total.total:null,totalDiscountFare:0,totalServiceFee:null!==(k=_.totalCharges)&&void 0!==k&&k.total?_.totalCharges.total.totalServiceFee:null,totalCharge:(null===(g=_.totalCharges)||void 0===g?void 0:g.total.total)||0,totalAddonCharge:null!==($=null===(P=null===(y=_.totalCharges)||void 0===y?void 0:y.total)||void 0===P?void 0:P.totalAddonCharge)&&void 0!==$?$:0,targetPriceOrder:null===(Q=_.fareCharges)||void 0===Q?void 0:Q.getTotalChargeOrder(),flightNumber:`${(null===(z=null===(G=_.journeys[0])||void 0===G?void 0:G.segments[0])||void 0===z?void 0:z.airline)||""}${(null===(T=null===(X=_.journeys[0])||void 0===X?void 0:X.segments[0])||void 0===T?void 0:T.flightNumber)||""}`,journeys:(null===(oe=_.journeys)||void 0===oe?void 0:oe.map(v=>{var O,F,M,L,U,q,w,R,K,j,J,V,le,ce;return{key:v.key,leg:v.leg,journeyBaseFare:null===(O=_.fareCharges)||void 0===O?void 0:O.getBaseFareByJourney(v.key),airline:v.airline||"N/A",airlineLogo:this._flightDataService.getAirlineLogoByCode(v.operating||v.airline),airlineName:v.airlineName||"N/A",operating:v.operating||"N/A",operatingName:v.operatingName||"N/A",startPoint:(null===(M=null===(F=v.departure)||void 0===F?void 0:F.airport)||void 0===M?void 0:M.code)||"N/A",startPointName:this._locationDataService.getCityNameByCode(v.departure.airport.code),endPoint:(null===(U=null===(L=v.arrival)||void 0===L?void 0:L.airport)||void 0===U?void 0:U.code)||"N/A",endPointName:this._locationDataService.getCityNameByCode(v.arrival.airport.code),startTime:null!==(q=v.departure)&&void 0!==q&&q.localTime?S(v.departure.localTime).toDate():void 0,endTime:null!==(w=v.arrival)&&void 0!==w&&w.localTime?S(v.arrival.localTime).toDate():void 0,startTerminal:v.segments[0].departure.airport.terminal?`T${v.segments[0].departure.airport.terminal}`:"",endTerminal:(()=>{var x;const Y=1===v.segments.length?v.segments[0].arrival.airport.terminal:null===(x=v.segments[v.segments.length-1])||void 0===x?void 0:x.departure.airport.terminal;return Y?`T${Y}`:""})(),segments:(null===(R=v.segments)||void 0===R?void 0:R.map(x=>{var Y,de,he,ue,ge,pe,me,_e,ve,fe,be,Ce,Te,ke,xe,ye,De,Be,Ee,Ae,Ie,Se,Pe;const je=x.getDelayString();return{airline:x.airline||"N/A",airlineName:x.operatingName||"N/A",airlineLogo:this._flightDataService.getAirlineLogoByCode(x.operating||x.airline),startPoint:(null===(de=null===(Y=x.departure)||void 0===Y?void 0:Y.airport)||void 0===de?void 0:de.code)||"N/A",startPointName:this._locationDataService.getCityNameByCode((null===(ue=null===(he=x.departure)||void 0===he?void 0:he.airport)||void 0===ue?void 0:ue.code)||""),endPoint:(null===(pe=null===(ge=x.arrival)||void 0===ge?void 0:ge.airport)||void 0===pe?void 0:pe.code)||"N/A",endPointName:this._locationDataService.getCityNameByCode((null===(_e=null===(me=x.arrival)||void 0===me?void 0:me.airport)||void 0===_e?void 0:_e.code)||""),startTime:null!==(ve=x.departure)&&void 0!==ve&&ve.localTime?S(x.departure.localTime).toDate():void 0,endTime:null!==(fe=x.arrival)&&void 0!==fe&&fe.localTime?S(x.arrival.localTime).toDate():void 0,startTerminal:null!==(Ce=null===(be=x.departure)||void 0===be?void 0:be.airport)&&void 0!==Ce&&Ce.terminal?`T${null===(Te=x.departure)||void 0===Te?void 0:Te.airport.terminal}`:"",endTerminal:null!==(xe=null===(ke=x.arrival)||void 0===ke?void 0:ke.airport)&&void 0!==xe&&xe.terminal?`T${null===(ye=x.arrival)||void 0===ye?void 0:ye.airport.terminal}`:"",flightNumber:x.flightNumber||"N/A",duration:x.getDurationString(),shortDuration:(0,Qe.N)(x.duration),key:x.key||"N/A",operating:x.operating||"N/A",operatingName:x.operatingName||"N/A",codeAirline:x.codeAirline||"N/A",checkedBaggage:(null===(De=x.bookedInfo)||void 0===De?void 0:De.checkedBaggage)||"N/A",fareClass:(null===(Be=x.bookedInfo)||void 0===Be?void 0:Be.fareClass)||"N/A",fareType:(null===(Ee=x.bookedInfo)||void 0===Ee?void 0:Ee.fareType)||(null===(Ae=x.bookedInfo)||void 0===Ae?void 0:Ae.fareClass)||"",fareBasic:(null===(Ie=x.bookedInfo)||void 0===Ie?void 0:Ie.fareBasic)||"N/A",handBaggage:(null===(Se=x.bookedInfo)||void 0===Se?void 0:Se.handBaggage)||"N/A",accompaniedService:_.getAccompaniedService(v.key),modelAirplane:x.modelAirplane||"N/A",stopPoint:je?`D\u1eebng t\u1ea1i: ${this._locationDataService.getAirportNameByCode(x.departure.airport.code)} (${x.departure.airport.code}). Th\u1eddi gian d\u1eebng: ${je}`:"",status:(null===(Pe=x.bookedInfo)||void 0===Pe?void 0:Pe.status)||""}}))||[],journeyStatus:{active:null!==(j=null===(K=v.status)||void 0===K?void 0:K.active)&&void 0!==j&&j,cancelled:null!==(V=null===(J=v.status)||void 0===J?void 0:J.cancelled)&&void 0!==V&&V,disrupted:null!==(ce=null===(le=v.status)||void 0===le?void 0:le.disrupted)&&void 0!==ce&&ce}}}))||[],passengers:(null===(ae=_.passengers)||void 0===ae?void 0:ae.map(v=>{var O,F,M,L,U,q,w,R,K,j,J,V;return{index:v.index,name:v.getName(),firstName:v.firstName||"N/A",lastName:v.lastName||"N/A",type:v.getType(),farePrice:(null===(O=_.fareCharges)||void 0===O?void 0:O.getBaseCharge(v.type))-(null===(F=_.fareCharges)||void 0===F?void 0:F.getDiscount(v.type)),tax:(null===(M=_.fareCharges)||void 0===M?void 0:M.getTaxCharge(v.type))||0,vat:(null===(L=_.fareCharges)||void 0===L?void 0:L.getVATCharge(v.type))||0,discountAmount:(null===(U=_.fareCharges)||void 0===U?void 0:U.getDiscountByPercent(v.type,this.discountPercentage,_.provider,_.journeys.length))||0,get totalDiscountFarePrice(){return this.total-this.discountAmount},total:(null===(q=_.fareCharges)||void 0===q?void 0:q.getTotalCharge(v.type))||0,key:v.key||"N/A",parentKey:v.parentKey||"N/A",birthday:v.birthday||"N/A",namePrefix:v.namePrefix||"N/A",gender:v.gender||"N/A",documentType:v.document&&(null===(w=v.document[0])||void 0===w?void 0:w.documentType)||"",issuanceDate:v.document&&(null===(R=v.document[0])||void 0===R?void 0:R.issuanceDate)||"",expiryDate:v.document&&(null===(K=v.document[0])||void 0===K?void 0:K.expiryDate)||"",issuanceCountry:v.document&&(null===(j=v.document[0])||void 0===j?void 0:j.issuanceCountry)||"",nationality:v.document&&(null===(J=v.document[0])||void 0===J?void 0:J.nationality)||"",number:v.document&&(null===(V=v.document[0])||void 0===V?void 0:V.number)||"",defaultDocumentInfo:v.defaultDocumentInfo,membershipNumber:v.membershipNumber}}))||[],actions:this.getListTicketAction(_.state,_.provider),bookingTextExplain:null==_?void 0:_.bookingTextExplain,serviceFeeDetail:_.serviceFeeDetail,isVJCancelAllJourney:"VJ"==_.airline&&0==_.journeys.length,ticketingAllowed:null!==(re=null===(se=_.bookDetail)||void 0===se?void 0:se.ticketingAllowed)&&void 0!==re&&re,isMultiJourney:this.checkMultiJourney()}]}initPriceDetail(){var t,n,i,o;this.priceDetail={provider:[this.bookingDetailResult.data.provider],totalBasePrice:null===(t=this.bookingDetailResult.data.totalCharges)||void 0===t?void 0:t.total.totalFareCharge,totalDiscountBasePrice:0,totalServiceFee:null===(n=this.bookingDetailResult.data.totalCharges)||void 0===n?void 0:n.total.totalServiceFee,totalAddonService:this.computeTotalChargeAddOn(),totalOthersCharge:null===(i=this.bookingDetailResult.data.totalCharges)||void 0===i?void 0:i.total.totalOthersCharge,passengers:this.passengers.map(a=>{var r,c,b,u,h,l;return{name:a.name,type:a.typeName,base:(null===(r=this.bookingDetailResult.data.fareCharges)||void 0===r?void 0:r.getBaseCharge(a.type))-(null===(c=this.bookingDetailResult.data.fareCharges)||void 0===c?void 0:c.getDiscount(a.type)),tax:(null===(b=this.bookingDetailResult.data.fareCharges)||void 0===b?void 0:b.getTaxCharge(a.type))+(null===(u=this.bookingDetailResult.data.fareCharges)||void 0===u?void 0:u.getVATCharge(a.type)),discountAmount:null===(h=this.bookingDetailResult.data.fareCharges)||void 0===h?void 0:h.getDiscountByPercent(a.type,this.discountPercentage,this.bookingDetailResult.data.provider,this.bookingDetailResult.data.journeys.length),total:null===(l=this.bookingDetailResult.data.fareCharges)||void 0===l?void 0:l.getTotalCharge(a.type),get totalDiscountFarePrice(){return this.total-this.discountAmount}}})},this.totalDiscountAmount=null===(o=this.priceDetail.passengers)||void 0===o?void 0:o.reduce((a,r)=>a+((null==r?void 0:r.discountAmount)||0),0),this.priceDetail.totalDiscountBasePrice=this.priceDetail.totalBasePrice-this.totalDiscountAmount,this.bookingDetails.forEach(a=>{a.totalDiscountFare=a.totalFare-this.totalDiscountAmount})}initTotalPrice(){var t;this.totalPrice=null===(t=this.bookingDetailResult.data.totalCharges)||void 0===t?void 0:t.total.total,this.totalDiscountFareCharge=this.totalPrice-this.totalDiscountAmount}onActionChange(t,n){if(this.isLockPnr&&(!this._permissionService.isBooker()||this.isPreviewPnr)&&!["boarding_pass"].includes(t))return this.isLoading=!0,void setTimeout(()=>{if(this.isLoading=!1,this._detectMobileService.isMobile()){const o=this._bottomSheetService.open(p.Q4,{headerTitle:"Th\xf4ng b\xe1o",rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4",data:{title:"",body:"K\u1ebft n\u1ed1i t\u1edbi h\xe3ng h\xe0ng kh\xf4ng \u0111ang kh\xf4ng \u1ed5n \u0111\u1ecbnh. Vui l\xf2ng li\xean h\u1ec7 Booker \u0111\u1ec3 \u0111\u01b0\u1ee3c h\u1ed7 tr\u1ee3.",okText:"\u0110\xf3ng",cancelText:"",hasIcon:!0,status:"info"}});o.containerInstance._rightButtonClick.subscribe(()=>{o.dismiss()})}else this._modal.open(p.V0,{title:"Th\xf4ng b\xe1o",body:"K\u1ebft n\u1ed1i t\u1edbi h\xe3ng h\xe0ng kh\xf4ng \u0111ang kh\xf4ng \u1ed5n \u0111\u1ecbnh. Vui l\xf2ng li\xean h\u1ec7 Booker \u0111\u1ec3 \u0111\u01b0\u1ee3c h\u1ed7 tr\u1ee3.",okText:"\u0110\xf3ng",cancelText:"",hasCancel:!1})},300);const i={airline:n.airlineSystem,bookingCode:n.bookingCode,payNow:"ISSUED"===n.status,bookingStatus:n.status,provider:n.provider||"",supplier:n.supplier||null};switch(t){case"addon_baggage":return this.onAddonBaggage(i,n);case"addon_seat":return this.onAddonSeat(i,n);case"void":return this.onVoidBooking();case"issue":return this.onIssueBooking(i,n);case"boarding_pass":return this.onShowBoardingPass(n);case"delete_segments":case"cancel_booking":return this.onDeleteSegment(n);case"copy_pnr":return this.onCopyBookingCode(n.bookingCode);case"register_order":return this._eventLogService.captureOpenFormDownFare({hasPNR:1,source:1}),this.onRegisterOrder(n);case"send_email":return this.onSendEmail(n);case"rerouting":return this.onRerouting(i,n);case"add_journey":return this.onAddonJourney(n);case"delete_each_journey":return this.onDeleteEachJourney(n);case"separate_passengers":return this.onSeparatePassengers(n);case"check_in_online":return this.onCheckInOnline(n);case"update_pax_info":return this.onUpdatePaxInfo(n);case"open_audit_log":return this.onOpenAuditLog(n);case"snapshot_pnr":return this.onPreviewPnr();case"rebook_pnr":return this.onRebookPnr();case"update_membership":return this.onUpdateMembership();case"add_infant":return this.onAddInfant();case"recalculate_price":return this.getBookingDetail(!1,!0);case"calculate_fare":return this.onCalculateFare();default:return}}checkRuleMMBVJ(t){return t.provider===E.QK.VJ&&"BOOKED"===t.status&&this._systemService.isFeatureEnabled(E.Ke.Web_Features_LogicVJ_OnNewLogicVJModify_Enable)}handleMMBVJ(t,n){if(this._mobileDetectService.isMobile()){const i=this._bottomSheetService.open(p.V0,{headerTitle:"Kh\xf4ng th\u1ec3 ti\u1ebfp t\u1ee5c",leftButtonIcon:"arrow_left",leftButtonIconClass:"text-neutral-gray-4",rightButtonIcon:"",containerFullHeigh:!0,data:{title:"",body:`<div>T\u1eeb ng\xe0y ${E.BK} Vietjet Air c\u1eadp nh\u1eadt ch\xednh s\xe1ch y\xeau c\u1ea7u \u0111\u1ea1i l\xfd ph\u1ea3i thanh to\xe1n (xu\u1ea5t v\xe9) ngay khi mua h\xe0nh l\xfd/ch\u1ed7 ng\u1ed3i, th\xeam h\xe0nh tr\xecnh, \u0111\u1ed5i h\xe0nh tr\xecnh, h\u1ee7y h\xe0nh tr\xecnh tr\xean v\xe9 tr\u1ea1ng th\xe1i "\u0110ang gi\u1eef ch\u1ed7".\n                      \u0110\u1ea1i l\xfd vui l\xf2ng xu\u1ea5t v\xe9 tr\u01b0\u1edbc khi s\u1eed d\u1ee5ng c\xe1c t\xednh n\u0103ng tr\xean.</div></br>\n                      B\u1ea1n c\xf3 mu\u1ed1n th\u1ef1c hi\u1ec7n xu\u1ea5t v\xe9 n\xe0y kh\xf4ng?`,okText:"X\xe1c nh\u1eadn",cancelText:"\u0110\xf3ng",hasIcon:!1}});i.containerInstance._leftButtonClick.subscribe(o=>i.dismiss()),i.afterDismissed().subscribe(o=>{o&&this.onIssueBooking(t,n)})}else this._modal.open(p.V0,{title:"Kh\xf4ng th\u1ec3 ti\u1ebfp t\u1ee5c",body:`<div>T\u1eeb ng\xe0y ${E.BK} Vietjet Air c\u1eadp nh\u1eadt ch\xednh s\xe1ch y\xeau c\u1ea7u \u0111\u1ea1i l\xfd ph\u1ea3i thanh to\xe1n (xu\u1ea5t v\xe9) ngay khi mua h\xe0nh l\xfd/ch\u1ed7 ng\u1ed3i, th\xeam h\xe0nh tr\xecnh, \u0111\u1ed5i h\xe0nh tr\xecnh, h\u1ee7y h\xe0nh tr\xecnh tr\xean v\xe9 tr\u1ea1ng th\xe1i "\u0110ang gi\u1eef ch\u1ed7".\n                      \u0110\u1ea1i l\xfd vui l\xf2ng xu\u1ea5t v\xe9 tr\u01b0\u1edbc khi s\u1eed d\u1ee5ng c\xe1c t\xednh n\u0103ng tr\xean.</div></br>\n                      B\u1ea1n c\xf3 mu\u1ed1n th\u1ef1c hi\u1ec7n xu\u1ea5t v\xe9 n\xe0y kh\xf4ng?`,okText:"X\xe1c nh\u1eadn",cancelText:"\u0110\xf3ng",hasIcon:!1}).afterClosed$.subscribe({next:o=>{o.data&&this.onIssueBooking(t,n)}})}handleMMBVJCancelBoooking(){if(this._mobileDetectService.isMobile()){const t=this._bottomSheetService.open(p.V0,{headerTitle:"Kh\xf4ng th\u1ec3 ti\u1ebfp t\u1ee5c",leftButtonIcon:"arrow_left",leftButtonIconClass:"text-neutral-gray-4",rightButtonIcon:"",containerFullHeigh:!0,data:{title:"",body:`<div>T\u1eeb ng\xe0y ${E.BK} Vietjet Air c\u1eadp nh\u1eadt ch\xednh s\xe1ch y\xeau c\u1ea7u \u0111\u1ea1i l\xfd ph\u1ea3i thanh to\xe1n (xu\u1ea5t v\xe9) ngay khi mua h\xe0nh l\xfd/ch\u1ed7 ng\u1ed3i, th\xeam h\xe0nh tr\xecnh, \u0111\u1ed5i h\xe0nh tr\xecnh, h\u1ee7y h\xe0nh tr\xecnh tr\xean v\xe9 tr\u1ea1ng th\xe1i "\u0110ang gi\u1eef ch\u1ed7".\n                      \u0110\u1ea1i l\xfd vui l\xf2ng li\xean h\u1ec7 Booker \u0111\u1ec3 \u0111\u01b0\u1ee3c h\u1ed7 tr\u1ee3 H\u1ee7y h\xe0nh tr\xecnh.</div>`,okText:"\u0110\xf3ng",hasIcon:!1,hasCancel:!1}});t.containerInstance._leftButtonClick.subscribe(n=>t.dismiss())}else this._modal.open(p.V0,{title:"Kh\xf4ng th\u1ec3 ti\u1ebfp t\u1ee5c",body:`<div>T\u1eeb ng\xe0y ${E.BK} Vietjet Air c\u1eadp nh\u1eadt ch\xednh s\xe1ch y\xeau c\u1ea7u \u0111\u1ea1i l\xfd ph\u1ea3i thanh to\xe1n (xu\u1ea5t v\xe9) ngay khi mua h\xe0nh l\xfd/ch\u1ed7 ng\u1ed3i, th\xeam h\xe0nh tr\xecnh, \u0111\u1ed5i h\xe0nh tr\xecnh, h\u1ee7y h\xe0nh tr\xecnh tr\xean v\xe9 tr\u1ea1ng th\xe1i "\u0110ang gi\u1eef ch\u1ed7".\n                      \u0110\u1ea1i l\xfd vui l\xf2ng li\xean h\u1ec7 Booker \u0111\u1ec3 \u0111\u01b0\u1ee3c h\u1ed7 tr\u1ee3 H\u1ee7y h\xe0nh tr\xecnh.</div>`,okText:"\u0110\xf3ng",hasIcon:!1,hasCancel:!1})}onAddonBaggage(t,n){var i;if(this.checkRuleMMBVJ(n))return void this.handleMMBVJ(t,n);if(E.PY&&"VN"===(null===(i=this.bookingDetailResult.data.airline)||void 0===i?void 0:i.toUpperCase()))return void this._modal.open(p.z5,{title:"Th\xf4ng b\xe1o",content:"H\u1ec7 th\u1ed1ng m\u1edbi Vietnam Airlines ch\u01b0a h\u1ed7 tr\u1ee3 t\xednh n\u0103ng n\xe0y. Xin li\u1ec7n h\u1ec7 booker \u0111\u1ec3 \u0111\u01b0\u1ee3c h\u1ed7 tr\u1ee3",status:"error",cancelText:"\u0110\xf3ng"});if(this.dataBaggageInput=this.mappingDataBaggageInput(),!this.dataBaggageInput.length||this.dataBaggageInput.every(a=>!a.journeys.length))return void this._toastService.add({severity:"error",summary:"Th\xeam h\xe0nh l\xfd th\u1ea5t b\u1ea1i",detail:"H\xe0nh l\xfd \u0111\xe3 c\xf3",sticky:!0});const o=Object.assign({},t);if(this._mobileDetectService.isMobile()){const a=this._bottomSheetService.open(te.AddOnBaggageModalComponent,{headerTitle:"Th\xeam h\xe0nh l\xfd",leftButtonIcon:"arrow_left",leftButtonIconClass:"text-neutral-gray-4",rightButtonIcon:"",containerFullHeigh:!0,data:{dataBaggageInput:this.dataBaggageInput,addonBaggageReq:o,type:"baggage_addon",bookingInfo:t}});a.containerInstance._leftButtonClick.subscribe(r=>a.dismiss()),a.afterDismissed().subscribe(r=>{r&&this.processAddonBaggage(t,r)})}else this._modal.open(te.AddOnBaggageModalComponent,{dataBaggageInput:this.dataBaggageInput,addonBaggageReq:o,type:"baggage_addon",bookingInfo:t}).afterClosed$.subscribe({next:r=>{this.processAddonBaggage(t,r.data)}})}processAddonBaggage(t,n){var i;const o=n;if(o&&o.success)if(this._mobileDetectService.isMobile()){const a=this._bottomSheetService.open(p.z5,{headerTitle:"",rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4",leftButtonIcon:"",data:{title:"Th\xeam h\xe0nh l\xfd th\xe0nh c\xf4ng!",content:"<div>\u0110\xe3 th\xeam h\xe0nh l\xfd cho booking code:</div>",status:"success",okText:"OK",extraText:`${t.bookingCode}`}});a.containerInstance._rightButtonClick.subscribe(r=>a.dismiss()),a.afterDismissed().subscribe(r=>{this.getBookingDetail()})}else this._modal.open(p.z5,{title:"Th\xeam h\xe0nh l\xfd th\xe0nh c\xf4ng!",content:"<div>\u0110\xe3 th\xeam h\xe0nh l\xfd cho booking code:</div>",status:"success",okText:"OK",extraText:`${t.bookingCode}`}).afterClosed$.subscribe({next:r=>{this.getBookingDetail()}});if(o&&!o.success){const a=null!==(i=o.objectError.errorDescription.vi)&&void 0!==i?i:o.objectError.errorDescription.en;this._toastService.add({severity:"error",summary:"Th\xeam h\xe0nh l\xfd th\u1ea5t b\u1ea1i",detail:a,sticky:!0})}}onAddonSeat(t,n){if(this.checkRuleMMBVJ(n))return void this.handleMMBVJ(t,n);this.dataSeatInput=this.mappingDataSeatInput();const i=Object.assign({},t);if(this._mobileDetectService.isMobile()){const o=this._bottomSheetService.open(te.AddOnSeatModalComponent,{headerTitle:"Th\xeam ch\u1ed7 ng\u1ed3i",leftButtonIcon:"arrow_left",leftButtonIconClass:"text-neutral-gray-4",rightButtonIcon:"",containerFullHeigh:!0,data:{dataSeatInput:this.dataSeatInput,addonSeatReq:i,type:"seat_addon",bookingInfo:t}});o.containerInstance._leftButtonClick.subscribe(a=>o.dismiss()),o.afterDismissed().subscribe(a=>{this.processAddonSeat(t,a)})}else this._modal.open(te.AddOnSeatModalComponent,{dataSeatInput:this.dataSeatInput,addonSeatReq:i,type:"seat_addon",bookingInfo:t}).afterClosed$.subscribe({next:a=>{this.processAddonSeat(t,a.data)}})}processAddonSeat(t,n){let i=n;if(n.data&&!n.data.addOnCharges&&n.data.data&&(i=n.data),i&&i.success){const a=i.data.addOnCharges.map(r=>({charge:Object.assign({},r.charge.charge),seatInfos:{journeyKey:r.seatItem.journeyKey,mapCell:Object.assign({},r.seatItem.mapCell),passengerKey:r.seatItem.passengerKey,segmentKey:r.seatItem.segmentKey}}));if(this.bookingDetailResult.data.seatCharges.push(...a),this._getSeatCharge(),this.initPriceDetail(),this.totalPrice=this.bookingDetailResult.data.totalCharges.total.total+this.computeTotalChargeAddOn(),this._mobileDetectService.isMobile()){const r=this._bottomSheetService.open(p.z5,{headerTitle:"",rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4",leftButtonIcon:"",data:{title:"Th\xeam ch\u1ed7 ng\u1ed3i th\xe0nh c\xf4ng!",content:"<div>\u0110\xe3 th\xeam ch\u1ed7 ng\u1ed3i cho booking code:</div>",status:"success",okText:"OK",extraText:`${t.bookingCode}`}});r.containerInstance._rightButtonClick.subscribe(c=>r.dismiss()),r.afterDismissed().subscribe(c=>{this.getBookingDetail()})}else this._modal.open(p.z5,{title:"Th\xeam ch\u1ed7 ng\u1ed3i th\xe0nh c\xf4ng!",content:"<div>\u0110\xe3 th\xeam ch\u1ed7 ng\u1ed3i cho booking code:</div>",status:"success",okText:"OK",extraText:`${t.bookingCode}`}).afterClosed$.subscribe({next:c=>{this.getBookingDetail()}})}if(i&&!i.success){const o=i.objectError.errorDescription.vi?i.objectError.errorDescription.vi:i.objectError.errorDescription.en;if(this._mobileDetectService.isMobile()){const a=this._bottomSheetService.open(p.z5,{headerTitle:"",rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4",leftButtonIcon:"",data:{title:"Th\xeam ch\u1ed7 ng\u1ed3i th\u1ea5t b\u1ea1i",content:`<div>\n                        <div>${o}</div>\n                        <div>Vui l\xf2ng th\u1eed l\u1ea1i sau!</div>\n                    </div>`,status:"error",okText:"Th\u1eed l\u1ea1i",cancelText:"\u0110\xf3ng"}});a.containerInstance._rightButtonClick.subscribe(r=>a.dismiss())}else this._modal.open(p.z5,{title:"Th\xeam ch\u1ed7 ng\u1ed3i th\u1ea5t b\u1ea1i",content:`<div>\n                      <div>${o}</div>\n                      <div>Vui l\xf2ng th\u1eed l\u1ea1i sau!</div>\n                  </div>`,status:"error",okText:"Th\u1eed l\u1ea1i",cancelText:"\u0110\xf3ng"})}}mappingDataBaggageInput(){const t=this.bookingDetailResult.data;let n=t.passengers.filter(i=>"INFANT"!==i.type).map(i=>{var o;return{passengerKey:i.key,passengerType:i.type,passengerName:i.lastName+" "+i.firstName,addBaggageFee:(null===(o=i.passengerDerivativeFee)||void 0===o?void 0:o.addBaggageFee)||0,journeys:t.journeys.filter(a=>{const r=t.ssrCharges?t.ssrCharges.filter(c=>"baggage"===c.ssrInfo.category.name.toLowerCase()&&c.ssrInfo.journeyKey===a.key&&c.ssrInfo.passengerKey===i.key):[];return!("VN"===a.airline&&r.length>=this.maxBag||"VN"!==a.airline&&r.length)&&a}).map(a=>{const r=S(a.departure.localTime).toDate();return{airlineName:this._flightDataService.getAirlineSystemNameByCode(a.airline),airlineLogo:this._flightDataService.getAirlineLogoByCode(a.airline),journeyKey:a.key,flight:a.airline.concat(" ",a.segments[0].flightNumber),flightNumber:a.segments[0].flightNumber,journeyName:`D\u1ecbch v\u1ee5 b\u1ed5 sung ${a.departure.airport.code}-${a.arrival.airport.code}, ${(0,I.p6)(r,"EEEE, ","vi-VN")} ${r.getDate()} th\xe1ng ${r.getMonth()+1}, ${r.getFullYear()}`,leg:a.leg,fareOptionKey:"",startCode:a.departure.airport.code,endCode:a.arrival.airport.code,startTime:(0,I.p6)(new Date(a.departure.localTime),"EEEE, dd/MM/yyyy","vi-VN"),baggageOptions:[],baggageSelected:{baggageName:"",baggageKey:"",containerKey:"",totalCharge:0}}})}});return n=n.filter(i=>i.journeys.length),n}mappingDataSeatInput(){const t=this.bookingDetailResult.data;return t.journeys.map(i=>({segments:i.segments.map(o=>{const a=S(o.departure.localTime).toDate(),r=`${(0,I.p6)(a,"EEEE, ","vi-VN")} ${a.getDate()} th\xe1ng ${a.getMonth()+1}, ${a.getFullYear()}`;return{airline:o.airline,flightNumber:o.flightNumber,bookingCode:t.bookingCode,serviceName:`Th\xeam ch\u1ed7 ng\u1ed3i tr\xean chuy\u1ebfn bay ${o.departure.airport.code}-${o.arrival.airport.code}, ${r}`,airlineLogo:this._flightDataService.getAirlineLogoByCode(o.airline),jetCode:"N/A",startCode:o.departure.airport.code,endCode:o.arrival.airport.code,departDate:r,passengers:t.passengers.filter(c=>"INFANT"!==c.type).map(c=>{var b,u,h;const l=null===(b=t.seatCharges)||void 0===b?void 0:b.find(k=>k.seatInfos.passengerKey===c.key&&k.seatInfos.journeyKey===i.key&&k.seatInfos.segmentKey===o.key),m=!(null===(u=t.passengers)||void 0===u||!u.find(k=>k.parentKey==c.key));return{passengerName:`${c.lastName} ${c.firstName}`,passengerType:c.type.toLowerCase(),passengerKey:c.key,includeInfant:m,addSeatFee:(null===(h=c.passengerDerivativeFee)||void 0===h?void 0:h.addSeatFee)||0,seatSelected:{containerKey:"",seat:l?l.seatInfos.mapCell.seatNumber:"",seatKey:l?l.seatInfos.key:"",totalPrice:l?l.charge.total:0}}}),segmentKey:o.key,segmentIndex:o.index,journeyKey:i.key,leg:i.leg,active:!1,seatSegment:{rows:[],cols:[],containerKey:"",seatMaps:[]},available:!(t.seatCharges&&t.seatCharges.some(c=>c.seatInfos.journeyKey===i.key&&c.seatInfos.segmentKey===o.key))}})})).flatMap(i=>i.segments).map((i,o)=>Object.assign(Object.assign({},i),{active:0===o}))}mappingJourneyBasic(){this.listJourneyBasic=this.bookingDetails.filter(t=>"INVALID"!==t.status).map(t=>({journeyInfo:t.journeys.map(n=>({airlineLogo:n.airlineLogo,flight:`${n.startPoint} - ${n.endPoint}`,startTime:n.startTime?(0,I.p6)(new Date(n.startTime),"dd/MM/yyyy","vi-VN"):void 0,journeyKey:n.key}))})).flatMap(t=>t.journeyInfo)}computeTotalChargeAddOn(){return this.listBaggage.reduce((i,o)=>i+o.totalCharge,0)+this.listService.reduce((i,o)=>i+o.totalCharge,0)}_getSeatCharge(){this.listService.length=0;const t=this.bookingDetailResult.data,n=t.journeys.flatMap(o=>o.segments),i=t.passengers;if(t.seatCharges&&t.seatCharges.length){const o=t.seatCharges.map(a=>{const r=i.find(b=>b.key===a.seatInfos.passengerKey),c=n.find(b=>b.key===a.seatInfos.segmentKey);return{airline:c.airline||"",airlineName:c?this._flightDataService.getAirlineNameByCode(c.airline):"",airlineLogo:c?this._flightDataService.getAirlineLogoByCode(c.airline):"",journeyKey:a.journeyKey||"",segmentKey:a.segmentKey||"",flight:c?c.departure.airport.code+" - "+c.arrival.airport.code:"",flightName:c?this._locationDataService.getCityNameByCode(c.departure.airport.code)+" - "+this._locationDataService.getCityNameByCode(c.arrival.airport.code):"",flightNumber:c?`${c.airline}${c.flightNumber}`:"",departDate:c?(0,I.p6)(new Date(c.departure.localTime),"dd/MM/yyyy","vi-VN"):"",passengerKey:r?r.key:"",passengerName:r?r.lastName+" "+r.firstName:"",serviceKey:"",totalCharge:a.charge.total,serviceName:a.seatInfos.mapCell.seatNumber?a.seatInfos.mapCell.seatNumber:a.seatInfos.mapCell.row+a.seatInfos.mapCell.identifier,categoryName:"seat"}});this.listService.push(...o)}this.hasSeatSelected=this.listService.some(o=>o)}_getBaggageCharge(){const t=this.bookingDetailResult.data,n=t.journeys,i=t.passengers;if(t.ssrCharges&&t.ssrCharges.length){const o=t.ssrCharges.map(a=>{const r=i.find(b=>b.key===a.ssrInfo.passengerKey),c=n.find(b=>b.key===a.ssrInfo.journeyKey);return{airline:(null==c?void 0:c.airline)||"",airlineName:c?this._flightDataService.getAirlineNameByCode(c.airline):"",airlineLogo:c?this._flightDataService.getAirlineLogoByCode(c.airline):"",journeyKey:c?c.key:"",segmentKey:"",flight:c?c.departure.airport.code+" - "+c.arrival.airport.code:"",flightName:c?this._locationDataService.getCityNameByCode(c.departure.airport.code)+" - "+this._locationDataService.getCityNameByCode(c.arrival.airport.code):"",flightNumber:"",departDate:c?(0,I.p6)(new Date(c.departure.localTime),"dd/MM/yyyy","vi-VN"):"",passengerKey:r?r.key:"",passengerName:r?r.lastName+" "+r.firstName:"",serviceKey:"",totalCharge:a.charge.total,serviceName:a.ssrInfo.name,categoryName:a.ssrInfo.category.name.toLowerCase()}});this.listBaggage.push(...o)}this.hasBaggageSelected=this.listBaggage.some(o=>o)}getOtherCharge(){var t;const i=o=>{switch(o.toUpperCase()){case"MODIFY":return"Thay \u0111\u1ed5i h\xe0nh tr\xecnh";case"CANCEL":return"H\u1ee7y h\xe0nh tr\xecnh";default:return""}};this.listOtherCharge=(null===(t=this.bookingDetailResult.data.otherCharges)||void 0===t?void 0:t.map(o=>({chargeTypeName:i(o.otherChargeInfo.code),description:o.otherChargeInfo.category.description,totalCharge:o.charge.total})))||[]}onVoidBooking(){if(this._mobileDetectService.isMobile()){const t=this._bottomSheetService.open(D.hF,{headerTitle:"Void v\xe9",leftButtonIcon:"close",leftButtonIconClass:"text-neutral-gray-4",rightButtonIcon:"",containerFullHeigh:!0,data:{bookingCode:this.bookingCode,airline:this.airline}});t.containerInstance._leftButtonClick.subscribe(n=>t.dismiss()),t.afterDismissed().subscribe(n=>{n&&this.getBookingDetail()})}else this._modal.open(D.hF,{bookingCode:this.bookingCode,airline:this.airline}).afterClosed$.subscribe({next:n=>{n.data&&this.getBookingDetail()}})}getIssueData(t){var n;const i=null===(n=t.passengers.filter(a=>"INF"!==a.type))||void 0===n?void 0:n.map(a=>{const r=t.passengers.filter(c=>"INF"===c.type).find(c=>c.parentKey===a.key);return{firstName:a.firstName,lastName:a.lastName,type:a.type,child:r?{firstName:r.firstName,lastName:r.lastName,type:r.type}:null}});return{bookingCode:t.bookingCode,passengers:i,segments:t.journeys.flatMap(a=>a.segments).map(a=>({flightNumber:`${a.airline}${a.flightNumber}`,startCode:a.startPoint,endCode:a.endPoint,route:`${a.startPoint}${a.endPoint}`,departDate:a.startTime?(0,I.p6)(a.startTime,"dMMM","en-US"):"",startTime:a.startTime?(0,I.p6)(a.startTime,"HH:mm","vi-VN"):"",endTime:a.endTime?(0,I.p6)(a.endTime,"HH:mm","vi-VN"):""})),totalCharge:this.totalDiscountFareCharge&&this.hasDiscountFare?this.totalDiscountFareCharge:this.totalPrice}}onIssueBooking(t,n){var i,o;if("ISSUED"===t.status&&E.PY&&"VN"===(null===(i=t.airline)||void 0===i?void 0:i.toUpperCase()))return void this._modal.open(p.z5,{title:"Th\xf4ng b\xe1o",content:"H\u1ec7 th\u1ed1ng m\u1edbi Vietnam Airlines ch\u01b0a h\u1ed7 tr\u1ee3 t\xednh n\u0103ng n\xe0y. Xin li\u1ec7n h\u1ec7 booker \u0111\u1ec3 \u0111\u01b0\u1ee3c h\u1ed7 tr\u1ee3",status:"error",cancelText:"\u0110\xf3ng"});const a_title="Xu\u1ea5t v\xe9 th\xe0nh c\xf4ng",a_content="M\xe3 \u0111\u1eb7t ch\u1ed7 \u0111\xe3 \u0111\u01b0\u1ee3c xu\u1ea5t v\xe9 th\xe0nh c\xf4ng!",r={title:"Xu\u1ea5t v\xe9 th\u1ea5t b\u1ea1i",content:"Xu\u1ea5t s\u1ed1 v\xe9 kh\xf4ng th\xe0nh c\xf4ng. Vui l\xf2ng th\u1eed l\u1ea1i ho\u1eb7c li\xean h\u1ec7 booker \u0111\u1ec3 \u0111\u01b0\u1ee3c h\u1ed7 tr\u1ee3!",status:"error"},c={agentId:"",bookingCode:t.bookingCode,bookingPrice:0,internal:!0,provider:t.provider||"",checkDiscountFee:!0,passengers:[]},b=this.bookingDetails[0].passengers.some(u=>u.defaultDocumentInfo);if("BSP"===(null===(o=t.provider)||void 0===o?void 0:o.toUpperCase())&&b){const u=h=>{c.passengers=this.bookingDetails[0].passengers.map(l=>{const m=h.find(k=>k.index==k.index);return{documentInfo:[{documentType:"PASSPORT",issuanceDate:null!=m&&m.issuanceDate&&S(null==m?void 0:m.issuanceDate).format("YYYY-MM-DD")||"",expiryDate:null!=m&&m.expiryDate&&S(null==m?void 0:m.expiryDate).format("YYYY-MM-DD")||"",issuanceCountry:(null==m?void 0:m.issuanceCountry)||"",nationality:(null==m?void 0:m.nationality)||"",number:(null==m?void 0:m.number)||""}],index:l.index}}),this.isLoading=!0,this._manageBookingService.issueTicket(c).pipe((0,A.x)(()=>this.isLoading=!1)).subscribe({next:l=>{if(this.isLoading=!0,"OK"===l.status&&l.data)this._toastService.add({severity:"success",summary:a_title,detail:a_content,sticky:!1}),this.getBookingDetail();else if("DS-EL005"===l.objectError.errorCode){const m=l.objectError.errorData.priceInfo.newPrice-l.objectError.errorData.priceInfo.oldPrice,k={newPrice:l.objectError.errorData.priceInfo.newPrice,oldPrice:l.objectError.errorData.priceInfo.oldPrice,priceGap:Math.abs(m),type:m>0?"+":"-"};this._modal.open(Z.EH,{priceChangeData:k}).afterClosed$.subscribe({next:y=>{y.data&&(this.isLoading=!0,this._manageBookingService.issueTicket(c).pipe((0,A.x)(()=>this.isLoading=!1)).subscribe({next:P=>{"OK"===P.status?(this._toastService.add({severity:"success",summary:a_title,detail:a_content,sticky:!1}),this.getBookingDetail()):"DS-EH001"===P.objectError.errorCode?this.hanldeTimeoutIssue():(r.content=P.objectError.errorDescription.vi?P.objectError.errorDescription.vi:P.objectError.errorDescription.en,this._toastService.add({severity:r.status,summary:r.title,detail:r.content,sticky:!0}))},error:P=>{P instanceof N.W?this.hanldeTimeoutIssue():(r.content=l.objectError.errorDescription.vi?l.objectError.errorDescription.vi:l.objectError.errorDescription.en,this._toastService.add({severity:r.status,summary:r.title,detail:r.content,sticky:!0}))}}))}})}else if("BE-EF045"===l.objectError.errorCode){const m={newPrice:l.objectError.errorData.newPriceTicket,oldPrice:l.objectError.errorData.oldPriceTicket,get priceGap(){return Math.abs(this.newPrice-this.oldPrice)},type:l.objectError.errorData.discountChange};if(this._detectMobileService.isMobile()){const k=this._bottomSheetService.open(Z.Gn,{headerTitle:"Th\xf4ng b\xe1o thay \u0111\u1ed5i chi\u1ebft kh\u1ea5u",rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4",data:{discountChangeData:m}});k.containerInstance._rightButtonClick.subscribe(()=>{k.dismiss()}),k.afterDismissed().subscribe({next:g=>{g&&(this.isLoading=!0,c.checkDiscountFee=!1,this._manageBookingService.issueTicket(c).pipe((0,A.x)(()=>this.isLoading=!1)).subscribe({next:y=>{"OK"===y.status?(this._toastService.add({severity:"success",summary:a_title,detail:a_content,sticky:!1}),this.getBookingDetail()):"DS-EH001"===y.objectError.errorCode?this.hanldeTimeoutIssue():(r.content=y.objectError.errorDescription.vi?y.objectError.errorDescription.vi:y.objectError.errorDescription.en,this._toastService.add({severity:r.status,summary:r.title,detail:r.content,sticky:!0}))},error:y=>{y instanceof N.W?this.hanldeTimeoutIssue():(r.content=l.objectError.errorDescription.vi?l.objectError.errorDescription.vi:l.objectError.errorDescription.en,this._toastService.add({severity:r.status,summary:r.title,detail:r.content,sticky:!0}))}}))}})}else this._modal.open(Z.Gn,{discountChangeData:m}).afterClosed$.subscribe({next:g=>{g.data&&(this.isLoading=!0,c.checkDiscountFee=!1,this._manageBookingService.issueTicket(c).pipe((0,A.x)(()=>this.isLoading=!1)).subscribe({next:y=>{"OK"===y.status?(this._toastService.add({severity:"success",summary:a_title,detail:a_content,sticky:!1}),this.getBookingDetail()):"DS-EH001"===y.objectError.errorCode?this.hanldeTimeoutIssue():(r.content=y.objectError.errorDescription.vi?y.objectError.errorDescription.vi:y.objectError.errorDescription.en,this._toastService.add({severity:r.status,summary:r.title,detail:r.content,sticky:!0}))},error:y=>{y instanceof N.W?this.hanldeTimeoutIssue():(r.content=l.objectError.errorDescription.vi?l.objectError.errorDescription.vi:l.objectError.errorDescription.en,this._toastService.add({severity:r.status,summary:r.title,detail:r.content,sticky:!0}))}}))}})}else"DS-EH001"===l.objectError.errorCode?this.hanldeTimeoutIssue():(r.content=l.objectError.errorDescription.vi?l.objectError.errorDescription.vi:l.objectError.errorDescription.en,this._toastService.add({severity:r.status,summary:r.title,detail:r.content,sticky:!0}))},error:l=>{l instanceof N.W?this.hanldeTimeoutIssue():this._toastService.add({severity:r.status,summary:r.title,detail:r.content,sticky:!0})}})};if(this._detectMobileService.isMobile()){const h=this._bottomSheetService.open(p.V0,{headerTitle:"Kh\xf4ng th\u1ec3 ti\u1ebfp t\u1ee5c",rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4",data:{title:"",body:"C\u1ea7n b\u1ed5 sung \u0111\u1ea7y \u0111\u1ee7 th\xf4ng tin h\u1ed9 chi\u1ebfu c\u1ee7a h\xe0nh kh\xe1ch tr\u01b0\u1edbc khi xu\u1ea5t v\xe9",okText:"B\u1ed5 sung",cancelText:"\u0110\xf3ng",hasIcon:!0}});h.containerInstance._rightButtonClick.subscribe(()=>{h.dismiss()}),h.afterDismissed().subscribe({next:l=>{if(l){const m=[];this.bookingDetails[0].passengers.forEach((g,y)=>{m.push({index:g.index,key:g.key||"",name:g.lastName+" "+g.firstName,parentKey:"N/A"==g.parentKey||null==g.parentKey?"":g.parentKey,type:g.type,child:"N/A",selected:0==y,gender:g.gender,firstName:g.firstName,lastName:g.lastName,dayOfBirth:g.birthday?g.birthday:"",parentName:"",fullType:g.type,issuanceDate:g.issuanceDate,expiryDate:g.expiryDate,issuanceCountry:g.issuanceCountry,nationality:g.nationality,number:g.number})});const k=this._bottomSheetService.open(D.vj,{headerTitle:"Ch\u1ec9nh s\u1eeda h\u1ed9 chi\u1ebfu",rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4",containerFullHeigh:!0,data:{listPaxUpdate:m}});k.containerInstance._rightButtonClick.subscribe(()=>{k.dismiss()}),k.afterDismissed().subscribe({next:g=>{g&&u(g)}})}}})}else this._modal.open(p.V0,{title:"Kh\xf4ng th\u1ec3 ti\u1ebfp t\u1ee5c",body:"C\u1ea7n b\u1ed5 sung \u0111\u1ea7y \u0111\u1ee7 th\xf4ng tin h\u1ed9 chi\u1ebfu c\u1ee7a h\xe0nh kh\xe1ch tr\u01b0\u1edbc khi xu\u1ea5t v\xe9",okText:"B\u1ed5 sung",cancelText:"\u0110\xf3ng"}).afterClosed$.subscribe({next:l=>{if(l.data){const m=[];this.bookingDetails[0].passengers.forEach((g,y)=>{m.push({index:g.index,key:g.key||"",name:g.lastName+" "+g.firstName,parentKey:"N/A"==g.parentKey||null==g.parentKey?"":g.parentKey,type:g.type,child:"N/A",selected:0==y,gender:g.gender,firstName:g.firstName,lastName:g.lastName,dayOfBirth:g.birthday?g.birthday:"",parentName:"",fullType:g.type,issuanceDate:g.issuanceDate,expiryDate:g.expiryDate,issuanceCountry:g.issuanceCountry,nationality:g.nationality,number:g.number})}),this._modal.open(D.vj,{listPaxUpdate:m}).afterClosed$.subscribe({next:g=>{g.data&&u(g.data)}})}}})}else{const u=()=>{this.isLoading=!0,this._manageBookingService.issueTicket(c).pipe((0,A.x)(()=>this.isLoading=!1)).subscribe({next:h=>{if(this.isLoading=!0,"OK"===h.status&&h.data)this._toastService.add({severity:"success",summary:a_title,detail:a_content,sticky:!1}),this.getBookingDetail();else if("DS-EL005"===h.objectError.errorCode){const l=h.objectError.errorData.priceInfo.newPrice-h.objectError.errorData.priceInfo.oldPrice,m={newPrice:h.objectError.errorData.priceInfo.newPrice,oldPrice:h.objectError.errorData.priceInfo.oldPrice,priceGap:Math.abs(l),type:l>0?"+":"-"};this._modal.open(Z.EH,{priceChangeData:m}).afterClosed$.subscribe({next:g=>{g.data&&(this.isLoading=!0,this._manageBookingService.issueTicket(c).pipe((0,A.x)(()=>this.isLoading=!1)).subscribe({next:y=>{"OK"===y.status?(this._toastService.add({severity:"success",summary:a_title,detail:a_content,sticky:!1}),this.getBookingDetail()):"DS-EH001"===y.objectError.errorCode?this.hanldeTimeoutIssue():(r.content=y.objectError.errorDescription.vi?y.objectError.errorDescription.vi:y.objectError.errorDescription.en,this._toastService.add({severity:r.status,summary:r.title,detail:r.content,sticky:!0}))},error:y=>{y instanceof N.W?this.hanldeTimeoutIssue():(r.content=h.objectError.errorDescription.vi?h.objectError.errorDescription.vi:h.objectError.errorDescription.en,this._toastService.add({severity:r.status,summary:r.title,detail:r.content,sticky:!0}))}}))}})}else if("BE-EF045"===h.objectError.errorCode){const l={newPrice:h.objectError.errorData.newPriceTicket,oldPrice:h.objectError.errorData.oldPriceTicket,get priceGap(){return Math.abs(this.newPrice-this.oldPrice)},type:h.objectError.errorData.discountChange};if(this._detectMobileService.isMobile()){const m=this._bottomSheetService.open(Z.Gn,{headerTitle:"Th\xf4ng b\xe1o thay \u0111\u1ed5i chi\u1ebft kh\u1ea5u",rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4",data:{discountChangeData:l}});m.containerInstance._rightButtonClick.subscribe(()=>{m.dismiss()}),m.afterDismissed().subscribe({next:k=>{k&&(this.isLoading=!0,c.checkDiscountFee=!1,this._manageBookingService.issueTicket(c).pipe((0,A.x)(()=>this.isLoading=!1)).subscribe({next:g=>{"OK"===g.status?(this._toastService.add({severity:"success",summary:a_title,detail:a_content,sticky:!1}),this.getBookingDetail()):"DS-EH001"===g.objectError.errorCode?this.hanldeTimeoutIssue():(r.content=g.objectError.errorDescription.vi?g.objectError.errorDescription.vi:g.objectError.errorDescription.en,this._toastService.add({severity:r.status,summary:r.title,detail:r.content,sticky:!0}))},error:g=>{g instanceof N.W?this.hanldeTimeoutIssue():(r.content=h.objectError.errorDescription.vi?h.objectError.errorDescription.vi:h.objectError.errorDescription.en,this._toastService.add({severity:r.status,summary:r.title,detail:r.content,sticky:!0}))}}))}})}else this._modal.open(Z.Gn,{discountChangeData:l}).afterClosed$.subscribe({next:k=>{k.data&&(this.isLoading=!0,c.checkDiscountFee=!1,this._manageBookingService.issueTicket(c).pipe((0,A.x)(()=>this.isLoading=!1)).subscribe({next:g=>{"OK"===g.status?(this._toastService.add({severity:"success",summary:a_title,detail:a_content,sticky:!1}),this.getBookingDetail()):"DS-EH001"===g.objectError.errorCode?this.hanldeTimeoutIssue():(r.content=g.objectError.errorDescription.vi?g.objectError.errorDescription.vi:g.objectError.errorDescription.en,this._toastService.add({severity:r.status,summary:r.title,detail:r.content,sticky:!0}))},error:g=>{g instanceof N.W?this.hanldeTimeoutIssue():(r.content=h.objectError.errorDescription.vi?h.objectError.errorDescription.vi:h.objectError.errorDescription.en,this._toastService.add({severity:r.status,summary:r.title,detail:r.content,sticky:!0}))}}))}})}else"DS-EH001"===h.objectError.errorCode?this.hanldeTimeoutIssue():(r.content=h.objectError.errorDescription.vi?h.objectError.errorDescription.vi:h.objectError.errorDescription.en,this._toastService.add({severity:r.status,summary:r.title,detail:r.content,sticky:!0}))},error:h=>{h instanceof N.W?this.hanldeTimeoutIssue():this._toastService.add({severity:r.status,summary:r.title,detail:r.content,sticky:!0})}})};if(this._detectMobileService.isMobile()){const h=this._bottomSheetService.open(p._3,{headerTitle:"X\xe1c nh\u1eadn xu\u1ea5t v\xe9",rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4",data:{issueDataConfirm:this.getIssueData(n)}});h.containerInstance._rightButtonClick.subscribe(()=>{h.dismiss()}),h.afterDismissed().subscribe(l=>{l&&u()})}else this._modal.open(p._3,{issueDataConfirm:this.getIssueData(n),hasWaitlistBooking:this.hasWaitlistBooking}).afterClosed$.subscribe({next:l=>{l.data&&u()}})}}onShare(){const t="origin"===this.modeBookingText?this.getOriginText():this.bookingTextExplain;this.clipboard.copy(t),this.isCopied=!0,setTimeout(()=>{this.isCopied=!1},2e3),this._mobileDetectService.isMobile()&&this._toastService.add({severity:"success",summary:"\u0110\xe3 sao ch\xe9p n\u1ed9i dung",detail:"N\u1ed9i dung \u0111\xe3 \u0111\u01b0\u1ee3c sao ch\xe9p v\xe0o b\u1ed9 nh\u1edb t\u1ea1m"})}getOriginText(){if(this.listBookingText){let t="";return this.listBookingText.forEach(n=>{var i,o,a,r,c,b,u,h,l,m,k;"VN"===n.airline?(t+=`${n.bookingCodeText}\r\n`,t+=(null!==(i=n.passengerTexts)&&void 0!==i?i:[]).join("\r\n")+"\r\n",t+=(null!==(o=n.segmentTexts)&&void 0!==o?o:[]).join("\r\n ")+"\r\n",t+="TKT/TIME LIMIT\r\n ",t+=(null!==(a=n.ticketTexts)&&void 0!==a?a:[]).join("\r\n ")+"\r\n",t+="VCR COUPON DATA EXISTS *VI TO DISPLAY\r\n",t+="PHONES\r\n ",t+=(null!==(r=n.contactTexts)&&void 0!==r?r:[]).join("\r\n ")+"\r\n",t+="PASSENGER EMAIL DATA EXISTS *PE TO DISPLAY ALL\r\n",t+="PRICE QUOTE RECORD EXISTS - *PQS\r\n",t+="FREQUENT TRAVELER\r\n",t+=(null!==(c=n.frequentTexts)&&void 0!==c?c:[]).join("\r\n ")+"\r\n",t+="TICKETED RETAINED REISSUE EXISTS - *PQS\r\n",t+="VN FACTS\r\n ",t+=(null!==(b=n.ssrTexts)&&void 0!==b?b:[]).join("\r\n ")+"\r\n",n.remarkTexts&&(t+="REMARKS\r\n ",t+=(null!==(u=n.remarkTexts)&&void 0!==u?u:[]).join("\r\n ")),t+=(null!==(h=n.agentTexts)&&void 0!==h?h:[]).join("\r\n")):(t+=`${n.bookingCodeText}\r\n`,t+=(null===(l=n.passengerTexts)||void 0===l?void 0:l.join(" "))+"\r\n",t+=(null===(m=n.segmentTexts)||void 0===m?void 0:m.join("\r\n"))+"\r\n",t+=`TOTAL PRICE: ${n.totalPrice} VND\r\n`,n.timeLimit&&(t+=`TIME LIMIT: ${n.timeLimit}\r\n`),t+=(null!==(k=n.contactTexts)&&void 0!==k?k:[]).join("\r\n"))}),t||""}return""}getExplaneText(){if(this.listBookingTextExplain){let t="";return this.listBookingTextExplain.forEach(n=>{var i;t+=(0,Ge.K)(n),t+="NOTE:\r\n",t+=null===(i=n.warning)||void 0===i?void 0:i.join("\r\n")}),t||""}return""}changeModeBookingText(t){this.modeBookingText=t}onShowBoardingPass(t){if(this._mobileDetectService.isMobile()){const n=this._bottomSheetService.open(Fe.G,{headerTitle:"M\u1eb7t v\xe9",rightButtonIcon:"",leftButtonIcon:"close",leftButtonIconClass:"text-neutral-gray-4",containerFullHeigh:!0,data:{bookingDetail:t,listBaggage:this.listBaggage,listService:this.listService,totalPrice:this.totalPrice,addonServiceCharge:(this.priceDetail.totalAddonService||0)+(this.priceDetail.totalOthersCharge||0),isMultiJourney:this.checkMultiJourney()}});n.containerInstance._leftButtonClick.subscribe(i=>n.dismiss())}else this._modal.open(Fe.G,{bookingDetail:t,listBaggage:this.listBaggage,listService:this.listService,totalPrice:this.totalPrice,addonServiceCharge:(this.priceDetail.totalAddonService||0)+(this.priceDetail.totalOthersCharge||0),isMultiJourney:this.checkMultiJourney()})}getListTicketAction(t,n){switch(t){case"BOOKED":if("VJ"===n){const i=["issue","boarding_pass","addon_baggage","addon_seat","register_order","send_email","rerouting","add_journey","delete_each_journey"];return this._permissionService.hasPermission(f.or.CanSplitPassengerVJ)&&this._systemService.isFeatureEnabled(E.Ke.Web_Features_SplitPassenger_SplitPassengerVJ_Enable)&&i.push("separate_passengers"),this._permissionService.hasPermission(f.or.CanUpdatePaxInfoVJ)&&i.push("update_pax_info"),this._permissionService.hasPermission(f.or.CanViewAuditLogVJ)&&i.push("open_audit_log"),this._permissionService.hasPermission(f.or.CanRebookPNRVJ)&&i.push("rebook_pnr"),this.actionOption.filter(o=>{if(0==this.bookingDetailResult.data.journeys.length){const a=[];return this._permissionService.hasPermission(f.or.CanAddFlightJourney)&&a.push("add_journey"),this._permissionService.hasPermission(f.or.CanRebookPNRVJ)&&a.push("rebook_pnr"),a.includes(o.value)}return i.includes(o.value)})}if("VN"===n){const i=["issue","boarding_pass","addon_baggage","addon_seat","add_journey","delete_segments","rerouting","register_order","send_email","update_membership","add_infant"];return this._permissionService.hasPermission(f.or.CanRebookPNRVN)&&i.push("rebook_pnr"),!this.isPreviewPnr&&this.isLockPnr&&i.push("snapshot_pnr"),this._permissionService.hasPermission(f.or.CanSplitPassengerVN)&&i.push("separate_passengers"),this._permissionService.hasPermission(f.or.CalculateFare)&&i.push("calculate_fare"),this.actionOption.filter(o=>i.includes(o.value))}if("GDS"===n)return this.actionOption.filter(i=>["boarding_pass"].includes(i.value));if("QH"===n)return this.actionOption.filter(i=>["issue","boarding_pass","register_order","send_email","separate_passengers"].includes(i.value));if("VU"===n)return this.actionOption.filter(i=>["issue","boarding_pass"].includes(i.value));if("SPA"===n)return this.actionOption.filter(i=>["issue","boarding_pass","addon_baggage","addon_seat"].includes(i.value));{const i=["boarding_pass"];return"BSP"===(null==n?void 0:n.toUpperCase())&&(this._permissionService.hasPermission(f.or.CanMonitorLowFareGDSTicket)&&i.push("register_order"),this._permissionService.hasPermission(f.or.CanIssuedFlightTicketBSP)&&i.push("issue"),this._permissionService.hasPermission(f.or.CancelBookingBSP)&&i.push("cancel_booking")),"AIR_1G"===(null==n?void 0:n.toUpperCase())&&(i.push("send_email"),this._permissionService.hasPermission(f.or.CanMonitorLowFareGDSTicket)&&i.push("register_order"),this._permissionService.hasPermission(f.or.CanIssuedFlightTicket1G)&&i.push("issue")),"ST"===(null==n?void 0:n.toUpperCase())&&i.push("issue"),"BZT"===(null==n?void 0:n.toUpperCase())&&(this._permissionService.hasPermission(f.or.CanIssuedFlightTicketBZT)&&i.push("issue"),this._permissionService.hasPermission(f.or.CancelBookingBZT)&&i.push("cancel_booking")),!this.isPreviewPnr&&this.isLockPnr&&i.push("snapshot_pnr"),this.actionOption.filter(o=>i.includes(o.value))}case"ISSUED":if("VN"===n){const i=["void","boarding_pass","addon_baggage","addon_seat","delete_segments","rerouting","update_membership","register_order","send_email","check_in_online"];return!this.isPreviewPnr&&this.isLockPnr&&i.push("snapshot_pnr"),this._permissionService.hasPermission(f.or.CanSplitPassengerVN)&&i.push("separate_passengers"),this.actionOption.filter(o=>i.includes(o.value))}if("GDS"===n)return this.actionOption.filter(i=>["boarding_pass"].includes(i.value));if("QH"===n){const i=["boarding_pass","addon_baggage","send_email","check_in_online","separate_passengers"];return!this.isPreviewPnr&&this.isLockPnr&&i.push("snapshot_pnr"),E.kp.qh&&i.push("addon_seat"),this.actionOption.filter(o=>i.includes(o.value))}if("VJ"===n){const i=["boarding_pass","addon_baggage","addon_seat","send_email","rerouting","add_journey","delete_each_journey","check_in_online"];return!this.isPreviewPnr&&this.isLockPnr&&i.push("snapshot_pnr"),this._permissionService.hasPermission(f.or.CanSplitPassengerVJ)&&this._systemService.isFeatureEnabled(E.Ke.Web_Features_SplitPassenger_SplitPassengerVJ_Enable)&&i.push("separate_passengers"),i.push("update_pax_info"),i.push("open_audit_log"),this.actionOption.filter(o=>0==this.bookingDetailResult.data.journeys.length?["add_journey","separate_passengers"].includes(o.value):i.includes(o.value))}if("VU"===n)return this.actionOption.filter(i=>["boarding_pass","check_in_online"].includes(i.value));if("SPA"===n)return this.actionOption.filter(i=>["boarding_pass","addon_baggage","addon_seat"].includes(i.value));{const i=["boarding_pass"];return!this.isPreviewPnr&&this.isLockPnr&&i.push("snapshot_pnr"),"BSP"===(null==n?void 0:n.toUpperCase())&&(this._permissionService.hasPermission(f.or.CanMonitorLowFareGDSTicket)&&i.push("register_order"),this._permissionService.hasPermission(f.or.CancelBookingBSP)&&i.push("cancel_booking")),"AIR_1G"===(null==n?void 0:n.toUpperCase())&&(i.push("send_email"),this._permissionService.hasPermission(f.or.CanMonitorLowFareGDSTicket)&&i.push("register_order")),this.actionOption.filter(o=>i.includes(o.value))}case"VOID":return this.actionOption.filter("VJ"===n?i=>["boarding_pass","addon_baggage","addon_seat"].includes(i.value):"GDS"===n?i=>["boarding_pass"].includes(i.value):i=>["issue","boarding_pass","delete_segments"].includes(i.value));case"CANCEL":return"VN"===n?[{value:"add_journey",name:"Th\xeam h\xe0nh tr\xecnh",icon:"",enabled:[f.or.CanAddFlightJourney].some(i=>this._permissionService.hasPermission(i))},{value:"rebook_pnr",name:"Rebook PNR",icon:"",enabled:[f.or.CanRebookPNRVN].some(i=>this._permissionService.hasPermission(i))}]:"VJ"===n?[{value:"rebook_pnr",name:"Rebook PNR",icon:"",enabled:[f.or.CanRebookPNRVJ].some(i=>this._permissionService.hasPermission(i))}]:[];default:return[]}}getListTicketInfo(){var t;const n=this.bookingDetails[0];this.listTicketInfo=(null===(t=this.bookingDetailResult.data.ticketInfos)||void 0===t?void 0:t.map(i=>(console.log(i),{ticketNumber:i.ticketNumber,journeyName:`${i.journeyDeparture} - ${i.journeyArrival}`,bookingCode:n.bookingCode,passengerName:i.passengerName,provider:n.provider,supplier:n.supplier,airline:i.airline,airlineName:i.airline,status:i.status,ticketType:i.ticketType,isDetail:!["QH","9G"].includes(i.airline)||!1})))||[],console.log(this.listTicketInfo)}getFareBasis(){this.fareBasisInfos=[],this.bookingDetails.forEach(t=>{t.journeys.forEach(n=>{n.segments.forEach(i=>{this.fareBasisInfos.push({airline:i.airline||"",airlineLogo:i.airlineLogo||"",startCode:i.startPoint||"",startPoint:i.startPointName||"",endCode:i.endPoint||"",endPoint:i.endPointName||"",fareClass:i.fareClass||"",fareBasis:i.fareBasic||""})})})})}onShowTicketInfo(t){if(E.PY&&"VN"===this.bookingDetailResult.data.airline.toUpperCase())return void this._modal.open(p.z5,{title:"Th\xf4ng b\xe1o",content:"H\u1ec7 th\u1ed1ng m\u1edbi Vietnam Airlines ch\u01b0a h\u1ed7 tr\u1ee3 t\xednh n\u0103ng n\xe0y. Xin li\u1ec7n h\u1ec7 booker \u0111\u1ec3 \u0111\u01b0\u1ee3c h\u1ed7 tr\u1ee3",status:"error",cancelText:"\u0110\xf3ng"});const n={provider:t.provider,supplier:t.supplier?t.supplier:null,ticketNumber:t.ticketNumber,ticketType:t.ticketType};this.isLoading=!0,this._manageBookingService.getTicketDetail(n).pipe((0,A.x)(()=>this.isLoading=!1)).subscribe({next:i=>{var o,a;if(i.success&&i.data){const r=this.proccessTicketDetail(i.data);if(this._mobileDetectService.isMobile()){const c=this._bottomSheetService.open(Z.co,{headerTitle:"Th\xf4ng tin s\u1ed1 v\xe9",rightButtonIcon:"",leftButtonIcon:"close",leftButtonIconClass:"text-neutral-gray-4",data:{ticketDetail:r,isAction:!1,airline:this.airline,bookingCode:this.bookingCode}});c.containerInstance._leftButtonClick.subscribe(b=>c.dismiss())}else this._modal.open(Z.co,{ticketDetail:r,isAction:!1,airline:this.airline,bookingCode:this.bookingCode})}else{const r=(null===(o=i.objectError)||void 0===o?void 0:o.errorDescription.vi)||(null===(a=i.objectError)||void 0===a?void 0:a.errorDescription.en);this._toastService.add({severity:"error",summary:"Xem s\u1ed1 v\xe9 th\u1ea5t b\u1ea1i",detail:r,sticky:!0})}}})}proccessTicketDetail(t){return{ticketImage:t.ticketImage,ticketInfo:{numCoupons:t.ticketInfo.numCoupons,issueDate:t.ticketInfo.issueDate,createDate:t.ticketInfo.createDate,bookingCode:t.ticketInfo.prn}}}onDeleteSegment(t){const n=t.journeys.flatMap(o=>o.segments).map((o,a)=>({order:a+1,segmentKey:o.key,journey:`${o.startPointName} (${o.startPoint}) - ${o.endPointName} (${o.endPoint})`,startTime:S(o.startTime).format("HH:mm DD/MM/YYYY"),flightNumber:`${o.airline}${o.flightNumber}`,status:"CREATE"})),i={airline:t.airline,bookingCode:t.bookingCode,provider:t.provider};if(this._mobileDetectService.isMobile()){const o=this._bottomSheetService.open(D.df,{headerTitle:"H\u1ee7y h\xe0nh tr\xecnh",rightButtonIcon:"",leftButtonIcon:"close",leftButtonIconClass:"text-neutral-gray-4",containerFullHeigh:!0,data:{listSegmentData:n,bookingInfo:i}});o.containerInstance._leftButtonClick.subscribe(a=>o.dismiss()),o.afterDismissed().subscribe(a=>{a&&this.getBookingDetail(!0)})}else this._modal.open(D.df,{listSegmentData:n,bookingInfo:i}).afterClosed$.subscribe({next:a=>{a.data&&this.getBookingDetail(!0)}})}togglePriceBottomSheet(t){this.isShowTotalPriceBts=!this.isShowTotalPriceBts,this.isShowTotalPriceBts?(this.showTotalPriceBts=this._bottomSheetService.open(t,{headerTitle:"Gi\xe1 v\xe9",rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4"}),this.zIndexPriceIncrease=!0,this.showTotalPriceBts.afterDismissed().subscribe(n=>{this.zIndexPriceIncrease=!1}),this.showTotalPriceBts.containerInstance._rightButtonClick.subscribe(n=>{this.showTotalPriceBts.dismiss()})):this.showTotalPriceBts&&this.showTotalPriceBts.dismiss()}mobileDetailClick(t){const n=this._bottomSheetService.open(D.iU,{headerTitle:"Chi ti\u1ebft \u0111\u1eb7t ch\u1ed7",rightButtonIcon:"",leftButtonIcon:"close",leftButtonIconClass:"text-neutral-gray-4",containerFullHeigh:!0,data:{flightInfos:[this.getFlightInfoDetail(t)],hasDiscountFare:this.hasDiscountFare,hasInternationalFlight:this.hasInternationalFlight,hasWaitlistBooking:this.hasWaitlistBooking}});n.containerInstance._leftButtonClick.subscribe(i=>{n.dismiss()})}mobileTabChange(t,n){this.mobileTabMode=t,n.scrollIntoView({behavior:"smooth",inline:"center"}),"FARE_RULE"===this.mobileTabMode&&this.getFareRule()}getFlightInfoDetail(t){var n,i,o,a,r,c;return{supplier:t.supplier,provider:t.provider,segments:t.journeys.flatMap((u,h)=>u.segments.map((l,m)=>({airline:l.airline,airlineSystem:l.airline,airlineName:l.airlineName,airlineLogo:l.airlineLogo,mobileAirlineLogo:["VJ","VN","QH"].includes(l.airline)?"assets/airline-logo/"+l.airline+"_small.png":"assets/airline-logo/"+l.airline+".png",flightNumber:l.airline+l.flightNumber,startTime:S(l.startTime).format("HH:mm"),startDate:S(l.startTime).format("DD/MM/YYYY"),startPoint:l.startPoint,startPointName:l.startPointName,startAirport:this._locationDataService.getAirportNameByCode(l.startPoint),endTime:S(l.endTime).format("HH:mm"),endDate:S(l.endTime).format("DD/MM/YYYY"),endPoint:l.endPoint,endPointName:l.endPointName,endAirport:this._locationDataService.getAirportNameByCode(l.endPoint),startTerminal:l.startTerminal,endTerminal:l.endTerminal,stopPoint:l.stopPoint,modelAirplane:l.modelAirplane,badge:0===h?"Chi\u1ec1u \u0111i":"Chi\u1ec1u v\u1ec1",rules:[{name:"T\xecnh tr\u1ea1ng ch\u1ed7",value:l.status||""},{name:"Th\u1eddi gian bay",value:l.duration},{name:"Lo\u1ea1i m\xe1y bay",value:l.modelAirplane},{name:"H\u1ea1ng ch\u1ed7",value:"QH"===l.airline?l.fareType:l.fareClass},{name:"H\xe0nh l\xfd k\xfd g\u1eedi",value:l.checkedBaggage||"N/A"},{name:"H\xe0nh l\xfd x\xe1ch tay",value:l.handBaggage||"N/A"}]}))),status:t.status,statusDesc:t.statusDesc,timeHoldBooking:t.timeHoldBooking||"",timeHoldPricing:t.timeHoldPricing||"",airlineSystem:t.airlineSystem,airlineName:t.airlineName,totalDiscountFareCharge:this.totalDiscountFareCharge||0,totalPrice:this.totalPrice||0,totalFare:t.totalFare,totalServiceFee:this.priceDetail.totalServiceFee||0,totalAddonService:this.priceDetail.totalAddonService||0,totalOthersCharge:this.priceDetail.totalOthersCharge||0,totalDiscountBasePrice:t.totalDiscountFare,passengers:t.passengers.map(u=>({name:u.name,type:u.type,farePrice:u.farePrice,discountAmount:u.discountAmount,totalDiscountFarePrice:u.totalDiscountFarePrice,tax:u.tax,vat:u.vat,total:u.total})),journeyStatus:{active:null!==(i=null===(n=t.journeys[0].journeyStatus)||void 0===n?void 0:n.active)&&void 0!==i&&i,cancelled:null!==(a=null===(o=t.journeys[0].journeyStatus)||void 0===o?void 0:o.cancelled)&&void 0!==a&&a,disrupted:null!==(c=null===(r=t.journeys[0].journeyStatus)||void 0===r?void 0:r.disrupted)&&void 0!==c&&c}}}onCopyBookingCode(t){this.clipboard.copy(t),this._toastService.add({severity:"success",summary:"\u0110\xe3 sao ch\xe9p n\u1ed9i dung",detail:"N\u1ed9i dung \u0111\xe3 \u0111\u01b0\u1ee3c sao ch\xe9p v\xe0o b\u1ed9 nh\u1edb t\u1ea1m"})}onChangeSuggest(t){switch(this._eventLogService.captureOpenFormDownFare({hasPNR:1,source:2}),t){case"register_order":this.isOpenSuggest=!1,this.onRegisterOrder(this.bookingDetails[0]);break;case"close":this.isOpenSuggest=!1}}onRegisterOrder(t){var n;if(["BSP","AIR_1G"].includes((null===(n=t.provider)||void 0===n?void 0:n.toUpperCase())||"")){const i=o=>{this.isLoading=!0,this._ticketLowFareService.registerTriggerOrderGds(o).pipe((0,A.x)(()=>this.isLoading=!1)).subscribe({next:a=>{console.log(a),this._toastService.add("OK"===a.status?{severity:"success",summary:"Th\xe0nh c\xf4ng",detail:`T\u1ea1o \u0111\u01a1n canh v\xe9 cho m\xe3 \u0111\u1eb7t ch\u1ed7 ${t.bookingCode} th\xe0nh c\xf4ng`,sticky:!1}:{severity:"error",summary:"Th\u1ea5t b\u1ea1i",detail:`T\u1ea1o \u0111\u01a1n canh v\xe9 cho m\xe3 \u0111\u1eb7t ch\u1ed7 ${t.bookingCode} th\u1ea5t b\u1ea1i. Vui l\xf2ng th\u1eed l\u1ea1i sau`,sticky:!0})},error:()=>{this._toastService.add({severity:"error",summary:"Th\u1ea5t b\u1ea1i",detail:`T\u1ea1o \u0111\u01a1n canh v\xe9 cho m\xe3 \u0111\u1eb7t ch\u1ed7 ${t.bookingCode} th\u1ea5t b\u1ea1i. Vui l\xf2ng th\u1eed l\u1ea1i sau`,sticky:!0})}})};if(this._mobileDetectService.isMobile()){const o=this._bottomSheetService.open(Ue.C,{headerTitle:"T\u1ea1o y\xeau c\u1ea7u canh v\xe9 r\u1ebb",rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4",leftButtonIcon:"",containerFullHeigh:!0,data:{bookingDetail:t}});o.containerInstance._rightButtonClick.subscribe(a=>o.dismiss()),o.afterDismissed().subscribe(a=>{a&&i({pnr:t.bookingCode,timeExpire:a})})}else this._modal.open(Ue.C,{bookingDetail:t}).afterClosed$.subscribe({next:a=>{console.log(a),a.data&&i({pnr:t.bookingCode,timeExpire:a.data})}})}else{const i={airline:t.airline,pnr:t.bookingCode};this.isLoading=!0,this._ticketLowFareService.canMonitorLowFare(i).pipe((0,A.x)(()=>this.isLoading=!1)).subscribe({next:o=>{var a,r,c,b;if("OK"===o.status&&null!==(a=o.data.canMonitor)&&void 0!==a&&a.enable)if(this._mobileDetectService.isMobile()){const u=this._bottomSheetService.open(ie.g,{headerTitle:"T\u1ea1o y\xeau c\u1ea7u canh v\xe9 r\u1ebb",rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4",leftButtonIcon:"",containerFullHeigh:!0,data:{bookingDetail:t,sourceEvent:"BOOKING_DETAIL"}});u.containerInstance._rightButtonClick.subscribe(h=>u.dismiss())}else{const u=this._modal.open(ie.g,{bookingDetail:t,sourceEvent:"BOOKING_DETAIL"});u.afterClosed$.subscribe({next:h=>{h.data||u.close(!1)}})}else if("OK"!==o.status||null!==(r=o.data.canMonitor)&&void 0!==r&&r.enable){const u=null===(b=null===(c=o.objectError)||void 0===c?void 0:c.errorDescription)||void 0===b?void 0:b.vi;if(this._mobileDetectService.isMobile()){const h=this._bottomSheetService.open(p.Q4,{headerTitle:"",rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4",data:{title:"M\xe3 \u0111\u1eb7t ch\u1ed7 kh\xf4ng h\u1ee3p l\u1ec7",body:u,okText:"Canh v\xe9 kh\xe1c",cancelText:"\u0110\xf3ng",hasIcon:!0,status:"error"}});h.containerInstance._rightButtonClick.subscribe(()=>{h.dismiss()}),h.afterDismissed().subscribe(l=>{l&&this.onRegisterNewPnrOrder()})}else this._modal.open(ne.V,{title:"M\xe3 \u0111\u1eb7t ch\u1ed7 kh\xf4ng h\u1ee3p l\u1ec7",content:u,status:"error",cancelText:"\u0110\xf3ng",okText:"Canh v\xe9 kh\xe1c",secondaryAction:!0}).afterClosed$.subscribe({next:l=>{l.data&&this.onRegisterNewPnrOrder()}})}else{let u="Xem danh s\xe1ch";u="TPS-TLF006"===o.data.canMonitor.reason.errorCode?"Qu\u1ea3n l\xfd canh v\xe9":"Canh v\xe9 kh\xe1c";const h=o.data.canMonitor.reason.desc;if(this._mobileDetectService.isMobile()){const l=this._bottomSheetService.open(p.Q4,{headerTitle:"",rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4",data:{title:"M\xe3 \u0111\u1eb7t ch\u1ed7 kh\xf4ng h\u1ee3p l\u1ec7",body:h,okText:u,cancelText:"\u0110\xf3ng",hasIcon:!0,status:"error"}});l.containerInstance._rightButtonClick.subscribe(()=>{l.dismiss()}),l.afterDismissed().subscribe(m=>{m?"TPS-TLF006"===o.data.canMonitor.reason.errorCode?this._route.navigate(["admin/manage-pnr-orders"]):this.onRegisterNewPnrOrder():l.dismiss()})}else this._modal.open(ne.V,{title:"M\xe3 \u0111\u1eb7t ch\u1ed7 kh\xf4ng h\u1ee3p l\u1ec7",content:h,status:"error",cancelText:"\u0110\xf3ng",okText:u,secondaryAction:!0}).afterClosed$.subscribe({next:m=>{m.data&&("TPS-TLF006"===o.data.canMonitor.reason.errorCode?this._route.navigate(["admin/manage-pnr-orders"]):this.onRegisterNewPnrOrder())}})}},error:()=>{const o="Canh v\xe9 kh\xe1c";if(this._mobileDetectService.isMobile()){const a=this._bottomSheetService.open(p.Q4,{headerTitle:"",rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4",data:{title:"M\xe3 \u0111\u1eb7t ch\u1ed7 kh\xf4ng h\u1ee3p l\u1ec7",body:`M\xe3 \u0111\u1eb7t ch\u1ed7 <strong>${t.bookingCode}</strong> kh\xf4ng h\u1ee3p l\u1ec7 \u0111\u1ec3 t\u1ea1o y\xeau c\u1ea7u canh v\xe9. Vui l\xf2ng canh v\xe9 v\u1edbi m\xe3 \u0111\u1eb7t ch\u1ed7 kh\xe1c.`,okText:o,cancelText:"\u0110\xf3ng",hasIcon:!0,status:"error"}});a.containerInstance._rightButtonClick.subscribe(()=>{a.dismiss()}),a.afterDismissed().subscribe(r=>{r&&this.onRegisterNewPnrOrder()})}else this._modal.open(ne.V,{title:"M\xe3 \u0111\u1eb7t ch\u1ed7 kh\xf4ng h\u1ee3p l\u1ec7",content:`M\xe3 \u0111\u1eb7t ch\u1ed7 <strong>${t.bookingCode}</strong> kh\xf4ng h\u1ee3p l\u1ec7 \u0111\u1ec3 t\u1ea1o y\xeau c\u1ea7u canh v\xe9. Vui l\xf2ng canh v\xe9 v\u1edbi m\xe3 \u0111\u1eb7t ch\u1ed7 kh\xe1c.`,status:"error",cancelText:"\u0110\xf3ng",okText:o,secondaryAction:!0}).afterClosed$.subscribe({next:r=>{r.data&&this.onRegisterNewPnrOrder()}})}})}}onRegisterNewPnrOrder(){if(this._eventLogService.captureOpenFormDownFare({hasPNR:0,source:1}),this._mobileDetectService.isMobile()){const t=this._bottomSheetService.open(ie.g,{headerTitle:"T\u1ea1o y\xeau c\u1ea7u canh v\xe9 r\u1ebb",rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4",leftButtonIcon:"",containerFullHeigh:!0,data:{isSuggest:!0,sourceEvent:"SUGGEST"}});t.containerInstance._rightButtonClick.subscribe(n=>t.dismiss())}else this._modal.open(ie.g,{isSuggest:!0,sourceEvent:"SUGGEST"})}gotoBookingDetail(t,n){this._route.navigate([`admin/booking-detail/${t}/${n}`])}gotoDownFareDetail(t){this._route.navigate([`admin/pnr-order-detail/${t}`])}onOrderDetail(t){this._route.navigate([`admin/pnr-order-detail/${t}`])}onSendEmail(t){if(this._mobileDetectService.isMobile()){const n=this._bottomSheetService.open(Le.B,{headerTitle:"Th\xf4ng tin m\u1eb7t v\xe9",leftButtonIcon:"close",leftButtonIconClass:"text-neutral-gray-4",rightButtonIcon:"",containerFullHeigh:!1,data:{emailInfo:{bookingCode:t.bookingCode,provider:t.provider,email:this.bookingContact.email}}});n.containerInstance._leftButtonClick.subscribe(i=>n.dismiss())}else this._modal.open(Le.B,{emailInfo:{bookingCode:t.bookingCode,provider:t.provider,email:this.bookingContact.email}})}hanldeTimeoutIssue(){this._mobileDetectService.isMobile()?(this.refTimoutBts=this._bottomSheetService.open(p.NK,{headerTitle:"",leftButtonIcon:"",rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4",containerFullHeigh:!1,data:{title:"\u0110ang x\u1eed l\xfd xu\u1ea5t v\xe9",body:"Qu\xfd \u0111\u1ea1i l\xfd vui l\xf2ng \u0111\u1ee3i trong gi\xe2y l\xe1t ho\u1eb7c ch\u1ee7 \u0111\u1ed9ng theo d\xf5i tr\u1ea1ng th\xe1i v\xe9 \u1edf m\u1ee5c Qu\u1ea3n l\xfd \u0111\u1eb7t ch\u1ed7",cancelText:"\u0110\xf3ng",okText:"M\u1edf qu\u1ea3n l\xfd \u0111\u1eb7t ch\u1ed7"}}),this.refTimoutBts.containerInstance._leftButtonClick.subscribe(t=>this.refTimoutBts.dismiss()),this.refTimoutBts.afterDismissed().subscribe({next:t=>{t&&this._route.navigate(["admin/manage-booking"])}})):(this.refTimoutModal=this._modal.open(p.NK,{title:"\u0110ang x\u1eed l\xfd xu\u1ea5t v\xe9",body:"Qu\xfd \u0111\u1ea1i l\xfd vui l\xf2ng \u0111\u1ee3i trong gi\xe2y l\xe1t ho\u1eb7c ch\u1ee7 \u0111\u1ed9ng theo d\xf5i tr\u1ea1ng th\xe1i v\xe9 \u1edf m\u1ee5c Qu\u1ea3n l\xfd \u0111\u1eb7t ch\u1ed7",cancelText:"\u0110\xf3ng",okText:"M\u1edf qu\u1ea3n l\xfd \u0111\u1eb7t ch\u1ed7"}),this.refTimoutModal.afterClosed$.subscribe({next:t=>{t.data&&this._route.navigate(["admin/manage-booking"])}}))}onRerouting(t,n){var i,o;if(this.checkRuleMMBVJ(n))return void this.handleMMBVJ(t,n);const a=this.bookingDetails[0].journeys.some(l=>{var m;return((null===(m=l.startTime)||void 0===m?void 0:m.getTime())||0)<=(new Date).getTime()}),b=((null===(i=this.bookingDetails[0].journeys.filter(l=>{var m;return((null===(m=l.startTime)||void 0===m?void 0:m.getTime())||0)>(new Date).getTime()})[0].startTime)||void 0===i?void 0:i.getTime())||0)-(new Date).getTime()<=E.J$;if("VN"===n.provider&&a)return void this._modal.open(p.V0,{title:"Kh\xf4ng th\u1ec3 ti\u1ebfp t\u1ee5c",body:"H\u1ec7 th\u1ed1ng ch\u01b0a h\u1ed7 tr\u1ee3 \u0111\u1ed5i h\xe0nh tr\xecnh tr\xean v\xe9 c\xf3 ch\u1eb7ng \u0111\xe3 bay, vui l\xf2ng li\xean h\u1ec7 Booker \u0111\u1ec3 \u0111\u01b0\u1ee3c h\u1ed7 tr\u1ee3.",okText:"\u0110\xf3ng",hasCancel:!1});if(b)return void this._modal.open(p.V0,{title:"C\xf3 l\u1ed7i x\u1ea3y ra",body:"Kh\xf4ng th\u1ec3 \u0110\u1ed5i h\xe0nh tr\xecnh khi g\u1ea7n gi\u1edd bay, li\xean h\u1ec7 Booker \u0111\u1ec3 \u0111\u01b0\u1ee3c h\u1ed7 tr\u1ee3.",okText:"\u0110\xf3ng",hasCancel:!1});if(n.provider===E.QK.VN&&"ISSUED"===n.status&&(this.listBaggage.some(l=>l.airline===E.QK.VN)||this.listService.some(l=>l.airline===E.QK.VN)))return void this._modal.open(p.V0,{title:"Thay \u0111\u1ed5i h\xe0nh tr\xecnh th\u1ea5t b\u1ea1i",body:"V\xe9 \u0111\xe3 xu\u1ea5t c\xf3 mua h\xe0nh l\xfd/ch\u1ed7 ng\u1ed3i, vui l\xf2ng li\xean h\u1ec7 Booker \u0111\u1ec3 \u0111\u01b0\u1ee3c h\u1ed7 tr\u1ee3 \u0111\u1ed5i h\xe0nh tr\xecnh.",okText:"\u0110\xf3ng",hasCancel:!1});if(this.creditShellTotal){if(this._detectMobileService.isMobile()){const l=this._bottomSheetService.open(p.Q4,{headerTitle:"Kh\xf4ng th\u1ec3 \u0110\u1ed5i h\xe0nh tr\xecnh",rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4",data:{title:"",body:"\u0110\u1ed1i v\u1edbi v\xe9 c\xf3 ho\xe0n b\u1ea3o l\u01b0u \u0111\u1ecbnh danh, vui l\xf2ng li\xean h\u1ec7 Booker \u0111\u1ec3 th\u1ef1c hi\u1ec7n \u0111\u1ed5i h\xe0nh tr\xecnh theo ch\xednh s\xe1ch c\u1ee7a h\xe3ng.",okText:"\u0110\xf3ng",cancelText:"",hasIcon:!0,status:"info"}});l.containerInstance._rightButtonClick.subscribe(()=>{l.dismiss()})}else this._modal.open(p.V0,{title:"Kh\xf4ng th\u1ec3 \u0110\u1ed5i h\xe0nh tr\xecnh",body:"\u0110\u1ed1i v\u1edbi v\xe9 c\xf3 ho\xe0n b\u1ea3o l\u01b0u \u0111\u1ecbnh danh, vui l\xf2ng li\xean h\u1ec7 Booker \u0111\u1ec3 th\u1ef1c hi\u1ec7n \u0111\u1ed5i h\xe0nh tr\xecnh theo ch\xednh s\xe1ch c\u1ee7a h\xe3ng.",okText:"\u0110\xf3ng",hasCancel:!1});return}const u=l=>{switch(l){case"ADULT":case"CHD":default:return"ADT";case"INFANT":return"INF"}};console.log("bookingDetail",n);const h={provider:n.provider,supplier:n.supplier,airline:n.airline,airlineName:n.airlineName,status:n.status,bookingCode:n.bookingCode,journeys:(null===(o=n.journeys)||void 0===o?void 0:o.map((l,m)=>{var k;return{journeyKey:l.key||"",airline:l.airline||"N/A",airlineName:l.airlineName||"N/A",airlineLogo:l.airlineLogo||"",startPointCode:l.startPoint||"N/A",startPointName:l.startPointName||"N/A",endPointCode:l.endPoint||"N/A",endPointName:l.endPointName||"N/A",segments:l.segments.map(g=>({airline:g.airline,fareClass:g.fareClass,departDate:g.startTime,endPoint:g.endPoint,flightNumber:g.flightNumber,startPoint:g.startPoint})),startTime:null!==(k=l.startTime)&&void 0!==k?k:new Date,redirectType:l.segments.length>1?"N\u1ed1i chuy\u1ebfn":"Bay th\u1eb3ng",statusText:n.statusText,selected:0===m}}))||[],passengers:this.passengers.map(l=>({name:l.name,type:l.type,typeDisplay:u(l.type),baseFare:0,taxFee:0,totalPrice:0}))};this._requestReroutingService.setBookingDetailReroutingData(h),this._route.navigate(["admin/rerouting"])}onAddonJourney(t){var n;const i=a=>{switch(a){case"ADULT":default:return"ADT";case"CHILD":return"CHD";case"INFANT":return"INF"}},o={provider:t.provider,supplier:t.supplier,airline:t.airline,airlineName:t.airlineName,status:t.status,bookingCode:t.bookingCode,journeys:(null===(n=t.journeys)||void 0===n?void 0:n.map((a,r)=>{var c;return{journeyKey:a.key||"",airline:a.airline||"N/A",airlineName:a.airlineName||"N/A",airlineLogo:a.airlineLogo||"",startPointCode:a.startPoint||"N/A",startPointName:a.startPointName||"N/A",endPointCode:a.endPoint||"N/A",endPointName:a.endPointName||"N/A",segments:a.segments.map(b=>({airline:b.airline,fareClass:b.fareClass,departDate:b.departureDate,endPoint:b.endPoint,flightNumber:b.flightNumber,startPoint:b.startPoint})),startTime:null!==(c=a.startTime)&&void 0!==c?c:new Date,redirectType:a.segments.length>1?"N\u1ed1i chuy\u1ebfn":"Bay th\u1eb3ng",statusText:t.statusText,selected:0===r}}))||[],passengers:this.passengers.map(a=>({name:a.name,type:a.type,typeDisplay:i(a.type),baseFare:0,taxFee:0,totalPrice:0}))};this._requestReroutingService.setBookingDetailReroutingData(o),this._route.navigate(["admin/add-journey"])}onDeleteEachJourney(t){this.checkRuleMMBVJ(t)?this.handleMMBVJCancelBoooking():(this.isLoading=!0,this._manageBookingService.validateBeforeModifyJourney(t.bookingCode,"CANCEL_JOURNEY").subscribe({next:n=>{this.isLoading=!1,n.status&&(1==n.data.canModify?(this.journeyForDeletes=t.journeys.map((i,o)=>({index:o,pnr:t.bookingCode,journeyKey:i.key,airlineLogoUrl:`assets/airline-logo/${i.airline}_short_logo.png`,airlineCode:i.airline,airlineName:i.airlineName,startPointCode:i.startPoint,endPointCode:i.endPoint,startPointName:i.startPointName,endPointName:i.endPointName,startDate:i.startTime,journeyType:i.segments.length>1?i.segments.length-1+" ch\u1eb7ng d\u1eebng":"Bay th\u1eb3ng",status:t.status,isSelected:0==o})),this.openSelectJourneyForCancel()):"DOWN_FARE"==n.data.type&&this._modal.open(p.V0,{title:"V\xe9 \u0111ang \u0111\u01b0\u1ee3c canh",body:"Kh\xf4ng th\u1ec3 h\u1ee7y h\xe0nh tr\xecnh khi \u0111ang canh v\xe9 r\u1ebb. Vui l\xf2ng h\u1ee7y canh v\xe9 h\xe0nh tr\xecnh n\xe0y tr\u01b0\u1edbc khi ti\u1ebfp t\u1ee5c",okText:"M\u1edf canh v\xe9",cancelText:"\u0110\xf3ng",hasIcon:!0}).afterClosed$.subscribe({next:o=>{o.data&&this.gotoDownFareDetail(n.data.orderId)}}))},error:n=>{this.isLoading=!1,console.log(n)}}))}openSelectJourneyForCancel(){if(this._detectMobileService.isMobile()){const t=this._bottomSheetService.open(D.Xg,{headerTitle:"Ch\u1ecdn h\xe0nh tr\xecnh c\u1ea7n h\u1ee7y",rightButtonIcon:"",leftButtonIcon:"close",leftButtonIconClass:"text-neutral-gray-4",containerFullHeigh:!0,data:{journeys:this.journeyForDeletes}});t.containerInstance._leftButtonClick.subscribe(n=>t.dismiss()),t.afterDismissed().subscribe(n=>{n&&this.onDeleteJourneyConfirm(n.journey,n.quotation)})}else this._modal.open(D.Xg,{journeys:this.journeyForDeletes}).afterClosed$.subscribe({next:n=>{n.data&&this.onDeleteJourneyConfirm(n.data.journey,n.data.quotation)}})}onDeleteJourneyConfirm(t,n){let i={airline:t.airlineCode,journeyKey:t.journeyKey,pnr:t.pnr,startPointCode:t.startPointCode,endPointCode:t.endPointCode,startDate:t.startDate,journeyType:t.journeyType,status:t.status,currentJourneyPrice:n.data.cancelJourney.charge.total,paid:"BOOKED"==t.status?0:"ISSUED"==t.status?n.data.cancelJourney.charge.total:0,cancelFee:n.data.cancelCharge.total,totalFee:"BOOKED"==t.status?n.data.totalCharge.total:void 0,noGiveBack:"ISSUED"==t.status?n.data.nonRefund.total:void 0,reservePrice:"ISSUED"==t.status?n.data.refund.total:void 0,totalCharge:n.data.totalCharge.total};if(this._detectMobileService.isMobile()){const o=this._bottomSheetService.open(D.mO,{headerTitle:"X\xe1c nh\u1eadn chi ph\xed",rightButtonIcon:"",leftButtonIcon:"close",leftButtonIconClass:"text-neutral-gray-4",containerFullHeigh:!0,data:{journeyConfirm:i}});o.containerInstance._leftButtonClick.subscribe(a=>o.dismiss()),o.afterDismissed().subscribe(a=>{a&&a&&("OK"==a.type&&(this._toastService.add({severity:"success",summary:"H\u1ee7y h\xe0nh tr\xecnh th\xe0nh c\xf4ng",detail:"H\xe0nh tr\xecnh \u0111\xe3 \u0111\u01b0\u1ee3c h\u1ee7y th\xe0nh c\xf4ng!",sticky:!1}),this.getBookingDetail()),"FAILED"==a.type&&"BE-EA019"==a.data&&this._modal.open(p.V0,{title:"Qu\xe1 th\u1eddi h\u1ea1n h\u1ee7y h\xe0nh tr\xecnh",body:"B\u1ea1n ch\u1ec9 c\xf3 th\u1ec3 th\u1ef1c hi\u1ec7n H\u1ee7y h\xe0nh tr\xecnh tr\u01b0\u1edbc gi\u1edd bay 24 ti\u1ebfng",okText:"\u0110\xf3ng",hasIcon:!0,hasCancel:!1}),"BACK"==a.type&&this.openSelectJourneyForCancel())})}else this._modal.open(D.mO,{journeyConfirm:i}).afterClosed$.subscribe({next:a=>{a.data&&"OK"==a.data.type&&(this._toastService.add({severity:"success",summary:"H\u1ee7y h\xe0nh tr\xecnh th\xe0nh c\xf4ng",detail:"H\xe0nh tr\xecnh \u0111\xe3 \u0111\u01b0\u1ee3c h\u1ee7y th\xe0nh c\xf4ng!",sticky:!1}),this.getBookingDetail()),"FAILED"==a.data.type&&"BE-EA019"==a.data.data&&this._modal.open(p.V0,{title:"Qu\xe1 th\u1eddi h\u1ea1n h\u1ee7y h\xe0nh tr\xecnh",body:"B\u1ea1n ch\u1ec9 c\xf3 th\u1ec3 th\u1ef1c hi\u1ec7n H\u1ee7y h\xe0nh tr\xecnh tr\u01b0\u1edbc gi\u1edd bay 24 ti\u1ebfng",okText:"\u0110\xf3ng",hasIcon:!0,hasCancel:!1}),"BACK"==a.data.type&&this.openSelectJourneyForCancel()}})}onShowIdentityReservation(){if(this._detectMobileService.isMobile()){this.zIndexPriceIncrease=!1;const t=this._bottomSheetService.open(D.$u,{headerTitle:"B\u1ea3o l\u01b0u \u0111\u1ecbnh danh h\xe0nh kh\xe1ch",rightButtonIcon:"",leftButtonIcon:"close",leftButtonIconClass:"text-neutral-gray-4",containerFullHeigh:!0,data:{info:this.identityReservationInfo}});t.containerInstance._leftButtonClick.subscribe(n=>{this.zIndexPriceIncrease=!0,t.dismiss()}),t.afterDismissed().subscribe(n=>this.zIndexPriceIncrease=!0)}else this._modal.open(D.$u,{info:this.identityReservationInfo})}onSeparatePassengers(t){const n=[];if(t.passengers.filter(i=>"INF"!==i.type).forEach(i=>{n.push({index:i.index,key:i.key||"",name:i.name,parentKey:i.parentKey||"",type:i.type,child:"N/A",selected:!1})}),t.passengers.filter(i=>"INF"===i.type).forEach(i=>{const o=n.find(a=>a.key===i.parentKey);o&&(o.child=i.name)}),n.length>=2)if(this._detectMobileService.isMobile()){const i=this._bottomSheetService.open(D.zb,{headerTitle:"Ch\u1ecdn h\xe0nh kh\xe1ch c\u1ea7n t\xe1ch",rightButtonIcon:"",leftButtonIcon:"close",leftButtonIconClass:"text-neutral-gray-4",containerFullHeigh:!0,data:{listPassengers:n,bookingDetail:t}});i.containerInstance._leftButtonClick.subscribe(()=>{i.dismiss()}),i.afterDismissed().subscribe({next:o=>{o&&(o===this.bookingCode?this.getBookingDetail():(this.bookingCode=o,this._route.navigate([`admin/booking-detail/${this.airline}/${this.bookingCode}`])))}})}else this._modal.open(D.zb,{listPassengers:n,bookingDetail:t}).afterClosed$.subscribe({next:o=>{o.data&&(o.data===this.bookingCode?this.getBookingDetail():(this.bookingCode=o.data,this._route.navigate([`admin/booking-detail/${this.airline}/${this.bookingCode}`])))}});else if(this._mobileDetectService.isMobile()){const i=this._bottomSheetService.open(p.Q4,{headerTitle:"Kh\xf4ng th\u1ec3 ti\u1ebfp t\u1ee5c",rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4",data:{title:"",body:"V\xe9 ph\u1ea3i c\xf3 t\u1ed1i thi\u1ec3u 2 kh\xe1ch \u0111\u1ec3 th\u1ef1c hi\u1ec7n thao t\xe1c t\xe1ch.",okText:"\u0110\xf3ng",cancelText:"",hasIcon:!0,status:"info"}});i.containerInstance._rightButtonClick.subscribe(()=>{i.dismiss()})}else this._modal.open(p.V0,{title:"Kh\xf4ng th\u1ec3 ti\u1ebfp t\u1ee5c",body:"V\xe9 ph\u1ea3i c\xf3 t\u1ed1i thi\u1ec3u 2 kh\xe1ch \u0111\u1ec3 th\u1ef1c hi\u1ec7n thao t\xe1c t\xe1ch.",okText:"\u0110\xf3ng",hasCancel:!1})}onCheckInOnline(t){switch(t.airline){case"QH":window.open("https://digital.bambooairways.com/ssci/identification");break;case"VN":window.open("https://booking.vietnamairlines.com/ssci/identification");break;case"VJ":window.open("https://www.vietjetair.com/vi/checkin");break;case"VU":window.open("https://booking.vietravelairlines.com/vi/checkin")}}onUpdatePaxInfo(t){const n=[];t.passengers.forEach((i,o)=>{n.push({index:i.index,key:i.key||"",name:i.lastName+" "+i.firstName,parentKey:"N/A"==i.parentKey||null==i.parentKey?"":i.parentKey,type:i.type,child:"N/A",selected:0==o,gender:i.gender,firstName:i.firstName,lastName:i.lastName,dayOfBirth:i.birthday?i.birthday:"",parentName:"",fullType:i.type})}),t.passengers.filter(i=>"INF"===i.type).forEach(i=>{const o=n.find(a=>a.key===i.parentKey);o&&(o.child=i.name)}),n.filter(i=>"INF"===i.type).forEach(i=>{const o=t.passengers.find(a=>a.key===i.parentKey);o&&(i.parentName=o.lastName+" "+o.firstName)}),this.isLoading=!0,this._manageBookingService.checkCurrentTimeBeforeDeparture(t.airline,t.bookingCode,3).subscribe({next:i=>{if("OK"===i.status&&i.data.isCurrentTimeBeforeDeparture)if(this._detectMobileService.isMobile()){const o=this._bottomSheetService.open(D.Pt,{headerTitle:"Ch\u1ecdn h\xe0nh kh\xe1ch c\u1ea7n ch\u1ec9nh s\u1eeda",rightButtonIcon:"",leftButtonIcon:"close",leftButtonIconClass:"text-neutral-gray-4",containerFullHeigh:!0,data:{listPassengers:n,bookingDetail:t}});o.containerInstance._leftButtonClick.subscribe(()=>{o.dismiss()}),o.afterDismissed().subscribe({next:a=>{"OK"==a.type&&(this._toastService.add({severity:"success",summary:"S\u1eeda th\xf4ng tin kh\xe1ch th\xe0nh c\xf4ng",detail:"Th\xf4ng tin h\xe0nh kh\xe1ch \u0111\u01b0\u1ee3c s\u1eeda th\xe0nh c\xf4ng!",sticky:!1}),this.getBookingDetail()),"FAILED"==a.type&&this._modal.open(p.V0,{title:"S\u1eeda h\xe0nh kh\xe1ch th\u1ea5t b\u1ea1i",body:a.data.errorDescription.vi,okText:"\u0110\xf3ng",hasIcon:!0,hasCancel:!1})}})}else this._modal.open(D.Pt,{listPassengers:n,bookingDetail:t}).afterClosed$.subscribe({next:a=>{"OK"==a.data.type&&(this._toastService.add({severity:"success",summary:"S\u1eeda th\xf4ng tin kh\xe1ch th\xe0nh c\xf4ng",detail:"Th\xf4ng tin h\xe0nh kh\xe1ch \u0111\u01b0\u1ee3c s\u1eeda th\xe0nh c\xf4ng!",sticky:!1}),this.getBookingDetail()),"FAILED"==a.data.type&&this._modal.open(p.V0,{title:"S\u1eeda h\xe0nh kh\xe1ch th\u1ea5t b\u1ea1i",body:a.data.data.errorDescription.vi,okText:"\u0110\xf3ng",hasIcon:!0,hasCancel:!1})}});else if(this.isLoading=!1,this._detectMobileService.isMobile()){const o=this._bottomSheetService.open(p.Q4,{headerTitle:"Qu\xe1 th\u1eddi h\u1ea1n s\u1eeda h\xe0nh kh\xe1ch",rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4",data:{title:"",body:"B\u1ea1n ch\u1ec9 c\xf3 th\u1ec3 th\u1ef1c hi\u1ec7n S\u1eeda h\xe0nh kh\xe1ch tr\u01b0\u1edbc gi\u1edd bay 3 ti\u1ebfng",okText:"\u0110\xf3ng",cancelText:"",hasIcon:!0,status:"info"}});o.containerInstance._rightButtonClick.subscribe(()=>{o.dismiss()})}else this._modal.open(p.V0,{title:"Qu\xe1 th\u1eddi h\u1ea1n s\u1eeda h\xe0nh kh\xe1ch",body:"B\u1ea1n ch\u1ec9 c\xf3 th\u1ec3 th\u1ef1c hi\u1ec7n S\u1eeda h\xe0nh kh\xe1ch tr\u01b0\u1edbc gi\u1edd bay 3 ti\u1ebfng",okText:"\u0110\xf3ng",hasCancel:!1})},error:i=>{this.isLoading=!1}})}onOpenAuditLog(t){this.isLoading=!0,this._manageBookingService.getAuditLog(t.airline,t.bookingCode).subscribe({next:n=>{if(this.isLoading=!1,"OK"===n.status){let i=n.data.auditLogs.map(o=>({dateTime:o.dateAndTime,reservation:o.reservation,user:o.user,description:o.description,oldValue:o.oldValue,newValue:o.newValue}));if("VJ"==t.airline)if(this._detectMobileService.isMobile()){const o=this._bottomSheetService.open(D.z_,{headerTitle:"Ki\u1ec3m to\xe1n \u0111\u1eb7t ch\u1ed7",rightButtonIcon:"",leftButtonIcon:"close",leftButtonIconClass:"text-neutral-gray-4",containerFullHeigh:!0,data:{auditLogs:i,pnr:t.bookingCode}});o.containerInstance._leftButtonClick.subscribe(()=>{o.dismiss()}),o.afterDismissed().subscribe({next:a=>{}})}else this._modal.open(D.z_,{auditLogs:i,pnr:t.bookingCode}).afterClosed$.subscribe({next:a=>{}})}},error:n=>{this.isLoading=!1}})}getFareRule(){const t={journeyInfo:[{provider:this.bookingDetails[0].provider,journeyKey:this.bookingDetails[0].journeys[0].key||"",bookingCode:this.bookingDetails[0].bookingCode||""}]};this.isLoading=!0,this._searchFlightService.getFareRule(t).pipe((0,A.x)(()=>this.isLoading=!1)).subscribe({next:n=>{"OK"===n.status?(this.fareRuleBsp=n.data,this._detectMobileService.isMobile()||this._modal.open(D.a7,{fareRuleBsp:this.fareRuleBsp,isBsp:!0})):this._toastService.add({severity:"error",summary:"C\xf3 l\u1ed7i x\u1ea3y ra",detail:"Kh\xf4ng th\u1ec3 xem th\xf4ng tin \u0111i\u1ec1u ki\u1ec7n gi\xe1 v\xe9",sticky:!0})},error:()=>{this._toastService.add({severity:"error",summary:"C\xf3 l\u1ed7i x\u1ea3y ra",detail:"Kh\xf4ng th\u1ec3 xem th\xf4ng tin \u0111i\u1ec1u ki\u1ec7n gi\xe1 v\xe9",sticky:!0})}})}onRefreshPnr(){this.getBookingDetail(!0)}onLockPnr(){const t="M\u1edf kh\xf3a PNR",n="X\xe1c nh\u1eadn kh\xf3a PNR",i=o=>{this.isLoading=!0;const a={actionType:o,airline:this.bookingDetails[0].airline,provider:this.bookingDetails[0].provider,bookingCode:this.bookingDetails[0].bookingCode};this._manageBookingService.lockPnr(a).pipe((0,A.x)(()=>this.isLoading=!1)).subscribe({next:r=>{var c;if("OK"===r.status){this.isLockPnr="LOCKED"===r.data.state;const b=Object.assign(Object.assign({},r),{data:(0,qe.yE)(Me.eG,r.data.bookingRetrieveData,{excludeExtraneousValues:!0})});this.handleBoookingDetailResult(b),this._toastService.add({severity:"success",summary:"Th\xe0nh c\xf4ng",detail:`M\xe3 \u0111\u1eb7t ch\u1ed7 <strong>${a.bookingCode}</strong> \u0111\xe3 \u0111\u01b0\u1ee3c ${this.isLockPnr?"kh\xf3a":"m\u1edf kh\xf3a"} th\xe0nh c\xf4ng!`,sticky:!1})}else{const b=null!==(c=r.objectError.errorDescription.vi)&&void 0!==c?c:r.objectError.errorDescription.en;this._toastService.add({severity:"error",summary:"Th\u1ea5t b\u1ea1i",detail:b,sticky:!0})}},error:()=>{this._toastService.add({severity:"error",summary:"C\xf3 l\u1ed7i x\u1ea3y ra",detail:`Kh\xf4ng th\u1ec3 thao t\xe1c ${this.isLockPnr?"kh\xf3a":"m\u1edf kh\xf3a"} tr\xean m\xe3 \u0111\u1eb7t ch\u1ed7 <strong>${a.bookingCode}</strong> ngay l\xfac n\xe0y. Vui l\xf2ng th\u1eed l\u1ea1i sau!`,sticky:!0})}})};if(this.isLockPnr)if(this._detectMobileService.isMobile()){const o=this._bottomSheetService.open(p.Q4,{headerTitle:t,rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4",data:{title:"",body:"",okText:"M\u1edf kh\xf3a",cancelText:"H\u1ee7y",hasIcon:!1,status:"info"}});o.containerInstance._rightButtonClick.subscribe(()=>{o.dismiss()}),o.afterDismissed().subscribe({next:a=>{a&&i("UNLOCKED")}})}else this._modal.open(p.V0,{title:"",body:t,okText:"M\u1edf kh\xf3a",cancelText:"H\u1ee7y",hasIcon:!1}).afterClosed$.subscribe({next:a=>{a.data&&i("UNLOCKED")}});else if(this._detectMobileService.isMobile()){const o=this._bottomSheetService.open(p.Q4,{headerTitle:n,rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4",data:{title:"",body:"",okText:"Kh\xf3a",cancelText:"H\u1ee7y",hasIcon:!1,status:"info"}});o.containerInstance._rightButtonClick.subscribe(()=>{o.dismiss()}),o.afterDismissed().subscribe({next:a=>{a&&i("LOCKED")}})}else this._modal.open(p.V0,{title:"",body:n,okText:"Kh\xf3a",cancelText:"H\u1ee7y",hasIcon:!1}).afterClosed$.subscribe({next:a=>{a.data&&i("LOCKED")}})}onPreviewPnr(){const i=`admin/booking-detail/${this.bookingDetails[0].airline}/${this.bookingDetails[0].bookingCode}?${new URLSearchParams({type:"preview",provider:this.bookingDetails[0].provider}).toString()}`;window.open(i,"_blank")}getSnapshotPnr(){const t={bookingCode:this.bookingCode,airline:this.airline,provider:this.provider};this.isLoading=!0,this._manageBookingService.getSnapshotPnr(t).pipe((0,A.x)(()=>this.isLoading=!1)).subscribe({next:n=>{var i;if("OK"===n.status){const o=Object.assign(Object.assign({},n),{data:(0,qe.yE)(Me.eG,n.data.bookingRetrieveData,{excludeExtraneousValues:!0})});this.handleBoookingDetailResult(o)}else{this.isSuccess=!1;const o=null!==(i=n.objectError.errorDescription.vi)&&void 0!==i?i:n.objectError.errorDescription.en;this.messageError=o,this._toastService.add({severity:"error",summary:"Xem chi ti\u1ebft th\u1ea5t b\u1ea1i",detail:o,sticky:!0})}},error:()=>{this.isSuccess=!1,this.messageError="\u0110\xe3 c\xf3 l\u1ed7i x\u1ea3y ra trong qu\xe1 tr\xednh th\u1ef1c hi\u1ec7n h\xe0nh \u0111\u1ed9ng n\xe0y"}})}getRebookPnrSnapshot$(t,n){return this._bookingDetailService.getRebookPnrSnapshot({provider:t,refPnr:n})}onRebookPnr(){if(this.bookingDetails[0].journeys.length>E.eH)return void this._modal.open(p.z5,{title:"C\xf3 l\u1ed7i x\u1ea3y ra!",content:"<div>Ch\u01b0a h\u1ed7 tr\u1ee3 Rebook PNR tr\xean h\xe0nh tr\xecnh \u0111a ch\u1eb7ng. Vui l\xf2ng li\xean h\u1ec7 Booker \u0111\u1ec3 \u0111\u01b0\u1ee3c h\u1ed7 tr\u1ee3</div>",status:"error"});const t=n=>{this.isLoading=!0,this._bookingDetailService.rebookPnr(n).pipe((0,A.x)(()=>this.isLoading=!1)).subscribe({next:i=>{var o,a;if("OK"===i.status){const r=i.data.bookingData.bookingCode===this.bookingDetails[0].bookingCode;this._modal.open(p.z5,{title:"\u0110\u1eb7t ch\u1ed7 th\xe0nh c\xf4ng!",content:r?"B\u1ea1n \u0111\xe3 rebook th\xe0nh c\xf4ng, m\xe3 \u0111\u1eb7t ch\u1ed7 hi\u1ec7n t\u1ea1i kh\xf4ng thay \u0111\u1ed5i":`<div>B\u1ea1n \u0111\xe3 rebook th\xe0nh c\xf4ng, m\xe3 \u0111\u1eb7t ch\u1ed7 m\u1edbi l\xe0 <strong>${i.data.bookingData.bookingCode}</strong></div>`,status:"success",okText:r?"\u0110\xf3ng":"M\u1edf booking",closeText:r?"":"\u0110\xf3ng"}).afterClosed$.subscribe({next:u=>{u.data?(this.bookingCode=i.data.bookingData.bookingCode,this.airline=i.data.bookingData.airline,this.gotoBookingDetail(i.data.bookingData.airline,i.data.bookingData.bookingCode),this.getBookingDetail()):this.getBookingDetail()}})}else{const r=(null===(a=null===(o=i.objectError)||void 0===o?void 0:o.errorDescription)||void 0===a?void 0:a.vi)||"Rebook PNR kh\xf4ng th\xe0nh c\xf4ng. Vui l\xf2ng li\xean h\u1ec7 Booker \u0111\u1ec3 \u0111\u01b0\u1ee3c h\u1ed7 tr\u1ee3";this._modal.open(p.z5,{title:"\u0110\u1eb7t ch\u1ed7 th\u1ea5t b\u1ea1i!",content:`<div>${r}</div>`,status:"error"}).afterClosed$.subscribe({next:b=>{null!=b&&b.data||this.gotoBookingDetail(this.airline,this.bookingCode)}})}},error:()=>{this._modal.open(p.z5,{title:"\u0110\u1eb7t ch\u1ed7 th\u1ea5t b\u1ea1i!",content:"<div>Rebook PNR kh\xf4ng th\xe0nh c\xf4ng. Vui l\xf2ng li\xean h\u1ec7 Booker \u0111\u1ec3 \u0111\u01b0\u1ee3c h\u1ed7 tr\u1ee3</div>",status:"error"}).afterClosed$.subscribe({next:o=>{null!=o&&o.data||this.gotoBookingDetail(this.airline,this.bookingCode)}})}})};if(this._mobileDetectService.isMobile()){const n=this._bottomSheetService.open(D.IG,{headerTitle:"",hasHeader:!1,leftButtonIcon:"close",leftButtonIconClass:"text-neutral-gray-4",rightButtonIcon:"",data:{bookingContact:this.bookingContact,bookingDetail:this.bookingDetails[0]}});n.containerInstance._leftButtonClick.subscribe(i=>n.dismiss()),n.afterDismissed().subscribe({next:i=>{i&&t(i)}})}else this._modal.open(D.IG,{bookingContact:this.bookingContact,bookingDetail:this.bookingDetails[0]}).afterClosed$.subscribe({next:i=>{i.data&&t(i.data)}})}onUpdateMembership(){const t=this.bookingDetails[0].passengers.map(i=>({key:i.key,firstName:i.firstName,lastName:i.lastName,type:i.type,membershipNumber:i.membershipNumber,canUpdate:!i.membershipNumber})),n=i=>{const o={bookingCode:this.bookingDetails[0].bookingCode,membershipInfos:i,provider:this.bookingDetails[0].provider};this.isLoading=!0,this._manageBookingService.updateMemebership(o).pipe((0,A.x)(()=>this.isLoading=!1)).subscribe({next:a=>{"OK"===a.status?(this._mobileDetectService.isMobile()?this._bottomSheetService.open(p.Q4,{headerTitle:"Th\xe0nh c\xf4ng",rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4",data:{title:"",body:"Th\xeam th\u1ebb B\xf4ng Sen V\xe0ng th\xe0nh c\xf4ng",okText:"\u0110\xf3ng",hasIcon:!1,status:"success"}}):this._modal.open(p.z5,{title:"Th\xe0nh c\xf4ng",content:"Th\xeam th\u1ebb B\xf4ng Sen V\xe0ng th\xe0nh c\xf4ng",status:"success",okText:"\u0110\xf3ng"}),this.getBookingDetail()):this._mobileDetectService.isMobile()?this._bottomSheetService.open(p.Q4,{headerTitle:"Th\u1ea5t b\u1ea1i",rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4",data:{title:"",body:"Th\xeam th\u1ebb B\xf4ng Sen V\xe0ng th\u1ea5t b\u1ea1i. Vui l\xf2ng th\u1ef1c hi\u1ec7n l\u1ea1i",okText:"\u0110\xf3ng",hasIcon:!1,status:"error"}}):this._modal.open(p.z5,{title:"Th\u1ea5t b\u1ea1i",content:"Th\xeam th\u1ebb B\xf4ng Sen V\xe0ng th\u1ea5t b\u1ea1i. Vui l\xf2ng th\u1ef1c hi\u1ec7n l\u1ea1i",status:"error",okText:"\u0110\xf3ng"})},error:()=>{this._mobileDetectService.isMobile()?this._bottomSheetService.open(p.Q4,{headerTitle:"Th\u1ea5t b\u1ea1i",rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4",data:{title:"",body:"Th\xeam th\u1ebb B\xf4ng Sen V\xe0ng th\u1ea5t b\u1ea1i. Vui l\xf2ng th\u1ef1c hi\u1ec7n l\u1ea1i",okText:"\u0110\xf3ng",hasIcon:!1,status:"error"}}):this._modal.open(p.z5,{title:"Th\u1ea5t b\u1ea1i",content:"Th\xeam th\u1ebb B\xf4ng Sen V\xe0ng th\u1ea5t b\u1ea1i. Vui l\xf2ng th\u1ef1c hi\u1ec7n l\u1ea1i",status:"error",okText:"\u0110\xf3ng"})}})};if(this._mobileDetectService.isMobile()){const i=this._bottomSheetService.open(D.OO,{headerTitle:"Th\xeam th\u1ebb B\xf4ng Sen V\xe0ng",leftButtonIcon:"close",leftButtonIconClass:"text-neutral-gray-4",rightButtonIcon:"",containerFullHeigh:!1,data:{listPax:t}});i.containerInstance._leftButtonClick.subscribe(o=>i.dismiss()),i.afterDismissed().subscribe({next:o=>{o&&n(o)}})}else this._modal.open(D.OO,{listPax:t}).afterClosed$.subscribe({next:o=>{o.data&&n(o.data)}})}onAddInfant(){var t,n,i,o;const a=null===(t=this.bookingDetails[0].passengers.filter(u=>"INF"===u.type))||void 0===t?void 0:t.map(u=>u.parentKey),r=(null===(n=this.bookingDetails[0].passengers.filter(u=>"ADT"===u.type&&!a.includes(u.key)))||void 0===n?void 0:n.map(u=>({text:u.name,value:u.key})))||[];if(this.bookingDetails[0].passengers.every(u=>"CHD"===u.type||"CHILD"===u.type))return void(this._mobileDetectService.isMobile()?this._bottomSheetService.open(p.Q4,{headerTitle:"Kh\xf4ng th\u1ec3 ti\u1ebfp t\u1ee5c",rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4",data:{title:"",body:"Kh\xf4ng th\u1ec3 th\xeam em b\xe9 v\u1edbi v\xe9 kh\xf4ng c\xf3 h\xe0nh kh\xe1ch ng\u01b0\u1eddi l\u1edbn.",okText:"\u0110\xf3ng",cancelText:"",hasIcon:!0,status:"info"}}):this._modal.open(p.V0,{title:"Kh\xf4ng th\u1ec3 ti\u1ebfp t\u1ee5c",body:"Kh\xf4ng th\u1ec3 th\xeam em b\xe9 v\u1edbi v\xe9 kh\xf4ng c\xf3 h\xe0nh kh\xe1ch ng\u01b0\u1eddi l\u1edbn.",okText:"\u0110\xf3ng",hasCancel:!1}));if(!r||!r.length)return void(this._mobileDetectService.isMobile()?this._bottomSheetService.open(p.Q4,{headerTitle:"Kh\xf4ng th\u1ec3 ti\u1ebfp t\u1ee5c",rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4",data:{title:"",body:"Kh\xf4ng th\u1ec3 th\xeam em b\xe9 v\u1edbi m\xe3 \u0111\u1eb7t ch\u1ed7 n\xe0y, t\u1ea5t c\u1ea3 ng\u01b0\u1eddi l\u1edbn \u0111\xe3 c\xf3 em b\xe9 \u0111i k\xe8m.",okText:"\u0110\xf3ng",cancelText:"",hasIcon:!0,status:"info"}}):this._modal.open(p.V0,{title:"Kh\xf4ng th\u1ec3 ti\u1ebfp t\u1ee5c",body:"Kh\xf4ng th\u1ec3 th\xeam em b\xe9 v\u1edbi m\xe3 \u0111\u1eb7t ch\u1ed7 n\xe0y, t\u1ea5t c\u1ea3 ng\u01b0\u1eddi l\u1edbn \u0111\xe3 c\xf3 em b\xe9 \u0111i k\xe8m.",okText:"\u0110\xf3ng",hasCancel:!1}));const c=u=>{"success"===u?this._mobileDetectService.isMobile()?this._bottomSheetService.open(p.Q4,{headerTitle:"Th\xe0nh c\xf4ng",rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4",data:{title:"",body:"Th\xeam em b\xe9 th\xe0nh c\xf4ng. Vui l\xf2ng ki\u1ec3m tra l\u1ea1i gi\xe1 v\xe9 \u0111\u01b0\u1ee3c c\u1eadp nh\u1eadt.",okText:"\u0110\xf3ng",hasIcon:!1,status:"success"}}).afterDismissed().subscribe({next:()=>{this.getBookingDetail()}}):this._modal.open(p.z5,{title:"Th\xe0nh c\xf4ng",content:"Th\xeam em b\xe9 th\xe0nh c\xf4ng. Vui l\xf2ng ki\u1ec3m tra l\u1ea1i gi\xe1 v\xe9 \u0111\u01b0\u1ee3c c\u1eadp nh\u1eadt.",status:"success",okText:"\u0110\xf3ng"}).afterClosed$.subscribe({next:()=>{this.getBookingDetail()}}):this._mobileDetectService.isMobile()?this._bottomSheetService.open(p.Q4,{headerTitle:"Th\u1ea5t b\u1ea1i",rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4",data:{title:"",body:"Th\xeam em b\xe9 th\u1ea5t b\u1ea1i. Vui l\xf2ng li\xean h\u1ec7 Booker \u0111\u1ec3 \u0111\u01b0\u1ee3c h\u1ed7 tr\u1ee3.",okText:"\u0110\xf3ng",hasIcon:!1,status:"error"}}).afterDismissed().subscribe({next:()=>{}}):this._modal.open(p.z5,{title:"Th\u1ea5t b\u1ea1i",content:"Th\xeam em b\xe9 th\u1ea5t b\u1ea1i. Vui l\xf2ng li\xean h\u1ec7 Booker \u0111\u1ec3 \u0111\u01b0\u1ee3c h\u1ed7 tr\u1ee3.",status:"error",okText:"\u0110\xf3ng"}).afterClosed$.subscribe({next:()=>{}})},b=u=>{const h={provider:this.bookingDetails[0].provider,bookingCode:this.bookingDetails[0].bookingCode,passengers:[{birthday:u.birthDay,firstName:u.firstName||"",gender:u.gender||"",lastName:u.lastName||"",parentKey:u.parentKey||"",membershipID:u.membershipID||"",type:"INF",setDefaultDocument:u.setDefaultDocument,defaultDocumentType:u.defaultDocumentType,documentInfo:(null==u?void 0:u.documentInfo)||[]}]};this.isLoading=!0,this._manageBookingService.addInfant(h).pipe((0,A.x)(()=>this.isLoading=!1)).subscribe({next:l=>{c("OK"===l.status&&l.data?"success":"error")},error:()=>{c("error")}})};if(this._mobileDetectService.isMobile()){const u=this._bottomSheetService.open(D.__,{headerTitle:"Th\xeam em b\xe9",leftButtonIcon:"close",leftButtonIconClass:"text-neutral-gray-4",rightButtonIcon:"",containerFullHeigh:!0,data:{departureTimestamp:(null===(i=this.bookingDetails[0].journeys[0].startTime)||void 0===i?void 0:i.getTime())||(new Date).getTime(),listAdultPassengerAvailable:r,hasAirportInternational:this.bookingDetails[0].journeys.some(h=>this._locationDataService.checkAirportInternational(h.startPoint)||this._locationDataService.checkAirportInternational(h.endPoint))}});u.containerInstance._leftButtonClick.subscribe(h=>u.dismiss()),u.afterDismissed().subscribe({next:h=>{h&&b(h)}})}else this._modal.open(D.__,{departureTimestamp:(null===(o=this.bookingDetails[0].journeys[0].startTime)||void 0===o?void 0:o.getTime())||(new Date).getTime(),listAdultPassengerAvailable:r,hasAirportInternational:this.bookingDetails[0].journeys.some(h=>this._locationDataService.checkAirportInternational(h.startPoint)||this._locationDataService.checkAirportInternational(h.endPoint))}).afterClosed$.subscribe({next:h=>{h.data&&b(h.data)}})}onCalculateFare(){this.isLoading=!0,this._manageBookingService.calculateFare({isConfirm:!0,pnr:this.bookingDetails[0].bookingCode,totalAmount:this.priceDetail.totalPrice||0}).pipe((0,A.x)(()=>this.isLoading=!1)).subscribe({next:n=>{this._modal.open(p.z5,"OK"===n.status?{title:"L\u1ea5y gi\xe1 th\u1ea5p nh\u1ea5t th\xe0nh c\xf4ng",content:"H\xe0nh l\xfd v\xe0 gh\u1ebf ng\u1ed3i s\u1ebd kh\xf4ng \u0111\u01b0\u1ee3c t\u1ef1 \u0111\u1ed9ng th\xeam s\u1eb5n, \u0111\u1ea1i l\xfd vui l\xf2ng ki\u1ec3m tra & ch\u1ee7 \u0111\u1ed9ng th\xeam m\u1edbi n\u1ebfu c\u1ea7n",status:"success",okText:"X\xe1c nh\u1eadn"}:{title:"Th\xf4ng b\xe1o",content:"Kh\xf4ng c\xf3 gi\xe1 v\xe9 th\u1ea5p h\u01a1n v\xe9 hi\u1ec7n t\u1ea1i. Vui l\xf2ng th\u1eed l\u1ea1i sau.",status:"error",okText:"\u0110\xf3ng"})}})}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(we.gz),e.Y36(ee.P3),e.Y36(B.KNP),e.Y36(Xe.G),e.Y36(et.oE),e.Y36(We._),e.Y36(tt.fB),e.Y36(it.BX),e.Y36(nt.TU),e.Y36(f.$A),e.Y36(Ne.a2),e.Y36(Re.L),e.Y36(ot.s),e.Y36(we.F0),e.Y36(at.x),e.Y36(st.$),e.Y36(rt.h),e.Y36(Re.L),e.Y36(lt.o),e.Y36(ct.t7),e.Y36(I.Ye))},s.\u0275cmp=e.Xpm({type:s,selectors:[["booking-detail-page"]],hostAttrs:[1,"md:h-full"],standalone:!0,features:[e.jDz],decls:4,vars:3,consts:[[1,"w-full","h-full"],["class","w-full h-full flex gap-x-4 justify-center p-4 md:p-0",3,"ngClass",4,"ngIf"],["class","w-full h-full p-[30px]",4,"ngIf"],["class","flex justify-center p-6",4,"ngIf"],[1,"w-full","h-full","flex","gap-x-4","justify-center","p-4","md:p-0",3,"ngClass"],[1,"w-[764px]","h-full","flex","flex-col","gap-2","md:hidden"],["class","mb-2",4,"ngIf"],[1,""],[1,"flex","justify-between","items-center","mb-4"],[1,"flex","gap-x-[20px]"],[1,"w-1","bg-primary-2-4"],[1,"text-heading-md","text-neutral-black"],["cf-button","","size","medium","type","secondary","class","justify-center gap-x-2 button-md bg-neutral-white",3,"click",4,"ngIf"],["class","w-full py-1.5 px-3 bg-red-1 text-primary-1-4 rounded flex items-center gap-x-3 mb-4",4,"ngIf"],[1,"flex","flex-col","gap-y-2"],[3,"isShowMore","bookingDetail","isBooked","hasDiscountFare","actionChange",4,"ngFor","ngForOf"],["class","bg-white rounded shadow-cf-md p-6",4,"ngIf"],[4,"ngIf"],["class","py-1.5 px-3 bg-functional-1-1 flex gap-x-2 mt-2 rounded",4,"ngIf"],[1,"mt-12","w-[340px]","h-fit","flex","flex-col","gap-y-4","md:hidden"],[3,"listBookingText","modeBookingText","bookingContact","listBookingTextExplain","actionShare","modeChange"],[3,"listBookingCode"],[1,"md:flex","hidden","flex-col","w-full"],[1,"py-2","px-4","md:flex","hidden","whitespace-nowrap","overflow-x-scroll","bg-neutral-white","sticky","min-h-[52px]","top-0","z-[1]","shadow-cf-sm"],[1,"px-4","py-1.5","rounded-full","text-espressive-md","text-neutral-gray-4","border","border-transparent",3,"click"],["bookingDetailTab",""],["paxInfoTab",""],["class","px-4 py-1.5 rounded-full text-espressive-md text-neutral-gray-4 border border-transparent",3,"text-secondary-3-4","!border-secondary-3-4","bg-secondary-3-1","click",4,"ngIf"],["class","hidden md:block pt-4 px-4",3,"actionChange",4,"ngIf"],["class","p-4 gap-y-3 md:flex md:flex-col hidden w-full",4,"ngIf"],["class","bg-neutral-white pt-3 pr-4 pb-3 pl-4 flex-row gap-0 items-end justify-end w-full fixed bottom-0 hidden md:flex",3,"z-1000","click",4,"ngIf"],["class","bg-neutral-white pt-3 pr-4 pb-3 pl-4 flex-row gap-0 items-end justify-end w-full fixed bottom-0 hidden md:flex",3,"z-1000",4,"ngIf"],["class","md:hidden",3,"actionChange",4,"ngIf"],[1,"mb-2"],["class","flex items-center gap-x-4",4,"ngIf"],[3,"passengerInfos"],[1,"flex","items-center","gap-x-4"],["class","cursor-pointer flex items-center gap-x-3",3,"click",4,"ngIf"],["type","inverted",3,"color",4,"ngIf"],["type","inverted",3,"color"],[1,"cursor-pointer","flex","items-center","gap-x-3",3,"click"],[1,"text-body-md"],[1,"pointer-events-none",3,"checked","color"],["cf-button","","size","medium","type","secondary",1,"justify-center","gap-x-2","button-md","bg-neutral-white",3,"click"],["width","16","height","16","viewBox","0 0 16 16","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M10.7016 3.35256C10.5945 3.49315 10.5476 3.6705 10.5713 3.84564C10.5949 4.02078 10.6871 4.17937 10.8276 4.28656C11.5552 4.8409 12.104 5.5968 12.4056 6.46037C12.7073 7.32393 12.7485 8.25709 12.5243 9.14392C12.3001 10.0308 11.8203 10.8322 11.1445 11.4486C10.4686 12.065 9.62659 12.4693 8.72293 12.6112L9.1956 12.1379C9.31704 12.0122 9.38423 11.8438 9.38271 11.669C9.3812 11.4942 9.31108 11.327 9.18748 11.2033C9.06387 11.0797 8.89666 11.0096 8.72187 11.0081C8.54707 11.0066 8.37867 11.0738 8.25293 11.1952L6.58627 12.8619C6.46128 12.9869 6.39107 13.1565 6.39107 13.3332C6.39107 13.51 6.46128 13.6795 6.58627 13.8046L8.25293 15.4712C8.37867 15.5927 8.54707 15.6599 8.72187 15.6583C8.89666 15.6568 9.06387 15.5867 9.18748 15.4631C9.31108 15.3395 9.3812 15.1723 9.38271 14.9975C9.38423 14.8227 9.31704 14.6543 9.1956 14.5286L8.6336 13.9672C9.82831 13.8403 10.9574 13.3576 11.8747 12.5818C12.792 11.8059 13.4553 10.7725 13.7787 9.61542C14.1021 8.45833 14.0708 7.23081 13.6887 6.09175C13.3066 4.95269 12.5914 3.95456 11.6356 3.22656C11.495 3.11948 11.3177 3.0726 11.1425 3.09622C10.9674 3.11985 10.8088 3.21205 10.7016 3.35256ZM9.41493 2.19523L7.74827 0.52856C7.62857 0.407724 7.46722 0.337206 7.29723 0.331438C7.12725 0.325671 6.96149 0.385092 6.83388 0.497538C6.70627 0.609983 6.62646 0.76695 6.6108 0.93631C6.59513 1.10567 6.64478 1.27461 6.7496 1.40856L6.80493 1.47123L7.36693 2.03323C6.19219 2.15818 5.08046 2.62712 4.17111 3.38125C3.26175 4.13538 2.59523 5.14116 2.25508 6.2725C1.91494 7.40385 1.91631 8.61043 2.25902 9.741C2.60173 10.8716 3.27053 11.8758 4.1816 12.6279C4.31837 12.7361 4.49213 12.7865 4.66558 12.7681C4.83903 12.7497 4.99838 12.6641 5.10942 12.5296C5.22047 12.395 5.27437 12.2224 5.25957 12.0486C5.24478 11.8748 5.16245 11.7137 5.03027 11.5999C4.33704 11.0274 3.82387 10.267 3.55242 9.40993C3.28097 8.55286 3.26279 7.63563 3.50006 6.76848C3.73734 5.90133 4.21998 5.12114 4.88998 4.52168C5.55998 3.92221 6.38883 3.52898 7.27693 3.38923L6.80493 3.86189C6.68537 3.98187 6.61595 4.14285 6.61078 4.31215C6.60561 4.48145 6.66508 4.64637 6.7771 4.77341C6.88912 4.90046 7.0453 4.9801 7.21391 4.99616C7.38253 5.01222 7.55094 4.9635 7.68493 4.85989L7.7476 4.80456L9.41427 3.13789C9.52905 3.0231 9.598 2.87037 9.60819 2.70835C9.61838 2.54633 9.5691 2.38616 9.4696 2.25789L9.41493 2.19523Z","fill","#212121"],[1,"w-full","py-1.5","px-3","bg-red-1","text-primary-1-4","rounded","flex","items-center","gap-x-3","mb-4"],[1,"text-body-md-short"],[3,"isShowMore","bookingDetail","isBooked","hasDiscountFare","actionChange"],[1,"bg-white","rounded","shadow-cf-md","p-6"],[1,"mb-4","flex","items-center","gap-x-3"],[1,"text-heading-sm","text-neutral-black"],[1,"table-auto","w-full"],[1,"border-b","border-neutral-gray-1"],[1,"text-left","text-espressive-sm","text-neutral-gray-4","py-3"],[4,"ngFor","ngForOf"],[1,"text-body-md","text-neutral-black","py-3"],[1,"w-[48px]","h-[24px]","object-contain",3,"src"],[1,"text-right","text-espressive-sm","text-neutral-gray-4","py-3"],[1,"text-right","text-body-md","text-neutral-black","py-3"],[1,"flex","gap-x-2","items-center"],[1,"w-[80px]","h-[40px]","object-contain","md:w-9","md:h-9",3,"src"],["class","text-left text-espressive-sm text-neutral-gray-4 py-3",4,"ngIf"],[1,"break-all","w-[200px]"],["class","text-body-md text-neutral-black py-3",4,"ngIf"],[1,"text-espressive-sm","text-secondary-3-4","cursor-pointer",3,"click"],[1,"flex","justify-between","items-center"],[1,"flex","gap-x-[20px]","my-4"],[1,"bg-white","rounded","shadow-cf-md"],[3,"priceDetail","hasDiscountFare"],[1,"p-6","flex","flex-col","items-end","gap-[10px]"],[1,"flex","items-center","gap-4"],[1,"text-espressive-md","text-neutral-black"],[1,"min-w-[140px]","text-end","text-heading-lg","text-secondary-3-4"],[4,"ngIf","ngIfElse"],["noDiscountTempl",""],["class","flex items-center gap-4",4,"ngIf"],[1,"flex","items-center","space-x-2","text-espressive-sm","font-semibold","text-secondary-3-4","cursor-pointer",3,"click"],["icon","chevron_right"],[1,"min-w-[140px]","text-end","text-body-md-short","text-neutral-gray-6"],[1,"py-1.5","px-3","bg-functional-1-1","flex","gap-x-2","mt-2","rounded"],["icon","info",1,"text-functional-1-3"],[1,"text-express-md"],[1,"ml-6"],[1,"text-body-md-short","list-disc"],[1,"px-6","pt-6","pb-6","bg-white","rounded","shadow-cf-md"],[1,"text-left","text-espressive-sm","text-neutral-gray-4","pb-3"],[1,"text-body-md","text-neutral-black","pt-4"],[1,"pt-4"],[1,"text-express-md","text-secondary-3-4","hover:underline","cursor-default","whitespace-nowrap",3,"click"],[1,"text-express-sm","rounded","py-1","px-2"],["totalPriceTab",""],["creditShellTab",""],["fareRuleTab",""],["ticketPriceTab",""],["ticketNumberTab",""],["remarkTab",""],["lowfareTab",""],["historyTab",""],[1,"hidden","md:block","pt-4","px-4",3,"actionChange"],[1,"p-4","gap-y-3","md:flex","md:flex-col","hidden","w-full"],["class","flex justify-end",4,"ngIf"],[3,"bookingDetail","onDetailClick","actionChange",4,"ngFor","ngForOf"],["class"," w-full",4,"ngIf"],[1,"flex","justify-end"],[3,"bookingDetail","onDetailClick","actionChange"],[1,"w-full"],[3,"title","active","contentClass","panelClass"],["titleTemplate",""],["class","flex flex-col mt-3 rounded-lg bg-neutral-white p-3 gap-y-2",4,"ngFor","ngForOf"],[1,"text-espressive-sm","text-neutral-black"],[1,"flex","flex-col","mt-3","rounded-lg","bg-neutral-white","p-3","gap-y-2"],[1,"flex","items-center","gap-x-5"],[1,"text-body-sm","text-neutral-gray-4","w-[104px]"],[1,"text-espressive-md","text-neutral-gray-6"],[1,"w-full","flex","justify-center","items-center","px-[15px]","py-[9px]","cursor-pointer","bg-secondary-3-1","rounded","text-heading-xs","text-secondary-3-4","mt-4",3,"click"],["class","flex flex-col rounded-lg bg-neutral-white p-3 gap-y-2",4,"ngFor","ngForOf"],[1,"flex","flex-col","rounded-lg","bg-neutral-white","p-3","gap-y-2"],["class","flex items-center gap-x-5",4,"ngIf"],[1,"text-espressive-md","text-secondary-5-3"],[1,"bg-neutral-white","pt-3","pr-4","pb-3","pl-4","flex-row","gap-0","items-end","justify-end","w-full","fixed","bottom-0","hidden","md:flex",3,"click"],[1,"flex","flex-row","gap-1","items-center","justify-start","shrink-0","relative"],[1,"text-neutral-gray-4","text-left","relative","text-espressive-xs"],[1,"text-secondary-3-4","text-center","relative","text-heading-sm"],["icon","chevron_up","size","small",4,"ngIf"],["icon","chevron_down","size","small",4,"ngIf"],["totalPriceBottomSheet",""],["icon","chevron_up","size","small"],["icon","chevron_down","size","small"],[1,"flex","flex-col","gap-4","items-start","justify-start","w-full","relative","p-4","pb-12"],[1,"flex","flex-row","gap-6","items-center","justify-start","self-stretch","shrink-0","relative"],[1,"flex","flex-row","gap-3","items-center","justify-start","flex-1","relative"],[1,"flex","flex-col","gap-1","items-start","justify-start","shrink-0","relative"],[1,"text-neutral-gray-4","text-left","relative","text-body-sm"],[1,"flex","flex-col","gap-1","items-end","justify-center","shrink-0","relative"],[1,"text-neutral-gray-4","text-right","relative","text-body-sm"],[1,"gap-y-3","md:flex","md:flex-col","hidden","w-full"],[1,"text-body-sm","text-neutral-gray-4","w-[120px]"],[1,"bg-neutral-white","pt-3","pr-4","pb-3","pl-4","flex-row","gap-0","items-end","justify-end","w-full","fixed","bottom-0","hidden","md:flex"],[3,"fareRuleBsp"],[1,"bg-neutral-white","rounded-lg","border-solid","p-4","flex","flex-col","gap-2","items-end","justify-start","shrink-0","w-full","relative","overflow-hidden"],[1,"flex","flex-row","gap-1.5","items-center","justify-start","shrink-0","relative",3,"click"],["size","small","icon","copy"],[1,"text-neutral-gray-6","text-center","relative","flex","items-center","justify-center","text-body-md"],[1,"text-body-sm","w-full",3,"bookingText"],["class","flex flex-col mt-3 rounded-lg bg-neutral-white p-3 gap-y-2",4,"ngIf"],[1,"md:hidden",3,"actionChange"],[1,"w-full","h-full","p-[30px]"],[1,"py-[120px]","shadow-cf-info-card","bg-neutral-white","rounded-lg","flex","flex-col","items-center","gap-y-8"],["src","assets/images/error.svg","alt",""],[1,"text-center","flex","flex-col","gap-y-2"],[1,"text-heading-lg"],[1,"flex","gap-x-[30px]"],["cf-button","","size","medium",3,"click"],["cfHeadIcon","","icon","refresh","size","small",1,"mr-2"],[1,"flex","justify-center","p-6"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e.YNc(1,wi,53,54,"div",1),e.YNc(2,Ri,14,1,"div",2),e.YNc(3,Ki,2,0,"div",3),e.qZA()),2&t&&(e.xp6(1),e.Q6J("ngIf",!n.isLoading&&n.isSuccess),e.xp6(1),e.Q6J("ngIf",!n.isLoading&&!n.isSuccess),e.xp6(1),e.Q6J("ngIf",n.isLoading))},dependencies:[D.Js,D.AT,D.Cg,B.AxE,B.Sm8,I.ez,I.mk,I.sg,I.O5,I.JJ,I.uU,$e.AS,p.OR,Je.j$,W.N8,W.Xq,p.bY,Ye.N,Ne.DW,D.CY,Oe.B,Oe.K,p.gx,ze,D.a7,He.I,Ve.b],encapsulation:2}),s})()}}]);