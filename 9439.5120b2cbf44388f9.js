"use strict";(self.webpackChunkcheapflightclient=self.webpackChunkcheapflightclient||[]).push([[9439],{19439:(Qt,ge,k)=>{k.r(ge),k.d(ge,{BookingSuccessPageComponent:()=>Yt});var F=k(36895),me=k(10908),pe=k(83700),ve=k(87683),x=k(72506),Te=k(44143),be=k(40529),y=k(18058),v=k(67534),q=k(6703),$=k(99251),z=k(89319),ee=k(65858),ye=k(26655),Se=k(44890),fe=k(95911),P=k(88001),r=k(40899),Be=k(89701),xe=k(64190),_e=k(94333),X=k(44586),te=k(52013),W=k(50494),A=k(15439),De=k(88996),Pe=k(95577),Ae=k(54004),Ie=k(70262),ie=k(39646),Ee=k(64307),I=k(28746),ke=k(17414),e=k(94650),Fe=k(3803),Ne=k(4520),Me=k(36634),Ze=k(86432),Re=k(3193),Oe=k(62733),we=k(28490),Ke=k(97579),Le=k(58273),Ve=k(64425),Ue=k(82761),je=k(62331),Je=k(40105),qe=k(82908),$e=k(9381),He=k(70800),Ye=k(77492),Qe=k(78533),Ge=k(27849),ze=k(9497);function Xe(c,_){1&c&&e._UZ(0,"cf-spinner")}function We(c,_){if(1&c&&(e.TgZ(0,"div",23)(1,"div",5),e._UZ(2,"div",6),e.TgZ(3,"div",7),e._uU(4,"Th\xf4ng tin h\xe0nh kh\xe1ch"),e.qZA()(),e._UZ(5,"booking-passenger-info",24),e.qZA()),2&c){const t=e.oxw();e.xp6(5),e.Q6J("passengerInfos",t.passengerInfos)}}function et(c,_){1&c&&(e.TgZ(0,"div",25)(1,"span",26),e._uU(2," H\u1ec7 th\u1ed1ng ph\xe1t hi\u1ec7n c\xf3 chuy\u1ebfn bay v\u1edbi t\xecnh tr\u1ea1ng ch\u1ed7 HL (trong danh s\xe1ch ch\u1edd), \u0111\u1ea1i l\xfd l\u01b0u \xfd ch\u1ee7 \u0111\u1ed9ng theo d\xf5i & x\u1eed l\xfd. "),e.qZA()())}const tt=function(){return["BOOKED","ISSUED"]};function it(c,_){if(1&c){const t=e.EpF();e.TgZ(0,"booking-detail",27),e.NdJ("actionChange",function(n){const a=e.CHM(t).$implicit,s=e.oxw();return e.KtG(s.onActionChange(n,a))})("retryBooking",function(n){e.CHM(t);const i=e.oxw();return e.KtG(i.onRetryBooking(n))}),e.qZA()}if(2&c){const t=_.$implicit,o=e.oxw();e.Q6J("isShowMore",!0)("paymentOrderCode",o.paymentOrderCode)("bookingDetail",t)("isBooked",e.DdM(5,tt).includes(t.status))("hasDiscountFare",o.hasDiscountFare)}}function ot(c,_){if(1&c&&(e.TgZ(0,"tr")(1,"td",35),e._UZ(2,"img",36),e.qZA(),e.TgZ(3,"td",35),e._uU(4),e.qZA(),e.TgZ(5,"td",35),e._uU(6),e.qZA(),e.TgZ(7,"td",35),e._uU(8),e.qZA(),e.TgZ(9,"td",35),e._uU(10),e.qZA(),e.TgZ(11,"td",35),e._uU(12),e.ALo(13,"number"),e.qZA()()),2&c){const t=_.$implicit;e.xp6(2),e.Q6J("src",t.airlineLogo,e.LSH),e.xp6(2),e.Oqu(t.flight),e.xp6(2),e.Oqu(t.departDate),e.xp6(2),e.Oqu(t.passengerName),e.xp6(2),e.Oqu(t.serviceName),e.xp6(2),e.Oqu(e.lcZ(13,6,t.totalCharge))}}function nt(c,_){if(1&c&&(e.TgZ(0,"div",28)(1,"div",29)(2,"span",30),e._uU(3,"H\xe0nh l\xfd & d\u1ecbch v\u1ee5 b\u1ed5 sung"),e.qZA()(),e.TgZ(4,"div")(5,"table",31)(6,"thead")(7,"tr",32)(8,"th",33),e._uU(9,"H\xe3ng bay"),e.qZA(),e.TgZ(10,"th",33),e._uU(11,"Chuy\u1ebfn bay"),e.qZA(),e.TgZ(12,"th",33),e._uU(13,"Ng\xe0y \u0111i"),e.qZA(),e.TgZ(14,"th",33),e._uU(15,"H\xe0nh kh\xe1ch"),e.qZA(),e.TgZ(16,"th",33),e._uU(17,"T\xean d\u1ecbch v\u1ee5"),e.qZA(),e.TgZ(18,"th",33),e._uU(19,"T\u1ed5ng gi\xe1"),e.qZA()()(),e.TgZ(20,"tbody"),e.YNc(21,ot,14,8,"tr",34),e.qZA()()()()),2&c){const t=e.oxw();e.xp6(21),e.Q6J("ngForOf",t.listBaggage)}}function at(c,_){if(1&c&&(e.TgZ(0,"tr")(1,"td",35),e._UZ(2,"img",36),e.qZA(),e.TgZ(3,"td",35),e._uU(4),e.qZA(),e.TgZ(5,"td",35),e._uU(6),e.qZA(),e.TgZ(7,"td",35),e._uU(8),e.qZA(),e.TgZ(9,"td",35),e._uU(10),e.qZA(),e.TgZ(11,"td",35),e._uU(12),e.ALo(13,"number"),e.qZA()()),2&c){const t=_.$implicit;e.xp6(2),e.Q6J("src",t.airlineLogo,e.LSH),e.xp6(2),e.Oqu(t.flight),e.xp6(2),e.Oqu(t.departDate),e.xp6(2),e.Oqu(t.passengerName),e.xp6(2),e.Oqu(t.serviceName),e.xp6(2),e.Oqu(e.lcZ(13,6,t.totalCharge))}}function st(c,_){if(1&c&&(e.TgZ(0,"div",28)(1,"div",29)(2,"span",30),e._uU(3,"D\u1ecbch v\u1ee5"),e.qZA()(),e.TgZ(4,"div")(5,"table",31)(6,"thead")(7,"tr",32)(8,"th",33),e._uU(9,"H\xe3ng bay"),e.qZA(),e.TgZ(10,"th",33),e._uU(11,"Chuy\u1ebfn bay"),e.qZA(),e.TgZ(12,"th",33),e._uU(13,"Ng\xe0y \u0111i"),e.qZA(),e.TgZ(14,"th",33),e._uU(15,"H\xe0nh kh\xe1ch"),e.qZA(),e.TgZ(16,"th",33),e._uU(17,"T\xean d\u1ecbch v\u1ee5"),e.qZA(),e.TgZ(18,"th",33),e._uU(19,"T\u1ed5ng gi\xe1"),e.qZA()()(),e.TgZ(20,"tbody"),e.YNc(21,at,14,8,"tr",34),e.qZA()()()()),2&c){const t=e.oxw();e.xp6(21),e.Q6J("ngForOf",t.listService)}}function rt(c,_){if(1&c&&(e.TgZ(0,"tr")(1,"td",35)(2,"div",37),e._UZ(3,"img",38),e.TgZ(4,"div"),e._uU(5),e.qZA()()(),e.TgZ(6,"td",35),e._uU(7),e.qZA(),e.TgZ(8,"td",35),e._uU(9),e.qZA(),e.TgZ(10,"td",35),e._uU(11),e.qZA()()),2&c){const t=_.$implicit,o=e.oxw(2);e.xp6(3),e.Q6J("src",t.airlineLogo,e.LSH),e.xp6(2),e.AsE("",t.startPoint," - ",t.endPoint,""),e.xp6(2),e.hij(" ",o.hasAdtPax?t.fareClass+" - "+t.fareBasis:"-"," "),e.xp6(2),e.hij(" ",o.hasChdPax?t.fareClass+" - "+t.fareBasis:"-"," "),e.xp6(2),e.hij(" ",o.hasInfPax?t.fareClass+" - "+t.fareBasis:"-"," ")}}function lt(c,_){if(1&c&&(e.TgZ(0,"div",28)(1,"div",29)(2,"span",30),e._uU(3,"H\u1ea1ng ch\u1ed7 - Fare Basis"),e.qZA()(),e.TgZ(4,"div")(5,"table",31)(6,"thead")(7,"tr",32)(8,"th",33),e._uU(9,"Ch\u1eb7ng bay"),e.qZA(),e.TgZ(10,"th",33),e._uU(11,"Ng\u01b0\u1eddi l\u1edbn (ADT)"),e.qZA(),e.TgZ(12,"th",33),e._uU(13,"Tr\u1ebb em (CHD)"),e.qZA(),e.TgZ(14,"th",33),e._uU(15,"Em b\xe9 (INF)"),e.qZA()()(),e.TgZ(16,"tbody"),e.YNc(17,rt,12,6,"tr",34),e.qZA()()()()),2&c){const t=e.oxw();e.xp6(17),e.Q6J("ngForOf",t.fareBasisInfos)}}function ct(c,_){if(1&c){const t=e.EpF();e.TgZ(0,"div")(1,"button",49),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.getFareRule())}),e._uU(2," \u0110i\u1ec1u ki\u1ec7n gi\xe1 v\xe9 "),e.qZA()()}}function ht(c,_){if(1&c&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"replace"),e.ALo(3,"number"),e.qZA()),2&c){const t=e.oxw(2);e.xp6(1),e.hij(" ",e.Dn7(2,1,e.lcZ(3,5,t.totalDiscountFareCharge),",",".")," \u0111 ")}}function dt(c,_){if(1&c&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"replace"),e.ALo(3,"number"),e.qZA()),2&c){const t=e.oxw(2);e.xp6(1),e.hij("",e.Dn7(2,1,e.lcZ(3,5,t.totalPrice),",",".")," \u0111")}}function ut(c,_){if(1&c&&(e.TgZ(0,"div")(1,"div",39)(2,"div",40),e._UZ(3,"div",6),e.TgZ(4,"div",7),e._uU(5,"T\u1ed5ng chi ph\xed h\xe0nh tr\xecnh"),e.qZA()(),e.YNc(6,ct,3,0,"div",0),e.qZA(),e.TgZ(7,"div",41),e._UZ(8,"price-detail",42),e.TgZ(9,"div",43)(10,"div",44)(11,"div",45),e._uU(12,"T\u1ed5ng chi ph\xed"),e.qZA(),e.TgZ(13,"div",46),e.YNc(14,ht,4,7,"span",47),e.YNc(15,dt,4,7,"ng-template",null,48,e.W1O),e.qZA()()()()()),2&c){const t=e.MAs(16),o=e.oxw();e.xp6(6),e.Q6J("ngIf",o.hasInternationalFlight),e.xp6(2),e.Q6J("priceDetail",o.priceDetail)("hasDiscountFare",o.hasDiscountFare),e.xp6(6),e.Q6J("ngIf",o.totalDiscountFareCharge&&o.hasDiscountFare)("ngIfElse",t)}}function gt(c,_){1&c&&(e.TgZ(0,"div",50),e._UZ(1,"cf-icon",51),e.TgZ(2,"div")(3,"div",52),e._uU(4,"L\u01b0u \xfd:"),e.qZA(),e.TgZ(5,"ul",53)(6,"li",54),e._uU(7,"Gi\xe1 v\xe9 c\xf3 th\u1ec3 thay \u0111\u1ed5i t\xf9y theo th\u1eddi \u0111i\u1ec3m \u0111\u1eb7t v\xe9, t\u1ef7 gi\xe1 v\xe0 ch\xednh s\xe1ch c\u1ee7a h\xe3ng h\xe0ng kh\xf4ng. \u0110\u1ea1i l\xfd ch\xfa \xfd ki\u1ec3m tra l\u1ea1i gi\xe1 v\xe9 m\u1edbi nh\u1ea5t t\u1ea1i b\u01b0\u1edbc Xu\u1ea5t v\xe9"),e.qZA(),e.TgZ(8,"li",54),e._uU(9," H\xe0nh tr\xecnh kh\u1edfi h\xe0nh ngo\xe0i Vi\u1ec7t Nam ch\u1ec9 \u0111\u01b0\u1ee3c b\u1ea3o \u0111\u1ea3m gi\xe1 t\u1ea1i th\u1eddi \u0111i\u1ec3m \u0111\u1eb7t v\xe9 "),e.qZA()()()())}function mt(c,_){if(1&c){const t=e.EpF();e.TgZ(0,"div",17,55),e.NdJ("click",function(){e.CHM(t);const n=e.MAs(1),i=e.oxw();return e.KtG(i.mobileTabChange("TOTAL_PRICE",n))}),e._uU(2," T\u1ed5ng chi ph\xed "),e.qZA()}if(2&c){const t=e.oxw();e.ekj("text-secondary-3-4","TOTAL_PRICE"===t.mobileTabMode)("!border-secondary-3-4","TOTAL_PRICE"===t.mobileTabMode)("bg-secondary-3-1","TOTAL_PRICE"===t.mobileTabMode)}}function pt(c,_){if(1&c){const t=e.EpF();e.TgZ(0,"div",17,56),e.NdJ("click",function(){e.CHM(t);const n=e.MAs(1),i=e.oxw();return e.KtG(i.mobileTabChange("FARE_RULE",n))}),e._uU(2," \u0110i\u1ec1u ki\u1ec7n gi\xe1 v\xe9 "),e.qZA()}if(2&c){const t=e.oxw();e.ekj("text-secondary-3-4","FARE_RULE"===t.mobileTabMode)("!border-secondary-3-4","FARE_RULE"===t.mobileTabMode)("bg-secondary-3-1","FARE_RULE"===t.mobileTabMode)}}function vt(c,_){if(1&c){const t=e.EpF();e.TgZ(0,"div",17,57),e.NdJ("click",function(){e.CHM(t);const n=e.MAs(1),i=e.oxw();return e.KtG(i.mobileTabChange("TICKET_FACE",n))}),e._uU(2," M\u1eb7t v\xe9 "),e.qZA()}if(2&c){const t=e.oxw();e.ekj("text-secondary-3-4","TICKET_FACE"===t.mobileTabMode)("!border-secondary-3-4","TICKET_FACE"===t.mobileTabMode)("bg-secondary-3-1","TICKET_FACE"===t.mobileTabMode)}}function bt(c,_){if(1&c){const t=e.EpF();e.TgZ(0,"div",17,58),e.NdJ("click",function(){e.CHM(t);const n=e.MAs(1),i=e.oxw();return e.KtG(i.mobileTabChange("TICKET_NUMBER",n))}),e._uU(2," S\u1ed1 v\xe9 "),e.qZA()}if(2&c){const t=e.oxw();e.ekj("text-secondary-3-4","TICKET_NUMBER"===t.mobileTabMode)("!border-secondary-3-4","TICKET_NUMBER"===t.mobileTabMode)("bg-secondary-3-1","TICKET_NUMBER"===t.mobileTabMode)}}function ft(c,_){if(1&c){const t=e.EpF();e.TgZ(0,"div",17,59),e.NdJ("click",function(){e.CHM(t);const n=e.MAs(1),i=e.oxw();return e.KtG(i.mobileTabChange("REMARK",n))}),e._uU(2," Remark "),e.qZA()}if(2&c){const t=e.oxw();e.ekj("text-secondary-3-4","REMARK"===t.mobileTabMode)("!border-secondary-3-4","REMARK"===t.mobileTabMode)("bg-secondary-3-1","REMARK"===t.mobileTabMode)}}function _t(c,_){if(1&c){const t=e.EpF();e.TgZ(0,"div",17,60),e.NdJ("click",function(){e.CHM(t);const n=e.MAs(1),i=e.oxw();return e.KtG(i.mobileTabChange("HISTORY",n))}),e._uU(2," L\u1ecbch s\u1eed "),e.qZA()}if(2&c){const t=e.oxw();e.ekj("text-secondary-3-4","HISTORY"===t.mobileTabMode)("!border-secondary-3-4","HISTORY"===t.mobileTabMode)("bg-secondary-3-1","HISTORY"===t.mobileTabMode)}}function kt(c,_){if(1&c){const t=e.EpF();e.TgZ(0,"booking-detail-mobile",64),e.NdJ("onDetailClick",function(){const i=e.CHM(t).$implicit,a=e.oxw(2);return e.KtG(a.mobileDetailClick(i))})("actionChange",function(n){const a=e.CHM(t).$implicit,s=e.oxw(2);return e.KtG(s.onActionChange(n,a))})("retryBooking",function(n){e.CHM(t);const i=e.oxw(2);return e.KtG(i.onRetryBooking(n))}),e.qZA()}2&c&&e.Q6J("bookingDetail",_.$implicit)}function Ct(c,_){1&c&&(e.TgZ(0,"div",69),e._uU(1,"H\xe0nh l\xfd & d\u1ecbch v\u1ee5 b\u1ed5 sung"),e.qZA())}function Tt(c,_){if(1&c&&(e.TgZ(0,"div",70)(1,"div",71)(2,"div",72),e._uU(3,"H\xe3ng bay"),e.qZA(),e.TgZ(4,"div",73),e._uU(5),e.qZA()(),e.TgZ(6,"div",71)(7,"div",72),e._uU(8,"H\xe0nh kh\xe1ch"),e.qZA(),e.TgZ(9,"div",73),e._uU(10),e.qZA()(),e.TgZ(11,"div",71)(12,"div",72),e._uU(13,"Chuy\u1ebfn bay"),e.qZA(),e.TgZ(14,"div",73),e._uU(15),e.qZA()(),e.TgZ(16,"div",71)(17,"div",72),e._uU(18,"Ng\xe0y \u0111i"),e.qZA(),e.TgZ(19,"div",73),e._uU(20),e.qZA()(),e.TgZ(21,"div",71)(22,"div",72),e._uU(23,"T\xean d\u1ecbch v\u1ee5"),e.qZA(),e.TgZ(24,"div",73),e._uU(25),e.qZA()(),e.TgZ(26,"div",71)(27,"div",72),e._uU(28,"T\u1ed5ng gi\xe1"),e.qZA(),e.TgZ(29,"div",73),e._uU(30),e.ALo(31,"replace"),e.ALo(32,"number"),e.qZA()()()),2&c){const t=_.$implicit;e.xp6(5),e.Oqu(t.airlineName),e.xp6(5),e.Oqu(t.passengerName),e.xp6(5),e.Oqu(t.flight),e.xp6(5),e.Oqu(t.departDate),e.xp6(5),e.Oqu(t.serviceName),e.xp6(5),e.hij("",e.Dn7(31,6,e.lcZ(32,10,t.totalCharge),",","."),"\u0111")}}function yt(c,_){if(1&c&&(e.TgZ(0,"div",65)(1,"cf-collapse",65)(2,"cf-collapse-panel",66),e.YNc(3,Ct,2,0,"ng-template",null,67,e.W1O),e.YNc(5,Tt,33,12,"div",68),e.qZA()()()),2&c){const t=e.MAs(4),o=e.oxw(2);e.xp6(2),e.Q6J("title",t)("active",!1)("contentClass","!p-0 bg-transparent")("panelClass","!p-3 bg-neutral-white rounded-lg"),e.xp6(3),e.Q6J("ngForOf",o.listBaggage)}}function St(c,_){1&c&&(e.TgZ(0,"div",69),e._uU(1,"D\u1ecbch v\u1ee5"),e.qZA())}function Bt(c,_){if(1&c&&(e.TgZ(0,"div",70)(1,"div",71)(2,"div",72),e._uU(3,"H\xe3ng bay"),e.qZA(),e.TgZ(4,"div",73),e._uU(5),e.qZA()(),e.TgZ(6,"div",71)(7,"div",72),e._uU(8,"H\xe0nh kh\xe1ch"),e.qZA(),e.TgZ(9,"div",73),e._uU(10),e.qZA()(),e.TgZ(11,"div",71)(12,"div",72),e._uU(13,"Chuy\u1ebfn bay"),e.qZA(),e.TgZ(14,"div",73),e._uU(15),e.qZA()(),e.TgZ(16,"div",71)(17,"div",72),e._uU(18,"Ng\xe0y \u0111i"),e.qZA(),e.TgZ(19,"div",73),e._uU(20),e.qZA()(),e.TgZ(21,"div",71)(22,"div",72),e._uU(23,"T\xean d\u1ecbch v\u1ee5"),e.qZA(),e.TgZ(24,"div",73),e._uU(25),e.qZA()(),e.TgZ(26,"div",71)(27,"div",72),e._uU(28,"T\u1ed5ng gi\xe1"),e.qZA(),e.TgZ(29,"div",73),e._uU(30),e.ALo(31,"replace"),e.ALo(32,"number"),e.qZA()()()),2&c){const t=_.$implicit;e.xp6(5),e.Oqu(t.airlineName),e.xp6(5),e.Oqu(t.passengerName),e.xp6(5),e.Oqu(t.flight),e.xp6(5),e.Oqu(t.departDate),e.xp6(5),e.Oqu(t.serviceName),e.xp6(5),e.hij("",e.Dn7(31,6,e.lcZ(32,10,t.totalCharge),",","."),"\u0111")}}function xt(c,_){if(1&c&&(e.TgZ(0,"div",65)(1,"cf-collapse",65)(2,"cf-collapse-panel",66),e.YNc(3,St,2,0,"ng-template",null,67,e.W1O),e.YNc(5,Bt,33,12,"div",68),e.qZA()()()),2&c){const t=e.MAs(4),o=e.oxw(2);e.xp6(2),e.Q6J("title",t)("active",!1)("contentClass","!p-0 bg-transparent")("panelClass","!p-3 bg-neutral-white rounded-lg"),e.xp6(3),e.Q6J("ngForOf",o.listService)}}function Dt(c,_){if(1&c&&(e.TgZ(0,"div",61),e.YNc(1,kt,1,1,"booking-detail-mobile",62),e.YNc(2,yt,6,5,"div",63),e.YNc(3,xt,6,5,"div",63),e.qZA()),2&c){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.bookingDetails),e.xp6(1),e.Q6J("ngIf",t.hasBaggageSelected),e.xp6(1),e.Q6J("ngIf",t.hasSeatSelected)}}function Pt(c,_){if(1&c&&(e.TgZ(0,"div",75)(1,"div",71)(2,"div",72),e._uU(3,"H\xe0nh kh\xe1ch"),e.qZA(),e.TgZ(4,"div",73),e._uU(5),e.qZA()(),e.TgZ(6,"div",71)(7,"div",72),e._uU(8,"Lo\u1ea1i h\xe0nh kh\xe1ch"),e.qZA(),e.TgZ(9,"div",73),e._uU(10),e.qZA()(),e.TgZ(11,"div",71)(12,"div",72),e._uU(13,"Ng\xe0y sinh"),e.qZA(),e.TgZ(14,"div",73),e._uU(15),e.qZA()(),e.TgZ(16,"div",71)(17,"div",72),e._uU(18,"Gi\u1edbi t\xednh"),e.qZA(),e.TgZ(19,"div",73),e._uU(20),e.qZA()(),e.TgZ(21,"div",71)(22,"div",72),e._uU(23,"Th\u1ebb B\xf4ng Sen V\xe0ng"),e.qZA(),e.TgZ(24,"div",73),e._uU(25),e.qZA()()()),2&c){const t=_.$implicit;e.xp6(5),e.Oqu((null==t?null:t.name)||"N/A"),e.xp6(5),e.Oqu((null==t?null:t.type)||"N/A"),e.xp6(5),e.Oqu((null==t?null:t.birthday)||"N/A"),e.xp6(5),e.Oqu((null==t?null:t.sex)||"N/A"),e.xp6(5),e.Oqu((null==t?null:t.membershipNumber)||"N/A")}}function At(c,_){if(1&c&&(e.TgZ(0,"div",61)(1,"div",69),e._uU(2,"Th\xf4ng tin kh\xe1ch h\xe0ng"),e.qZA(),e.YNc(3,Pt,26,5,"div",74),e.TgZ(4,"div",69),e._uU(5,"Th\xf4ng tin li\xean h\u1ec7"),e.qZA(),e.TgZ(6,"div",75)(7,"div",71)(8,"div",72),e._uU(9,"M\xe3 v\xf9ng"),e.qZA(),e.TgZ(10,"div",73),e._uU(11,"+84"),e.qZA()(),e.TgZ(12,"div",71)(13,"div",72),e._uU(14,"S\u1ed1 \u0111i\u1ec7n tho\u1ea1i"),e.qZA(),e.TgZ(15,"div",73),e._uU(16),e.qZA()(),e.TgZ(17,"div",71)(18,"div",72),e._uU(19,"Email"),e.qZA(),e.TgZ(20,"div",73),e._uU(21),e.qZA()()()()),2&c){const t=e.oxw();e.xp6(3),e.Q6J("ngForOf",t.passengerInfos),e.xp6(13),e.Oqu((null==t.bookingContact?null:t.bookingContact.phone)||"N/A"),e.xp6(5),e.Oqu((null==t.bookingContact?null:t.bookingContact.email)||"N/A")}}function It(c,_){if(1&c&&(e.TgZ(0,"div",71)(1,"div",72),e._uU(2,"Chi\u1ebft kh\u1ea5u"),e.qZA(),e.TgZ(3,"div",77),e._uU(4),e.ALo(5,"replace"),e.ALo(6,"number"),e.qZA()()),2&c){const t=e.oxw().$implicit;e.xp6(4),e.hij(" ",e.Dn7(5,1,e.lcZ(6,5,t.discountAmount),",","."),"\u0111 ")}}function Et(c,_){if(1&c&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"replace"),e.ALo(3,"number"),e.qZA()),2&c){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",e.Dn7(2,1,e.lcZ(3,5,t.totalDiscountFarePrice),",",".")," ")}}function Ft(c,_){if(1&c&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"replace"),e.ALo(3,"number"),e.qZA()),2&c){const t=e.oxw().$implicit;e.xp6(1),e.Oqu(e.Dn7(2,1,e.lcZ(3,5,t.total),",","."))}}function Nt(c,_){if(1&c&&(e.TgZ(0,"div",75)(1,"div",71)(2,"div",72),e._uU(3,"H\xe0nh kh\xe1ch"),e.qZA(),e.TgZ(4,"div",73),e._uU(5),e.qZA()(),e.TgZ(6,"div",71)(7,"div",72),e._uU(8,"Lo\u1ea1i kh\xe1ch"),e.qZA(),e.TgZ(9,"div",73),e._uU(10),e.qZA()(),e.TgZ(11,"div",71)(12,"div",72),e._uU(13,"Gi\xe1 v\xe9"),e.qZA(),e.TgZ(14,"div",73),e._uU(15),e.ALo(16,"replace"),e.ALo(17,"number"),e.qZA()(),e.TgZ(18,"div",71)(19,"div",72),e._uU(20,"Thu\u1ebf ph\xed"),e.qZA(),e.TgZ(21,"div",73),e._uU(22),e.ALo(23,"replace"),e.ALo(24,"number"),e.qZA()(),e.YNc(25,It,7,7,"div",76),e.TgZ(26,"div",71)(27,"div",72),e._uU(28,"T\u1ed5ng gi\xe1"),e.qZA(),e.TgZ(29,"div",73),e.YNc(30,Et,4,7,"span",47),e.YNc(31,Ft,4,7,"ng-template",null,48,e.W1O),e.qZA()()()),2&c){const t=_.$implicit,o=e.MAs(32),n=e.oxw(2);e.xp6(5),e.Oqu(t.name),e.xp6(5),e.Oqu(t.type),e.xp6(5),e.hij("",e.Dn7(16,7,e.lcZ(17,11,t.base),",","."),"\u0111 "),e.xp6(7),e.hij("",e.Dn7(23,13,e.lcZ(24,17,t.tax),",","."),"\u0111 "),e.xp6(3),e.Q6J("ngIf",n.hasDiscountFare),e.xp6(5),e.Q6J("ngIf",t.discountAmount&&n.hasDiscountFare)("ngIfElse",o)}}function Mt(c,_){if(1&c&&(e.TgZ(0,"div",61),e.YNc(1,Nt,33,19,"div",74),e.qZA()),2&c){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",null==t.priceDetail?null:t.priceDetail.passengers)}}function Zt(c,_){if(1&c&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"replace"),e.ALo(3,"number"),e.qZA()),2&c){const t=e.oxw(2);e.xp6(1),e.hij(" ",e.Dn7(2,1,e.lcZ(3,5,t.totalDiscountFareCharge),",",".")," \u0111 ")}}function Rt(c,_){if(1&c&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"replace"),e.ALo(3,"number"),e.qZA()),2&c){const t=e.oxw(2);e.xp6(1),e.hij(" ",e.Dn7(2,1,e.lcZ(3,5,t.totalPrice),",",".")," \u0111 ")}}function Ot(c,_){1&c&&e._UZ(0,"cf-icon",86)}function wt(c,_){1&c&&e._UZ(0,"cf-icon",87)}function Kt(c,_){if(1&c&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"replace"),e.ALo(3,"number"),e.qZA()),2&c){const t=e.oxw(3);e.xp6(1),e.hij(" ",e.Dn7(2,1,e.lcZ(3,5,t.priceDetail.totalDiscountBasePrice),",",".")," \u0111")}}function Lt(c,_){if(1&c&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"replace"),e.ALo(3,"number"),e.qZA()),2&c){const t=e.oxw(3);e.xp6(1),e.hij(" ",e.Dn7(2,1,e.lcZ(3,5,t.priceDetail.totalBasePrice),",",".")," \u0111")}}function Vt(c,_){if(1&c&&(e.TgZ(0,"div",88)(1,"div",89)(2,"div",90)(3,"div",91)(4,"div",92),e._uU(5," Gi\xe1 v\xe9 m\xe1y bay "),e.qZA(),e.TgZ(6,"div",92),e._uU(7," D\u1ecbch v\u1ee5 c\u1ed9ng th\xeam "),e.qZA(),e.TgZ(8,"div",92),e._uU(9," Ph\xed d\u1ecbch v\u1ee5 "),e.qZA()()(),e.TgZ(10,"div",93)(11,"div",94),e.YNc(12,Kt,4,7,"span",0),e.YNc(13,Lt,4,7,"span",0),e.qZA(),e.TgZ(14,"div",94),e._uU(15),e.ALo(16,"replace"),e.ALo(17,"number"),e.qZA(),e.TgZ(18,"div",94),e._uU(19),e.ALo(20,"replace"),e.ALo(21,"number"),e.qZA()()()()),2&c){const t=e.oxw(2);e.xp6(12),e.Q6J("ngIf",t.priceDetail.totalDiscountBasePrice),e.xp6(1),e.Q6J("ngIf",!t.priceDetail.totalDiscountBasePrice),e.xp6(2),e.hij(" ",e.Dn7(16,4,e.lcZ(17,8,t.priceDetail.totalAddonService),",","."),"\u0111 "),e.xp6(4),e.hij(" ",e.Dn7(20,10,e.lcZ(21,14,t.priceDetail.totalServiceFee),",","."),"\u0111 ")}}function Ut(c,_){if(1&c){const t=e.EpF();e.TgZ(0,"div",78)(1,"div",79),e.NdJ("click",function(){e.CHM(t);const n=e.MAs(12),i=e.oxw();return e.KtG(i.togglePriceBottomSheet(n))}),e.TgZ(2,"div",80)(3,"div",81),e._uU(4," T\u1ed5ng chi ph\xed: "),e.qZA(),e.TgZ(5,"div",82),e.YNc(6,Zt,4,7,"span",47),e.YNc(7,Rt,4,7,"ng-template",null,48,e.W1O),e.qZA()(),e.YNc(9,Ot,1,0,"cf-icon",83),e.YNc(10,wt,1,0,"cf-icon",84),e.qZA(),e.YNc(11,Vt,22,16,"ng-template",null,85,e.W1O),e.qZA()}if(2&c){const t=e.MAs(8),o=e.oxw();e.ekj("z-1000",o.zIndexPriceIncrease),e.xp6(6),e.Q6J("ngIf",o.totalDiscountFareCharge&&o.hasDiscountFare)("ngIfElse",t),e.xp6(3),e.Q6J("ngIf",!o.isShowTotalPriceBts),e.xp6(1),e.Q6J("ngIf",o.isShowTotalPriceBts)}}function jt(c,_){if(1&c&&(e.TgZ(0,"div",61),e._UZ(1,"fare-rule-modal",95),e.qZA()),2&c){const t=e.oxw();e.xp6(1),e.Q6J("fareRuleBsp",t.fareRuleBsp)}}function Jt(c,_){if(1&c){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",96)(2,"div",97),e.NdJ("click",function(){const i=e.CHM(t).$implicit,a=e.oxw(2);return e.KtG(a.onShare(i.airline))}),e._UZ(3,"cf-icon",98),e.TgZ(4,"div",99),e._uU(5," Sao ch\xe9p "),e.qZA()(),e._UZ(6,"booking-text-origin",100),e.qZA(),e.BQk()}if(2&c){const t=_.$implicit;e.xp6(6),e.Q6J("bookingText",t)}}function qt(c,_){if(1&c&&(e.TgZ(0,"div",61),e.YNc(1,Jt,7,1,"ng-container",34),e.qZA()),2&c){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.listBookingText)}}function $t(c,_){if(1&c&&(e.TgZ(0,"div",61),e._UZ(1,"remark-booking-page",15),e.qZA()),2&c){const t=e.oxw();e.xp6(1),e.Q6J("listBookingCode",t.listBookingCode)}}const Ht=function(){return["BOOKED","ISSUED","IN_PROGRESS"]};let Yt=(()=>{class c{constructor(t,o,n,i,a,s,h,m,d,u,l,p,b,g,C,D,S,B,E,M,H,Y,Q,G){this._flightDataService=s,this._locationDataService=h,this._bookingResultDataProvider=m,this._modal=d,this._manageBookingService=u,this.clipboard=l,this._route=p,this._bookFlightService=b,this._permissionService=g,this._toastService=C,this._searchFlightService=D,this._bottomSheetService=S,this._bookingDetailService=B,this._detectMobileService=E,this._ticketLowFareService=M,this._eventLogService=H,this._sockerService=Y,this._requestReroutingService=Q,this._systemService=G,this.passengerInfos=[],this.bookingDetails=[],this.isSuccess=!1,this.dataBaggageInput=[],this.hasBaggageSelected=!1,this.dataSeatInput=[],this.hasSeatSelected=!1,this.listBaggage=[],this.listService=[],this.listJourneyBasic=[],this.isLoading=!1,this.listBookingText=[],this.listBookingTextExplain=[],this.modeBookingText="explain",this.listBookingCode=[],this.zIndexPriceIncrease=!1,this.firstLoad=!1,this.hasIVSProvider=!1,this.afterIssueBooking=!1,this.maxBag=10,this.isShowTotalPriceBts=!1,this.hasInternationalFlight=!1,this.has1AProvider=!1,this.mobileTabMode="BOOKING_DETAIL",this.fareBasisInfos=[],this.hasAdtPax=!1,this.hasChdPax=!1,this.hasInfPax=!1,this.hasDiscountFare=!1,this.isShowBookingInfo=!1,this.hasWaitlistBooking=!1,this.DATE_ENABLE_LOGIC_MMB_VJ=P.BK,n.registerIcons([x.xgX,x.Ey$,x.B2I,x.xgX,x.llu,x.bHT,x.QkI,x.ILM,x.tLH,x.xbi,x.NYs,x.okA,x.B2I,x.s5C,x.qDv,x.rks,x.Ffn,x._tC,x.fqi,x.n78,x.Hge,x.cnj]),this.ticketSelected=t.ticketSelectedData,this.bookFlightResult=(0,W.yE)($.aM,m.bookingResultData,{excludeExtraneousValues:!0}),this.paymentOrderCode=m.bookingResultData.paymentCode,this.firstLoad=m.firstBookingResult,this.hasIVSProvider=m.hasIVSProvider,m.firstBookingResult=!1,this.bookingRequest=o.bookingRequestData}ngOnInit(){this.isSuccess=this.bookFlightResult.data.some(t=>"OK"===t.status),this.isSuccess&&this.initPassenger();for(const t of this.bookFlightResult.data)if(this.hasWaitlistBooking=t.bookingResult.journeys.flatMap(o=>o.segments).some(o=>{var n;return"HL"===(null===(n=o.bookedInfo)||void 0===n?void 0:n.status)}),this.hasWaitlistBooking)break;this.initBookingDetail(),this.handleSocketTimoutEvent()}handleSocketTimoutEvent(){const o=this._permissionService.getCurrentUser().userId;this._sockerService.timeoutEvent$.subscribe({next:n=>{this.refTimoutModal&&this.refTimoutModal.close(),this.refTimoutBts&&this.refTimoutBts.dismiss(),n.receiverId===o&&(this._toastService.add({severity:"success",summary:"Xu\u1ea5t v\xe9 th\xe0nh c\xf4ng",detail:"M\xe3 \u0111\u1eb7t ch\u1ed7 \u0111\xe3 \u0111\u01b0\u1ee3c xu\u1ea5t v\xe9 th\xe0nh c\xf4ng!",sticky:!1}),this.gotoBookingDetail(n.airline,n.pnr))}})}getBookingContact(){const t=this.bookFlightResult.data.find(o=>"OK"===o.status);this.bookingContact=t?t.bookingResult.bookingContact:this.bookingRequest.data.bookingContact}getBooingText(){const t=this.bookFlightResult.data.filter(o=>"OK"===o.status);this.listBookingText=t.filter(o=>o.bookingResult.bookingText).map(o=>{var n;return Object.assign(Object.assign({},o.bookingResult.bookingText),{segmentTexts:"CANCEL"!=o.bookingResult.state?o.bookingResult.bookingText.segmentTexts:[],airline:o.bookingResult.airline,totalPrice:"CANCEL"!=o.bookingResult.state?new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(o.bookingResult.bookingText.totalPrice||0):"",timeLimit:null!==(n=o.bookingResult.bookDetail)&&void 0!==n&&n.timeHoldBooking?A(o.bookingResult.bookDetail.timeHoldBooking).format("HH:mm, DD/MM/YYYY"):""})}),this.listBookingTextExplain=t.filter(o=>o.bookingResult.bookingTextExplain).map(o=>Object.assign(Object.assign({},o.bookingResult.bookingTextExplain),{segmentTexts:"CANCEL"!=o.bookingResult.state?o.bookingResult.bookingTextExplain.segmentTexts:[],bags:"CANCEL"!=o.bookingResult.state?o.bookingResult.bookingTextExplain.bags:[],seatCharge:"CANCEL"!=o.bookingResult.state?o.bookingResult.bookingTextExplain.seatCharge:[],ssrCharge:"CANCEL"!=o.bookingResult.state?o.bookingResult.bookingTextExplain.ssrCharge:[],totalCharge:"CANCEL"!=o.bookingResult.state?o.bookingResult.bookingTextExplain.totalCharge:"",totalPrice:"CANCEL"!=o.bookingResult.state?o.bookingResult.bookingTextExplain.totalPrice:0}))}getFareBasis(){this.fareBasisInfos=[],this.bookingDetails.forEach(t=>{t.journeys.forEach(o=>{o.segments.forEach(n=>{this.fareBasisInfos.push({airline:n.airline||"",airlineLogo:n.airlineLogo||"",startCode:n.startPoint||"",startPoint:n.startPointName||"",endCode:n.endPoint||"",endPoint:n.endPointName||"",fareClass:n.fareClass||"",fareBasis:n.fareBasic||""})})})})}getAirlineLogo(t){return this._flightDataService.getAirlineLogoByCode(t)}initPassenger(){const t=this.bookFlightResult.data.find(o=>"OK"==o.status);t&&(this.passengerInfos=t.bookingResult.passengers.map(o=>("ADT"===o.getType()&&(this.hasAdtPax=!0),"CHD"===o.getType()&&(this.hasChdPax=!0),"INF"===o.getType()&&(this.hasInfPax=!0),{name:o.getName(),type:o.getType(),sex:o.getGender(),birthday:o.getBirthday(),membershipNumber:o.membershipNumber||""})),this.passengers=t.bookingResult.passengers.map(o=>({name:o.getName(),type:o.type,typeName:o.getType(),key:o.key})))}initBookingDetail(t=!1){this.isLoading=!0,(0,De.D)(this.bookFlightResult.data).pipe((0,Pe.z)(o=>{if("OK"==o.status){const n=o.bookingResult;return this.discountPercentage=o.bookingResult.discountPercentage,this.hasDiscountFare=!!this.discountPercentage,this.listBookingCode.push({bookingCode:n.bookingCode}),!this.firstLoad&&!this.afterIssueBooking&&!this.hasIVSProvider||n.provider===P.QK.VN&&n.supplier===P.f$.EVC?this._bookingDetailService.getBookingDetail(n.bookingCode,n.airline,t).pipe((0,Ae.U)(i=>{if("OK"===i.status){t&&this._toastService.add({severity:"success",summary:"Th\xe0nh c\xf4ng",detail:"C\u1eadp nh\u1eadt tr\u1ea1ng th\xe1i m\u1edbi nh\u1ea5t c\u1ee7a v\xe9 th\xe0nh c\xf4ng.",sticky:!1});const a=o.bookingResult,s=Object.create(Object.getPrototypeOf(a));return Object.assign(s,a,i.data),o.bookingResult=s,this.parseBookingResult(o.bookingResult)}return t&&this._toastService.add({severity:"error",summary:"Th\u1ea5t b\u1ea1i",detail:"C\u1eadp nh\u1eadt tr\u1ea1ng th\xe1i v\xe9 th\u1ea5t b\u1ea1i. Vui l\xf2ng li\xean h\u1ec7 Booker \u0111\u1ec3 \u0111\u01b0\u1ee3c h\u1ed7 tr\u1ee3.",sticky:!0}),this.parseBookingResult(o.bookingResult)}),(0,Ie.K)(i=>(t&&this._toastService.add({severity:"error",summary:"Th\u1ea5t b\u1ea1i",detail:"C\u1eadp nh\u1eadt tr\u1ea1ng th\xe1i v\xe9 th\u1ea5t b\u1ea1i. Vui l\xf2ng li\xean h\u1ec7 Booker \u0111\u1ec3 \u0111\u01b0\u1ee3c h\u1ed7 tr\u1ee3.",sticky:!0}),(0,ie.of)(this.parseBookingResult(o.bookingResult))))):(0,ie.of)(this.parseBookingResult(o.bookingResult))}{const n=o.bookingResult.journeys.flatMap(s=>s),i=[];let a;return n.forEach(s=>{const h=this.ticketSelected.find(m=>s.key===m.journeyKey);h&&(a=h,i.push(h))}),(0,ie.of)({agentId:"",coOwnerId:"",bookingCode:"",holdLimitTime:"",codeAirline:"",provider:"",supplier:"",bookingCodeDisplay:"",airline:(null==a?void 0:a.airline)||"",airlineLogo:this._flightDataService.getAirlineLogoByCode(a.airline),mobileAirlineLogo:a&&["VJ","VN","QH","VU"].includes(a.airline)?"assets/airline-logo/"+a.airline+"_small.png":"assets/airline-logo/"+a.airline+".png",airlineName:this._flightDataService.getAirlineSystemNameByCode(a.airline),airlineSystem:(null==a?void 0:a.airline)||"",startPoint:(null==a?void 0:a.startCode)||"",endPoint:(null==a?void 0:a.endCode)||"",status:o.bookingResult.state,issued:!1,statusText:o.bookingResult.getStatusText(),statusDesc:o.error.errorDescription.vi?o.error.errorDescription.vi:o.error.errorDescription.en,caCode:"N/A",timeHoldBooking:new Date,timeHoldPricing:new Date,tourCode:"N/A",totalFare:0,totalDiscountFare:0,totalCharge:0,totalServiceFee:0,totalAddonCharge:0,targetPriceOrder:0,flightNumber:"",journeys:i.map(s=>({airline:s.airline,airlineLogo:this._flightDataService.getAirlineLogoByCode(s.airline),airlineName:this._flightDataService.getAirlineSystemNameByCode(s.airline),operating:s.operating,operatingName:s.operatingName,startPoint:s.startCode,startPointName:this._locationDataService.getCityNameByCode(s.startCode),endPoint:s.endCode,endPointName:this._locationDataService.getCityNameByCode(s.endCode),startTime:A(s.startTime).toDate(),endTime:A(s.endTime).toDate(),startTerminal:"",endTerminal:"",flightNumber:s.flight,duration:s.duration,key:s.journeyKey,leg:s.leg,journeyBaseFare:0,numOfStops:0,segments:s.segments.map(h=>({airline:h.airline,airlineLogo:h.airlineLogo,airlineName:this._flightDataService.getAirlineSystemNameByCode(h.airlineName),startPoint:h.startCode,startPointName:h.startPoint,endPoint:h.endCode,endPointName:h.endPoint,startTime:A(h.departDate).toDate(),endTime:A(h.arrivalDate).toDate(),flightNumber:h.flightNumber,duration:h.duration,key:h.segmentKey,operating:h.operating,operatingName:h.operatingName,checkedBaggage:h.checkedBaggage||"",fareClass:h.fareClass||"",handBaggage:h.handBaggage||"",modelAirplane:h.modelAirplane||"",stopPoint:h.stopPoint})),journeyStatus:{active:!1,cancelled:!1,disrupted:!1}})),passengers:[],canRetry:o.error.canRetry,serviceFeeDetail:{adtFee:0,chdFee:0,infFee:0},isVJCancelAllJourney:!1,ticketingAllowed:!1,isMultiJourney:!1})}}),(0,Ee.q)()).subscribe(o=>{this.bookingDetails=o,this.hasInternationalFlight=this.bookingDetails.some(n=>["BSP","AIR_1G","BZT","ST"].includes(n.provider)),this.has1AProvider=this.bookingDetails.some(n=>"BSP".includes(n.provider)),this.isShowBookingInfo=o.some(n=>"BOOKED"===n.status||"ISSUED"===n.status),this._getSeatCharge(),this._getBaggageCharge(),this.isSuccess&&this.initPriceDetail(),this.isSuccess&&this.initTotalPrice(),this.mappingJourneyBasic(),this.getBookingContact(),this.getBooingText(),this.getFareBasis(),this.isLoading=!1})}syncDelayPoint(t){for(let o=0;o<t.length-1;o++)t[o+1].delay=t[o].delay,t[o].delay=0;return t}parseBookingResult(t){var o,n,i,a,s,h,m,d,u,l,p,b,g,C,D,S,B,E,M,H,Y,Q,G;return t.journeys.forEach(f=>{t.provider===P.QK.VN&&"VN"===f.airline&&(f.segments=this.syncDelayPoint(f.segments))}),{agentId:t.agentId,coOwnerId:t.coOwnerId,bookingCode:t.bookingCode,holdLimitTime:null===(o=t.bookingTextExplain)||void 0===o?void 0:o.holdLimitTime,provider:t.provider,supplier:t.supplier,bookingCodeDisplay:t.bookingCode,airline:t.airline,airlineLogo:this._flightDataService.getAirlineLogoByCode((null===(n=t.journeys[0])||void 0===n?void 0:n.operating)||t.airline),mobileAirlineLogo:["VJ","VN","QH"].includes((null===(i=t.journeys[0])||void 0===i?void 0:i.operating)||t.airline)?"assets/airline-logo/"+((null===(a=t.journeys[0])||void 0===a?void 0:a.operating)||t.airline)+"_small.png":"assets/airline-logo/"+((null===(s=t.journeys[0])||void 0===s?void 0:s.operating)||t.airline)+".png",airlineName:["VJ","VN","QH"].includes(t.airline)?this._flightDataService.getAirlineSystemNameByCode(t.airline):t.airlineName,airlineSystem:t.airline,startPoint:null===(h=t.journeys[0])||void 0===h?void 0:h.departure.airport.code,endPoint:1===t.journeys.length?null===(m=t.journeys[0])||void 0===m?void 0:m.arrival.airport.code:null===(d=t.journeys[t.journeys.length-1])||void 0===d?void 0:d.departure.airport.code,status:t.state,issued:t.issued,statusText:this.getStatusText(t.state),statusDesc:"N/A",caCode:"N/A",timeHoldBooking:null!==(u=t.bookDetail)&&void 0!==u&&u.timeHoldBooking?new Date(t.bookDetail.timeHoldBooking):null,timeHoldPricing:null!==(l=t.bookDetail)&&void 0!==l&&l.timeKeepPrice?new Date(t.bookDetail.timeKeepPrice):null,tourCode:"N/A",totalFare:null!==(p=t.fareCharges)&&void 0!==p&&p.total?t.fareCharges.total.total:null,totalDiscountFare:0,totalServiceFee:null!==(b=t.totalCharges)&&void 0!==b&&b.total?t.totalCharges.total.totalServiceFee:null,totalCharge:null===(g=t.totalCharges)||void 0===g?void 0:g.total.total,totalAddonCharge:null!==(S=null===(D=null===(C=t.totalCharges)||void 0===C?void 0:C.total)||void 0===D?void 0:D.totalAddonCharge)&&void 0!==S?S:0,targetPriceOrder:null===(B=t.fareCharges)||void 0===B?void 0:B.getTotalChargeOrder(),flightNumber:`${null===(E=t.journeys[0])||void 0===E?void 0:E.segments[0].airline}${null===(M=t.journeys[0])||void 0===M?void 0:M.segments[0].flightNumber}`,journeys:(null===(H=t.journeys)||void 0===H?void 0:H.map(f=>{var Z,R,O,w,K,L,V,U;return{airline:f.airline,airlineLogo:this._flightDataService.getAirlineLogoByCode(f.operating||f.airline),airlineName:this._flightDataService.getAirlineSystemNameByCode(f.airline),operating:f.operating,operatingName:f.operatingName,startPoint:f.departure.airport.code,startPointName:this._locationDataService.getCityNameByCode(f.departure.airport.code),endPoint:f.arrival.airport.code,endPointName:this._locationDataService.getCityNameByCode(f.arrival.airport.code),startTime:A(f.departure.localTime).toDate(),endTime:A(f.arrival.localTime).toDate(),startTerminal:f.segments[0].departure.airport.terminal?`T${f.segments[0].departure.airport.terminal}`:"",endTerminal:(()=>{var T;const N=1===f.segments.length?f.segments[0].arrival.airport.terminal:null===(T=f.segments[f.segments.length-1])||void 0===T?void 0:T.arrival.airport.terminal;return N?`T${N}`:""})(),key:f.key,leg:f.leg,journeyBaseFare:null===(Z=t.fareCharges)||void 0===Z?void 0:Z.getBaseFareByJourney(f.key),segments:null===(R=f.segments)||void 0===R?void 0:R.map(T=>{var N,j,J,oe,ne,ae,se,re,le,ce,he,de,ue;const Ce=T.getDelayString();return{airline:T.airline,airlineLogo:this._flightDataService.getAirlineLogoByCode(T.operating||T.airline),airlineName:this._flightDataService.getAirlineSystemNameByCode(T.operatingName),startPoint:T.departure.airport.code,startPointName:this._locationDataService.getCityNameByCode(T.departure.airport.code),endPoint:T.arrival.airport.code,endPointName:this._locationDataService.getCityNameByCode(T.arrival.airport.code),startTime:A(T.departure.localTime).toDate(),endTime:A(T.arrival.localTime).toDate(),startTerminal:null!==(j=null===(N=T.departure)||void 0===N?void 0:N.airport)&&void 0!==j&&j.terminal?`T${null===(J=T.departure)||void 0===J?void 0:J.airport.terminal}`:"",endTerminal:null!==(ne=null===(oe=T.arrival)||void 0===oe?void 0:oe.airport)&&void 0!==ne&&ne.terminal?`T${null===(ae=T.arrival)||void 0===ae?void 0:ae.airport.terminal}`:"",flightNumber:T.flightNumber,duration:T.getDurationString(),shortDuration:(0,Be.N)(T.duration),key:T.key,operating:T.operating,operatingName:T.operatingName,codeAirline:T.codeAirline,checkedBaggage:(null===(se=T.bookedInfo)||void 0===se?void 0:se.checkedBaggage)||"",fareClass:(null===(re=T.bookedInfo)||void 0===re?void 0:re.fareClass)||"",fareType:(null===(le=T.bookedInfo)||void 0===le?void 0:le.fareType)||(null===(ce=T.bookedInfo)||void 0===ce?void 0:ce.fareClass)||"",fareBasic:(null===(he=T.bookedInfo)||void 0===he?void 0:he.fareBasic)||"",handBaggage:(null===(de=T.bookedInfo)||void 0===de?void 0:de.handBaggage)||"",accompaniedService:t.getAccompaniedService(f.key),modelAirplane:T.modelAirplane,stopPoint:Ce?`D\u1eebng t\u1ea1i: ${this._locationDataService.getAirportNameByCode(T.departure.airport.code)} (${T.departure.airport.code}). Th\u1eddi gian d\u1eebng: ${Ce}`:"",status:(null===(ue=T.bookedInfo)||void 0===ue?void 0:ue.status)||""}}),journeyStatus:{active:null!==(w=null===(O=f.status)||void 0===O?void 0:O.active)&&void 0!==w&&w,cancelled:null!==(L=null===(K=f.status)||void 0===K?void 0:K.cancelled)&&void 0!==L&&L,disrupted:null!==(U=null===(V=f.status)||void 0===V?void 0:V.disrupted)&&void 0!==U&&U}}}))||[],passengers:null===(Y=t.passengers)||void 0===Y?void 0:Y.map(f=>{var Z,R,O,w,K,L,V,U,T,N,j,J;return{index:f.index,name:f.getName(),firstName:f.firstName,lastName:f.lastName,type:f.getType(),farePrice:(null===(Z=t.fareCharges)||void 0===Z?void 0:Z.getBaseCharge(f.type))-(null===(R=t.fareCharges)||void 0===R?void 0:R.getDiscount(f.type)),tax:null===(O=t.fareCharges)||void 0===O?void 0:O.getTaxCharge(f.type),vat:null===(w=t.fareCharges)||void 0===w?void 0:w.getVATCharge(f.type),discountAmount:null===(K=t.fareCharges)||void 0===K?void 0:K.getDiscountByPercent(f.type,this.discountPercentage,t.provider,t.journeys.length),total:null===(L=t.fareCharges)||void 0===L?void 0:L.getTotalCharge(f.type),get totalDiscountFarePrice(){return this.discountAmount?this.total-this.discountAmount:0},key:f.key,parentKey:f.parentKey,birthday:f.birthday,namePrefix:f.namePrefix,gender:f.gender,documentType:f.document&&(null===(V=f.document[0])||void 0===V?void 0:V.documentType)||"",issuanceDate:f.document&&(null===(U=f.document[0])||void 0===U?void 0:U.issuanceDate)||"",expiryDate:f.document&&(null===(T=f.document[0])||void 0===T?void 0:T.expiryDate)||"",issuanceCountry:f.document&&(null===(N=f.document[0])||void 0===N?void 0:N.issuanceCountry)||"",nationality:f.document&&(null===(j=f.document[0])||void 0===j?void 0:j.nationality)||"",number:f.document&&(null===(J=f.document[0])||void 0===J?void 0:J.number)||"",defaultDocumentInfo:f.defaultDocumentInfo,membershipNumber:f.membershipNumber}}),actions:this.getListTicketAction(t.state,t.provider,t.journeys.length),bookingTextExplain:t.bookingTextExplain,serviceFeeDetail:t.serviceFeeDetail,isVJCancelAllJourney:"VJ"==t.airline&&0==t.journeys.length,ticketingAllowed:null!==(G=null===(Q=t.bookDetail)||void 0===Q?void 0:Q.ticketingAllowed)&&void 0!==G&&G,isMultiJourney:this.checkMultiJourney(t.journeys)}}checkMultiJourney(t){return t.length>2||t.length>1&&!(t[0].departure.airport.code==t[1].arrival.airport.code&&t[0].arrival.airport.code===t[1].departure.airport.code)}getStatusText(t){switch(t){case"BOOKED":return"\u0110\xe3 gi\u1eef ch\u1ed7";case"ISSUED":return"\u0110\xe3 xu\u1ea5t v\xe9";case"REFUND":return"\u0110\xe3 ho\xe0n";case"CANCEL":return"\u0110\xe3 h\u1ee7y";case"EXPIRED":return"H\u1ebft h\u1ea1n";case"INVALID":return"Kh\xf4ng c\xf2n gi\xe1 tr\u1ecb";case"VOID":return"\u0110\xe3 void";case"IN_PROGRESS":return"\u0110ang x\u1eed l\xfd";default:return"\u0110\u1eb7t ch\u1ed7 l\u1ed7i"}}initPriceDetail(){var t;this.priceDetail={provider:this.bookFlightResult.data.filter(o=>"OK"==o.status).map(o=>o.bookingResult.provider),totalBasePrice:this.bookFlightResult.data.filter(o=>"OK"==o.status).flatMap(o=>{var n;return o.bookingResult.totalCharges?null===(n=o.bookingResult.totalCharges)||void 0===n?void 0:n.total.totalFareCharge:0}).reduce((o,n)=>o+n,0),totalDiscountBasePrice:0,totalServiceFee:this.bookFlightResult.data.filter(o=>"OK"==o.status).flatMap(o=>{var n;return o.bookingResult.totalCharges?null===(n=o.bookingResult.totalCharges)||void 0===n?void 0:n.total.totalServiceFee:0}).reduce((o,n)=>o+n,0),totalAddonService:this.computeTotalChargeAddOn(),totalOthersCharge:this.bookFlightResult.data.filter(o=>"OK"==o.status).flatMap(o=>{var n;return o.bookingResult.totalCharges?null===(n=o.bookingResult.totalCharges)||void 0===n?void 0:n.total.totalOthersCharge:0}).reduce((o,n)=>o+n,0),passengers:this.passengers.map(o=>({name:o.name,type:o.typeName,base:this.bookFlightResult.data.filter(n=>"OK"==n.status).flatMap(n=>{var i,a;return(null===(i=n.bookingResult.fareCharges)||void 0===i?void 0:i.getBaseCharge(o.type))-(null===(a=n.bookingResult.fareCharges)||void 0===a?void 0:a.getDiscount(o.type))}).reduce((n,i)=>n+i,0),tax:this.bookFlightResult.data.filter(n=>"OK"==n.status).flatMap(n=>{var i;return null===(i=n.bookingResult.fareCharges)||void 0===i?void 0:i.getTaxAndVat(o.type)}).reduce((n,i)=>n+i,0),discountAmount:this.bookFlightResult.data.filter(n=>"OK"==n.status).flatMap(n=>{var i;return null===(i=n.bookingResult.fareCharges)||void 0===i?void 0:i.getDiscountByPercent(o.type,this.discountPercentage,n.bookingResult.provider,n.bookingResult.journeys.length)}).reduce((n,i)=>n+i,0),total:this.bookFlightResult.data.filter(n=>"OK"==n.status).flatMap(n=>{var i;return null===(i=n.bookingResult.fareCharges)||void 0===i?void 0:i.getTotalCharge(o.type)}).reduce((n,i)=>n+i,0),get totalDiscountFarePrice(){return this.discountAmount?this.total-this.discountAmount:0}}))},this.totalDiscountAmount=null===(t=this.priceDetail.passengers)||void 0===t?void 0:t.reduce((o,n)=>o+((null==n?void 0:n.discountAmount)||0),0),this.priceDetail.totalDiscountBasePrice=this.priceDetail.totalBasePrice-this.totalDiscountAmount,this.bookingDetails.forEach(o=>{o.totalDiscountFare=this.totalDiscountAmount?o.totalFare-this.totalDiscountAmount:0})}initTotalPrice(){this.totalPrice=this.bookFlightResult.data.filter(t=>"OK"==t.status).flatMap(t=>{var o,n,i;return null!==(o=t.bookingResult.totalCharges)&&void 0!==o&&o.total?(null===(n=t.bookingResult.totalCharges)||void 0===n?void 0:n.total.totalFareCharge)+(null===(i=t.bookingResult.totalCharges)||void 0===i?void 0:i.total.totalServiceFee):-1}).reduce((t,o)=>t+o,0)+this.computeTotalChargeAddOn(),this.totalDiscountFareCharge=this.totalDiscountAmount?this.totalPrice-this.totalDiscountAmount:0}onActionChange(t,o){const n={airline:o.airlineSystem,bookingCode:o.bookingCode,payNow:"ISSUED"===o.status,bookingStatus:o.status,provider:o.provider,supplier:o.supplier};switch(t){case"booking_detail":return this.gotoBookingDetail(n.airline,n.bookingCode);case"addon_baggage":return this.onAddonBaggage(n,o);case"addon_seat":return this.onAddonSeat(n,o);case"void":return this.onVoidBooking(n);case"issue":return this.onIssueBooking(n,o);case"boarding_pass":return this.onShowBoardingPass(o);case"delete_segments":case"cancel_booking":return this.onDeleteSegment(o);case"copy_pnr":return this.onCopyBookingCode(o.bookingCode);case"delete_each_journey":return this.onDeleteEachJourney(o);case"register_order":return this._eventLogService.captureOpenFormDownFare({hasPNR:1,source:0}),this.onRegisterOrder(o);case"send_email":return this.onSendEmail(o);case"rerouting":return this.onRerouting(o,o);case"add_journey":return this.onAddonJourney(o);case"separate_passengers":return this.onSeparatePassengers(o);case"open_audit_log":return this.onOpenAuditLog(o);case"check_in_online":return this.onCheckInOnline(o);case"update_pax_info":return this.onUpdatePaxInfo(o);case"rebook_pnr":return this.onRebookPnr(o);case"update_membership":return this.onUpdateMembership();case"add_infant":return this.onAddInfant();case"calculate_fare":return this.onCalculateFare();default:return}}gotoBookingDetail(t,o){this._route.navigate([`admin/booking-detail/${t}/${o}`])}gotoDownFareDetail(t){this._route.navigate([`admin/pnr-order-detail/${t}`])}checkRuleMMBVJ(t){return t.provider===P.QK.VJ&&"BOOKED"===t.status&&this._systemService.isFeatureEnabled(P.Ke.Web_Features_LogicVJ_OnNewLogicVJModify_Enable)}handleMMBVJ(t,o){if(this._detectMobileService.isMobile()){const n=this._bottomSheetService.open(v.V0,{headerTitle:"Kh\xf4ng th\u1ec3 ti\u1ebfp t\u1ee5c",leftButtonIcon:"arrow_left",leftButtonIconClass:"text-neutral-gray-4",rightButtonIcon:"",containerFullHeigh:!0,data:{title:"",body:`<div>T\u1eeb ng\xe0y ${P.BK} Vietjet Air c\u1eadp nh\u1eadt ch\xednh s\xe1ch y\xeau c\u1ea7u \u0111\u1ea1i l\xfd ph\u1ea3i thanh to\xe1n (xu\u1ea5t v\xe9) ngay khi mua h\xe0nh l\xfd/ch\u1ed7 ng\u1ed3i, th\xeam h\xe0nh tr\xecnh, \u0111\u1ed5i h\xe0nh tr\xecnh, h\u1ee7y h\xe0nh tr\xecnh tr\xean v\xe9 tr\u1ea1ng th\xe1i "\u0110ang gi\u1eef ch\u1ed7".\n                      \u0110\u1ea1i l\xfd vui l\xf2ng xu\u1ea5t v\xe9 tr\u01b0\u1edbc khi s\u1eed d\u1ee5ng c\xe1c t\xednh n\u0103ng tr\xean.</div></br>\n                      B\u1ea1n c\xf3 mu\u1ed1n th\u1ef1c hi\u1ec7n xu\u1ea5t v\xe9 n\xe0y kh\xf4ng?`,okText:"X\xe1c nh\u1eadn",cancelText:"\u0110\xf3ng",hasIcon:!1}});n.containerInstance._leftButtonClick.subscribe(i=>n.dismiss()),n.afterDismissed().subscribe(i=>{i&&this.onIssueBooking(t,o)})}else this._modal.open(v.V0,{title:"Kh\xf4ng th\u1ec3 ti\u1ebfp t\u1ee5c",body:`<div>T\u1eeb ng\xe0y ${P.BK} Vietjet Air c\u1eadp nh\u1eadt ch\xednh s\xe1ch y\xeau c\u1ea7u \u0111\u1ea1i l\xfd ph\u1ea3i thanh to\xe1n (xu\u1ea5t v\xe9) ngay khi mua h\xe0nh l\xfd/ch\u1ed7 ng\u1ed3i, th\xeam h\xe0nh tr\xecnh, \u0111\u1ed5i h\xe0nh tr\xecnh, h\u1ee7y h\xe0nh tr\xecnh tr\xean v\xe9 tr\u1ea1ng th\xe1i "\u0110ang gi\u1eef ch\u1ed7".\n                      \u0110\u1ea1i l\xfd vui l\xf2ng xu\u1ea5t v\xe9 tr\u01b0\u1edbc khi s\u1eed d\u1ee5ng c\xe1c t\xednh n\u0103ng tr\xean.</div></br>\n                      B\u1ea1n c\xf3 mu\u1ed1n th\u1ef1c hi\u1ec7n xu\u1ea5t v\xe9 n\xe0y kh\xf4ng?`,okText:"X\xe1c nh\u1eadn",cancelText:"\u0110\xf3ng",hasIcon:!1}).afterClosed$.subscribe({next:i=>{i.data&&this.onIssueBooking(t,o)}})}handleMMBVJCancelBoooking(){if(this._detectMobileService.isMobile()){const t=this._bottomSheetService.open(v.V0,{headerTitle:"Kh\xf4ng th\u1ec3 ti\u1ebfp t\u1ee5c",leftButtonIcon:"arrow_left",leftButtonIconClass:"text-neutral-gray-4",rightButtonIcon:"",containerFullHeigh:!0,data:{title:"",body:`<div>T\u1eeb ng\xe0y ${P.BK} Vietjet Air c\u1eadp nh\u1eadt ch\xednh s\xe1ch y\xeau c\u1ea7u \u0111\u1ea1i l\xfd ph\u1ea3i thanh to\xe1n (xu\u1ea5t v\xe9) ngay khi mua h\xe0nh l\xfd/ch\u1ed7 ng\u1ed3i, th\xeam h\xe0nh tr\xecnh, \u0111\u1ed5i h\xe0nh tr\xecnh, h\u1ee7y h\xe0nh tr\xecnh tr\xean v\xe9 tr\u1ea1ng th\xe1i "\u0110ang gi\u1eef ch\u1ed7".\n                      \u0110\u1ea1i l\xfd vui l\xf2ng li\xean h\u1ec7 Booker \u0111\u1ec3 \u0111\u01b0\u1ee3c h\u1ed7 tr\u1ee3 H\u1ee7y h\xe0nh tr\xecnh.</div>`,okText:"\u0110\xf3ng",hasIcon:!1,hasCancel:!1}});t.containerInstance._leftButtonClick.subscribe(o=>t.dismiss())}else this._modal.open(v.V0,{title:"Kh\xf4ng th\u1ec3 ti\u1ebfp t\u1ee5c",body:`<div>T\u1eeb ng\xe0y ${P.BK} Vietjet Air c\u1eadp nh\u1eadt ch\xednh s\xe1ch y\xeau c\u1ea7u \u0111\u1ea1i l\xfd ph\u1ea3i thanh to\xe1n (xu\u1ea5t v\xe9) ngay khi mua h\xe0nh l\xfd/ch\u1ed7 ng\u1ed3i, th\xeam h\xe0nh tr\xecnh, \u0111\u1ed5i h\xe0nh tr\xecnh, h\u1ee7y h\xe0nh tr\xecnh tr\xean v\xe9 tr\u1ea1ng th\xe1i "\u0110ang gi\u1eef ch\u1ed7".\n                      \u0110\u1ea1i l\xfd vui l\xf2ng li\xean h\u1ec7 Booker \u0111\u1ec3 \u0111\u01b0\u1ee3c h\u1ed7 tr\u1ee3 H\u1ee7y h\xe0nh tr\xecnh.</div>`,okText:"\u0110\xf3ng",hasIcon:!1,hasCancel:!1})}onAddonBaggage(t,o){var n;if(this.checkRuleMMBVJ(o))return void this.handleMMBVJ(t,o);if(P.PY&&"VN"===(null===(n=t.airline)||void 0===n?void 0:n.toUpperCase()))return void this._modal.open(v.z5,{title:"Th\xf4ng b\xe1o",content:"H\u1ec7 th\u1ed1ng m\u1edbi Vietnam Airlines ch\u01b0a h\u1ed7 tr\u1ee3 t\xednh n\u0103ng n\xe0y. Xin li\u1ec7n h\u1ec7 booker \u0111\u1ec3 \u0111\u01b0\u1ee3c h\u1ed7 tr\u1ee3",status:"error",cancelText:"\u0110\xf3ng"});if(this.dataBaggageInput=this.mappingDataBaggageInput(t),!this.dataBaggageInput.length||this.dataBaggageInput.every(a=>!a.journeys.length))return void this._toastService.add({severity:"error",summary:"Th\xeam h\xe0nh l\xfd th\u1ea5t b\u1ea1i",detail:"H\xe0nh l\xfd \u0111\xe3 c\xf3",sticky:!0});const i=Object.assign({},t);if(this._detectMobileService.isMobile()){const a=this._bottomSheetService.open(z.AddOnBaggageModalComponent,{headerTitle:"Th\xeam h\xe0nh l\xfd",leftButtonIcon:"arrow_left",leftButtonIconClass:"text-neutral-gray-4",rightButtonIcon:"",containerFullHeigh:!0,data:{dataBaggageInput:this.dataBaggageInput,addonBaggageReq:i,type:"baggage_addon",bookingInfo:t}});a.containerInstance._leftButtonClick.subscribe(s=>a.dismiss()),a.afterDismissed().subscribe(s=>{this.processAddonBaggage({type:"",data:s})})}else this._modal.open(z.AddOnBaggageModalComponent,{dataBaggageInput:this.dataBaggageInput,addonBaggageReq:i,type:"baggage_addon",bookingInfo:t}).afterClosed$.subscribe({next:s=>{this.processAddonBaggage(s)}})}processAddonBaggage(t){if("backdropClick"==t.type)return;const o=t.data;if(o&&o.success){const n=o.data,i=n.bookingCode,a=this.bookFlightResult.data.find(h=>h.bookingResult.bookingCode===i),s=n.addOnCharges.map(h=>{var m;return{charge:Object.assign({},h.charge.charge),ssrInfo:{category:{name:h.ancillaryItem.category,description:h.ancillaryItem.description+("QH"===(null===(m=null==a?void 0:a.bookingResult)||void 0===m?void 0:m.provider)?" KG":"")},code:"",description:h.ancillaryItem.description,journeyKey:h.ancillaryItem.journeyKey,name:h.ancillaryItem.name,passengerKey:h.ancillaryItem.passengerKey,segmentKey:"",unit:"",weight:""}}});if(a&&(a.bookingResult.ssrCharges.push(...s),this._bookingResultDataProvider.bookingResultData=this.bookFlightResult,this.priceDetail.totalServiceFee+=n.derivativeFee,this._getBaggageCharge(),this.initPriceDetail(),this.initTotalPrice(),this.getShortRetrieve(a.bookingResult.provider,n.bookingCode)),this._detectMobileService.isMobile()){const h=this._bottomSheetService.open(v.z5,{headerTitle:"",rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4",leftButtonIcon:"",data:{title:"Th\xeam h\xe0nh l\xfd th\xe0nh c\xf4ng!",content:"<div>\u0110\xe3 th\xeam h\xe0nh l\xfd cho booking code:</div>",status:"success",okText:"OK",extraText:`${i}`}});h.containerInstance._rightButtonClick.subscribe(m=>h.dismiss())}else this._modal.open(v.z5,{title:"Th\xeam h\xe0nh l\xfd th\xe0nh c\xf4ng!",content:"<div>\u0110\xe3 th\xeam h\xe0nh l\xfd cho booking code:</div>",status:"success",okText:"OK",extraText:`${i}`})}else if(o&&!o.success){const n=o.objectError.errorDescription.vi?o.objectError.errorDescription.vi:o.objectError.errorDescription.en;if(this._detectMobileService.isMobile()){const i=this._bottomSheetService.open(v.z5,{headerTitle:"",rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4",leftButtonIcon:"",data:{title:"Th\xeam h\xe0nh l\xfd th\u1ea5t b\u1ea1i",content:`<div>\n                        <div>${n}</div>\n                        <div>Vui l\xf2ng th\u1eed l\u1ea1i sau!</div>\n                    </div>`,status:"error",okText:"Th\u1eed l\u1ea1i",cancelText:"\u0110\xf3ng"}});i.containerInstance._rightButtonClick.subscribe(a=>i.dismiss())}else this._modal.open(v.z5,{title:"Th\xeam h\xe0nh l\xfd th\u1ea5t b\u1ea1i",content:`<div>\n                      <div>${n}</div>\n                      <div>Vui l\xf2ng th\u1eed l\u1ea1i sau!</div>\n                  </div>`,status:"error",okText:"Th\u1eed l\u1ea1i",cancelText:"\u0110\xf3ng"})}}onAddonSeat(t,o){if(this.checkRuleMMBVJ(o))return void this.handleMMBVJ(t,o);this.dataSeatInput=this.mappingDataSeatInput(t);const n=Object.assign({},t);if(this._detectMobileService.isMobile()){const i=this._bottomSheetService.open(z.AddOnSeatModalComponent,{headerTitle:"Th\xeam ch\u1ed7 ng\u1ed3i",leftButtonIcon:"arrow_left",leftButtonIconClass:"text-neutral-gray-4",rightButtonIcon:"",containerFullHeigh:!0,data:{dataSeatInput:this.dataSeatInput,addonSeatReq:n,type:"seat_addon",bookingInfo:t}});i.containerInstance._leftButtonClick.subscribe(a=>i.dismiss()),i.afterDismissed().subscribe(a=>{this.processAddonSeat(a)})}else this._modal.open(z.AddOnSeatModalComponent,{dataSeatInput:this.dataSeatInput,addonSeatReq:n,type:"seat_addon",bookingInfo:t}).afterClosed$.subscribe({next:a=>{this.processAddonSeat(a.data)}})}processAddonSeat(t){var o;let n=t;if(t.data&&!t.data.addOnCharges&&t.data.data&&(n=t.data),n&&n.success){const i=n.data,a=i.bookingCode,s=this.bookFlightResult.data.find(m=>m.bookingResult.bookingCode===a),h=i.addOnCharges.map(m=>({charge:Object.assign({},m.charge.charge),seatInfos:{journeyKey:m.seatItem.journeyKey,mapCell:Object.assign({},m.seatItem.mapCell),passengerKey:m.seatItem.passengerKey,segmentKey:m.seatItem.segmentKey}}));if(s&&(null===(o=s.bookingResult.seatCharges)||void 0===o||o.push(...h),this._bookingResultDataProvider.bookingResultData=this.bookFlightResult,this.priceDetail.totalServiceFee+=i.derivativeFee,this._getSeatCharge(),this.initPriceDetail(),this.initTotalPrice(),this.getShortRetrieve(s.bookingResult.provider,i.bookingCode)),this._detectMobileService.isMobile()){const m=this._bottomSheetService.open(v.z5,{headerTitle:"",rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4",leftButtonIcon:"",data:{title:"Th\xeam ch\u1ed7 ng\u1ed3i th\xe0nh c\xf4ng!",content:"<div>\u0110\xe3 th\xeam ch\u1ed7 ng\u1ed3i cho booking code:</div>",status:"success",okText:"OK",extraText:`${a}`}});m.containerInstance._rightButtonClick.subscribe(d=>m.dismiss())}else this._modal.open(v.z5,{title:"Th\xeam ch\u1ed7 ng\u1ed3i th\xe0nh c\xf4ng!",content:"<div>\u0110\xe3 th\xeam ch\u1ed7 ng\u1ed3i cho booking code:</div>",status:"success",okText:"OK",extraText:`${a}`})}if(n&&!n.success){const i=n.objectError.errorDescription.vi?n.objectError.errorDescription.vi:n.objectError.errorDescription.en;if(this._detectMobileService.isMobile()){const a=this._bottomSheetService.open(v.z5,{headerTitle:"",rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4",leftButtonIcon:"",data:{title:"Th\xeam ch\u1ed7 ng\u1ed3i th\u1ea5t b\u1ea1i",content:`<div>\n                      <div>${i}</div>\n                      <div>Vui l\xf2ng th\u1eed l\u1ea1i sau!</div>\n                  </div>`,status:"error",okText:"Th\u1eed l\u1ea1i",cancelText:"\u0110\xf3ng"}});a.containerInstance._rightButtonClick.subscribe(s=>a.dismiss())}else this._modal.open(v.z5,{title:"Th\xeam ch\u1ed7 ng\u1ed3i th\u1ea5t b\u1ea1i",content:`<div>\n                      <div>${i}</div>\n                      <div>Vui l\xf2ng th\u1eed l\u1ea1i sau!</div>\n                  </div>`,status:"error",okText:"Th\u1eed l\u1ea1i",cancelText:"\u0110\xf3ng"})}}mappingDataBaggageInput(t){var o,n;let i=[];const a=null===(n=null===(o=this.bookFlightResult.data)||void 0===o?void 0:o.find(s=>s.bookingResult.bookingCode===t.bookingCode))||void 0===n?void 0:n.bookingResult;return a&&(i=a.passengers.filter(s=>"INFANT"!==s.type).map(s=>{var h,m;return{passengerKey:s.key,passengerType:s.type,passengerName:s.lastName+" "+s.firstName,addBaggageFee:(null===(h=s.passengerDerivativeFee)||void 0===h?void 0:h.addBaggageFee)||0,journeys:null===(m=a.journeys)||void 0===m?void 0:m.filter(d=>{const u=a.ssrCharges?a.ssrCharges.filter(l=>"baggage"===l.ssrInfo.category.name.toLowerCase()&&l.ssrInfo.journeyKey===d.key&&l.ssrInfo.passengerKey===s.key):[];return!("VN"===d.airline&&u.length>=this.maxBag||"VN"!==d.airline&&u.length)&&d}).map(d=>{const u=A(d.departure.localTime).toDate();return{flight:d.segments[0].airline.concat(" ",d.segments[0].flightNumber),flightNumber:d.segments[0].flightNumber,airlineName:this._flightDataService.getAirlineSystemNameByCode(d.airline),airlineLogo:this.getAirlineLogo(d.airline),journeyKey:d.key,journeyName:`D\u1ecbch v\u1ee5 b\u1ed5 sung ${d.departure.airport.code}-${d.arrival.airport.code}, ${(0,F.p6)(u,"EEEE, ","vi-VN")} ${u.getDate()} th\xe1ng ${u.getMonth()+1}, ${u.getFullYear()}`,leg:d.leg,fareOptionKey:"",startCode:d.departure.airport.code,endCode:d.arrival.airport.code,startTime:(0,F.p6)(new Date(d.departure.localTime),"EEEE, dd/MM/yyyy","vi-VN"),baggageOptions:[],baggageSelected:{baggageName:"",baggageKey:"",containerKey:"",totalCharge:0}}})}})),i=i.filter(s=>s.journeys.length),i}mappingDataSeatInput(t){var o,n;const i=null===(n=null===(o=this.bookFlightResult.data)||void 0===o?void 0:o.find(s=>s.bookingResult.bookingCode===t.bookingCode))||void 0===n?void 0:n.bookingResult;let a=[];return i&&(a=i.journeys.map(s=>({segments:s.segments.map(h=>{var m;const d=A(h.departure.localTime).toDate(),u=`${(0,F.p6)(d,"EEEE, ","vi-VN")} ${d.getDate()} th\xe1ng ${d.getMonth()+1}, ${d.getFullYear()}`;return{airline:h.airline,flightNumber:h.flightNumber,modelAirplaneName:"",bookingCode:null!==(m=i.bookingCode)&&void 0!==m?m:"",serviceName:`Th\xeam ch\u1ed7 ng\u1ed3i tr\xean chuy\u1ebfn bay ${h.departure.airport.code}-${h.arrival.airport.code}, ${u}`,mobileServiceName:`${h.departure.airport.code}-${h.arrival.airport.code}, ${u}`,airlineLogo:this._flightDataService.getAirlineLogoByCode(h.airline),jetCode:"N/A",startCode:h.departure.airport.code,endCode:h.arrival.airport.code,departDate:u,passengers:i.passengers.filter(l=>"INFANT"!==l.type).map(l=>{var p,b,g;const C=null===(p=i.seatCharges)||void 0===p?void 0:p.find(S=>S.seatInfos.passengerKey===l.key&&S.seatInfos.journeyKey===s.key&&S.seatInfos.segmentKey===h.key),D=!(null===(b=i.passengers)||void 0===b||!b.find(S=>S.parentKey==l.key));return{passengerName:`${l.lastName} ${l.firstName}`,passengerType:l.type.toLowerCase(),passengerKey:l.key,includeInfant:D,addSeatFee:(null===(g=l.passengerDerivativeFee)||void 0===g?void 0:g.addSeatFee)||0,seatSelected:{containerKey:"",seat:C?C.seatInfos.mapCell.seatNumber:"",seatKey:"",totalPrice:C?C.charge.total:0}}}),segmentKey:h.key,segmentIndex:h.index,journeyKey:s.key,leg:s.leg,active:!1,seatSegment:{rows:[],cols:[],containerKey:"",seatMaps:[]},available:!(i.seatCharges&&i.seatCharges.some(l=>l.seatInfos.journeyKey===s.key&&l.seatInfos.segmentKey===h.key))}})})).flatMap(s=>s.segments)),a.map((s,h)=>Object.assign(Object.assign({},s),{active:0===h}))}mappingJourneyBasic(){this.listJourneyBasic=this.bookingDetails.filter(t=>"INVALID"!==t.status).map(t=>({journeyInfo:t.journeys.map(o=>({airlineLogo:o.airlineLogo,flight:`${o.startPoint} - ${o.endPoint}`,startTime:(0,F.p6)(o.startTime?new Date(o.startTime):new Date,"dd/MM/yyyy","vi-VN"),journeyKey:o.key}))})).flatMap(t=>t.journeyInfo)}computeTotalChargeAddOn(){return this.listBaggage.reduce((n,i)=>n+i.totalCharge,0)+this.listService.reduce((n,i)=>n+i.totalCharge,0)}_getSeatCharge(){this.listService.length=0,this.bookFlightResult.data.filter(o=>"ERROR"!==o.bookingResult.state&&o.bookingResult.seatCharges&&o.bookingResult.seatCharges.length).forEach(o=>{var n;const i=o.bookingResult,a=i.journeys.flatMap(m=>m.segments),s=i.passengers,h=null===(n=o.bookingResult.seatCharges)||void 0===n?void 0:n.map(m=>{const d=s.find(l=>l.key===m.seatInfos.passengerKey),u=a.find(l=>l.key===m.seatInfos.segmentKey);return{airline:(null==u?void 0:u.airline)||"",airlineName:u?this._flightDataService.getAirlineNameByCode(u.airline):"",airlineLogo:u?this.getAirlineLogo(u.airline):"",journeyKey:m.seatInfos.journeyKey||"",segmentKey:m.seatInfos.segmentKey||"",flight:u?u.departure.airport.code+" - "+u.arrival.airport.code:"",flightName:u?this._locationDataService.getCityNameByCode(u.departure.airport.code)+" - "+this._locationDataService.getCityNameByCode(u.arrival.airport.code):"",flightNumber:u?`${u.airline}${u.flightNumber}`:"",departDate:u?(0,F.p6)(new Date(u.departure.localTime),"dd/MM/yyyy","vi-VN"):"",passengerKey:d?d.key:"",passengerName:d?d.lastName+" "+d.firstName:"",serviceKey:"",totalCharge:m.charge.total,serviceName:m.seatInfos.mapCell.seatNumber?m.seatInfos.mapCell.seatNumber:m.seatInfos.mapCell.row+m.seatInfos.mapCell.identifier,categoryName:"seat"}});this.listService.push(...h)}),this.hasSeatSelected=this.listService.some(o=>o)}_getBaggageCharge(){const t=this.bookFlightResult.data.filter(n=>"ERROR"!==n.bookingResult.state&&n.bookingResult.ssrCharges&&n.bookingResult.ssrCharges.length),o=[];t.forEach(n=>{const i=n.bookingResult,a=i.journeys,s=i.passengers,h=n.bookingResult.ssrCharges.map(m=>{const d=s.find(l=>l.key===m.ssrInfo.passengerKey),u=a.find(l=>l.key===m.ssrInfo.journeyKey);return{airline:(null==u?void 0:u.airline)||"",airlineName:u?this._flightDataService.getAirlineNameByCode(u.airline):"",airlineLogo:u?this.getAirlineLogo(u.airline):"",journeyKey:u?u.key:"",segmentKey:"",flight:u?u.departure.airport.code+" - "+u.arrival.airport.code:"",flightName:u?this._locationDataService.getCityNameByCode(u.departure.airport.code)+" - "+this._locationDataService.getCityNameByCode(u.arrival.airport.code):"",flightNumber:"",departDate:u?(0,F.p6)(new Date(u.departure.localTime),"dd/MM/yyyy","vi-VN"):"",passengerKey:d?d.key:"",passengerName:d?d.lastName+" "+d.firstName:"",serviceKey:"",totalCharge:m.charge.total,serviceName:m.ssrInfo.name,categoryName:m.ssrInfo.category.name.toLowerCase()}});o.push(...h)}),this.listBaggage=o,this.hasBaggageSelected=this.listBaggage.some(n=>n)}onVoidBooking(t){if(this._detectMobileService.isMobile()){const o=this._bottomSheetService.open(y.hF,{headerTitle:"Void v\xe9",leftButtonIcon:"close",leftButtonIconClass:"text-neutral-gray-4",rightButtonIcon:"",containerFullHeigh:!0,data:{bookingCode:t.bookingCode,airline:t.airline}});o.containerInstance._leftButtonClick.subscribe(n=>o.dismiss()),o.afterDismissed().subscribe(n=>{this.gotoBookingDetail(t.airline,t.bookingCode)})}else this._modal.open(y.hF,{bookingCode:t.bookingCode,airline:t.airline}).afterClosed$.subscribe({next:n=>{this.gotoBookingDetail(t.airline,t.bookingCode)}})}getIssueData(t){var o;const n=null===(o=t.passengers.filter(a=>"INF"!==a.type))||void 0===o?void 0:o.map(a=>{const s=t.passengers.filter(h=>"INF"===h.type).find(h=>h.parentKey===a.key);return{firstName:a.firstName,lastName:a.lastName,type:a.type,child:s?{firstName:s.firstName,lastName:s.lastName,type:s.type}:null}});return{bookingCode:t.bookingCode,passengers:n,segments:t.journeys.flatMap(a=>a.segments).map(a=>({flightNumber:`${a.airline}${a.flightNumber}`,startCode:a.startPoint,endCode:a.endPoint,route:`${a.startPoint}${a.endPoint}`,departDate:a.startTime?(0,F.p6)(a.startTime,"dMMM","en-US"):"",startTime:a.startTime?(0,F.p6)(a.startTime,"HH:mm","vi-VN"):"",endTime:a.endTime?(0,F.p6)(a.endTime,"HH:mm","vi-VN"):""})),totalCharge:this.totalDiscountFareCharge&&this.hasDiscountFare?this.totalDiscountFareCharge:this.totalPrice}}onIssueBooking(t,o){var n,i;if("ISSUED"===t.status&&P.PY&&"VN"===(null===(n=t.airline)||void 0===n?void 0:n.toUpperCase()))return void this._modal.open(v.z5,{title:"Th\xf4ng b\xe1o",content:"H\u1ec7 th\u1ed1ng m\u1edbi Vietnam Airlines ch\u01b0a h\u1ed7 tr\u1ee3 t\xednh n\u0103ng n\xe0y. Xin li\u1ec7n h\u1ec7 booker \u0111\u1ec3 \u0111\u01b0\u1ee3c h\u1ed7 tr\u1ee3",status:"error",cancelText:"\u0110\xf3ng"});const a={title:"Xu\u1ea5t v\xe9 th\xe0nh c\xf4ng",content:"<div>V\xe9 \u0111\xe3 \u0111\u01b0\u1ee3c xu\u1ea5t th\xe0nh c\xf4ng!</div>",status:"success",okText:"X\xe1c nh\u1eadn"},s={title:"Xu\u1ea5t v\xe9 th\u1ea5t b\u1ea1i",content:"<div>Xu\u1ea5t s\u1ed1 v\xe9 kh\xf4ng th\xe0nh c\xf4ng. Vui l\xf2ng th\u1eed l\u1ea1i ho\u1eb7c li\xean h\u1ec7 booker \u0111\u1ec3 \u0111\u01b0\u1ee3c h\u1ed7 tr\u1ee3!</div>",status:"error"},h={agentId:"",bookingCode:t.bookingCode,bookingPrice:0,internal:!0,provider:t.provider||"",checkDiscountFee:!0,passengers:[]},m=this.bookingDetails[0].passengers.some(d=>d.defaultDocumentInfo);if("BSP"===(null===(i=t.provider)||void 0===i?void 0:i.toUpperCase())&&m){const d=u=>{h.passengers=this.bookingDetails[0].passengers.map(l=>{const p=u.find(b=>b.index==b.index);return{documentInfo:[{documentType:"PASSPORT",issuanceDate:null!=p&&p.issuanceDate&&A(null==p?void 0:p.issuanceDate).format("YYYY-MM-DD")||"",expiryDate:null!=p&&p.expiryDate&&A(null==p?void 0:p.expiryDate).format("YYYY-MM-DD")||"",issuanceCountry:(null==p?void 0:p.issuanceCountry)||"",nationality:(null==p?void 0:p.nationality)||"",number:(null==p?void 0:p.number)||""}],index:l.index}}),this.isLoading=!0,this._manageBookingService.issueTicket(h).pipe((0,I.x)(()=>this.isLoading=!1)).subscribe({next:l=>{if(l.success&&l.data){this.afterIssueBooking=!0,this._modal.open(v.z5,a);const p=this.bookFlightResult.data.find(b=>b.bookingResult.bookingCode===t.bookingCode);p&&(p.bookingResult=Object.assign(Object.assign({},l.data),{passengers:p.bookingResult.passengers}),this._bookingResultDataProvider.bookingResultData=this.bookFlightResult,this.bookFlightResult=(0,W.yE)($.aM,this._bookingResultDataProvider.bookingResultData,{excludeExtraneousValues:!0}),this.initBookingDetail(),this.initPriceDetail(),this.getShortRetrieve(p.bookingResult.provider,p.bookingResult.bookingCode))}else if("DS-EL005"===l.objectError.errorCode){const p=l.objectError.errorData.priceInfo.newPrice-l.objectError.errorData.priceInfo.oldPrice,b={newPrice:l.objectError.errorData.priceInfo.newPrice,oldPrice:l.objectError.errorData.priceInfo.oldPrice,priceGap:Math.abs(p),type:p>0?"+":"-"};this._modal.open(q.EH,{priceChangeData:b}).afterClosed$.subscribe({next:C=>{C.data&&(this.isLoading=!0,this._manageBookingService.issueTicket(h).pipe((0,I.x)(()=>this.isLoading=!1)).subscribe({next:D=>{D.success?this._modal.open(v.z5,a).afterClosed$.subscribe({next:B=>{if(B.data){const E=this.bookFlightResult.data.find(M=>M.bookingResult.bookingCode===t.bookingCode);E&&(E.bookingResult.state=D.data.state,E.bookingResult.issued=D.data.issued,E.bookingResult.discountPercentage=D.data.discountPercentage,this._bookingResultDataProvider.bookingResultData=this.bookFlightResult,this.initBookingDetail())}}}):(s.content=D.objectError.errorDescription.vi?D.objectError.errorDescription.vi:D.objectError.errorDescription.en,this._modal.open(v.z5,s))}}))}})}else if("BE-EF045"===l.objectError.errorCode){const p={newPrice:l.objectError.errorData.newPriceTicket,oldPrice:l.objectError.errorData.oldPriceTicket,get priceGap(){return Math.abs(this.newPrice-this.oldPrice)},type:l.objectError.errorData.discountChange};if(this._detectMobileService.isMobile()){const b=this._bottomSheetService.open(q.Gn,{headerTitle:"Th\xf4ng b\xe1o thay \u0111\u1ed5i chi\u1ebft kh\u1ea5u",rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4",data:{discountChangeData:p}});b.containerInstance._rightButtonClick.subscribe(()=>{b.dismiss()}),b.afterDismissed().subscribe({next:g=>{g&&(this.isLoading=!0,h.checkDiscountFee=!1,this._manageBookingService.issueTicket(h).pipe((0,I.x)(()=>this.isLoading=!1)).subscribe({next:C=>{C.success?this._modal.open(v.z5,a).afterClosed$.subscribe({next:S=>{if(S.data){const B=this.bookFlightResult.data.find(E=>E.bookingResult.bookingCode===t.bookingCode);B&&(B.bookingResult.state=C.data.state,B.bookingResult.issued=C.data.issued,B.bookingResult.discountPercentage=C.data.discountPercentage,this._bookingResultDataProvider.bookingResultData=this.bookFlightResult,this.initBookingDetail())}}}):(s.content=C.objectError.errorDescription.vi?C.objectError.errorDescription.vi:C.objectError.errorDescription.en,this._modal.open(v.z5,s))}}))}})}else this._modal.open(q.Gn,{discountChangeData:p}).afterClosed$.subscribe({next:g=>{g.data&&(this.isLoading=!0,h.checkDiscountFee=!1,this._manageBookingService.issueTicket(h).pipe((0,I.x)(()=>this.isLoading=!1)).subscribe({next:C=>{C.success?this._modal.open(v.z5,a).afterClosed$.subscribe({next:S=>{if(S.data){const B=this.bookFlightResult.data.find(E=>E.bookingResult.bookingCode===t.bookingCode);B&&(B.bookingResult.state=C.data.state,B.bookingResult.issued=C.data.issued,B.bookingResult.discountPercentage=C.data.discountPercentage,this._bookingResultDataProvider.bookingResultData=this.bookFlightResult,this.initBookingDetail())}}}):(s.content=C.objectError.errorDescription.vi?C.objectError.errorDescription.vi:C.objectError.errorDescription.en,this._modal.open(v.z5,s))}}))}})}else"DS-EH001"===l.objectError.errorCode?this.hanldeTimeoutIssue():(s.content=l.objectError.errorDescription.vi?l.objectError.errorDescription.vi:l.objectError.errorDescription.en,this._modal.open(v.z5,s))},error:l=>{l instanceof ke.W?this.hanldeTimeoutIssue():this._modal.open(v.z5,s)}})};if(this._detectMobileService.isMobile()){const u=this._bottomSheetService.open(v.V0,{headerTitle:"Kh\xf4ng th\u1ec3 ti\u1ebfp t\u1ee5c",rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4",data:{title:"",body:"C\u1ea7n b\u1ed5 sung \u0111\u1ea7y \u0111\u1ee7 th\xf4ng tin h\u1ed9 chi\u1ebfu c\u1ee7a h\xe0nh kh\xe1ch tr\u01b0\u1edbc khi xu\u1ea5t v\xe9",okText:"B\u1ed5 sung",cancelText:"\u0110\xf3ng",hasIcon:!0}});u.containerInstance._rightButtonClick.subscribe(()=>{u.dismiss()}),u.afterDismissed().subscribe({next:l=>{if(l){const p=[];this.bookingDetails[0].passengers.forEach((g,C)=>{p.push({index:g.index,key:g.key||"",name:g.lastName+" "+g.firstName,parentKey:"N/A"==g.parentKey||null==g.parentKey?"":g.parentKey,type:g.type,child:"N/A",selected:0==C,gender:g.gender,firstName:g.firstName,lastName:g.lastName,dayOfBirth:g.birthday?g.birthday:"",parentName:"",fullType:g.type,issuanceDate:g.issuanceDate,expiryDate:g.expiryDate,issuanceCountry:g.issuanceCountry,nationality:g.nationality,number:g.number})});const b=this._bottomSheetService.open(y.vj,{headerTitle:"Ch\u1ec9nh s\u1eeda h\u1ed9 chi\u1ebfu",rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4",containerFullHeigh:!0,data:{listPaxUpdate:p}});b.containerInstance._rightButtonClick.subscribe(()=>{b.dismiss()}),b.afterDismissed().subscribe({next:g=>{g&&d(g)}})}}})}else this._modal.open(v.V0,{title:"Kh\xf4ng th\u1ec3 ti\u1ebfp t\u1ee5c",body:"C\u1ea7n b\u1ed5 sung \u0111\u1ea7y \u0111\u1ee7 th\xf4ng tin h\u1ed9 chi\u1ebfu c\u1ee7a h\xe0nh kh\xe1ch tr\u01b0\u1edbc khi xu\u1ea5t v\xe9",status:"error",okText:"B\u1ed5 sung",cancelText:"\u0110\xf3ng"}).afterClosed$.subscribe({next:l=>{if(l.data){const p=[];this.bookingDetails[0].passengers.forEach((g,C)=>{p.push({index:g.index,key:g.key||"",name:g.lastName+" "+g.firstName,parentKey:"N/A"==g.parentKey||null==g.parentKey?"":g.parentKey,type:g.type,child:"N/A",selected:0==C,gender:g.gender,firstName:g.firstName,lastName:g.lastName,dayOfBirth:g.birthday?g.birthday:"",parentName:"",fullType:g.type,issuanceDate:g.issuanceDate,expiryDate:g.expiryDate,issuanceCountry:g.issuanceCountry,nationality:g.nationality,number:g.number})}),this._modal.open(y.vj,{listPaxUpdate:p}).afterClosed$.subscribe({next:g=>{g.data&&d(g.data)}})}}})}else{const d=()=>{this.isLoading=!0,this._manageBookingService.issueTicket(h).pipe((0,I.x)(()=>this.isLoading=!1)).subscribe({next:u=>{if(u.success&&u.data){this.afterIssueBooking=!0,this._modal.open(v.z5,a);const l=this.bookFlightResult.data.find(p=>p.bookingResult.bookingCode===t.bookingCode);l&&(l.bookingResult=Object.assign(Object.assign({},u.data),{passengers:l.bookingResult.passengers}),this._bookingResultDataProvider.bookingResultData=this.bookFlightResult,this.bookFlightResult=(0,W.yE)($.aM,this._bookingResultDataProvider.bookingResultData,{excludeExtraneousValues:!0}),this.initBookingDetail(),this.initPriceDetail(),this.getShortRetrieve(l.bookingResult.provider,l.bookingResult.bookingCode))}else if("DS-EL005"===u.objectError.errorCode){const l=u.objectError.errorData.priceInfo.newPrice-u.objectError.errorData.priceInfo.oldPrice,p={newPrice:u.objectError.errorData.priceInfo.newPrice,oldPrice:u.objectError.errorData.priceInfo.oldPrice,priceGap:Math.abs(l),type:l>0?"+":"-"};this._modal.open(q.EH,{priceChangeData:p}).afterClosed$.subscribe({next:g=>{g.data&&(this.isLoading=!0,this._manageBookingService.issueTicket(h).pipe((0,I.x)(()=>this.isLoading=!1)).subscribe({next:C=>{C.success?this._modal.open(v.z5,a).afterClosed$.subscribe({next:S=>{if(S.data){const B=this.bookFlightResult.data.find(E=>E.bookingResult.bookingCode===t.bookingCode);B&&(B.bookingResult.state=C.data.state,B.bookingResult.issued=C.data.issued,B.bookingResult.discountPercentage=C.data.discountPercentage,this._bookingResultDataProvider.bookingResultData=this.bookFlightResult,this.initBookingDetail())}}}):(s.content=C.objectError.errorDescription.vi?C.objectError.errorDescription.vi:C.objectError.errorDescription.en,this._modal.open(v.z5,s))}}))}})}else if("BE-EF045"===u.objectError.errorCode){const l={newPrice:u.objectError.errorData.newPriceTicket,oldPrice:u.objectError.errorData.oldPriceTicket,get priceGap(){return Math.abs(this.newPrice-this.oldPrice)},type:u.objectError.errorData.discountChange};if(this._detectMobileService.isMobile()){const p=this._bottomSheetService.open(q.Gn,{headerTitle:"Th\xf4ng b\xe1o thay \u0111\u1ed5i chi\u1ebft kh\u1ea5u",rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4",data:{discountChangeData:l}});p.containerInstance._rightButtonClick.subscribe(()=>{p.dismiss()}),p.afterDismissed().subscribe({next:b=>{b&&(this.isLoading=!0,h.checkDiscountFee=!1,this._manageBookingService.issueTicket(h).pipe((0,I.x)(()=>this.isLoading=!1)).subscribe({next:g=>{g.success?this._modal.open(v.z5,a).afterClosed$.subscribe({next:D=>{if(D.data){const S=this.bookFlightResult.data.find(B=>B.bookingResult.bookingCode===t.bookingCode);S&&(S.bookingResult.state=g.data.state,S.bookingResult.issued=g.data.issued,S.bookingResult.discountPercentage=g.data.discountPercentage,this._bookingResultDataProvider.bookingResultData=this.bookFlightResult,this.initBookingDetail())}}}):(s.content=g.objectError.errorDescription.vi?g.objectError.errorDescription.vi:g.objectError.errorDescription.en,this._modal.open(v.z5,s))}}))}})}else this._modal.open(q.Gn,{discountChangeData:l}).afterClosed$.subscribe({next:b=>{b.data&&(this.isLoading=!0,h.checkDiscountFee=!1,this._manageBookingService.issueTicket(h).pipe((0,I.x)(()=>this.isLoading=!1)).subscribe({next:g=>{g.success?this._modal.open(v.z5,a).afterClosed$.subscribe({next:D=>{if(D.data){const S=this.bookFlightResult.data.find(B=>B.bookingResult.bookingCode===t.bookingCode);S&&(S.bookingResult.state=g.data.state,S.bookingResult.issued=g.data.issued,S.bookingResult.discountPercentage=g.data.discountPercentage,this._bookingResultDataProvider.bookingResultData=this.bookFlightResult,this.initBookingDetail())}}}):(s.content=g.objectError.errorDescription.vi?g.objectError.errorDescription.vi:g.objectError.errorDescription.en,this._modal.open(v.z5,s))}}))}})}else"DS-EH001"===u.objectError.errorCode?this.hanldeTimeoutIssue():(s.content=u.objectError.errorDescription.vi?u.objectError.errorDescription.vi:u.objectError.errorDescription.en,this._modal.open(v.z5,s))},error:u=>{u instanceof ke.W?this.hanldeTimeoutIssue():this._modal.open(v.z5,s)}})};if(this._detectMobileService.isMobile()){const u=this._bottomSheetService.open(v._3,{headerTitle:"X\xe1c nh\u1eadn xu\u1ea5t v\xe9",rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4",data:{issueDataConfirm:this.getIssueData(o)}});u.containerInstance._rightButtonClick.subscribe(()=>{u.dismiss()}),u.afterDismissed().subscribe(l=>{l&&d()})}else this._modal.open(v._3,{issueDataConfirm:this.getIssueData(o),hasWaitlistBooking:this.hasWaitlistBooking}).afterClosed$.subscribe({next:l=>{l.data&&d()}})}}onShare(t){const o="origin"===this.modeBookingText?this.getOriginText(t):this.getExplaneText(t);this.clipboard.copy(o),this._detectMobileService.isMobile()&&this._toastService.add({severity:"success",summary:"\u0110\xe3 sao ch\xe9p n\u1ed9i dung",detail:"N\u1ed9i dung \u0111\xe3 \u0111\u01b0\u1ee3c sao ch\xe9p v\xe0o b\u1ed9 nh\u1edb t\u1ea1m"})}getOriginText(t){var o,n,i,a,s,h,m,d,u,l,p;if(this.listBookingText){let b="";const g=this.listBookingText.find(C=>C.airline===t);return g&&("VN"===g.airline?(b+=`${g.bookingCodeText}\r\n`,b+=(null!==(o=g.passengerTexts)&&void 0!==o?o:[]).join("\r\n")+"\r\n",b+=(null!==(n=g.segmentTexts)&&void 0!==n?n:[]).join("\r\n ")+"\r\n",b+="TKT/TIME LIMIT\r\n ",b+=(null!==(i=g.ticketTexts)&&void 0!==i?i:[]).join("\r\n ")+"\r\n",b+="VCR COUPON DATA EXISTS *VI TO DISPLAY\r\n",b+="PHONES\r\n ",b+=(null!==(a=g.contactTexts)&&void 0!==a?a:[]).join("\r\n ")+"\r\n",b+="PASSENGER EMAIL DATA EXISTS *PE TO DISPLAY ALL\r\n",b+="PRICE QUOTE RECORD EXISTS - *PQS\r\n",b+="FREQUENT TRAVELER\r\n",b+=(null!==(s=g.frequentTexts)&&void 0!==s?s:[]).join("\r\n ")+"\r\n",b+="TICKETED RETAINED REISSUE EXISTS - *PQS\r\n",b+="VN FACTS\r\n ",b+=(null!==(h=g.ssrTexts)&&void 0!==h?h:[]).join("\r\n ")+"\r\n",g.remarkTexts&&(b+="REMARKS\r\n ",b+=(null!==(m=g.remarkTexts)&&void 0!==m?m:[]).join("\r\n ")),b+=(null!==(d=g.agentTexts)&&void 0!==d?d:[]).join("\r\n")):(b+=`${g.bookingCodeText}\r\n`,b+=(null===(u=g.passengerTexts)||void 0===u?void 0:u.join(" "))+"\r\n",b+=(null===(l=g.segmentTexts)||void 0===l?void 0:l.join("\r\n"))+"\r\n",b+=`TOTAL PRICE: ${g.totalPrice} VND\r\n`,b+=`TIME LIMIT: ${g.timeLimit}\r\n`,b+=(null!==(p=g.contactTexts)&&void 0!==p?p:[]).join("\r\n"))),b||""}return""}getExplaneText(t){var o;if(this.listBookingTextExplain){let n="";const i=this.listBookingTextExplain.find(a=>a.airline===t);return i&&(n+=(0,xe.K)(i),n+="NOTE:\r\n",n+=null===(o=i.warning)||void 0===o?void 0:o.join("\r\n")),n||""}return""}changeModeBookingText(t){this.modeBookingText=t}onShowBoardingPass(t){if(this._detectMobileService.isMobile()){const o=this._bottomSheetService.open(be.G,{headerTitle:"M\u1eb7t v\xe9",rightButtonIcon:"",leftButtonIcon:"close",leftButtonIconClass:"text-neutral-gray-4",containerFullHeigh:!0,data:{bookingDetail:t,listBaggage:this.listBaggage.filter(n=>n.airline===t.airline),listService:this.listService.filter(n=>n.airline===t.airline),addonServiceCharge:(this.priceDetail.totalAddonService||0)+(this.priceDetail.totalOthersCharge||0),totalPrice:this.totalPrice}});o.containerInstance._leftButtonClick.subscribe(n=>o.dismiss())}else this._modal.open(be.G,{bookingDetail:t,listBaggage:this.listBaggage.filter(o=>o.airline===t.airline),listService:this.listService.filter(o=>o.airline===t.airline),addonServiceCharge:(this.priceDetail.totalAddonService||0)+(this.priceDetail.totalOthersCharge||0),totalPrice:this.totalPrice})}getListTicketAction(t,o,n){switch(t){case"BOOKED":if("VJ"===o)return 0===n?[{value:"add_journey",name:"Th\xeam h\xe0nh tr\xecnh",icon:"",enabled:[r.or.CanAddFlightJourney].some(i=>this._permissionService.hasPermission(i))},{value:"rebook_pnr",name:"Rebook PNR",icon:"",enabled:[r.or.CanRebookPNRVJ].some(i=>this._permissionService.hasPermission(i))}]:[{value:"booking_detail",name:"M\u1edf booking",icon:"external_link",enabled:[r.or.ViewAllFlightBookingDetail,r.or.ViewOwnFlightBookingDetail].some(i=>this._permissionService.hasPermission(i))},{value:"issue",name:"Xu\u1ea5t v\xe9",icon:"grouping",enabled:[r.or.CanIssuedFlightTicket].some(i=>this._permissionService.hasPermission(i))},{value:"boarding_pass",name:"M\u1eb7t v\xe9",icon:"coupon",enabled:[r.or.CreateFlightTicketFace].some(i=>this._permissionService.hasPermission(i))},{value:"addon_baggage",name:"Th\xeam h\xe0nh l\xfd",icon:"",enabled:[r.or.CanAddonFlightBaggage].some(i=>this._permissionService.hasPermission(i))},{value:"addon_seat",name:"Th\xeam ch\u1ed7 ng\u1ed3i",icon:"",enabled:[r.or.CanAddonFlightSeat].some(i=>this._permissionService.hasPermission(i))},{value:"register_order",name:"Canh v\xe9 r\u1ebb",icon:"price_down",enabled:[r.or.CanMonitorLowFareTicket].some(i=>this._permissionService.hasPermission(i))},{value:"add_journey",name:"Th\xeam h\xe0nh tr\xecnh",icon:"",enabled:[r.or.CanAddFlightJourney].some(i=>this._permissionService.hasPermission(i))},{value:"other",name:"Kh\xe1c",icon:"options_vertical",enabled:[r.or.CanAddonFlightBaggage,r.or.CanAddonFlightSeat,r.or.CanUpdateFlightJourney].some(i=>this._permissionService.hasPermission(i)),items:[{value:"rerouting",name:"\u0110\u1ed5i h\xe0nh tr\xecnh",icon:"",enabled:[r.or.CanUpdateFlightJourney].some(i=>this._permissionService.hasPermission(i))},{value:"delete_each_journey",name:"H\u1ee7y h\xe0nh tr\xecnh",icon:"delete",enabled:[r.or.CanDeleteFlightSegment].some(i=>this._permissionService.hasPermission(i))},{value:"separate_passengers",name:"T\xe1ch h\xe0nh kh\xe1ch",icon:"",enabled:[r.or.CanSplitPassengerVJ].some(i=>this._permissionService.hasPermission(i))&&this._systemService.isFeatureEnabled(P.Ke.Web_Features_SplitPassenger_SplitPassengerVJ_Enable)},{value:"update_pax_info",name:"S\u1eeda h\xe0nh kh\xe1ch",icon:"",enabled:[r.or.CanUpdatePaxInfoVJ].some(i=>this._permissionService.hasPermission(i))},{value:"send_email",name:"G\u1eedi email",icon:"email",enabled:[r.or.CanSendEmail].some(i=>this._permissionService.hasPermission(i))},{value:"open_audit_log",name:"Ki\u1ec3m to\xe1n \u0111\u1eb7t ch\u1ed7",icon:"",enabled:[r.or.CanViewAuditLogVJ].some(i=>this._permissionService.hasPermission(i))},{value:"rebook_pnr",name:"Rebook PNR",icon:"",enabled:[r.or.CanRebookPNRVJ].some(i=>this._permissionService.hasPermission(i))}]}];if("VN"===o)return[{value:"booking_detail",name:"M\u1edf booking",icon:"external_link",enabled:[r.or.ViewAllFlightBookingDetail,r.or.ViewOwnFlightBookingDetail].some(i=>this._permissionService.hasPermission(i))},{value:"issue",name:"Xu\u1ea5t v\xe9",icon:"grouping",enabled:[r.or.CanIssuedFlightTicket].some(i=>this._permissionService.hasPermission(i))},{value:"boarding_pass",name:"M\u1eb7t v\xe9",icon:"coupon",enabled:[r.or.CreateFlightTicketFace].some(i=>this._permissionService.hasPermission(i))},{value:"addon_baggage",name:"Th\xeam h\xe0nh l\xfd",icon:"",enabled:[r.or.CanAddonFlightBaggage].some(i=>this._permissionService.hasPermission(i))},{value:"addon_seat",name:"Th\xeam ch\u1ed7 ng\u1ed3i",icon:"",enabled:[r.or.CanAddonFlightSeat].some(i=>this._permissionService.hasPermission(i))},{value:"add_journey",name:"Th\xeam h\xe0nh tr\xecnh",icon:"",enabled:[r.or.CanAddFlightJourney].some(i=>this._permissionService.hasPermission(i))},{value:"rerouting",name:"\u0110\u1ed5i h\xe0nh tr\xecnh",icon:"",enabled:[r.or.CanUpdateFlightJourney].some(i=>this._permissionService.hasPermission(i))},{value:"delete_segments",name:"H\u1ee7y h\xe0nh tr\xecnh",icon:"delete",enabled:[r.or.CanDeleteFlightSegment].some(i=>this._permissionService.hasPermission(i))},{value:"separate_passengers",name:"T\xe1ch h\xe0nh kh\xe1ch",icon:"",enabled:[r.or.CanSplitPassengerVN].some(i=>this._permissionService.hasPermission(i))},{value:"register_order",name:"Canh v\xe9 r\u1ebb",icon:"price_down",enabled:[r.or.CanMonitorLowFareTicket].some(i=>this._permissionService.hasPermission(i))},{value:"send_email",name:"G\u1eedi email",icon:"email",enabled:[r.or.CanSendEmail].some(i=>this._permissionService.hasPermission(i))},{value:"rebook_pnr",name:"Rebook PNR",icon:"",enabled:[r.or.CanRebookPNRVN].some(i=>this._permissionService.hasPermission(i))},{value:"update_membership",name:"Th\xeam th\u1ebb BSV",icon:"",enabled:[r.or.CanAddMemberShip].some(i=>this._permissionService.hasPermission(i))},{value:"add_infant",name:"Th\xeam em b\xe9",icon:"",enabled:!0},{value:"calculate_fare",name:"L\u1ea5y gi\xe1 th\u1ea5p nh\u1ea5t",icon:"",enabled:[r.or.CalculateFare].some(i=>this._permissionService.hasPermission(i))}];if("GDS"===o)return[{value:"booking_detail",name:"M\u1edf booking",icon:"external_link",enabled:[r.or.ViewAllFlightBookingDetail,r.or.ViewOwnFlightBookingDetail].some(i=>this._permissionService.hasPermission(i))},{value:"boarding_pass",name:"M\u1eb7t v\xe9",icon:"coupon",enabled:[r.or.CreateFlightTicketFace].some(i=>this._permissionService.hasPermission(i))}];if("QH"===o)return[{value:"booking_detail",name:"M\u1edf booking",icon:"external_link",enabled:[r.or.ViewAllFlightBookingDetail,r.or.ViewOwnFlightBookingDetail].some(i=>this._permissionService.hasPermission(i))},{value:"issue",name:"Xu\u1ea5t v\xe9",icon:"grouping",enabled:[r.or.CanIssuedFlightTicket].some(i=>this._permissionService.hasPermission(i))},{value:"boarding_pass",name:"M\u1eb7t v\xe9",icon:"coupon",enabled:[r.or.CreateFlightTicketFace].some(i=>this._permissionService.hasPermission(i))},{value:"register_order",name:"Canh v\xe9 r\u1ebb",icon:"price_down",enabled:[r.or.CanMonitorLowFareTicket].some(i=>this._permissionService.hasPermission(i))},{value:"send_email",name:"G\u1eedi email",icon:"email",enabled:[r.or.CanSendEmail].some(i=>this._permissionService.hasPermission(i))},{value:"separate_passengers",name:"T\xe1ch h\xe0nh kh\xe1ch",icon:"",enabled:[r.or.CanSplitPassengerQH].some(i=>this._permissionService.hasPermission(i))}];if("VU"===o)return[{value:"booking_detail",name:"M\u1edf booking",icon:"external_link",enabled:[r.or.ViewAllFlightBookingDetail,r.or.ViewOwnFlightBookingDetail].some(i=>this._permissionService.hasPermission(i))},{value:"issue",name:"Xu\u1ea5t v\xe9",icon:"grouping",enabled:[r.or.CanIssuedFlightTicket].some(i=>this._permissionService.hasPermission(i))},{value:"boarding_pass",name:"M\u1eb7t v\xe9",icon:"coupon",enabled:[r.or.CreateFlightTicketFace].some(i=>this._permissionService.hasPermission(i))}];if("SPA"===o)return[{value:"booking_detail",name:"M\u1edf booking",icon:"external_link",enabled:[r.or.ViewAllFlightBookingDetail,r.or.ViewOwnFlightBookingDetail].some(i=>this._permissionService.hasPermission(i))},{value:"issue",name:"Xu\u1ea5t v\xe9",icon:"grouping",enabled:[r.or.CanIssuedFlightTicket].some(i=>this._permissionService.hasPermission(i))},{value:"boarding_pass",name:"M\u1eb7t v\xe9",icon:"coupon",enabled:[r.or.CreateFlightTicketFace].some(i=>this._permissionService.hasPermission(i))},{value:"addon_baggage",name:"Th\xeam h\xe0nh l\xfd",icon:"",enabled:[r.or.CanAddonFlightBaggage].some(i=>this._permissionService.hasPermission(i))},{value:"addon_seat",name:"Th\xeam ch\u1ed7 ng\u1ed3i",icon:"",enabled:[r.or.CanAddonFlightSeat].some(i=>this._permissionService.hasPermission(i))}];if("ST"===o)return[{value:"booking_detail",name:"M\u1edf booking",icon:"external_link",enabled:[r.or.ViewAllFlightBookingDetail,r.or.ViewOwnFlightBookingDetail].some(i=>this._permissionService.hasPermission(i))},{value:"issue",name:"Xu\u1ea5t v\xe9",icon:"grouping",enabled:!0},{value:"boarding_pass",name:"M\u1eb7t v\xe9",icon:"coupon",enabled:[r.or.CreateFlightTicketFace].some(i=>this._permissionService.hasPermission(i))}];if("BZT"===o)return[{value:"booking_detail",name:"M\u1edf booking",icon:"external_link",enabled:[r.or.ViewAllFlightBookingDetail,r.or.ViewOwnFlightBookingDetail].some(i=>this._permissionService.hasPermission(i))},{value:"issue",name:"Xu\u1ea5t v\xe9",icon:"grouping",enabled:[r.or.CanIssuedFlightTicketBZT].some(i=>this._permissionService.hasPermission(i))},{value:"boarding_pass",name:"M\u1eb7t v\xe9",icon:"coupon",enabled:[r.or.CreateFlightTicketFace].some(i=>this._permissionService.hasPermission(i))},{value:"cancel_booking",name:"H\u1ee7y h\xe0nh tr\xecnh",icon:"delete",enabled:[r.or.CancelBookingBZT].some(i=>this._permissionService.hasPermission(i))}];{const i=[{value:"booking_detail",name:"M\u1edf booking",icon:"external_link",enabled:[r.or.ViewAllFlightBookingDetail,r.or.ViewOwnFlightBookingDetail].some(a=>this._permissionService.hasPermission(a))},{value:"boarding_pass",name:"M\u1eb7t v\xe9",icon:"coupon",enabled:[r.or.CreateFlightTicketFace].some(a=>this._permissionService.hasPermission(a))}];return"AIR_1G"===(null==o?void 0:o.toUpperCase())&&(i.push({value:"register_order",name:"Canh v\xe9 r\u1ebb",icon:"price_down",enabled:[r.or.CanMonitorLowFareGDSTicket].some(a=>this._permissionService.hasPermission(a))}),i.push({value:"send_email",name:"G\u1eedi email",icon:"email",enabled:[r.or.CanSendEmail].some(a=>this._permissionService.hasPermission(a))})),[r.or.CanIssuedFlightTicket].some(a=>this._permissionService.hasPermission(a))&&("BSP"===(null==o?void 0:o.toUpperCase())&&this._permissionService.hasPermission(r.or.CanIssuedFlightTicketBSP)&&i.push({value:"issue",name:"Xu\u1ea5t v\xe9",icon:"grouping",enabled:!0}),"AIR_1G"===(null==o?void 0:o.toUpperCase())&&this._permissionService.hasPermission(r.or.CanIssuedFlightTicket1G)&&i.push({value:"issue",name:"Xu\u1ea5t v\xe9",icon:"grouping",enabled:!0})),"BSP"===(null==o?void 0:o.toUpperCase())&&(i.push({value:"register_order",name:"Canh v\xe9 r\u1ebb",icon:"price_down",enabled:[r.or.CanMonitorLowFareGDSTicket].some(a=>this._permissionService.hasPermission(a))}),this._permissionService.hasPermission(r.or.CancelBookingBSP)&&i.push({value:"cancel_booking",name:"H\u1ee7y h\xe0nh tr\xecnh",icon:"delete",enabled:!0})),i}case"ISSUED":if("VN"===o)return[{value:"booking_detail",name:"M\u1edf booking",icon:"external_link",enabled:[r.or.ViewAllFlightBookingDetail,r.or.ViewOwnFlightBookingDetail].some(i=>this._permissionService.hasPermission(i))},{value:"boarding_pass",name:"M\u1eb7t v\xe9",icon:"coupon",enabled:[r.or.CreateFlightTicketFace].some(i=>this._permissionService.hasPermission(i))},{value:"addon_baggage",name:"Th\xeam h\xe0nh l\xfd",icon:"",enabled:[r.or.CanAddonFlightBaggage].some(i=>this._permissionService.hasPermission(i))},{value:"send_email",name:"G\u1eedi email",icon:"email",enabled:[r.or.CanSendEmail].some(i=>this._permissionService.hasPermission(i))},{value:"void",name:"Void v\xe9",icon:"coupon_slash",enabled:[r.or.CanVoidFlightTicket].some(i=>this._permissionService.hasPermission(i))},{value:"register_order",name:"Canh v\xe9 r\u1ebb",icon:"price_down",enabled:[r.or.CanMonitorLowFareTicket].some(i=>this._permissionService.hasPermission(i))},{value:"addon_seat",name:"Th\xeam ch\u1ed7 ng\u1ed3i",icon:"",enabled:[r.or.CanAddonFlightSeat].some(i=>this._permissionService.hasPermission(i))},{value:"delete_segments",name:"H\u1ee7y h\xe0nh tr\xecnh",icon:"delete",enabled:[r.or.CanDeleteFlightSegment].some(i=>this._permissionService.hasPermission(i))},{value:"rerouting",name:"\u0110\u1ed5i h\xe0nh tr\xecnh",icon:"",enabled:[r.or.CanUpdateFlightJourney].some(i=>this._permissionService.hasPermission(i))},{value:"separate_passengers",name:"T\xe1ch h\xe0nh kh\xe1ch",icon:"",enabled:[r.or.CanSplitPassengerVN].some(i=>this._permissionService.hasPermission(i))},{value:"check_in_online",name:"Check in",icon:"",enabled:!0},{value:"update_membership",name:"Th\xeam th\u1ebb BSV",icon:"",enabled:[r.or.CanAddMemberShip].some(i=>this._permissionService.hasPermission(i))}];if("GDS"===o)return[{value:"booking_detail",name:"M\u1edf booking",icon:"external_link",enabled:[r.or.ViewAllFlightBookingDetail,r.or.ViewOwnFlightBookingDetail].some(i=>this._permissionService.hasPermission(i))},{value:"boarding_pass",name:"M\u1eb7t v\xe9",icon:"coupon",enabled:[r.or.CreateFlightTicketFace].some(i=>this._permissionService.hasPermission(i))}];if("QH"===o){const i=[{value:"booking_detail",name:"M\u1edf booking",icon:"external_link",enabled:[r.or.ViewAllFlightBookingDetail,r.or.ViewOwnFlightBookingDetail].some(a=>this._permissionService.hasPermission(a))},{value:"boarding_pass",name:"M\u1eb7t v\xe9",icon:"coupon",enabled:[r.or.CreateFlightTicketFace].some(a=>this._permissionService.hasPermission(a))},{value:"addon_baggage",name:"Th\xeam h\xe0nh l\xfd",icon:"",enabled:[r.or.CanAddonFlightBaggage].some(a=>this._permissionService.hasPermission(a))},{value:"send_email",name:"G\u1eedi email",icon:"email",enabled:[r.or.CanSendEmail].some(a=>this._permissionService.hasPermission(a))},{value:"check_in_online",name:"Check in",icon:"",enabled:!0},{value:"separate_passengers",name:"T\xe1ch h\xe0nh kh\xe1ch",icon:"",enabled:[r.or.CanSplitPassengerQH].some(a=>this._permissionService.hasPermission(a))}];return P.kp.qh&&i.push({value:"addon_seat",name:"Th\xeam ch\u1ed7 ng\u1ed3i",icon:"",enabled:[r.or.CanAddonFlightSeat].some(a=>this._permissionService.hasPermission(a))}),i}if("VJ"===o)return 0===n?[{value:"add_journey",name:"Th\xeam h\xe0nh tr\xecnh",icon:"",enabled:[r.or.CanAddFlightJourney].some(i=>this._permissionService.hasPermission(i))},{value:"separate_passengers",name:"T\xe1ch h\xe0nh kh\xe1ch",icon:"",enabled:[r.or.CanSplitPassengerVJ].some(i=>this._permissionService.hasPermission(i))&&this._systemService.isFeatureEnabled(P.Ke.Web_Features_SplitPassenger_SplitPassengerVJ_Enable)}]:[{value:"booking_detail",name:"M\u1edf booking",icon:"external_link",enabled:[r.or.ViewAllFlightBookingDetail,r.or.ViewOwnFlightBookingDetail].some(i=>this._permissionService.hasPermission(i))},{value:"boarding_pass",name:"M\u1eb7t v\xe9",icon:"coupon",enabled:[r.or.CreateFlightTicketFace].some(i=>this._permissionService.hasPermission(i))},{value:"addon_baggage",name:"Th\xeam h\xe0nh l\xfd",icon:"",enabled:[r.or.CanAddonFlightBaggage].some(i=>this._permissionService.hasPermission(i))},{value:"addon_seat",name:"Th\xeam ch\u1ed7 ng\u1ed3i",icon:"",enabled:[r.or.CanAddonFlightSeat].some(i=>this._permissionService.hasPermission(i))},{value:"add_journey",name:"Th\xeam h\xe0nh tr\xecnh",icon:"",enabled:[r.or.CanAddFlightJourney].some(i=>this._permissionService.hasPermission(i))},{value:"rerouting",name:"\u0110\u1ed5i h\xe0nh tr\xecnh",icon:"",enabled:[r.or.CanUpdateFlightJourney].some(i=>this._permissionService.hasPermission(i))},{value:"delete_each_journey",name:"H\u1ee7y h\xe0nh tr\xecnh",icon:"delete",enabled:[r.or.CanDeleteFlightSegment].some(i=>this._permissionService.hasPermission(i))},{value:"separate_passengers",name:"T\xe1ch h\xe0nh kh\xe1ch",icon:"",enabled:[r.or.CanSplitPassengerVJ].some(i=>this._permissionService.hasPermission(i))&&this._systemService.isFeatureEnabled(P.Ke.Web_Features_SplitPassenger_SplitPassengerVJ_Enable)},{value:"update_pax_info",name:"S\u1eeda h\xe0nh kh\xe1ch",icon:"",enabled:[r.or.CanUpdatePaxInfoVJ].some(i=>this._permissionService.hasPermission(i))},{value:"send_email",name:"G\u1eedi email",icon:"email",enabled:[r.or.CanSendEmail].some(i=>this._permissionService.hasPermission(i))},{value:"open_audit_log",name:"Ki\u1ec3m to\xe1n \u0111\u1eb7t ch\u1ed7",icon:"",enabled:[r.or.CanViewAuditLogVJ].some(i=>this._permissionService.hasPermission(i))},{value:"check_in_online",name:"Check in",icon:"",enabled:!0}];if("VU"===o)return[{value:"booking_detail",name:"M\u1edf booking",icon:"external_link",enabled:[r.or.ViewAllFlightBookingDetail,r.or.ViewOwnFlightBookingDetail].some(i=>this._permissionService.hasPermission(i))},{value:"boarding_pass",name:"M\u1eb7t v\xe9",icon:"coupon",enabled:[r.or.CreateFlightTicketFace].some(i=>this._permissionService.hasPermission(i))}];if("SPA"===o)return[{value:"booking_detail",name:"M\u1edf booking",icon:"external_link",enabled:[r.or.ViewAllFlightBookingDetail,r.or.ViewOwnFlightBookingDetail].some(i=>this._permissionService.hasPermission(i))},{value:"boarding_pass",name:"M\u1eb7t v\xe9",icon:"coupon",enabled:[r.or.CreateFlightTicketFace].some(i=>this._permissionService.hasPermission(i))},{value:"addon_baggage",name:"Th\xeam h\xe0nh l\xfd",icon:"",enabled:[r.or.CanAddonFlightBaggage].some(i=>this._permissionService.hasPermission(i))},{value:"addon_seat",name:"Th\xeam ch\u1ed7 ng\u1ed3i",icon:"",enabled:[r.or.CanAddonFlightSeat].some(i=>this._permissionService.hasPermission(i))}];{const i=[{value:"booking_detail",name:"M\u1edf booking",icon:"external_link",enabled:[r.or.ViewAllFlightBookingDetail,r.or.ViewOwnFlightBookingDetail].some(a=>this._permissionService.hasPermission(a))},{value:"boarding_pass",name:"M\u1eb7t v\xe9",icon:"coupon",enabled:[r.or.CreateFlightTicketFace].some(a=>this._permissionService.hasPermission(a))},{value:"check_in_online",name:"Check in",icon:"",enabled:!0}];return"BSP"===(null==o?void 0:o.toUpperCase())&&(i.push({value:"register_order",name:"Canh v\xe9 r\u1ebb",icon:"price_down",enabled:[r.or.CanMonitorLowFareGDSTicket].some(a=>this._permissionService.hasPermission(a))}),this._permissionService.hasPermission(r.or.CancelBookingBSP)&&i.push({value:"cancel_booking",name:"H\u1ee7y h\xe0nh tr\xecnh",icon:"delete",enabled:!0})),"AIR_1G"===(null==o?void 0:o.toUpperCase())&&(i.push({value:"register_order",name:"Canh v\xe9 r\u1ebb",icon:"price_down",enabled:[r.or.CanMonitorLowFareGDSTicket].some(a=>this._permissionService.hasPermission(a))}),i.push({value:"send_email",name:"G\u1eedi email",icon:"email",enabled:[r.or.CanSendEmail].some(a=>this._permissionService.hasPermission(a))})),i}case"VOID":return"VJ"===o?[{value:"booking_detail",name:"M\u1edf booking",icon:"external_link",enabled:[r.or.ViewAllFlightBookingDetail,r.or.ViewOwnFlightBookingDetail].some(i=>this._permissionService.hasPermission(i))},{value:"issue",name:"Xu\u1ea5t v\xe9",icon:"grouping",enabled:[r.or.CanIssuedFlightTicket].some(i=>this._permissionService.hasPermission(i))},{value:"boarding_pass",name:"M\u1eb7t v\xe9",icon:"coupon",enabled:[r.or.CreateFlightTicketFace].some(i=>this._permissionService.hasPermission(i))},{value:"other",name:"Kh\xe1c",icon:"options_vertical",enabled:[r.or.CanAddonFlightBaggage,r.or.CanAddonFlightSeat].some(i=>this._permissionService.hasPermission(i)),items:[{value:"addon_baggage",name:"Th\xeam h\xe0nh l\xfd",icon:"",enabled:[r.or.CanAddonFlightBaggage].some(i=>this._permissionService.hasPermission(i))},{value:"addon_seat",name:"Th\xeam ch\u1ed7 ng\u1ed3i",icon:"",enabled:[r.or.CanAddonFlightSeat].some(i=>this._permissionService.hasPermission(i))},{value:"open_audit_log",name:"Ki\u1ec3m to\xe1n \u0111\u1eb7t ch\u1ed7",icon:"",enabled:[r.or.CanViewAuditLogVJ].some(i=>this._permissionService.hasPermission(i))}]}]:"GDS"===o?[{value:"booking_detail",name:"M\u1edf booking",icon:"external_link",enabled:[r.or.ViewAllFlightBookingDetail,r.or.ViewOwnFlightBookingDetail].some(i=>this._permissionService.hasPermission(i))},{value:"boarding_pass",name:"M\u1eb7t v\xe9",icon:"coupon",enabled:[r.or.CreateFlightTicketFace].some(i=>this._permissionService.hasPermission(i))}]:[{value:"booking_detail",name:"M\u1edf booking",icon:"external_link",enabled:[r.or.ViewAllFlightBookingDetail,r.or.ViewOwnFlightBookingDetail].some(i=>this._permissionService.hasPermission(i))},{value:"issue",name:"Xu\u1ea5t v\xe9",icon:"grouping",enabled:[r.or.CanIssuedFlightTicket].some(i=>this._permissionService.hasPermission(i))},{value:"boarding_pass",name:"M\u1eb7t v\xe9",icon:"coupon",enabled:[r.or.CreateFlightTicketFace].some(i=>this._permissionService.hasPermission(i))}];case"CANCEL":return"VN"===o?[{value:"add_journey",name:"Th\xeam h\xe0nh tr\xecnh",icon:"",enabled:[r.or.CanAddFlightJourney].some(i=>this._permissionService.hasPermission(i))},{value:"rebook_pnr",name:"Rebook PNR",icon:"",enabled:[r.or.CanRebookPNRVN].some(i=>this._permissionService.hasPermission(i))}]:"VJ"===o?[{value:"rebook_pnr",name:"Rebook PNR",icon:"",enabled:[r.or.CanRebookPNRVJ].some(i=>this._permissionService.hasPermission(i))}]:[];default:return[]}}onRetryBooking(t){const o=this.bookingRequest.data.bookingFlights.bookingOptions.filter(i=>t.includes(i.journeyKey)),n=Object.assign(Object.assign({},this.bookingRequest),{data:Object.assign(Object.assign({},this.bookingRequest.data),{bookingFlights:{mode:this.bookingRequest.data.bookingFlights.mode,bookingOptions:o.map((i,a)=>Object.assign(Object.assign({},i),{leg:a}))},bookingPassengers:this.bookingRequest.data.bookingPassengers.map(i=>Object.assign(Object.assign({},i),{bookingBaggages:i.bookingBaggages.filter(a=>t.includes(a.journeyKey)),bookingSeats:i.bookingSeats.filter(a=>t.includes(a.journeyKey))}))})});this.isLoading=!0,this._bookFlightService.bookFlight(n).pipe((0,I.x)(()=>this.isLoading=!1)).subscribe({next:i=>{this.handleBookingResult(i,n.data.payNow)},error:()=>{this._modal.open(ee.xG,{isSuccess:!1,body:"Vui l\xf2ng th\u1eed l\u1ea1i ho\u1eb7c li\xean h\u1ec7 booker \u0111\u1ec3 \u0111\u01b0\u1ee3c h\u1ed7 tr\u1ee3!"})}})}handleBookingResult(t,o){var n,i;if("OK"===t.status){this.bookFlightResult=t;const a=[];let s=!0;t.data.forEach((m,d)=>{"ERROR"===m.status&&(s=!1,a.push(`${m.bookingResult.journeys[0].departure.airport.code}${m.bookingResult.journeys[0].arrival.airport.code}`))}),this._modal.open(ee.xG,{isSuccess:s,title:o?"Xu\u1ea5t v\xe9 th\xe0nh c\xf4ng":"\u0110\u1eb7t ch\u1ed7 th\xe0nh c\xf4ng",body:o?"B\u1ea1n \u0111\xe3 xu\u1ea5t v\xe9 th\xe0nh c\xf4ng":"B\u1ea1n \u0111\xe3 \u0111\u1eb7t ch\u1ed7 th\xe0nh c\xf4ng",listFlight:s?[]:a}).afterClosed$.subscribe({next:()=>{this.isSuccess=this.bookFlightResult.data.some(m=>"OK"===m.status),this.isSuccess&&this.initPassenger(),this.initBookingDetail()}})}else this._modal.open(ee.xG,{isSuccess:!1,body:(null===(i=null===(n=t.objectError)||void 0===n?void 0:n.errorDescription)||void 0===i?void 0:i.vi)||"Vui l\xf2ng th\u1eed l\u1ea1i ho\u1eb7c li\xean h\u1ec7 booker \u0111\u1ec3 \u0111\u01b0\u1ee3c h\u1ed7 tr\u1ee3!"})}getShortRetrieve(t,o){this._searchFlightService.getShortRetrieve({airline:t,bookingCode:o}).subscribe({next:i=>{if(i.success){const a=this.bookFlightResult.data.find(h=>h.bookingResult.bookingCode===o);let s=this.bookingDetails.find(h=>h.bookingCode===o);s&&(s.bookingTextExplain=i.data.bookingTextExplain),a&&(a.bookingResult.bookingText=i.data.bookingText,a.bookingResult.bookingTextExplain=i.data.bookingTextExplain,a.bookingResult.totalCharges=i.data.totalCharges,this._bookingResultDataProvider.bookingResultData=this.bookFlightResult,this.bookFlightResult=(0,W.yE)($.aM,this._bookingResultDataProvider.bookingResultData,{excludeExtraneousValues:!0}),this.getBooingText(),s=this.parseBookingResult(a.bookingResult),this.bookingDetails.forEach(h=>{h.bookingCode===o&&s&&(h.totalFare=s.totalFare,h.totalDiscountFare=s.totalDiscountFare,h.totalServiceFee=s.totalServiceFee,h.totalCharge=s.totalCharge,h.targetPriceOrder=s.targetPriceOrder,h.totalAddonCharge=s.totalAddonCharge)}))}}})}togglePriceBottomSheet(t){this.isShowTotalPriceBts=!this.isShowTotalPriceBts,this.isShowTotalPriceBts?(this.showTotalPriceBts=this._bottomSheetService.open(t,{headerTitle:"Gi\xe1 v\xe9",rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4"}),this.zIndexPriceIncrease=!0,this.showTotalPriceBts.afterDismissed().subscribe(o=>{this.isShowTotalPriceBts=!1,this.zIndexPriceIncrease=!1}),this.showTotalPriceBts.containerInstance._rightButtonClick.subscribe(o=>{this.showTotalPriceBts.dismiss(),this.zIndexPriceIncrease=!1})):this.showTotalPriceBts&&this.showTotalPriceBts.dismiss()}mobileDetailClick(t){const o=this._bottomSheetService.open(y.iU,{headerTitle:"Chi ti\u1ebft \u0111\u1eb7t ch\u1ed7",rightButtonIcon:"",leftButtonIcon:"close",leftButtonIconClass:"text-neutral-gray-4",containerFullHeigh:!0,data:{flightInfos:[this.getFlightInfoDetail(t)],hasDiscountFare:this.hasDiscountFare,hasWaitlistBooking:this.hasWaitlistBooking}});o.containerInstance._leftButtonClick.subscribe(n=>{o.dismiss()})}mobileTabChange(t,o){this.mobileTabMode=t,o.scrollIntoView({behavior:"smooth",inline:"center"}),"FARE_RULE"===this.mobileTabMode&&this.getFareRule()}getFlightInfoDetail(t){var o,n,i,a,s,h;return{supplier:t.supplier,provider:t.provider,segments:t.journeys.flatMap((d,u)=>d.segments.map((l,p)=>({airline:l.airline,airlineSystem:l.airline,airlineName:l.airlineName,airlineLogo:l.airlineLogo,mobileAirlineLogo:["VJ","VN","QH"].includes(l.airline)?"assets/airline-logo/"+l.airline+"_small.png":"assets/airline-logo/"+l.airline+".png",flightNumber:l.airline+l.flightNumber,startTime:A(l.startTime).format("HH:mm"),startDate:A(l.startTime).format("DD/MM/YYYY"),startPoint:l.startPoint,startPointName:l.startPointName,startAirport:this._locationDataService.getAirportNameByCode(l.startPoint),endTime:A(l.endTime).format("HH:mm"),endDate:A(l.endTime).format("DD/MM/YYYY"),endPoint:l.endPoint,endPointName:l.endPointName,endAirport:this._locationDataService.getAirportNameByCode(l.endPoint),startTerminal:l.startTerminal,endTerminal:l.endTerminal,stopPoint:l.stopPoint,modelAirplane:l.modelAirplane,badge:0===u?"Chi\u1ec1u \u0111i":"Chi\u1ec1u v\u1ec1",rules:[{name:"T\xecnh tr\u1ea1ng ch\u1ed7",value:l.status||""},{name:"Th\u1eddi gian bay",value:l.duration},{name:"Lo\u1ea1i m\xe1y bay",value:l.modelAirplane},{name:"H\u1ea1ng ch\u1ed7",value:(l.fareType||"")+(l.fareClass?`(${l.fareClass})`:"N/A")},{name:"H\xe0nh l\xfd k\xfd g\u1eedi",value:l.checkedBaggage||"N/A"},{name:"H\xe0nh l\xfd x\xe1ch tay",value:l.handBaggage||"N/A"}]}))),statusDesc:t.statusDesc,timeHoldBooking:t.timeHoldBooking||"",timeHoldPricing:t.timeHoldPricing||"",airlineSystem:t.airlineSystem,airlineName:t.airlineName,totalPrice:this.totalPrice||0,totalFare:t.totalFare,totalDiscountFareCharge:this.totalDiscountFareCharge||0,totalServiceFee:this.priceDetail.totalServiceFee||0,totalAddonService:this.priceDetail.totalAddonService||0,totalOthersCharge:this.priceDetail.totalOthersCharge||0,totalDiscountBasePrice:t.totalDiscountFare,passengers:t.passengers.map(d=>({name:d.name,type:d.type,farePrice:d.farePrice,tax:d.tax,vat:d.vat,discountAmount:d.discountAmount,totalDiscountFarePrice:d.totalDiscountFarePrice,total:d.total})),status:t.status,journeyStatus:{active:null!==(n=null===(o=t.journeys[0].journeyStatus)||void 0===o?void 0:o.active)&&void 0!==n&&n,cancelled:null!==(a=null===(i=t.journeys[0].journeyStatus)||void 0===i?void 0:i.cancelled)&&void 0!==a&&a,disrupted:null!==(h=null===(s=t.journeys[0].journeyStatus)||void 0===s?void 0:s.disrupted)&&void 0!==h&&h}}}onDeleteSegment(t){const o=t.journeys.flatMap(i=>i.segments).map((i,a)=>({order:a+1,segmentKey:i.key,journey:`${i.startPointName} (${i.startPoint}) - ${i.endPointName} (${i.endPoint})`,startTime:A(i.startTime).format("HH:mm DD/MM/YYYY"),flightNumber:`${i.airline}${i.flightNumber}`,status:""})),n={airline:t.airline,bookingCode:t.bookingCode,provider:t.provider};if(this._detectMobileService.isMobile()){const i=this._bottomSheetService.open(y.df,{headerTitle:"H\u1ee7y h\xe0nh tr\xecnh",rightButtonIcon:"",leftButtonIcon:"close",leftButtonIconClass:"text-neutral-gray-4",containerFullHeigh:!0,data:{listSegmentData:o,bookingInfo:n}});i.containerInstance._leftButtonClick.subscribe(a=>i.dismiss()),i.afterDismissed().subscribe(a=>{a&&this.gotoBookingDetail(n.airline,n.bookingCode)})}else this._modal.open(y.df,{listSegmentData:o,bookingInfo:n}).afterClosed$.subscribe({next:a=>{a.data&&this.gotoBookingDetail(n.airline,n.bookingCode)}})}onCopyBookingCode(t){this.clipboard.copy(t),this._toastService.add({severity:"success",summary:"\u0110\xe3 sao ch\xe9p n\u1ed9i dung",detail:"N\u1ed9i dung \u0111\xe3 \u0111\u01b0\u1ee3c sao ch\xe9p v\xe0o b\u1ed9 nh\u1edb t\u1ea1m"})}onDeleteEachJourney(t){this.checkRuleMMBVJ(t)?this.handleMMBVJCancelBoooking():(this.isLoading=!0,this._manageBookingService.validateBeforeModifyJourney(t.bookingCode,"CANCEL_JOURNEY").subscribe({next:o=>{this.isLoading=!1,o.status&&(1==o.data.canModify?(this.journeyForDeletes=t.journeys.map((n,i)=>({index:i,pnr:t.bookingCode,journeyKey:n.key,airlineLogoUrl:`assets/airline-logo/${n.airline}_short_logo.png`,airlineCode:n.airline,airlineName:n.airlineName,startPointCode:n.startPoint,endPointCode:n.endPoint,startPointName:n.startPointName,endPointName:n.endPointName,startDate:n.startTime,journeyType:n.segments.length>1?n.segments.length-1+" ch\u1eb7ng d\u1eebng":"Bay th\u1eb3ng",status:t.status,isSelected:0==i})),this.openSelectJourneyForCancel()):"DOWN_FARE"==o.data.type&&this._modal.open(v.V0,{title:"V\xe9 \u0111ang \u0111\u01b0\u1ee3c canh",body:"Kh\xf4ng th\u1ec3 h\u1ee7y h\xe0nh tr\xecnh khi \u0111ang canh v\xe9 r\u1ebb. Vui l\xf2ng h\u1ee7y canh v\xe9 h\xe0nh tr\xecnh n\xe0y tr\u01b0\u1edbc khi ti\u1ebfp t\u1ee5c",okText:"M\u1edf canh v\xe9",cancelText:"\u0110\xf3ng",hasIcon:!0}).afterClosed$.subscribe({next:i=>{i.data&&this.gotoDownFareDetail(o.data.orderId)}}))},error:o=>{this.isLoading=!1,console.log(o)}}))}openSelectJourneyForCancel(){if(this._detectMobileService.isMobile()){const t=this._bottomSheetService.open(y.Xg,{headerTitle:"Ch\u1ecdn h\xe0nh tr\xecnh c\u1ea7n h\u1ee7y",rightButtonIcon:"",leftButtonIcon:"close",leftButtonIconClass:"text-neutral-gray-4",containerFullHeigh:!0,data:{journeys:this.journeyForDeletes}});t.containerInstance._leftButtonClick.subscribe(o=>t.dismiss()),t.afterDismissed().subscribe(o=>{o&&this.onDeleteJourneyConfirm(o.journey,o.quotation)})}else this._modal.open(y.Xg,{journeys:this.journeyForDeletes}).afterClosed$.subscribe({next:o=>{o.data&&this.onDeleteJourneyConfirm(o.data.journey,o.data.quotation)}})}onDeleteJourneyConfirm(t,o){let n={airline:t.airlineCode,journeyKey:t.journeyKey,pnr:t.pnr,startPointCode:t.startPointCode,endPointCode:t.endPointCode,startDate:t.startDate,journeyType:t.journeyType,status:t.status,currentJourneyPrice:o.data.cancelJourney.charge.total,paid:"BOOKED"==t.status?0:"ISSUED"==t.status?o.data.cancelJourney.charge.total:0,cancelFee:o.data.cancelCharge.total,totalFee:"BOOKED"==t.status?o.data.totalCharge.total:void 0,noGiveBack:"ISSUED"==t.status?o.data.nonRefund.total:void 0,reservePrice:"ISSUED"==t.status?o.data.refund.total:void 0,totalCharge:o.data.totalCharge.total};if(this._detectMobileService.isMobile()){const i=this._bottomSheetService.open(y.mO,{headerTitle:"X\xe1c nh\u1eadn chi ph\xed",rightButtonIcon:"",leftButtonIcon:"close",leftButtonIconClass:"text-neutral-gray-4",containerFullHeigh:!0,data:{journeyConfirm:n}});i.containerInstance._leftButtonClick.subscribe(a=>i.dismiss()),i.afterDismissed().subscribe(a=>{a&&a&&("OK"==a.type&&(this._toastService.add({severity:"success",summary:"H\u1ee7y h\xe0nh tr\xecnh th\xe0nh c\xf4ng",detail:"H\xe0nh tr\xecnh \u0111\xe3 \u0111\u01b0\u1ee3c h\u1ee7y th\xe0nh c\xf4ng!",sticky:!1}),this.gotoBookingDetail(t.airlineCode,t.pnr)),"FAILED"==a.type&&"BE-EA019"==a.data&&this._modal.open(v.V0,{title:"Qu\xe1 th\u1eddi h\u1ea1n h\u1ee7y h\xe0nh tr\xecnh",body:"B\u1ea1n ch\u1ec9 c\xf3 th\u1ec3 th\u1ef1c hi\u1ec7n H\u1ee7y h\xe0nh tr\xecnh tr\u01b0\u1edbc gi\u1edd bay 24 ti\u1ebfng",okText:"\u0110\xf3ng",hasIcon:!0,hasCancel:!1}),"BACK"==a.type&&this.openSelectJourneyForCancel())})}else this._modal.open(y.mO,{journeyConfirm:n}).afterClosed$.subscribe({next:a=>{a.data&&"OK"==a.data.type&&(this._toastService.add({severity:"success",summary:"H\u1ee7y h\xe0nh tr\xecnh th\xe0nh c\xf4ng",detail:"H\xe0nh tr\xecnh \u0111\xe3 \u0111\u01b0\u1ee3c h\u1ee7y th\xe0nh c\xf4ng!",sticky:!1}),this.gotoBookingDetail(t.airlineCode,t.pnr)),"FAILED"==a.data.type&&"BE-EA019"==a.data.data&&this._modal.open(v.V0,{title:"Qu\xe1 th\u1eddi h\u1ea1n h\u1ee7y h\xe0nh tr\xecnh",body:"B\u1ea1n ch\u1ec9 c\xf3 th\u1ec3 th\u1ef1c hi\u1ec7n H\u1ee7y h\xe0nh tr\xecnh tr\u01b0\u1edbc gi\u1edd bay 24 ti\u1ebfng",okText:"\u0110\xf3ng",hasIcon:!0,hasCancel:!1}),"BACK"==a.data.type&&this.openSelectJourneyForCancel()}})}onShowIdentityReservation(){let t={pnr:"ABCDEF",expirationDate:new Date,passengers:[{name:"Nguyen Thanh Duong",type:"ADT",price:1e6},{name:"Nguyen Thanh Duong 2",type:"ADT",price:2e6}]};if(this._detectMobileService.isMobile()){this.zIndexPriceIncrease=!1;const o=this._bottomSheetService.open(y.$u,{headerTitle:"B\u1ea3o l\u01b0u \u0111\u1ecbnh danh h\xe0nh kh\xe1ch",rightButtonIcon:"",leftButtonIcon:"close",leftButtonIconClass:"text-neutral-gray-4",containerFullHeigh:!0,data:{info:t}});o.containerInstance._leftButtonClick.subscribe(n=>{this.zIndexPriceIncrease=!0,o.dismiss()}),o.afterDismissed().subscribe(n=>this.zIndexPriceIncrease=!0)}else this._modal.open(y.$u,{info:t})}onRegisterOrder(t){var o;if(["BSP","AIR_1G"].includes((null===(o=t.provider)||void 0===o?void 0:o.toUpperCase())||"")){const n=i=>{this.isLoading=!0,this._ticketLowFareService.registerTriggerOrderGds(i).pipe((0,I.x)(()=>this.isLoading=!1)).subscribe({next:a=>{console.log(a),this._toastService.add("OK"===a.status?{severity:"success",summary:"Th\xe0nh c\xf4ng",detail:`T\u1ea1o \u0111\u01a1n canh v\xe9 cho m\xe3 \u0111\u1eb7t ch\u1ed7 ${t.bookingCode} th\xe0nh c\xf4ng`,sticky:!1}:{severity:"error",summary:"Th\u1ea5t b\u1ea1i",detail:`T\u1ea1o \u0111\u01a1n canh v\xe9 cho m\xe3 \u0111\u1eb7t ch\u1ed7 ${t.bookingCode} th\u1ea5t b\u1ea1i. Vui l\xf2ng th\u1eed l\u1ea1i sau`,sticky:!0})},error:()=>{this._toastService.add({severity:"error",summary:"Th\u1ea5t b\u1ea1i",detail:`T\u1ea1o \u0111\u01a1n canh v\xe9 cho m\xe3 \u0111\u1eb7t ch\u1ed7 ${t.bookingCode} th\u1ea5t b\u1ea1i. Vui l\xf2ng th\u1eed l\u1ea1i sau`,sticky:!0})}})};if(this._detectMobileService.isMobile()){const i=this._bottomSheetService.open(_e.C,{headerTitle:"T\u1ea1o y\xeau c\u1ea7u canh v\xe9 r\u1ebb",rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4",leftButtonIcon:"",containerFullHeigh:!0,data:{bookingDetail:t}});i.containerInstance._rightButtonClick.subscribe(a=>i.dismiss()),i.afterDismissed().subscribe(a=>{a&&n({pnr:t.bookingCode,timeExpire:a})})}else this._modal.open(_e.C,{bookingDetail:t}).afterClosed$.subscribe({next:a=>{console.log(a),a.data&&n({pnr:t.bookingCode,timeExpire:a.data})}})}else{const n={airline:t.airline,pnr:t.bookingCode};this.isLoading=!0,this._ticketLowFareService.canMonitorLowFare(n).pipe((0,I.x)(()=>this.isLoading=!1)).subscribe({next:i=>{var a,s,h,m;if("OK"===i.status&&null!==(a=i.data.canMonitor)&&void 0!==a&&a.enable)if(this._detectMobileService.isMobile()){const d=this._bottomSheetService.open(X.g,{headerTitle:"T\u1ea1o y\xeau c\u1ea7u canh v\xe9 r\u1ebb",rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4",leftButtonIcon:"",containerFullHeigh:!0,data:{bookingDetail:t,sourceEvent:"BOOKING_SUCCESS"}});d.containerInstance._rightButtonClick.subscribe(u=>d.dismiss())}else{const d=this._modal.open(X.g,{bookingDetail:t,sourceEvent:"BOOKING_SUCCESS"});d.afterClosed$.subscribe({next:u=>{u.data||d.close(!1)}})}else if("OK"!==i.status||null!==(s=i.data.canMonitor)&&void 0!==s&&s.enable){const d=null===(m=null===(h=i.objectError)||void 0===h?void 0:h.errorDescription)||void 0===m?void 0:m.vi;this._modal.open(te.V,{title:"M\xe3 \u0111\u1eb7t ch\u1ed7 kh\xf4ng h\u1ee3p l\u1ec7",content:d,status:"error",cancelText:"\u0110\xf3ng",okText:"Canh v\xe9 kh\xe1c",secondaryAction:!0}).afterClosed$.subscribe({next:l=>{l.data&&this.onRegisterNewPnrOrder()}})}else{let d="Xem danh s\xe1ch";d="TPS-TLF006"===i.data.canMonitor.reason.errorCode?"Qu\u1ea3n l\xfd canh v\xe9":"Canh v\xe9 kh\xe1c";const u=i.data.canMonitor.reason.desc;if(this._detectMobileService.isMobile()){const l=this._bottomSheetService.open(v.Q4,{headerTitle:"",rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4",data:{title:"M\xe3 \u0111\u1eb7t ch\u1ed7 kh\xf4ng h\u1ee3p l\u1ec7",body:u,okText:d,cancelText:"\u0110\xf3ng",hasIcon:!0,status:"error"}});l.containerInstance._rightButtonClick.subscribe(()=>{l.dismiss()}),l.afterDismissed().subscribe(p=>{p&&this.onRegisterNewPnrOrder()})}else this._modal.open(te.V,{title:"M\xe3 \u0111\u1eb7t ch\u1ed7 kh\xf4ng h\u1ee3p l\u1ec7",content:u,status:"error",cancelText:"\u0110\xf3ng",okText:d,secondaryAction:!0}).afterClosed$.subscribe({next:p=>{p.data&&("TPS-TLF006"===i.data.canMonitor.reason.errorCode?this._route.navigate(["admin/manage-pnr-orders"]):this.onRegisterNewPnrOrder())}})}},error:()=>{const i="Canh v\xe9 kh\xe1c";if(this._detectMobileService.isMobile()){const a=this._bottomSheetService.open(v.Q4,{headerTitle:"",rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4",data:{title:"M\xe3 \u0111\u1eb7t ch\u1ed7 kh\xf4ng h\u1ee3p l\u1ec7",body:`M\xe3 \u0111\u1eb7t ch\u1ed7 <strong>${t.bookingCode}</strong> kh\xf4ng h\u1ee3p l\u1ec7 \u0111\u1ec3 t\u1ea1o y\xeau c\u1ea7u canh v\xe9. Vui l\xf2ng canh v\xe9 v\u1edbi m\xe3 \u0111\u1eb7t ch\u1ed7 kh\xe1c.`,okText:i,cancelText:"\u0110\xf3ng",hasIcon:!0,status:"error"}});a.containerInstance._rightButtonClick.subscribe(()=>{a.dismiss()}),a.afterDismissed().subscribe(s=>{s&&this.onRegisterNewPnrOrder()})}else this._modal.open(te.V,{title:"M\xe3 \u0111\u1eb7t ch\u1ed7 kh\xf4ng h\u1ee3p l\u1ec7",content:`M\xe3 \u0111\u1eb7t ch\u1ed7 <strong>${t.bookingCode}</strong> kh\xf4ng h\u1ee3p l\u1ec7 \u0111\u1ec3 t\u1ea1o y\xeau c\u1ea7u canh v\xe9. Vui l\xf2ng canh v\xe9 v\u1edbi m\xe3 \u0111\u1eb7t ch\u1ed7 kh\xe1c.`,status:"error",cancelText:"\u0110\xf3ng",okText:i,secondaryAction:!0}).afterClosed$.subscribe({next:s=>{s.data&&this.onRegisterNewPnrOrder()}})}})}}onRegisterNewPnrOrder(){if(this._eventLogService.captureOpenFormDownFare({hasPNR:0,source:0}),this._detectMobileService.isMobile()){const t=this._bottomSheetService.open(X.g,{headerTitle:"T\u1ea1o y\xeau c\u1ea7u canh v\xe9 r\u1ebb",rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4",leftButtonIcon:"",containerFullHeigh:!0,data:{isSuggest:!0,sourceEvent:"SUGGEST"}});t.containerInstance._rightButtonClick.subscribe(o=>t.dismiss())}else this._modal.open(X.g,{isSuggest:!0,sourceEvent:"SUGGEST"})}onSendEmail(t){if(this._detectMobileService.isMobile()){const o=this._bottomSheetService.open(fe.B,{headerTitle:"Th\xf4ng tin m\u1eb7t v\xe9",leftButtonIcon:"close",leftButtonIconClass:"text-neutral-gray-4",rightButtonIcon:"",containerFullHeigh:!1,data:{emailInfo:{bookingCode:t.bookingCode,provider:t.provider,email:this.bookingContact.email}}});o.containerInstance._leftButtonClick.subscribe(n=>o.dismiss())}else this._modal.open(fe.B,{emailInfo:{bookingCode:t.bookingCode,provider:t.provider,email:this.bookingContact.email}})}hanldeTimeoutIssue(){this._detectMobileService.isMobile()?(this.refTimoutBts=this._bottomSheetService.open(v.NK,{headerTitle:"",leftButtonIcon:"",rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4",containerFullHeigh:!1,data:{title:"\u0110ang x\u1eed l\xfd xu\u1ea5t v\xe9",body:"Qu\xfd \u0111\u1ea1i l\xfd vui l\xf2ng \u0111\u1ee3i trong gi\xe2y l\xe1t ho\u1eb7c ch\u1ee7 \u0111\u1ed9ng theo d\xf5i tr\u1ea1ng th\xe1i v\xe9 \u1edf m\u1ee5c Qu\u1ea3n l\xfd \u0111\u1eb7t ch\u1ed7",cancelText:"\u0110\xf3ng",okText:"M\u1edf qu\u1ea3n l\xfd \u0111\u1eb7t ch\u1ed7"}}),this.refTimoutBts.containerInstance._leftButtonClick.subscribe(t=>this.refTimoutBts.dismiss()),this.refTimoutBts.afterDismissed().subscribe({next:t=>{t&&this._route.navigate(["admin/manage-booking"])}})):(this.refTimoutModal=this._modal.open(v.NK,{title:"\u0110ang x\u1eed l\xfd xu\u1ea5t v\xe9",body:"Qu\xfd \u0111\u1ea1i l\xfd vui l\xf2ng \u0111\u1ee3i trong gi\xe2y l\xe1t ho\u1eb7c ch\u1ee7 \u0111\u1ed9ng theo d\xf5i tr\u1ea1ng th\xe1i v\xe9 \u1edf m\u1ee5c Qu\u1ea3n l\xfd \u0111\u1eb7t ch\u1ed7",cancelText:"\u0110\xf3ng",okText:"M\u1edf qu\u1ea3n l\xfd \u0111\u1eb7t ch\u1ed7"}),this.refTimoutModal.afterClosed$.subscribe({next:t=>{t.data&&this._route.navigate(["admin/manage-booking"])}}))}onRerouting(t,o){var n,i;if(this.checkRuleMMBVJ(o))return void this.handleMMBVJ(t,o);const a=this.bookingDetails[0].journeys.some(l=>{var p;return((null===(p=l.startTime)||void 0===p?void 0:p.getTime())||0)<=(new Date).getTime()}),m=((null===(n=this.bookingDetails[0].journeys.filter(l=>{var p;return((null===(p=l.startTime)||void 0===p?void 0:p.getTime())||0)>(new Date).getTime()})[0].startTime)||void 0===n?void 0:n.getTime())||0)-(new Date).getTime()<=P.J$;if("VN"===o.provider&&a)return void this._modal.open(v.V0,{title:"Kh\xf4ng th\u1ec3 ti\u1ebfp t\u1ee5c",body:"H\u1ec7 th\u1ed1ng ch\u01b0a h\u1ed7 tr\u1ee3 \u0111\u1ed5i h\xe0nh tr\xecnh tr\xean v\xe9 c\xf3 ch\u1eb7ng \u0111\xe3 bay, vui l\xf2ng li\xean h\u1ec7 Booker \u0111\u1ec3 \u0111\u01b0\u1ee3c h\u1ed7 tr\u1ee3.",okText:"\u0110\xf3ng",hasCancel:!1});if(m)return void this._modal.open(v.V0,{title:"C\xf3 l\u1ed7i x\u1ea3y ra",body:"Kh\xf4ng th\u1ec3 \u0110\u1ed5i h\xe0nh tr\xecnh khi g\u1ea7n gi\u1edd bay, li\xean h\u1ec7 Booker \u0111\u1ec3 \u0111\u01b0\u1ee3c h\u1ed7 tr\u1ee3.",okText:"\u0110\xf3ng",hasCancel:!1});if(o.provider===P.QK.VN&&"ISSUED"===o.status&&(this.listBaggage.some(l=>l.airline===P.QK.VN)||this.listService.some(l=>l.airline===P.QK.VN)))return void this._modal.open(v.V0,{title:"Thay \u0111\u1ed5i h\xe0nh tr\xecnh th\u1ea5t b\u1ea1i",body:"V\xe9 \u0111\xe3 xu\u1ea5t c\xf3 mua h\xe0nh l\xfd/ch\u1ed7 ng\u1ed3i, vui l\xf2ng li\xean h\u1ec7 Booker \u0111\u1ec3 \u0111\u01b0\u1ee3c h\u1ed7 tr\u1ee3 \u0111\u1ed5i h\xe0nh tr\xecnh.",okText:"\u0110\xf3ng",hasCancel:!1});const d=l=>{switch(l){case"ADULT":default:return"ADT";case"CHILD":return"CHD";case"INFANT":return"INF"}},u={provider:o.provider,supplier:o.supplier,airline:o.airline,airlineName:o.airlineName,status:o.status,bookingCode:o.bookingCode,journeys:(null===(i=o.journeys)||void 0===i?void 0:i.map((l,p)=>{var b;return{journeyKey:l.key||"",airline:l.airline||"N/A",airlineName:l.airlineName||"N/A",airlineLogo:l.airlineLogo||"",startPointCode:l.startPoint||"N/A",startPointName:l.startPointName||"N/A",endPointCode:l.endPoint||"N/A",endPointName:l.endPointName||"N/A",segments:l.segments.map(g=>({airline:g.airline,fareClass:g.fareClass,departDate:g.departureDate,endPoint:g.endPoint,flightNumber:g.flightNumber,startPoint:g.startPoint})),startTime:null!==(b=l.startTime)&&void 0!==b?b:new Date,redirectType:l.segments.length>1?"N\u1ed1i chuy\u1ebfn":"Bay th\u1eb3ng",statusText:o.statusText,selected:0===p}}))||[],passengers:this.passengers.map(l=>({name:l.name,type:l.type,typeDisplay:d(l.type),baseFare:0,taxFee:0,totalPrice:0}))};this._requestReroutingService.setBookingDetailReroutingData(u),this._route.navigate(["admin/rerouting"])}onAddonJourney(t){var o;const n=a=>{switch(a){case"ADULT":default:return"ADT";case"CHILD":return"CHD";case"INFANT":return"INF"}},i={provider:t.provider,supplier:t.supplier,airline:t.airline,airlineName:t.airlineName,status:t.status,bookingCode:t.bookingCode,journeys:(null===(o=t.journeys)||void 0===o?void 0:o.map((a,s)=>{var h;return{journeyKey:a.key||"",airline:a.airline||"N/A",airlineName:a.airlineName||"N/A",airlineLogo:a.airlineLogo||"",startPointCode:a.startPoint||"N/A",startPointName:a.startPointName||"N/A",endPointCode:a.endPoint||"N/A",endPointName:a.endPointName||"N/A",segments:a.segments.map(m=>({airline:m.airline,fareClass:m.fareClass,departDate:m.departureDate,endPoint:m.endPoint,flightNumber:m.flightNumber,startPoint:m.startPoint})),startTime:null!==(h=a.startTime)&&void 0!==h?h:new Date,redirectType:a.segments.length>1?"N\u1ed1i chuy\u1ebfn":"Bay th\u1eb3ng",statusText:t.statusText,selected:0===s}}))||[],passengers:this.passengers.map(a=>({name:a.name,type:a.type,typeDisplay:n(a.type),baseFare:0,taxFee:0,totalPrice:0}))};this._requestReroutingService.setBookingDetailReroutingData(i),this._route.navigate(["admin/add-journey"])}onSeparatePassengers(t){const o=[];if(t.passengers.filter(n=>"INF"!==n.type).forEach(n=>{o.push({index:n.index,key:n.key||"",name:n.name,parentKey:n.parentKey||"",type:n.type,child:"N/A",selected:!1})}),t.passengers.filter(n=>"INF"===n.type).forEach(n=>{const i=o.find(a=>a.key===n.parentKey);i&&(i.child=n.name)}),o.length>=2)if(this._detectMobileService.isMobile()){const n=this._bottomSheetService.open(y.zb,{headerTitle:"Ch\u1ecdn h\xe0nh kh\xe1ch c\u1ea7n t\xe1ch",rightButtonIcon:"",leftButtonIcon:"close",leftButtonIconClass:"text-neutral-gray-4",containerFullHeigh:!0,data:{listPassengers:o,bookingDetail:t}});n.containerInstance._leftButtonClick.subscribe(()=>{n.dismiss()}),n.afterDismissed().subscribe({next:i=>{i&&this._route.navigate([`admin/booking-detail/${t.airline}/${i}`])}})}else this._modal.open(y.zb,{listPassengers:o,bookingDetail:t}).afterClosed$.subscribe({next:i=>{i.data&&this._route.navigate([`admin/booking-detail/${t.airline}/${i.data}`])}});else if(this._detectMobileService.isMobile()){const n=this._bottomSheetService.open(v.Q4,{headerTitle:"Kh\xf4ng th\u1ec3 ti\u1ebfp t\u1ee5c",rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4",data:{title:"",body:"V\xe9 ph\u1ea3i c\xf3 t\u1ed1i thi\u1ec3u 2 kh\xe1ch \u0111\u1ec3 th\u1ef1c hi\u1ec7n thao t\xe1c t\xe1ch.",okText:"\u0110\xf3ng",cancelText:"",hasIcon:!0,status:"info"}});n.containerInstance._rightButtonClick.subscribe(()=>{n.dismiss()})}else this._modal.open(v.V0,{title:"Kh\xf4ng th\u1ec3 ti\u1ebfp t\u1ee5c",body:"V\xe9 ph\u1ea3i c\xf3 t\u1ed1i thi\u1ec3u 2 kh\xe1ch \u0111\u1ec3 th\u1ef1c hi\u1ec7n thao t\xe1c t\xe1ch.",okText:"\u0110\xf3ng",hasCancel:!1})}onOpenAuditLog(t){this.isLoading=!0,this._manageBookingService.getAuditLog(t.airline,t.bookingCode).subscribe({next:o=>{if(this.isLoading=!1,"OK"===o.status){let n=o.data.auditLogs.map(i=>({dateTime:i.dateAndTime,reservation:i.reservation,user:i.user,description:i.description,oldValue:i.oldValue,newValue:i.newValue}));if("VJ"==t.airline)if(this._detectMobileService.isMobile()){const i=this._bottomSheetService.open(y.z_,{headerTitle:"Ki\u1ec3m to\xe1n \u0111\u1eb7t ch\u1ed7",rightButtonIcon:"",leftButtonIcon:"close",leftButtonIconClass:"text-neutral-gray-4",containerFullHeigh:!0,data:{auditLogs:n,pnr:t.bookingCode}});i.containerInstance._leftButtonClick.subscribe(()=>{i.dismiss()}),i.afterDismissed().subscribe({next:a=>{}})}else this._modal.open(y.z_,{auditLogs:n,pnr:t.bookingCode}).afterClosed$.subscribe({next:a=>{}})}},error:o=>{this.isLoading=!1}})}onCheckInOnline(t){switch(t.airline){case"QH":window.open("https://digital.bambooairways.com/ssci/identification");break;case"VN":window.open("https://booking.vietnamairlines.com/ssci/identification");break;case"VJ":window.open("https://www.vietjetair.com/vi/checkin");break;case"VU":window.open("https://booking.vietravelairlines.com/vi/checkin")}}onUpdatePaxInfo(t){const o=[];if(t.passengers.forEach((n,i)=>{o.push({index:n.index,key:n.key||"",name:n.lastName+" "+n.firstName,parentKey:"N/A"==n.parentKey||null==n.parentKey?"":n.parentKey,type:n.type,child:"N/A",selected:0==i,gender:n.gender,firstName:n.firstName,lastName:n.lastName,dayOfBirth:n.birthday?n.birthday:"",parentName:"",fullType:n.type})}),t.passengers.filter(n=>"INF"===n.type).forEach(n=>{const i=o.find(a=>a.key===n.parentKey);i&&(i.child=n.name)}),o.filter(n=>"INF"===n.type).forEach(n=>{const i=t.passengers.find(a=>a.key===n.parentKey);i&&(n.parentName=i.lastName+" "+i.firstName)}),this._detectMobileService.isMobile()){const n=this._bottomSheetService.open(y.Pt,{headerTitle:"Ch\u1ecdn h\xe0nh kh\xe1ch c\u1ea7n ch\u1ec9nh s\u1eeda",rightButtonIcon:"",leftButtonIcon:"close",leftButtonIconClass:"text-neutral-gray-4",containerFullHeigh:!0,data:{listPassengers:o,bookingDetail:t}});n.containerInstance._leftButtonClick.subscribe(()=>{n.dismiss()}),n.afterDismissed().subscribe({next:i=>{"OK"==i.type&&(this._toastService.add({severity:"success",summary:"S\u1eeda th\xf4ng tin kh\xe1ch th\xe0nh c\xf4ng",detail:"Th\xf4ng tin h\xe0nh kh\xe1ch \u0111\u01b0\u1ee3c s\u1eeda th\xe0nh c\xf4ng!",sticky:!1}),this.gotoBookingDetail(t.airline,t.bookingCode)),"FAILED"==i.type&&this._modal.open(v.V0,{title:"S\u1eeda h\xe0nh kh\xe1ch th\u1ea5t b\u1ea1i",body:i.data.errorDescription.vi,okText:"\u0110\xf3ng",hasIcon:!0,hasCancel:!1})}})}else this._modal.open(y.Pt,{listPassengers:o,bookingDetail:t}).afterClosed$.subscribe({next:i=>{"OK"==i.data.type&&(this._toastService.add({severity:"success",summary:"S\u1eeda th\xf4ng tin kh\xe1ch th\xe0nh c\xf4ng",detail:"Th\xf4ng tin h\xe0nh kh\xe1ch \u0111\u01b0\u1ee3c s\u1eeda th\xe0nh c\xf4ng!",sticky:!1}),this.gotoBookingDetail(t.airline,t.bookingCode)),"FAILED"==i.data.type&&this._modal.open(v.V0,{title:"S\u1eeda h\xe0nh kh\xe1ch th\u1ea5t b\u1ea1i",body:i.data.data.errorDescription.vi,okText:"\u0110\xf3ng",hasIcon:!0,hasCancel:!1})}})}getFareRule(){const t={journeyInfo:this.bookingDetails[0].journeys.map(o=>({provider:this.bookingDetails[0].provider,journeyKey:o.key||"",bookingCode:this.bookingDetails[0].bookingCode||""}))};this.isLoading=!0,this._searchFlightService.getFareRule(t).pipe((0,I.x)(()=>this.isLoading=!1)).subscribe({next:o=>{console.log(o),"OK"===o.status?(this.fareRuleBsp=o.data,this._detectMobileService.isMobile()||this._modal.open(y.a7,{fareRuleBsp:this.fareRuleBsp,isBsp:!0})):this._toastService.add({severity:"error",summary:"C\xf3 l\u1ed7i x\u1ea3y ra",detail:"Kh\xf4ng th\u1ec3 xem th\xf4ng tin \u0111i\u1ec1u ki\u1ec7n gi\xe1 v\xe9",sticky:!0})},error:()=>{this._toastService.add({severity:"error",summary:"C\xf3 l\u1ed7i x\u1ea3y ra",detail:"Kh\xf4ng th\u1ec3 xem th\xf4ng tin \u0111i\u1ec1u ki\u1ec7n gi\xe1 v\xe9",sticky:!0})}})}onRefreshPnr(){this.initBookingDetail(!0)}getRebookPnrSnapshot$(t,o){return this._bookingDetailService.getRebookPnrSnapshot({provider:t,refPnr:o})}onRebookPnr(t){if(this.bookingDetails[0].journeys.length>P.eH)return void this._modal.open(v.z5,{title:"C\xf3 l\u1ed7i x\u1ea3y ra!",content:"<div>Ch\u01b0a h\u1ed7 tr\u1ee3 Rebook PNR tr\xean h\xe0nh tr\xecnh \u0111a ch\u1eb7ng. Vui l\xf2ng li\xean h\u1ec7 Booker \u0111\u1ec3 \u0111\u01b0\u1ee3c h\u1ed7 tr\u1ee3</div>",status:"error"});const o=n=>{this.isLoading=!0,this._bookingDetailService.rebookPnr(n).pipe((0,I.x)(()=>this.isLoading=!1)).subscribe({next:i=>{var a,s;if("OK"===i.status)this._modal.open(v.z5,{title:"\u0110\u1eb7t ch\u1ed7 th\xe0nh c\xf4ng!",content:`<div>B\u1ea1n \u0111\xe3 rebook th\xe0nh c\xf4ng, m\xe3 \u0111\u1eb7t ch\u1ed7 m\u1edbi l\xe0 <strong>${i.data.bookingData.bookingCode}</strong></div>`,status:"success",okText:"M\u1edf booking",closeText:"\u0110\xf3ng"}).afterClosed$.subscribe({next:m=>{m.data?this.gotoBookingDetail(i.data.bookingData.airline,i.data.bookingData.bookingCode):this.gotoBookingDetail(t.airline,t.bookingCode)}});else{const h=(null===(s=null===(a=i.objectError)||void 0===a?void 0:a.errorDescription)||void 0===s?void 0:s.vi)||"Rebook PNR kh\xf4ng th\xe0nh c\xf4ng. Vui l\xf2ng li\xean h\u1ec7 Booker \u0111\u1ec3 \u0111\u01b0\u1ee3c h\u1ed7 tr\u1ee3";this._modal.open(v.z5,{title:"\u0110\u1eb7t ch\u1ed7 th\u1ea5t b\u1ea1i!",content:`<div>${h}</div>`,status:"error"}).afterClosed$.subscribe({next:d=>{null!=d&&d.data||this.gotoBookingDetail(t.airline,t.bookingCode)}})}},error:()=>{this._modal.open(v.z5,{title:"\u0110\u1eb7t ch\u1ed7 th\u1ea5t b\u1ea1i!",content:"<div>Rebook PNR kh\xf4ng th\xe0nh c\xf4ng. Vui l\xf2ng li\xean h\u1ec7 Booker \u0111\u1ec3 \u0111\u01b0\u1ee3c h\u1ed7 tr\u1ee3</div>",status:"error"}).afterClosed$.subscribe({next:a=>{null!=a&&a.data||this.gotoBookingDetail(t.airline,t.bookingCode)}})}})};if(this._detectMobileService.isMobile()){const n=this._bottomSheetService.open(y.IG,{headerTitle:"",hasHeader:!1,leftButtonIcon:"close",leftButtonIconClass:"text-neutral-gray-4",rightButtonIcon:"",data:{bookingContact:this.bookingContact,bookingDetail:this.bookingDetails[0]}});n.containerInstance._leftButtonClick.subscribe(i=>n.dismiss()),n.afterDismissed().subscribe({next:i=>{i&&o(i)}})}else this._modal.open(y.IG,{bookingContact:this.bookingContact,bookingDetail:this.bookingDetails[0]}).afterClosed$.subscribe({next:i=>{i.data&&o(i.data)}})}onUpdateMembership(){const t=this.bookingDetails[0].passengers.map(n=>({key:n.key,firstName:n.firstName,lastName:n.lastName,type:n.type,membershipNumber:n.membershipNumber,canUpdate:!n.membershipNumber})),o=n=>{const i={bookingCode:this.bookingDetails[0].bookingCode,membershipInfos:n,provider:this.bookingDetails[0].provider};this.isLoading=!0,this._manageBookingService.updateMemebership(i).pipe((0,I.x)(()=>this.isLoading=!1)).subscribe({next:a=>{"OK"===a.status?(this._detectMobileService.isMobile()?this._bottomSheetService.open(v.Q4,{headerTitle:"Th\xe0nh c\xf4ng",rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4",data:{title:"",body:"Th\xeam th\u1ebb B\xf4ng Sen V\xe0ng th\xe0nh c\xf4ng",okText:"\u0110\xf3ng",hasIcon:!1,status:"success"}}):this._modal.open(v.z5,{title:"Th\xe0nh c\xf4ng",content:"Th\xeam th\u1ebb B\xf4ng Sen V\xe0ng th\xe0nh c\xf4ng",status:"success",okText:"\u0110\xf3ng"}),this.gotoBookingDetail(this.bookingDetails[0].airline,this.bookingDetails[0].bookingCode)):this._detectMobileService.isMobile()?this._bottomSheetService.open(v.Q4,{headerTitle:"Th\u1ea5t b\u1ea1i",rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4",data:{title:"",body:"Th\xeam th\u1ebb B\xf4ng Sen V\xe0ng th\u1ea5t b\u1ea1i. Vui l\xf2ng th\u1ef1c hi\u1ec7n l\u1ea1i",okText:"\u0110\xf3ng",hasIcon:!1,status:"error"}}):this._modal.open(v.z5,{title:"Th\u1ea5t b\u1ea1i",content:"Th\xeam th\u1ebb B\xf4ng Sen V\xe0ng th\u1ea5t b\u1ea1i. Vui l\xf2ng th\u1ef1c hi\u1ec7n l\u1ea1i",status:"error",okText:"\u0110\xf3ng"})},error:()=>{this._detectMobileService.isMobile()?this._bottomSheetService.open(v.Q4,{headerTitle:"Th\u1ea5t b\u1ea1i",rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4",data:{title:"",body:"Th\xeam th\u1ebb B\xf4ng Sen V\xe0ng th\u1ea5t b\u1ea1i. Vui l\xf2ng th\u1ef1c hi\u1ec7n l\u1ea1i",okText:"\u0110\xf3ng",hasIcon:!1,status:"error"}}):this._modal.open(v.z5,{title:"Th\u1ea5t b\u1ea1i",content:"Th\xeam th\u1ebb B\xf4ng Sen V\xe0ng th\u1ea5t b\u1ea1i. Vui l\xf2ng th\u1ef1c hi\u1ec7n l\u1ea1i",status:"error",okText:"\u0110\xf3ng"})}})};if(this._detectMobileService.isMobile()){const n=this._bottomSheetService.open(y.OO,{headerTitle:"Th\xeam th\u1ebb B\xf4ng Sen V\xe0ng",leftButtonIcon:"close",leftButtonIconClass:"text-neutral-gray-4",rightButtonIcon:"",containerFullHeigh:!1,data:{listPax:t}});n.containerInstance._leftButtonClick.subscribe(i=>n.dismiss()),n.afterDismissed().subscribe({next:i=>{i&&o(i)}})}else this._modal.open(y.OO,{listPax:t}).afterClosed$.subscribe({next:i=>{i.data&&o(i.data)}})}onAddInfant(){var t,o,n,i;const a=null===(t=this.bookingDetails[0].passengers.filter(d=>"INF"===d.type))||void 0===t?void 0:t.map(d=>d.parentKey),s=(null===(o=this.bookingDetails[0].passengers.filter(d=>"ADT"===d.type&&!a.includes(d.key)))||void 0===o?void 0:o.map(d=>({text:d.name,value:d.key})))||[];if(this.bookingDetails[0].passengers.every(d=>"CHD"===d.type||"CHILD"===d.type))return void(this._detectMobileService.isMobile()?this._bottomSheetService.open(v.Q4,{headerTitle:"Kh\xf4ng th\u1ec3 ti\u1ebfp t\u1ee5c",rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4",data:{title:"",body:"Kh\xf4ng th\u1ec3 th\xeam em b\xe9 v\u1edbi v\xe9 kh\xf4ng c\xf3 h\xe0nh kh\xe1ch ng\u01b0\u1eddi l\u1edbn.",okText:"\u0110\xf3ng",cancelText:"",hasIcon:!0,status:"info"}}):this._modal.open(v.V0,{title:"Kh\xf4ng th\u1ec3 ti\u1ebfp t\u1ee5c",body:"Kh\xf4ng th\u1ec3 th\xeam em b\xe9 v\u1edbi v\xe9 kh\xf4ng c\xf3 h\xe0nh kh\xe1ch ng\u01b0\u1eddi l\u1edbn.",okText:"\u0110\xf3ng",hasCancel:!1}));if(!s||!s.length)return void(this._detectMobileService.isMobile()?this._bottomSheetService.open(v.Q4,{headerTitle:"Kh\xf4ng th\u1ec3 ti\u1ebfp t\u1ee5c",rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4",data:{title:"",body:"Kh\xf4ng th\u1ec3 th\xeam em b\xe9 v\u1edbi m\xe3 \u0111\u1eb7t ch\u1ed7 n\xe0y, t\u1ea5t c\u1ea3 ng\u01b0\u1eddi l\u1edbn \u0111\xe3 c\xf3 em b\xe9 \u0111i k\xe8m.",okText:"\u0110\xf3ng",cancelText:"",hasIcon:!0,status:"info"}}):this._modal.open(v.V0,{title:"Kh\xf4ng th\u1ec3 ti\u1ebfp t\u1ee5c",body:"Kh\xf4ng th\u1ec3 th\xeam em b\xe9 v\u1edbi m\xe3 \u0111\u1eb7t ch\u1ed7 n\xe0y, t\u1ea5t c\u1ea3 ng\u01b0\u1eddi l\u1edbn \u0111\xe3 c\xf3 em b\xe9 \u0111i k\xe8m.",okText:"\u0110\xf3ng",hasCancel:!1}));if(this.bookingDetails[0].passengers.every(d=>"CHD"===d.type||"CHILD"===d.type))return void(this._detectMobileService.isMobile()?this._bottomSheetService.open(v.Q4,{headerTitle:"Kh\xf4ng th\u1ec3 ti\u1ebfp t\u1ee5c",rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4",data:{title:"",body:"Kh\xf4ng th\u1ec3 th\xeam em b\xe9 v\u1edbi v\xe9 kh\xf4ng c\xf3 h\xe0nh kh\xe1ch ng\u01b0\u1eddi l\u1edbn.",okText:"\u0110\xf3ng",cancelText:"",hasIcon:!0,status:"info"}}):this._modal.open(v.V0,{title:"Kh\xf4ng th\u1ec3 ti\u1ebfp t\u1ee5c",body:"Kh\xf4ng th\u1ec3 th\xeam em b\xe9 v\u1edbi v\xe9 kh\xf4ng c\xf3 h\xe0nh kh\xe1ch ng\u01b0\u1eddi l\u1edbn.",okText:"\u0110\xf3ng",hasCancel:!1}));const h=d=>{"success"===d?this._detectMobileService.isMobile()?this._bottomSheetService.open(v.Q4,{headerTitle:"Th\xe0nh c\xf4ng",rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4",data:{title:"",body:"Th\xeam em b\xe9 th\xe0nh c\xf4ng. Vui l\xf2ng ki\u1ec3m tra l\u1ea1i gi\xe1 v\xe9 \u0111\u01b0\u1ee3c c\u1eadp nh\u1eadt.",okText:"\u0110\xf3ng",hasIcon:!1,status:"success"}}).afterDismissed().subscribe({next:()=>{this.gotoBookingDetail(this.bookingDetails[0].airline,this.bookingDetails[0].bookingCode)}}):this._modal.open(v.z5,{title:"Th\xe0nh c\xf4ng",content:"Th\xeam em b\xe9 th\xe0nh c\xf4ng. Vui l\xf2ng ki\u1ec3m tra l\u1ea1i gi\xe1 v\xe9 \u0111\u01b0\u1ee3c c\u1eadp nh\u1eadt.",status:"success",okText:"\u0110\xf3ng"}).afterClosed$.subscribe({next:()=>{this.gotoBookingDetail(this.bookingDetails[0].airline,this.bookingDetails[0].bookingCode)}}):this._detectMobileService.isMobile()?this._bottomSheetService.open(v.Q4,{headerTitle:"Th\u1ea5t b\u1ea1i",rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4",data:{title:"",body:"Th\xeam em b\xe9 th\u1ea5t b\u1ea1i. Vui l\xf2ng li\xean h\u1ec7 Booker \u0111\u1ec3 \u0111\u01b0\u1ee3c h\u1ed7 tr\u1ee3.",okText:"\u0110\xf3ng",hasIcon:!1,status:"error"}}).afterDismissed().subscribe({next:()=>{}}):this._modal.open(v.z5,{title:"Th\u1ea5t b\u1ea1i",content:"Th\xeam em b\xe9 th\u1ea5t b\u1ea1i. Vui l\xf2ng li\xean h\u1ec7 Booker \u0111\u1ec3 \u0111\u01b0\u1ee3c h\u1ed7 tr\u1ee3.",status:"error",okText:"\u0110\xf3ng"}).afterClosed$.subscribe({next:()=>{}})},m=d=>{const u={provider:this.bookingDetails[0].provider,bookingCode:this.bookingDetails[0].bookingCode,passengers:[{birthday:d.birthDay,firstName:d.firstName||"",gender:d.gender||"",lastName:d.lastName||"",parentKey:d.parentKey||"",membershipID:d.membershipID||"",type:"INF",setDefaultDocument:d.setDefaultDocument,defaultDocumentType:d.defaultDocumentType,documentInfo:(null==d?void 0:d.documentInfo)||[]}]};this.isLoading=!0,this._manageBookingService.addInfant(u).pipe((0,I.x)(()=>this.isLoading=!1)).subscribe({next:l=>{h("OK"===l.status&&l.data?"success":"error")},error:()=>{h("error")}})};if(this._detectMobileService.isMobile()){const d=this._bottomSheetService.open(y.__,{headerTitle:"Th\xeam em b\xe9",leftButtonIcon:"close",leftButtonIconClass:"text-neutral-gray-4",rightButtonIcon:"",containerFullHeigh:!0,data:{departureTimestamp:(null===(n=this.bookingDetails[0].journeys[0].startTime)||void 0===n?void 0:n.getTime())||(new Date).getTime(),listAdultPassengerAvailable:s,hasAirportInternational:this.bookingDetails[0].journeys.some(u=>this._locationDataService.checkAirportInternational(u.startPoint)||this._locationDataService.checkAirportInternational(u.endPoint))}});d.containerInstance._leftButtonClick.subscribe(u=>d.dismiss()),d.afterDismissed().subscribe({next:u=>{u&&m(u)}})}else this._modal.open(y.__,{departureTimestamp:(null===(i=this.bookingDetails[0].journeys[0].startTime)||void 0===i?void 0:i.getTime())||(new Date).getTime(),listAdultPassengerAvailable:s,hasAirportInternational:this.bookingDetails[0].journeys.some(u=>this._locationDataService.checkAirportInternational(u.startPoint)||this._locationDataService.checkAirportInternational(u.endPoint))}).afterClosed$.subscribe({next:u=>{u.data&&m(u.data)}})}onCalculateFare(){this.isLoading=!0,this._manageBookingService.calculateFare({isConfirm:!0,pnr:this.bookingDetails[0].bookingCode,totalAmount:this.priceDetail.totalPrice||0}).pipe((0,I.x)(()=>this.isLoading=!1)).subscribe({next:o=>{this._modal.open(v.z5,"OK"===o.status?{title:"L\u1ea5y gi\xe1 th\u1ea5p nh\u1ea5t th\xe0nh c\xf4ng",content:"H\xe0nh l\xfd v\xe0 gh\u1ebf ng\u1ed3i s\u1ebd kh\xf4ng \u0111\u01b0\u1ee3c t\u1ef1 \u0111\u1ed9ng th\xeam s\u1eb5n, \u0111\u1ea1i l\xfd vui l\xf2ng ki\u1ec3m tra & ch\u1ee7 \u0111\u1ed9ng th\xeam m\u1edbi n\u1ebfu c\u1ea7n",status:"success",okText:"X\xe1c nh\u1eadn"}:{title:"Th\xf4ng b\xe1o",content:"Kh\xf4ng c\xf3 gi\xe1 v\xe9 th\u1ea5p h\u01a1n v\xe9 hi\u1ec7n t\u1ea1i. Vui l\xf2ng th\u1eed l\u1ea1i sau.",status:"error",okText:"\u0110\xf3ng"})}})}}return c.\u0275fac=function(t){return new(t||c)(e.Y36(Fe.h),e.Y36(Ne.J),e.Y36(x.KNP),e.Y36(Me.U),e.Y36(Ze.h),e.Y36(Oe.G),e.Y36(we._),e.Y36(Re.m),e.Y36(Ke.oE),e.Y36(Le.fB),e.Y36(Ve.TU),e.Y36(Ue.F0),e.Y36($.Fj),e.Y36(r.$A),e.Y36(je.BX),e.Y36(Je.t7),e.Y36(me.a2),e.Y36(qe.P3),e.Y36($e.L),e.Y36(He.s),e.Y36(Ye.x),e.Y36(Qe.$),e.Y36(Ge.h),e.Y36(ze.o))},c.\u0275cmp=e.Xpm({type:c,selectors:[["booking-success-page"]],standalone:!0,features:[e.jDz],decls:41,vars:40,consts:[[4,"ngIf"],[1,"w-full","h-full","flex","gap-x-4","justify-center","p-4","md:hidden"],[1,"w-[764px]","h-full","flex","flex-col","gap-2"],["class","mb-2",4,"ngIf"],[1,""],[1,"flex","gap-x-[20px]","mb-4"],[1,"w-1","bg-primary-2-4"],[1,"text-heading-md","text-neutral-black"],["class","w-full py-1.5 px-3 bg-red-1 text-primary-1-4 rounded flex items-center gap-x-3 mb-4",4,"ngIf"],[1,"flex","flex-col","gap-y-2"],[3,"isShowMore","paymentOrderCode","bookingDetail","isBooked","hasDiscountFare","actionChange","retryBooking",4,"ngFor","ngForOf"],["class","bg-white rounded shadow-cf-md p-6",4,"ngIf"],["class","py-1.5 px-3 bg-functional-1-1 flex gap-x-2 mt-2 rounded",4,"ngIf"],[1,"mt-12","w-[340px]","h-fit","flex","flex-col","gap-y-4"],[3,"listBookingText","modeBookingText","bookingContact","listBookingTextExplain","actionShare","modeChange"],[3,"listBookingCode"],[1,"py-2","px-4","md:flex","hidden","whitespace-nowrap","overflow-x-scroll","bg-neutral-white","sticky","top-0","z-[1]","shadow-cf-sm"],[1,"px-4","py-1.5","rounded-full","text-espressive-md","text-neutral-gray-4","border","border-transparent",3,"click"],["bookingDetailTab",""],["paxInfoTab",""],["class","px-4 py-1.5 rounded-full text-espressive-md text-neutral-gray-4 border border-transparent",3,"text-secondary-3-4","!border-secondary-3-4","bg-secondary-3-1","click",4,"ngIf"],["class","p-4 gap-y-3 md:flex md:flex-col hidden w-full",4,"ngIf"],["class","bg-neutral-white pt-3 pr-4 pb-3 pl-4 flex-row gap-0 items-end justify-end w-full fixed bottom-0 hidden md:flex",3,"z-1000",4,"ngIf"],[1,"mb-2"],[3,"passengerInfos"],[1,"w-full","py-1.5","px-3","bg-red-1","text-primary-1-4","rounded","flex","items-center","gap-x-3","mb-4"],[1,"text-body-md-short"],[3,"isShowMore","paymentOrderCode","bookingDetail","isBooked","hasDiscountFare","actionChange","retryBooking"],[1,"bg-white","rounded","shadow-cf-md","p-6"],[1,"mb-4","flex","items-center","gap-x-3"],[1,"text-heading-sm","text-neutral-black"],[1,"table-auto","w-full"],[1,"border-b","border-neutral-gray-1"],[1,"text-left","text-espressive-sm","text-neutral-gray-4","py-3"],[4,"ngFor","ngForOf"],[1,"text-body-md","text-neutral-black","py-3"],[1,"w-[48px]","h-[24px]","object-contain",3,"src"],[1,"flex","gap-x-2","items-center"],[1,"w-[80px]","h-[40px]","object-contain","md:w-9","md:h-9",3,"src"],[1,"flex","justify-between","items-center"],[1,"flex","gap-x-[20px]","my-4"],[1,"bg-white","rounded","shadow-cf-md"],[3,"priceDetail","hasDiscountFare"],[1,"p-6","flex","flex-col","items-end","gap-[6px]"],[1,"flex","items-center","gap-4"],[1,"text-espressive-md","text-neutral-black"],[1,"min-w-[140px]","text-end","text-heading-lg","text-secondary-3-4"],[4,"ngIf","ngIfElse"],["noDiscountTempl",""],["cf-button","","size","medium","type","secondary",1,"justify-center","gap-x-2","button-md","bg-neutral-white",3,"click"],[1,"py-1.5","px-3","bg-functional-1-1","flex","gap-x-2","mt-2","rounded"],["icon","info",1,"text-functional-1-3"],[1,"text-express-md"],[1,"ml-6"],[1,"text-body-md-short","list-disc"],["totalPriceTab",""],["fareRuleTab",""],["ticketPriceTab",""],["ticketNumberTab",""],["remarkTab",""],["historyTab",""],[1,"p-4","gap-y-3","md:flex","md:flex-col","hidden","w-full"],[3,"bookingDetail","onDetailClick","actionChange","retryBooking",4,"ngFor","ngForOf"],["class"," w-full",4,"ngIf"],[3,"bookingDetail","onDetailClick","actionChange","retryBooking"],[1,"w-full"],[3,"title","active","contentClass","panelClass"],["titleTemplate",""],["class","flex flex-col mt-3 rounded-lg bg-neutral-white p-3 gap-y-2",4,"ngFor","ngForOf"],[1,"text-espressive-sm","text-neutral-black"],[1,"flex","flex-col","mt-3","rounded-lg","bg-neutral-white","p-3","gap-y-2"],[1,"flex","items-center","gap-x-5"],[1,"text-body-sm","text-neutral-gray-4","w-[104px]"],[1,"text-espressive-md","text-neutral-gray-6"],["class","flex flex-col rounded-lg bg-neutral-white p-3 gap-y-2",4,"ngFor","ngForOf"],[1,"flex","flex-col","rounded-lg","bg-neutral-white","p-3","gap-y-2"],["class","flex items-center gap-x-5",4,"ngIf"],[1,"text-espressive-md","text-secondary-5-3"],[1,"bg-neutral-white","pt-3","pr-4","pb-3","pl-4","flex-row","gap-0","items-end","justify-end","w-full","fixed","bottom-0","hidden","md:flex"],[1,"flex","flex-row","gap-1","items-center","justify-start","shrink-0","relative",3,"click"],[1,"flex","flex-row","gap-1","items-center","justify-start","shrink-0","relative"],[1,"text-neutral-gray-4","text-left","relative","text-espressive-xs"],[1,"text-secondary-3-4","text-center","relative","text-heading-sm"],["icon","chevron_up","size","small",4,"ngIf"],["icon","chevron_down","size","small",4,"ngIf"],["totalPriceBottomSheet",""],["icon","chevron_up","size","small"],["icon","chevron_down","size","small"],[1,"flex","flex-col","gap-4","items-start","justify-start","w-full","relative","p-4","pb-12"],[1,"flex","flex-row","gap-6","items-center","justify-start","self-stretch","shrink-0","relative"],[1,"flex","flex-row","gap-3","items-center","justify-start","flex-1","relative"],[1,"flex","flex-col","gap-1","items-start","justify-start","shrink-0","relative"],[1,"text-neutral-gray-4","text-left","relative","text-body-sm"],[1,"flex","flex-col","gap-1","items-end","justify-center","shrink-0","relative"],[1,"text-neutral-gray-4","text-right","relative","text-body-sm"],[3,"fareRuleBsp"],[1,"bg-neutral-white","rounded-lg","border-solid","p-4","flex","flex-col","gap-2","items-end","justify-start","shrink-0","w-full","relative","overflow-hidden"],[1,"flex","flex-row","gap-1.5","items-center","justify-start","shrink-0","relative",3,"click"],["size","small","icon","copy"],[1,"text-neutral-gray-6","text-center","relative","flex","items-center","justify-center","text-body-md"],[1,"text-body-sm","w-full",3,"bookingText"]],template:function(t,o){if(1&t){const n=e.EpF();e.YNc(0,Xe,1,0,"cf-spinner",0),e.TgZ(1,"div")(2,"div",1)(3,"div",2),e.YNc(4,We,6,1,"div",3),e.TgZ(5,"div",4)(6,"div",5),e._UZ(7,"div",6),e.TgZ(8,"div",7),e._uU(9,"Chi ti\u1ebft \u0111\u1eb7t ch\u1ed7"),e.qZA()(),e.YNc(10,et,3,0,"div",8),e.TgZ(11,"div",9),e.YNc(12,it,1,6,"booking-detail",10),e.qZA()(),e.YNc(13,nt,22,1,"div",11),e.YNc(14,st,22,1,"div",11),e.YNc(15,lt,18,1,"div",11),e.YNc(16,ut,17,5,"div",0),e.YNc(17,gt,10,0,"div",12),e.qZA(),e.TgZ(18,"div",13)(19,"cf-booking-text",14),e.NdJ("actionShare",function(a){return o.onShare(a)})("modeChange",function(a){return o.changeModeBookingText(a)}),e.qZA(),e._UZ(20,"remark-booking-page",15),e.qZA()(),e.TgZ(21,"div",16)(22,"div",17,18),e.NdJ("click",function(){e.CHM(n);const a=e.MAs(23);return e.KtG(o.mobileTabChange("BOOKING_DETAIL",a))}),e._uU(24," Chi ti\u1ebft \u0111\u1eb7t ch\u1ed7 "),e.qZA(),e.TgZ(25,"div",17,19),e.NdJ("click",function(){e.CHM(n);const a=e.MAs(26);return e.KtG(o.mobileTabChange("PAX_INFO",a))}),e._uU(27," Th\xf4ng tin h\xe0nh kh\xe1ch "),e.qZA(),e.YNc(28,mt,3,6,"div",20),e.YNc(29,pt,3,6,"div",20),e.YNc(30,vt,3,6,"div",20),e.YNc(31,bt,3,6,"div",20),e.YNc(32,ft,3,6,"div",20),e.YNc(33,_t,3,6,"div",20),e.qZA(),e.YNc(34,Dt,4,3,"div",21),e.YNc(35,At,22,3,"div",21),e.YNc(36,Mt,2,1,"div",21),e.YNc(37,Ut,13,6,"div",22),e.YNc(38,jt,2,1,"div",21),e.YNc(39,qt,2,1,"div",21),e.YNc(40,$t,2,1,"div",21),e.qZA()}2&t&&(e.Q6J("ngIf",o.isLoading),e.xp6(4),e.Q6J("ngIf",o.isSuccess),e.xp6(6),e.Q6J("ngIf",o.hasWaitlistBooking),e.xp6(2),e.Q6J("ngForOf",o.bookingDetails),e.xp6(1),e.Q6J("ngIf",o.hasBaggageSelected),e.xp6(1),e.Q6J("ngIf",o.hasSeatSelected),e.xp6(1),e.Q6J("ngIf",o.hasInternationalFlight&&o.fareBasisInfos&&(null==o.fareBasisInfos[0]?null:o.fareBasisInfos[0].fareClass)&&(null==o.fareBasisInfos[0]?null:o.fareBasisInfos[0].fareBasis)&&o.isShowBookingInfo),e.xp6(1),e.Q6J("ngIf",o.isSuccess&&o.totalPrice&&e.DdM(39,Ht).includes(o.bookingDetails[0].status)),e.xp6(1),e.Q6J("ngIf",o.hasInternationalFlight&&o.isShowBookingInfo),e.xp6(2),e.Q6J("listBookingText",o.listBookingText)("modeBookingText",o.modeBookingText)("bookingContact",o.bookingContact)("listBookingTextExplain",o.listBookingTextExplain),e.xp6(1),e.Q6J("listBookingCode",o.listBookingCode),e.xp6(2),e.ekj("text-secondary-3-4","BOOKING_DETAIL"===o.mobileTabMode)("!border-secondary-3-4","BOOKING_DETAIL"===o.mobileTabMode)("bg-secondary-3-1","BOOKING_DETAIL"===o.mobileTabMode),e.xp6(3),e.ekj("text-secondary-3-4","PAX_INFO"===o.mobileTabMode)("!border-secondary-3-4","PAX_INFO"===o.mobileTabMode)("bg-secondary-3-1","PAX_INFO"===o.mobileTabMode),e.xp6(3),e.Q6J("ngIf",o.isShowBookingInfo),e.xp6(1),e.Q6J("ngIf",o.isShowBookingInfo&&o.hasInternationalFlight),e.xp6(1),e.Q6J("ngIf",o.isShowBookingInfo),e.xp6(1),e.Q6J("ngIf",o.isShowBookingInfo),e.xp6(1),e.Q6J("ngIf",o.isShowBookingInfo),e.xp6(1),e.Q6J("ngIf",o.isShowBookingInfo),e.xp6(1),e.Q6J("ngIf","BOOKING_DETAIL"===o.mobileTabMode),e.xp6(1),e.Q6J("ngIf","PAX_INFO"===o.mobileTabMode),e.xp6(1),e.Q6J("ngIf","TOTAL_PRICE"===o.mobileTabMode),e.xp6(1),e.Q6J("ngIf","TOTAL_PRICE"===o.mobileTabMode),e.xp6(1),e.Q6J("ngIf","FARE_RULE"===o.mobileTabMode),e.xp6(1),e.Q6J("ngIf","TICKET_FACE"===o.mobileTabMode),e.xp6(1),e.Q6J("ngIf","REMARK"===o.mobileTabMode))},dependencies:[F.O5,F.ax,Se.AS,F.JJ,y.Js,y.AT,y.Cg,x.AxE,x.Sm8,v.OR,Te.j$,pe.N8,pe.Xq,v.bY,ye.N,y.CY,ve.B,ve.K,me.DW,v.gx,y.a7],encapsulation:2}),c})()}}]);