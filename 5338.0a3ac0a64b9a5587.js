"use strict";(self.webpackChunkcheapflightclient=self.webpackChunkcheapflightclient||[]).push([[5338],{45338:(Pi,R,f)=>{f.r(R),f.d(R,{ImportPnrPageComponent:()=>me,ImportTicketPageComponent:()=>Fi,IssueBookingPageComponent:()=>Ie,ManageBookingPageComponent:()=>Ut,ManageOriginalTicketComponent:()=>ti,OpenBookingComponent:()=>Ti,VoidBookingPageComponent:()=>Si});var g=f(36895),h=f(24006),N=f(10908),A=f(83700),G=f(72853),_=f(72506),D=f(44143),I=f(19123),j=f(74713),y=f(67534),S=f(6703),Y=f(44890),V=f(88001),B=f(15439),Z=f(28746),e=f(94650),$=f(40105),q=f(62733),W=f(2225),O=f(62331),J=f(82761),Q=f(97579);function ne(o,s){1&o&&e._UZ(0,"cf-hint",29),2&o&&e.Q6J("hint","Ch\u01b0a nh\u1eadp booking code")}function oe(o,s){if(1&o&&(e.TgZ(0,"cf-radio",36),e._uU(1),e.qZA()),2&o){const t=s.$implicit;e.Q6J("value",t.value),e.xp6(1),e.Oqu(t.text)}}function ae(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"div",30)(1,"div",31)(2,"cf-radio-group",32),e.NdJ("ngModelChange",function(n){e.CHM(t);const a=e.oxw();return e.KtG(a.mobileProviderChange(n))}),e.YNc(3,oe,2,2,"cf-radio",33),e.qZA()(),e.TgZ(4,"div",34)(5,"button",35),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.providerOptionChange())}),e._uU(6,"X\xe1c nh\u1eadn"),e.qZA()()()}if(2&o){const t=e.oxw();e.xp6(2),e.Q6J("ngModel",t.searchForm.controls.provider.value),e.xp6(1),e.Q6J("ngForOf",t.providerSelectOption)}}function re(o,s){if(1&o&&(e.TgZ(0,"cf-radio",36),e._uU(1),e.qZA()),2&o){const t=s.$implicit;e.Q6J("value",t.value),e.xp6(1),e.Oqu(t.text)}}function se(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"div",30)(1,"div",31)(2,"cf-radio-group",32),e.NdJ("ngModelChange",function(n){e.CHM(t);const a=e.oxw();return e.KtG(a.mobileSupplierChange(n))}),e.YNc(3,re,2,2,"cf-radio",33),e.qZA()(),e.TgZ(4,"div",34)(5,"button",35),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.supplierOptionChange())}),e._uU(6,"X\xe1c nh\u1eadn"),e.qZA()()()}if(2&o){const t=e.oxw();e.xp6(2),e.Q6J("ngModel",t.searchForm.controls.supplier.value),e.xp6(1),e.Q6J("ngForOf",t.supplierSelectOption)}}const X=function(o){return{"opacity-50 pointer-events-none cursor-default":o}};function le(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"div",37)(1,"div",38)(2,"cf-input-group",20),e._UZ(3,"cf-icon",7)(4,"input",39),e.qZA(),e.TgZ(5,"cf-select",40),e.NdJ("ngModelChange",function(n){e.CHM(t);const a=e.oxw();return e.KtG(a.mobileProviderChange(n))}),e.TgZ(6,"label",41),e._uU(7,"Provider"),e.qZA()(),e.TgZ(8,"cf-select",42)(9,"label",41),e._uU(10,"Nh\xe0 cung c\u1ea5p"),e.qZA()()(),e.TgZ(11,"div")(12,"button",43),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.onMobileSearch())}),e._UZ(13,"cf-icon",44),e.TgZ(14,"div"),e._uU(15,"T\xecm ki\u1ebfm"),e.qZA()()()()}if(2&o){const t=e.oxw();e.xp6(4),e.Q6J("formControl",t.searchForm.controls.searchText),e.xp6(1),e.Q6J("ngModel",t.searchForm.controls.provider.value)("data",t.providerSelectOption)("allowSearch",!1),e.xp6(3),e.Q6J("formControl",t.searchForm.controls.supplier)("data",t.supplierSelectOption)("allowSearch",!1)("ngClass",e.VKq(8,X,t.isDisableSupplier))}}function ce(o,s){1&o&&(e.TgZ(0,"div",45)(1,"div",46)(2,"div",47)(3,"div",48)(4,"div",49),e._UZ(5,"img",50),e.qZA(),e.TgZ(6,"div",51),e._uU(7," Nh\u1eadp m\xe3 \u0111\u1eb7t ch\u1ed7 \u0111\u1ec3 import v\xe9 "),e.qZA(),e.TgZ(8,"div",52),e._uU(9," Vui l\xf2ng nh\u1eadp m\xe3 \u0111\u1eb7t ch\u1ed7 c\u1ee7a b\u1ea1n v\xe0o \xf4 b\xean tr\xean v\xe0 ch\u1ecdn n\xfat "),e.TgZ(10,"span",53),e._uU(11,"T\xecm ki\u1ebfm"),e.qZA(),e._uU(12," \u0111\u1ec3 b\u1eaft \u0111\u1ea7u "),e.qZA()()()()())}function ue(o,s){1&o&&(e.ynx(0),e.TgZ(1,"div",51),e._uU(2," Kh\xf4ng c\xf3 k\u1ebft qu\u1ea3 "),e.qZA(),e.TgZ(3,"div",55)(4,"div"),e._uU(5,"Kh\xf4ng c\xf3 k\u1ebft qu\u1ea3 \u0111\u1ec3 hi\u1ec3n th\u1ecb"),e.qZA(),e.TgZ(6,"div"),e._uU(7,"Vui l\xf2ng th\u1eed l\u1ea1i sau ho\u1eb7c ki\u1ec3m tra l\u1ea1i th\xf4ng tin m\xe3 \u0111\u1eb7t ch\u1ed7!"),e.qZA()(),e.BQk())}function ge(o,s){if(1&o&&(e.TgZ(0,"div",45)(1,"div",46)(2,"div",47)(3,"div",48)(4,"div",49),e._UZ(5,"img",54),e.qZA(),e.YNc(6,ue,8,0,"ng-container",28),e.qZA()()()()),2&o){const t=e.oxw();e.xp6(6),e.Q6J("ngIf","not_found"===t.stateMode)}}function pe(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"div",56)(1,"import-pnr-detail",57),e.NdJ("importBooking",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.onImportBooking())})("selectedAgent",function(n){e.CHM(t);const a=e.oxw();return e.KtG(a.onSelectedAgent(n))}),e.qZA()()}if(2&o){const t=e.oxw();e.xp6(1),e.Q6J("optionAgent",t.agentSelectOption)("isLoading",t.isLoading)("bookingDetail",t.bookingDetail)("priceDetail",t.priceDetail)}}function de(o,s){1&o&&(e.TgZ(0,"div",58)(1,"div",59),e._UZ(2,"ticket-item-skeleton",60)(3,"ticket-item-skeleton",60)(4,"ticket-item-skeleton",60)(5,"ticket-item-skeleton",60),e.qZA()())}function he(o,s){1&o&&e._UZ(0,"cf-spinner")}let me=(()=>{class o{constructor(t,i,n,a,r,l,c,p){this._fb=t,this._searchFlightService=i,this._flightDataService=n,this._userService=a,this._toastService=r,this._router=l,this._modal=c,this._bottomSheetService=p,this.stateMode="search_default",this.isLoadingImport=!1,this.isLoading=!1,this.isDisableSupplier=!0,this.providerSelectOption=[],this.supplierSelectOption=[],this.agentSelectOption=[],this.optionDisplayMobile={provider:"",supplier:""},this.getAllAgentUser()}ngOnInit(){this.initSelectOption(),this.searchForm=this._fb.group({provider:["",h.kI.required],supplier:[""],searchText:["",h.kI.required]})}initSelectOption(){this.providerSelectOption=[{text:"Vietnam Airlines",value:"VN"},{text:"Bamboo Airways",value:"QH"},{text:"Vietjet Air",value:"VJ"},{text:"Vietravel Airlines",value:"VU"},{text:"Sun Phu Quoc Airways",value:"SPA"},{text:"1A",value:"BSP"},{text:"1G",value:"AIR_1G"},{text:"LCC",value:"FLY_ONE"},{text:"BZT",value:"BZT"},{text:"ST",value:"ST"}],this.supplierSelectOption=[...Object.entries(V.f$).map(([t,i])=>({text:t,value:i}))]}onSearch(){var t,i;if(this.searchForm.invalid)return;const n=this.searchForm.value,a={provider:n.provider||"",bookingCode:(null===(i=null===(t=n.searchText)||void 0===t?void 0:t.trim())||void 0===i?void 0:i.toUpperCase())||"",supplier:"VN"===n.provider&&n.supplier||null};this.isLoading=!0,this._searchFlightService.searchPNRImport(a).pipe((0,Z.x)(()=>this.isLoading=!1)).subscribe({next:r=>{"OK"===r.status?(console.log(r),this.stateMode="has_value",this.initBookingDetail(r.data),r.data.totalCharges&&this.initPriceDetail(r.data)):(this.stateMode="not_found",this._toastService.add({severity:"error",summary:"C\xf3 l\u1ed7i x\u1ea3y ra",detail:r.objectError.errorDescription.vi?r.objectError.errorDescription.vi:r.objectError.errorDescription.en,sticky:!0}))},error:()=>{this._toastService.add({severity:"error",summary:"T\xecm ki\u1ebfm v\xe9 th\u1ea5t b\u1ea1i",detail:"C\xf3 l\u1ed7i x\u1ea3y ra",sticky:!0})}})}initBookingDetail(t){var i,n,a,r;this.bookingDetail={bookingCode:t.bookingCode,provider:t.provider||"",supplier:t.supplier||"",airlineLogo:this._flightDataService.getAirlineLogoByCode(t.airline),airlineSystem:t.airline,airlineName:this._flightDataService.getAirlineSystemNameByCode(t.airline),startPoint:(null===(i=t.journeys[0])||void 0===i?void 0:i.departure.airport.code)||"",endPoint:t.journeys.length?1===t.journeys.length?t.journeys[0].arrival.airport.code:t.journeys[t.journeys.length-1].departure.airport.code:"",statusText:t.getStatusText(),internal:t.internal,status:t.state,flightNumber:t.journeys.length?`${t.journeys[0].airline}${t.journeys[0].segments[0].flightNumber}`:"",journeys:(null===(n=t.journeys)||void 0===n?void 0:n.map(l=>{var c;return{startPoint:l.departure.airport.code,endPoint:l.arrival.airport.code,startTime:B(l.departure.localTime).toDate(),flightNumber:l.segments[0].operating+l.segments[0].flightNumber,segments:null===(c=l.segments)||void 0===c?void 0:c.map(p=>({airline:p.airline,startPoint:p.departure.airport.code,endPoint:p.arrival.airport.code,startTime:p.departure.localTime,endTime:p.arrival.localTime,flightNumber:p.flightNumber}))}}))||[],passengers:t.passengers.map(l=>({name:l.getName(),type:l.getType(),index:l.index,key:l.key,birthday:l.birthday,lastName:l.lastName,firstName:l.firstName,parentKey:l.parentKey,gender:l.gender,base:l.base,tax:l.tax,total:l.total,document:l.document})),ticketingAllowed:null!==(r=null===(a=t.bookDetail)||void 0===a?void 0:a.ticketingAllowed)&&void 0!==r&&r}}initPriceDetail(t){var i,n,a;const r=t.passengers.map(l=>({name:l.getName(),type:l.type,typeName:l.getType(),key:l.key}));this.priceDetail={provider:t.journeys.map(l=>l.airline||l.operating),totalBasePrice:t.totalCharges.total.totalFareCharge,totalDiscountBasePrice:0,totalServiceFee:t.totalCharges.total.totalServiceFee,totalAddonService:t.totalCharges.total.totalAddonCharge,totalPrice:t.totalCharges.total.total,totalDiscountFareCharge:0,totalOthersCharge:t.totalCharges.total.totalOthersCharge,passengers:r.map(l=>{var c;return{name:l.name,type:l.typeName,base:t.fareCharges.getBaseCharge(l.type),tax:t.fareCharges.getTaxCharge(l.type)+t.fareCharges.getVATCharge(l.type),discountAmount:null===(c=t.fareCharges)||void 0===c?void 0:c.getDiscountByPercent(l.type,this.discountPercentage,t.provider,t.journeys.length),total:t.fareCharges.getTotalCharge(l.type),get totalDiscountFarePrice(){return this.total-this.discountAmount}}})},this.totalDiscountAmount=null===(i=this.priceDetail.passengers)||void 0===i?void 0:i.reduce((l,c)=>l+((null==c?void 0:c.discountAmount)||0),0),this.priceDetail.totalDiscountBasePrice=this.priceDetail.totalBasePrice-this.totalDiscountAmount,this.priceDetail.totalDiscountFareCharge=null!==(n=this.priceDetail)&&void 0!==n&&n.totalPrice?(null===(a=this.priceDetail)||void 0===a?void 0:a.totalPrice)-this.totalDiscountAmount:0}onProviderChange(t){this.checkDisableSupplier(t.value)}checkDisableSupplier(t){"VN"!==t?(this.isDisableSupplier=!0,this.searchForm.get("supplier").clearValidators(),this.searchForm.get("supplier").updateValueAndValidity()):(this.isDisableSupplier=!1,this.searchForm.get("supplier").setValidators([h.kI.required]),this.searchForm.get("supplier").updateValueAndValidity())}onSelectedAgent(t){this.agentSelected=t}getAllAgentUser(){this._userService.getAutocompleteUser().subscribe({next:t=>{t.success&&(this.agentSelectOption=t.data.map(i=>({id:i.id,name:`${i.username} - ${i.name}`})))}})}onImportBooking(){this._modal.open(y.V0,{title:"",body:"X\xe1c nh\u1eadn import v\xe9 n\xe0y v\xe0o h\u1ec7 th\u1ed1ng?",okText:"Import",cancelText:"\u0110\xf3ng",hasIcon:!1}).afterClosed$.subscribe({next:i=>{var n;if(i.data){const a={agentId:(null===(n=this.agentSelected)||void 0===n?void 0:n.id)||"",bookingCode:this.bookingDetail.bookingCode||"",provider:this.bookingDetail.provider||"",supplier:this.bookingDetail.supplier||null};this.isLoadingImport=!0,this._searchFlightService.importPNROutside(a).pipe((0,Z.x)(()=>this.isLoadingImport=!1)).subscribe({next:r=>{console.log(r),"OK"===r.status?(this._toastService.add({severity:"success",summary:"Import v\xe9 th\xe0nh c\xf4ng",detail:"M\xe3 \u0111\u1eb7t ch\u1ed7 \u0111\xe3 \u0111\u01b0\u1ee3c import v\xe9 th\xe0nh c\xf4ng!",sticky:!1}),this._router.navigate([`/admin/booking-detail/${this.bookingDetail.airlineSystem}/${this.bookingDetail.bookingCode}`])):this._toastService.add({severity:"error",summary:"Import v\xe9 th\u1ea5t b\u1ea1i",detail:r.objectError.errorDescription.vi?r.objectError.errorDescription.vi:r.objectError.errorDescription.en,sticky:!0})},error:()=>{this._toastService.add({severity:"error",summary:"Import v\xe9 th\u1ea5t b\u1ea1i",detail:"C\xf3 l\u1ed7i x\u1ea3y ra, vui l\xf2ng th\u1eed l\u1ea1i sau!",sticky:!0})}})}}})}openProviderBts(t){const i=this._bottomSheetService.open(t,{headerTitle:"Provider",rightButtonIcon:"",leftButtonIcon:"close",leftButtonIconClass:"text-neutral-gray-4",restoreFocus:!1});i.containerInstance._leftButtonClick.subscribe(()=>i.dismiss())}openSupplierBts(t){if(this.isDisableSupplier)return;const i=this._bottomSheetService.open(t,{headerTitle:"Nh\xe0 cung c\u1ea5p",rightButtonIcon:"",leftButtonIcon:"close",leftButtonIconClass:"text-neutral-gray-4",restoreFocus:!1});i.containerInstance._leftButtonClick.subscribe(()=>i.dismiss())}openSearchBts(t){const i=this._bottomSheetService.open(t,{headerTitle:"T\xecm ki\u1ebfm",rightButtonIcon:"",leftButtonIcon:"close",containerFullHeigh:!0,leftButtonIconClass:"text-neutral-gray-4",restoreFocus:!1});i.containerInstance._leftButtonClick.subscribe(()=>i.dismiss())}mobileProviderChange(t){this.tempMobileProvider=t,this.checkDisableSupplier(this.tempMobileProvider)}mobileSupplierChange(t){this.tempMobileSupplier=t}providerOptionChange(){var t;this.checkDisableSupplier(this.tempMobileProvider),this.searchForm.controls.provider.setValue(this.tempMobileProvider),this.optionDisplayMobile.provider=(null===(t=this.providerSelectOption.find(i=>i.value===this.tempMobileProvider))||void 0===t?void 0:t.text)||"",this._bottomSheetService.dismiss(),this.onSearch()}supplierOptionChange(){var t;this.searchForm.controls.supplier.setValue(this.tempMobileSupplier),this.optionDisplayMobile.supplier=(null===(t=this.supplierSelectOption.find(i=>i.value===this.tempMobileSupplier))||void 0===t?void 0:t.text)||"",this._bottomSheetService.dismiss(),this.onSearch()}onMobileSearch(){this.tempMobileProvider&&this.searchForm.controls.provider.setValue(this.tempMobileProvider),this._bottomSheetService.dismiss(),this.onSearch()}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(h.qu),e.Y36($.t7),e.Y36(q.G),e.Y36(W.KD),e.Y36(O.BX),e.Y36(J.F0),e.Y36(Q.oE),e.Y36(N.a2))},o.\u0275cmp=e.Xpm({type:o,selectors:[["import-pnr-page"]],standalone:!0,features:[e.jDz],decls:41,vars:24,consts:[[1,"flex-auto","flex","flex-col","w-full"],[1,"bg-white","p-[30px]","w-full","shadow-sm","flex","flex-col","gap-y-[30px]","md:hidden"],[1,"text-heading-lg"],[1,"flex","gap-x-3","items-start","min-h-[60px]"],["textField","text","valueField","value","size","medium","placeholder","Ch\u1ecdn provider",1,"w-[200px]",3,"formControl","data","allowSearch","selectedChange"],["textField","text","valueField","value","size","medium","placeholder","Ch\u1ecdn nh\xe0 cung c\u1ea5p",1,"w-[180px]",3,"formControl","data","allowSearch","ngClass"],[1,"flex-1",3,"status"],["cfHeadIcon","","icon","search","size","small"],["size","medium","cf-input","","placeholder","Nh\u1eadp booking code",3,"formControl"],["tableSearchInput",""],["cfHint","",3,"hint",4,"ngIf"],["cf-button","","size","medium","type","secondary",1,"!text-button-md",3,"disabled","click"],["icon","search","size","small",1,"mr-2.5"],[1,"hidden","md:flex","flex-col","py-3","px-4","gap-y-3","pr-0","bg-neutral-white"],[1,"text-heading-sm","text-neutral-gray-6"],[1,"flex","gap-x-3","overflow-x-auto"],[1,"gap-x-1.5","items-center","border","border-neutral-gray-3","rounded-full","px-4","py-[5px]","hidden","md:flex",3,"click"],[1,"text-body-md","whitespace-nowrap"],["icon","chevron_down","size","small",1,"text-neutral-gray-5"],[1,"gap-x-1.5","items-center","border","border-neutral-gray-3","rounded-full","px-4","py-[5px]","hidden","md:flex",3,"ngClass","click"],[1,"hidden","!w-full","md:pr-4","md:block"],["size","medium","cf-input","","placeholder","T\xecm ki\u1ebfm",3,"formControl","focus"],["providerOptionMobile",""],["supplierOptionMobile",""],["searchBts",""],["class","flex-auto w-full max-h-[calc(100vh-152px)] py-4 px-[30px] md:p-0",4,"ngIf"],["class","flex-auto flex justify-center w-full max-h-[calc(100vh-152px)] py-4",4,"ngIf"],["class","flex-auto flex justify-center w-full max-h-[calc(100vh-152px)] py-4 px-[30px]",4,"ngIf"],[4,"ngIf"],["cfHint","",3,"hint"],[1,"flex","flex-col","justify-between","w-full"],[1,"p-4","pb-2"],[1,"flex","flex-col","gap-y-4",3,"ngModel","ngModelChange"],["size","medium",3,"value",4,"ngFor","ngForOf"],[1,"p-4"],["cf-button","",1,"justify-center","w-full",3,"click"],["size","medium",3,"value"],[1,"p-4","w-full","flex","flex-col","justify-between"],[1,"flex","flex-col","gap-y-4"],["size","medium","cf-input","","placeholder","T\xecm ki\u1ebfm",3,"formControl"],["textField","text","valueField","value","size","medium","placeholder","Ch\u1ecdn provider",1,"w-full","max-w-none","mr-4",3,"ngModel","data","allowSearch","ngModelChange"],["cfLabel",""],["textField","text","valueField","value","size","medium","placeholder","Ch\u1ecdn nh\xe0 cung c\u1ea5p",1,"w-full","max-w-none","mr-4",3,"formControl","data","allowSearch","ngClass"],["cf-button","",1,"w-full","justify-center","gap-x-2",3,"click"],["icon","search","size","small"],[1,"flex-auto","w-full","max-h-[calc(100vh-152px)]","py-4","px-[30px]","md:p-0"],[1,"bg-white","w-full","h-full","rounded-lg","md:bg-transparent"],[1,"h-[500px]","flex","flex-col","justify-center","items-center"],[1,"flex","flex-col","justify-center","items-center"],[1,"mb-8"],["src","assets/images/web-page.svg","alt",""],[1,"text-heading-md","text-neutral-black","mb-2"],[1,"text-espressive-md","text-neutral-gray-5","md:w-[257px]","md:text-center"],[1,"text-espressive-md"],["src","assets/images/empty-result.svg","alt",""],[1,"text-espressive-md","text-neutral-gray-5","text-center","md:w-[257px]"],[1,"flex-auto","flex","justify-center","w-full","max-h-[calc(100vh-152px)]","py-4"],[1,"w-fit",3,"optionAgent","isLoading","bookingDetail","priceDetail","importBooking","selectedAgent"],[1,"flex-auto","flex","justify-center","w-full","max-h-[calc(100vh-152px)]","py-4","px-[30px]"],[1,"flex","flex-col","justify-center","items-center","w-full","h-full"],[1,"w-full"]],template:function(t,i){if(1&t){const n=e.EpF();e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._uU(3,"Import v\xe9"),e.qZA(),e.TgZ(4,"div",3)(5,"cf-select",4),e.NdJ("selectedChange",function(r){return i.onProviderChange(r)}),e.qZA(),e._UZ(6,"cf-select",5),e.TgZ(7,"cf-input-group",6),e._UZ(8,"cf-icon",7)(9,"input",8,9),e.YNc(11,ne,1,1,"cf-hint",10),e.qZA(),e.TgZ(12,"button",11),e.NdJ("click",function(){return i.onSearch()}),e._UZ(13,"cf-icon",12),e._uU(14," T\xecm ki\u1ebfm "),e.qZA()()(),e.TgZ(15,"div",13)(16,"div",14),e._uU(17,"Import v\xe9"),e.qZA(),e.TgZ(18,"div",15)(19,"div",16),e.NdJ("click",function(){e.CHM(n);const r=e.MAs(31);return e.KtG(i.openProviderBts(r))}),e.TgZ(20,"div",17),e._uU(21),e.qZA(),e._UZ(22,"cf-icon",18),e.qZA(),e.TgZ(23,"div",19),e.NdJ("click",function(){e.CHM(n);const r=e.MAs(33);return e.KtG(i.openSupplierBts(r))}),e.TgZ(24,"div",17),e._uU(25),e.qZA(),e._UZ(26,"cf-icon",18),e.qZA()(),e.TgZ(27,"cf-input-group",20),e._UZ(28,"cf-icon",7),e.TgZ(29,"input",21),e.NdJ("focus",function(){e.CHM(n);const r=e.MAs(35);return e.KtG(i.openSearchBts(r))}),e.qZA()()(),e.YNc(30,ae,7,2,"ng-template",null,22,e.W1O),e.YNc(32,se,7,2,"ng-template",null,23,e.W1O),e.YNc(34,le,16,10,"ng-template",null,24,e.W1O),e.YNc(36,ce,13,0,"div",25),e.YNc(37,ge,7,1,"div",25),e.YNc(38,pe,2,4,"div",26),e.YNc(39,de,6,0,"div",27),e.qZA(),e.YNc(40,he,1,0,"cf-spinner",28)}2&t&&(e.xp6(5),e.Q6J("formControl",i.searchForm.controls.provider)("data",i.providerSelectOption)("allowSearch",!1),e.xp6(1),e.Q6J("formControl",i.searchForm.controls.supplier)("data",i.supplierSelectOption)("allowSearch",!1)("ngClass",e.VKq(20,X,i.isDisableSupplier)),e.xp6(1),e.Q6J("status",i.searchForm.controls.searchText.invalid&&(i.searchForm.controls.searchText.dirty||i.searchForm.controls.searchText.touched)?"error":"default"),e.xp6(2),e.Q6J("formControl",i.searchForm.controls.searchText),e.xp6(2),e.Q6J("ngIf",(null==i.searchForm.controls.searchText.errors?null:i.searchForm.controls.searchText.errors.required)&&(i.searchForm.controls.searchText.dirty||i.searchForm.controls.searchText.touched)),e.xp6(1),e.Q6J("disabled",i.isLoading||i.searchForm.invalid),e.xp6(9),e.Oqu((null==i.optionDisplayMobile?null:i.optionDisplayMobile.provider)||"Ch\u1ecdn provider"),e.xp6(2),e.Q6J("ngClass",e.VKq(22,X,i.isDisableSupplier)),e.xp6(2),e.Oqu((null==i.optionDisplayMobile?null:i.optionDisplayMobile.supplier)||"Ch\u1ecdn nh\xe0 cung c\u1ea5p"),e.xp6(4),e.Q6J("formControl",i.searchForm.controls.searchText),e.xp6(7),e.Q6J("ngIf",!i.isLoading&&"search_default"===i.stateMode),e.xp6(1),e.Q6J("ngIf",!i.isLoading&&("not_found"===i.stateMode||"cancelled"===i.stateMode||"issued"===i.stateMode)),e.xp6(1),e.Q6J("ngIf",!i.isLoading&&"has_value"===i.stateMode),e.xp6(1),e.Q6J("ngIf",i.isLoading),e.xp6(1),e.Q6J("ngIf",i.isLoadingImport))},dependencies:[g.ez,g.mk,g.sg,g.O5,D.j$,D.ND,D.BN,_.AxE,_.Sm8,A.N8,A.Xq,j.q,h.u5,h.Fj,h.JJ,h.On,h.UX,h.oH,G.m,S.UD,y.OR,Y.IA,I.o,I.T,N.DW],encapsulation:2}),o})();var ee=f(18058),w=f(17414),te=f(82908),H=f(58273),L=f(9381),K=f(40899),fe=f(78533);const ie=function(o){return{"opacity-50 pointer-events-none cursor-default":o}};function _e(o,s){if(1&o&&e._UZ(0,"cf-select",29),2&o){const t=e.oxw();e.Q6J("formControl",t.searchForm.controls.supplier)("data",t.supplierSelectOption)("allowSearch",!1)("ngClass",e.VKq(4,ie,t.isDisableSupplier))}}function ve(o,s){1&o&&e._UZ(0,"cf-hint",30),2&o&&e.Q6J("hint","Ch\u01b0a nh\u1eadp booking code")}function xe(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"div",31),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(),a=e.MAs(30);return e.KtG(n.openSupplierBts(a))}),e.TgZ(1,"div",17),e._uU(2,"Ch\u1ecdn nh\xe0 cung c\u1ea5p"),e.qZA(),e._UZ(3,"cf-icon",18),e.qZA()}if(2&o){const t=e.oxw();e.Q6J("ngClass",e.VKq(1,ie,t.isDisableSupplier))}}function Te(o,s){if(1&o&&(e.TgZ(0,"cf-radio",38),e._uU(1),e.qZA()),2&o){const t=s.$implicit;e.Q6J("value",t.value),e.xp6(1),e.Oqu(t.name)}}function Ce(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"div",32)(1,"div",33)(2,"cf-radio-group",34),e.NdJ("ngModelChange",function(n){e.CHM(t);const a=e.oxw();return e.KtG(a.mobileAirlineChange(n))}),e.YNc(3,Te,2,2,"cf-radio",35),e.qZA()(),e.TgZ(4,"div",36)(5,"button",37),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.airlineOptionChange())}),e._uU(6,"X\xe1c nh\u1eadn"),e.qZA()()()}if(2&o){const t=e.oxw();e.xp6(2),e.Q6J("ngModel",t.searchForm.controls.airline.value),e.xp6(1),e.Q6J("ngForOf",t.airlineSelectOption)}}function be(o,s){if(1&o&&(e.TgZ(0,"cf-radio",38),e._uU(1),e.qZA()),2&o){const t=s.$implicit;e.Q6J("value",t.value),e.xp6(1),e.Oqu(t.name)}}function ke(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"div",32)(1,"div",33)(2,"cf-radio-group",34),e.NdJ("ngModelChange",function(n){e.CHM(t);const a=e.oxw();return e.KtG(a.mobileSupplierChange(n))}),e.YNc(3,be,2,2,"cf-radio",35),e.qZA()(),e.TgZ(4,"div",36)(5,"button",37),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.airlineOptionChange())}),e._uU(6,"X\xe1c nh\u1eadn"),e.qZA()()()}if(2&o){const t=e.oxw();e.xp6(2),e.Q6J("ngModel",t.searchForm.controls.supplier.value),e.xp6(1),e.Q6J("ngForOf",t.supplierSelectOption)}}function ye(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"div",39)(1,"div",40)(2,"cf-input-group",20),e._UZ(3,"cf-icon",7)(4,"input",41),e.qZA(),e.TgZ(5,"cf-select",42),e.NdJ("ngModelChange",function(n){e.CHM(t);const a=e.oxw();return e.KtG(a.mobileAirlineChange(n))}),e.TgZ(6,"label",43),e._uU(7,"H\xe3ng bay"),e.qZA()()(),e.TgZ(8,"div")(9,"button",44),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.onMobileSearch())}),e._UZ(10,"cf-icon",45),e.TgZ(11,"div"),e._uU(12,"T\xecm ki\u1ebfm"),e.qZA()()()()}if(2&o){const t=e.oxw();e.xp6(4),e.Q6J("formControl",t.searchForm.controls.searchText),e.xp6(1),e.Q6J("ngModel",t.searchForm.controls.airline.value)("data",t.airlineSelectOption)("allowSearch",!1)}}function Ee(o,s){1&o&&(e.TgZ(0,"div",46)(1,"div",47)(2,"div",48)(3,"div",49)(4,"div",50),e._UZ(5,"img",51),e.qZA(),e.TgZ(6,"div",52),e._uU(7," Nh\u1eadp m\xe3 \u0111\u1eb7t ch\u1ed7 \u0111\u1ec3 xu\u1ea5t v\xe9 "),e.qZA(),e.TgZ(8,"div",53),e._uU(9," Vui l\xf2ng nh\u1eadp m\xe3 \u0111\u1eb7t ch\u1ed7 c\u1ee7a b\u1ea1n v\xe0o \xf4 b\xean tr\xean v\xe0 ch\u1ecdn n\xfat "),e.TgZ(10,"span",54),e._uU(11,"T\xecm ki\u1ebfm"),e.qZA(),e._uU(12," \u0111\u1ec3 b\u1eaft \u0111\u1ea7u "),e.qZA()()()()())}function De(o,s){1&o&&(e.ynx(0),e.TgZ(1,"div",52),e._uU(2," Kh\xf4ng c\xf3 k\u1ebft qu\u1ea3 "),e.qZA(),e.TgZ(3,"div",56)(4,"div"),e._uU(5,"Kh\xf4ng c\xf3 k\u1ebft qu\u1ea3 \u0111\u1ec3 hi\u1ec3n th\u1ecb"),e.qZA(),e.TgZ(6,"div"),e._uU(7,"Vui l\xf2ng th\u1eed l\u1ea1i sau ho\u1eb7c ki\u1ec3m tra l\u1ea1i th\xf4ng tin m\xe3 \u0111\u1eb7t ch\u1ed7!"),e.qZA()(),e.BQk())}function Ze(o,s){1&o&&(e.ynx(0),e.TgZ(1,"div",52),e._uU(2," M\xe3 \u0111\u1eb7t ch\u1ed7 \u0111\xe3 b\u1ecb h\u1ee7y "),e.qZA(),e.TgZ(3,"div",57)(4,"div"),e._uU(5,"M\xe3 \u0111\u1eb7t ch\u1ed7 n\xe0y \u0111\xe3 b\u1ecb h\u1ee7y, kh\xf4ng th\u1ec3 ti\u1ebfp t\u1ee5c xu\u1ea5t v\xe9. Vui l\xf2ng xu\u1ea5t cho m\xe3 \u0111\u1eb7t ch\u1ed7 kh\xe1c!"),e.qZA()(),e.BQk())}function Se(o,s){1&o&&(e.ynx(0),e.TgZ(1,"div",52),e._uU(2," M\xe3 \u0111\u1eb7t ch\u1ed7 \u0111\xe3 xu\u1ea5t "),e.qZA(),e.TgZ(3,"div",57)(4,"div"),e._uU(5,"M\xe3 \u0111\u1eb7t ch\u1ed7 n\xe0y \u0111\xe3 xu\u1ea5t v\xe9, kh\xf4ng th\u1ec3 ti\u1ebfp t\u1ee5c xu\u1ea5t v\xe9. Vui l\xf2ng xu\u1ea5t cho m\xe3 \u0111\u1eb7t ch\u1ed7 kh\xe1c!"),e.qZA()(),e.BQk())}function Ae(o,s){if(1&o&&(e.TgZ(0,"div",46)(1,"div",47)(2,"div",48)(3,"div",49)(4,"div",50),e._UZ(5,"img",55),e.qZA(),e.YNc(6,De,8,0,"ng-container",28),e.YNc(7,Ze,6,0,"ng-container",28),e.YNc(8,Se,6,0,"ng-container",28),e.qZA()()()()),2&o){const t=e.oxw();e.xp6(6),e.Q6J("ngIf","not_found"===t.stateMode),e.xp6(1),e.Q6J("ngIf","cancelled"===t.stateMode),e.xp6(1),e.Q6J("ngIf","issued"===t.stateMode)}}function Me(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"div",58)(1,"issue-booking-detail",59),e.NdJ("issueBooking",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.onIssue())})("gotoBooking",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.onGotoBooking())})("selectedAgent",function(n){e.CHM(t);const a=e.oxw();return e.KtG(a.onSelectedAgent(n))}),e.qZA()()}if(2&o){const t=e.oxw();e.xp6(1),e.Q6J("optionAgent",t.optionAgent)("isLoading",t.isLoading)("bookingDetail",t.bookingDetail)("priceDetail",t.priceDetail)("hasDiscountFare",t.hasDiscountFare)}}function Be(o,s){1&o&&(e.TgZ(0,"div",60)(1,"div",61),e._UZ(2,"ticket-item-skeleton",62)(3,"ticket-item-skeleton",62)(4,"ticket-item-skeleton",62)(5,"ticket-item-skeleton",62),e.qZA()())}function Ne(o,s){1&o&&(e.TgZ(0,"div"),e._UZ(1,"cf-spinner"),e.qZA())}let Ie=(()=>{class o{constructor(t,i,n,a,r,l,c,p,T,E,u,C,m,d,v){this._router=n,this._bookingDetailService=a,this._manageBookingService=r,this._modal=l,this._flightDataService=c,this._route=p,this._userService=T,this._searchFlightService=E,this._toastService=u,this._bottomSheetService=C,this._mobileDetectService=m,this._permissionService=d,this._sockerService=v,this.airlineSelectOption=[],this.supplierSelectOption=[],this.stateMode="search_default",this.isLoading=!1,this.isLoadingIssue=!1,this.optionAgent=[],this.isShowSupplier=this._permissionService.isAgent1()||this._permissionService.isBooker(),this.isDisableSupplier=!1,this.hasDiscountFare=!1,t.registerIcons([_.esH,_.n78]),this.searchForm=i.group({airline:["all",h.kI.required],supplier:[""],searchText:["",h.kI.required]})}ngOnInit(){this.airlineSelectOption=[{name:"T\u1ef1 \u0111\u1ed9ng",value:"all"},{name:"Vietnam Airlines",value:"VN"},{name:"Bamboo Airways",value:"QH"},{name:"Vietjet Air",value:"VJ"},{name:"Vietravel Airlines",value:"VU"},{name:"Sun Phu Quoc Airways",value:"SPA"},{name:"1A",value:"BSP"},{name:"1G",value:"AIR_1G"}],this.supplierSelectOption=[{name:"T\u1ef1 \u0111\u1ed9ng",value:""},...Object.entries(V.f$).map(([t,i])=>({name:t,value:i}))]}handleSocketTimoutEvent(){const i=this._permissionService.getCurrentUser().userId;this._sockerService.timeoutEvent$.subscribe({next:n=>{if(this.refTimoutModal&&this.refTimoutModal.close(),this.refTimoutBts&&this.refTimoutBts.dismiss(),n.receiverId===i){const a=`/admin/booking-detail/${n.airline}/${n.pnr}`;this._toastService.add({severity:"success",summary:"Xu\u1ea5t v\xe9 th\xe0nh c\xf4ng",detail:"M\xe3 \u0111\u1eb7t ch\u1ed7 \u0111\xe3 \u0111\u01b0\u1ee3c xu\u1ea5t v\xe9 th\xe0nh c\xf4ng!",sticky:!1}),this._router.navigate([a])}}})}getAllAgentUser(){this._userService.getAutocompleteUser().subscribe({next:t=>{t.success&&(this.optionAgent=t.data.map(i=>({id:i.id,name:`${i.username} - ${i.name}`})))}})}onAirlineChange(t){this.checkDisableSupplier(t.value)}onSearch(){var t;if(this.searchForm.invalid)return;this.isLoading=!0;const n={provider:"all"===this.searchForm.controls.airline.value?"":this.searchForm.controls.airline.value,bookingCode:this.searchForm.value.searchText.trim().toUpperCase(),globalSearch:!1,supplier:(null===(t=this.searchForm.controls.supplier)||void 0===t?void 0:t.value)||null};this._searchFlightService.searchByPNR(n).pipe((0,Z.x)(()=>this.isLoading=!1)).subscribe({next:a=>{a.success&&a.data&&("VN"===a.data.airline&&"CANCEL"!==a.data.state||"BOOKED"===a.data.state)?(this.bookingCodeStatus=a.data.state,this.internal=a.data.internal,this.stateMode="has_value",this.bookingCode=a.data.bookingCode,this.airline=a.data.airline,this.discountPercentage=a.data.discountPercentage,this.hasDiscountFare=!!this.discountPercentage,this.initBookingDetail(a.data),this.initPriceDetail(a.data),this.bookingDetail.internal||this.getAllAgentUser()):this.stateMode=a.success&&a.data&&("CANCEL"===a.data.state||"VOID"===a.data.state)?"cancelled":a.success&&a.data&&"ISSUED"===a.data.state?"issued":"not_found"},error:()=>{this.stateMode="not_found"}})}initBookingDetail(t){var i,n;this.bookingDetail={bookingCode:t.bookingCode,provider:t.provider||"",supplier:t.supplier||"",airlineLogo:this._flightDataService.getAirlineLogoByCode(t.airline),airlineSystem:t.airline,airlineName:this._flightDataService.getAirlineSystemNameByCode(t.airline),startPoint:t.journeys[0].departure.airport.code,endPoint:1===t.journeys.length?t.journeys[0].arrival.airport.code:t.journeys[t.journeys.length-1].departure.airport.code,statusText:t.getStatusText(),internal:t.internal,status:t.state,flightNumber:`${t.journeys[0].airline}${t.journeys[0].segments[0].flightNumber}`,journeys:t.journeys.map(a=>{var r;return{startPoint:a.departure.airport.code,endPoint:a.arrival.airport.code,startTime:B(a.departure.localTime).toDate(),flightNumber:a.segments[0].operating+a.segments[0].flightNumber,segments:null===(r=a.segments)||void 0===r?void 0:r.map(l=>({airline:l.airline,startPoint:l.departure.airport.code,endPoint:l.arrival.airport.code,startTime:l.departure.localTime,endTime:l.arrival.localTime,flightNumber:l.flightNumber}))}}),passengers:t.passengers.map(a=>({name:a.getName(),type:a.getType(),index:a.index,key:a.key,birthday:a.birthday,lastName:a.lastName,firstName:a.firstName,parentKey:a.parentKey,gender:a.gender,base:a.base,tax:a.tax,total:a.total,document:a.document})),ticketingAllowed:null!==(n=null===(i=t.bookDetail)||void 0===i?void 0:i.ticketingAllowed)&&void 0!==n&&n}}initPriceDetail(t){var i,n,a;const r=t.passengers.map(l=>({name:l.getName(),type:l.type,typeName:l.getType(),key:l.key}));this.priceDetail={provider:t.journeys.map(l=>l.airline||l.operating),totalBasePrice:t.totalCharges.total.totalFareCharge,totalDiscountBasePrice:0,totalServiceFee:t.totalCharges.total.totalServiceFee,totalAddonService:t.totalCharges.total.totalAddonCharge,totalPrice:t.totalCharges.total.total,totalDiscountFareCharge:0,totalOthersCharge:t.totalCharges.total.totalOthersCharge,passengers:r.map(l=>{var c;return{name:l.name,type:l.typeName,base:t.fareCharges.getBaseCharge(l.type),tax:t.fareCharges.getTaxCharge(l.type)+t.fareCharges.getVATCharge(l.type),discountAmount:null===(c=t.fareCharges)||void 0===c?void 0:c.getDiscountByPercent(l.type,this.discountPercentage,t.provider,t.journeys.length),total:t.fareCharges.getTotalCharge(l.type),get totalDiscountFarePrice(){return this.total-this.discountAmount}}})},this.totalDiscountAmount=null===(i=this.priceDetail.passengers)||void 0===i?void 0:i.reduce((l,c)=>l+((null==c?void 0:c.discountAmount)||0),0),this.priceDetail.totalDiscountBasePrice=this.priceDetail.totalBasePrice-this.totalDiscountAmount,this.priceDetail.totalDiscountFareCharge=null!==(n=this.priceDetail)&&void 0!==n&&n.totalPrice?(null===(a=this.priceDetail)||void 0===a?void 0:a.totalPrice)-this.totalDiscountAmount:0}getIssueData(){var t,i,n,a;const r=null===(t=this.bookingDetail.passengers.filter(c=>"INF"!==c.type))||void 0===t?void 0:t.map(c=>{const p=this.bookingDetail.passengers.filter(T=>"INF"===T.type).find(T=>T.parentKey===c.key);return{firstName:c.firstName,lastName:c.lastName,type:c.type,child:p?{firstName:p.firstName,lastName:p.lastName,type:p.type}:null}});return{bookingCode:this.bookingDetail.bookingCode,passengers:r,segments:null===(n=null===(i=this.bookingDetail.journeys)||void 0===i?void 0:i.flatMap(c=>c.segments))||void 0===n?void 0:n.map(c=>({flightNumber:`${c.airline}${c.flightNumber}`,startCode:c.startPoint,endCode:c.endPoint,route:`${c.startPoint}${c.endPoint}`,departDate:c.startTime?(0,g.p6)(c.startTime,"dMMM","en-US"):"",startTime:c.startTime?(0,g.p6)(c.startTime,"HH:mm","vi-VN"):"",endTime:c.endTime?(0,g.p6)(c.endTime,"HH:mm","vi-VN"):""})),totalCharge:(null===(a=this.priceDetail)||void 0===a?void 0:a.totalPrice)||0}}onIssue(){var t,i,n;if("ISSUED"===this.bookingCodeStatus&&V.PY&&"VN"===(null===(t=this.airline)||void 0===t?void 0:t.toUpperCase()))return void this._modal.open(y.z5,{title:"Th\xf4ng b\xe1o",content:"H\u1ec7 th\u1ed1ng m\u1edbi Vietnam Airlines ch\u01b0a h\u1ed7 tr\u1ee3 t\xednh n\u0103ng n\xe0y. Xin li\u1ec7n h\u1ec7 booker \u0111\u1ec3 \u0111\u01b0\u1ee3c h\u1ed7 tr\u1ee3",status:"error",cancelText:"\u0110\xf3ng"});const a={agentId:(null===(i=this.agentSelected)||void 0===i?void 0:i.id)||"",bookingCode:this.bookingCode,bookingPrice:0,internal:this.internal,provider:this.bookingDetail.provider||"",checkDiscountFee:!0,passengers:[]};this.bookingDetail.supplier&&(a.supplier=this.bookingDetail.supplier);const r=`/admin/booking-detail/${this.airline}/${this.bookingCode}`;if("BSP"===(null===(n=this.bookingDetail.provider)||void 0===n?void 0:n.toUpperCase())){const l=c=>{this.isLoadingIssue=!0,this._manageBookingService.issueTicket(a).pipe((0,Z.x)(()=>this.isLoadingIssue=!1)).subscribe({next:p=>{var T,E;if(p.success)this._toastService.add({severity:"success",summary:"Xu\u1ea5t v\xe9 th\xe0nh c\xf4ng",detail:"M\xe3 \u0111\u1eb7t ch\u1ed7 \u0111\xe3 \u0111\u01b0\u1ee3c xu\u1ea5t v\xe9 th\xe0nh c\xf4ng!",sticky:!1}),this._router.navigate([r]);else if("DS-EL005"===p.objectError.errorCode){const u=p.objectError.errorData.priceInfo.newPrice-p.objectError.errorData.priceInfo.oldPrice,C={newPrice:p.objectError.errorData.priceInfo.newPrice,oldPrice:p.objectError.errorData.priceInfo.oldPrice,priceGap:Math.abs(u),type:u>0?"+":"-"};if(this._mobileDetectService.isMobile()){const m=this._bottomSheetService.open(S.EH,{headerTitle:"Chi ph\xed thay \u0111\u1ed5i",containerFullHeigh:!0,rightButtonIcon:"",leftButtonIcon:"close",leftButtonIconClass:"text-neutral-gray-4",data:{priceChangeData:C}});m.containerInstance._leftButtonClick.subscribe(d=>m.dismiss()),m.afterDismissed().subscribe(d=>{d&&(this.isLoadingIssue=!0,this._manageBookingService.issueTicket(a).pipe((0,Z.x)(()=>this.isLoadingIssue=!1)).subscribe({next:v=>{v.success?(this._toastService.add({severity:"success",summary:"Xu\u1ea5t v\xe9 th\xe0nh c\xf4ng",detail:"M\xe3 \u0111\u1eb7t ch\u1ed7 \u0111\xe3 \u0111\u01b0\u1ee3c xu\u1ea5t v\xe9 th\xe0nh c\xf4ng!",sticky:!1}),this._router.navigate([r])):"DS-EH001"===v.objectError.errorCode?this.hanldeTimeoutIssue():this._toastService.add({severity:"error",summary:"Xu\u1ea5t v\xe9 th\u1ea5t b\u1ea1i",detail:v.objectError.errorDescription.vi?v.objectError.errorDescription.vi:v.objectError.errorDescription.en,sticky:!0,life:1e4})},error:v=>{v instanceof w.W?this.hanldeTimeoutIssue():this._toastService.add({severity:"error",summary:"C\xf3 l\u1ed7i x\u1ea3y ra",detail:"Xu\u1ea5t s\u1ed1 v\xe9 kh\xf4ng th\xe0nh c\xf4ng. Vui l\xf2ng th\u1eed l\u1ea1i ho\u1eb7c li\xean h\u1ec7 booker \u0111\u1ec3 \u0111\u01b0\u1ee3c h\u1ed7 tr\u1ee3!",sticky:!0,life:1e4})}}))})}else this._modal.open(S.EH,{priceChangeData:C}).afterClosed$.subscribe({next:d=>{d.data&&(this.isLoadingIssue=!0,this._manageBookingService.issueTicket(a).pipe((0,Z.x)(()=>this.isLoadingIssue=!1)).subscribe({next:v=>{v.success?(this._toastService.add({severity:"success",summary:"Xu\u1ea5t v\xe9 th\xe0nh c\xf4ng",detail:"M\xe3 \u0111\u1eb7t ch\u1ed7 \u0111\xe3 \u0111\u01b0\u1ee3c xu\u1ea5t v\xe9 th\xe0nh c\xf4ng!",sticky:!1}),this._router.navigate([r])):this._toastService.add({severity:"error",summary:"Xu\u1ea5t v\xe9 th\u1ea5t b\u1ea1i",detail:v.objectError.errorDescription.vi?v.objectError.errorDescription.vi:v.objectError.errorDescription.en,sticky:!0,life:1e4})}}))}})}else if("BE-EF045"===p.objectError.errorCode){const u={newPrice:p.objectError.errorData.newPriceTicket,oldPrice:p.objectError.errorData.oldPriceTicket,get priceGap(){return Math.abs(this.newPrice-this.oldPrice)},type:p.objectError.errorData.discountChange};if(this._mobileDetectService.isMobile()){const C=this._bottomSheetService.open(S.Gn,{headerTitle:"Th\xf4ng b\xe1o thay \u0111\u1ed5i chi\u1ebft kh\u1ea5u",rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4",data:{discountChangeData:u}});C.containerInstance._rightButtonClick.subscribe(()=>{C.dismiss()}),C.afterDismissed().subscribe({next:m=>{m&&(this.isLoadingIssue=!0,a.checkDiscountFee=!1,this._manageBookingService.issueTicket(a).pipe((0,Z.x)(()=>this.isLoadingIssue=!1)).subscribe({next:d=>{d.success?(this._toastService.add({severity:"success",summary:"Xu\u1ea5t v\xe9 th\xe0nh c\xf4ng",detail:"M\xe3 \u0111\u1eb7t ch\u1ed7 \u0111\xe3 \u0111\u01b0\u1ee3c xu\u1ea5t v\xe9 th\xe0nh c\xf4ng!",sticky:!1}),this._router.navigate([r])):"DS-EH001"===d.objectError.errorCode?this.hanldeTimeoutIssue():this._toastService.add({severity:"error",summary:"Xu\u1ea5t v\xe9 th\u1ea5t b\u1ea1i",detail:d.objectError.errorDescription.vi?d.objectError.errorDescription.vi:d.objectError.errorDescription.en,sticky:!0,life:1e4})},error:d=>{d instanceof w.W?this.hanldeTimeoutIssue():this._toastService.add({severity:"error",summary:"C\xf3 l\u1ed7i x\u1ea3y ra",detail:"Xu\u1ea5t s\u1ed1 v\xe9 kh\xf4ng th\xe0nh c\xf4ng. Vui l\xf2ng th\u1eed l\u1ea1i ho\u1eb7c li\xean h\u1ec7 booker \u0111\u1ec3 \u0111\u01b0\u1ee3c h\u1ed7 tr\u1ee3!",sticky:!0,life:1e4})}}))}})}else this._modal.open(S.Gn,{discountChangeData:u}).afterClosed$.subscribe({next:m=>{m.data&&(this.isLoadingIssue=!0,a.checkDiscountFee=!1,this._manageBookingService.issueTicket(a).pipe((0,Z.x)(()=>this.isLoadingIssue=!1)).subscribe({next:d=>{d.success?(this._toastService.add({severity:"success",summary:"Xu\u1ea5t v\xe9 th\xe0nh c\xf4ng",detail:"M\xe3 \u0111\u1eb7t ch\u1ed7 \u0111\xe3 \u0111\u01b0\u1ee3c xu\u1ea5t v\xe9 th\xe0nh c\xf4ng!",sticky:!1}),this._router.navigate([r])):"DS-EH001"===d.objectError.errorCode?this.hanldeTimeoutIssue():this._toastService.add({severity:"error",summary:"Xu\u1ea5t v\xe9 th\u1ea5t b\u1ea1i",detail:d.objectError.errorDescription.vi?d.objectError.errorDescription.vi:d.objectError.errorDescription.en,sticky:!0,life:1e4})},error:d=>{d instanceof w.W?this.hanldeTimeoutIssue():this._toastService.add({severity:"error",summary:"C\xf3 l\u1ed7i x\u1ea3y ra",detail:"Xu\u1ea5t s\u1ed1 v\xe9 kh\xf4ng th\xe0nh c\xf4ng. Vui l\xf2ng th\u1eed l\u1ea1i ho\u1eb7c li\xean h\u1ec7 booker \u0111\u1ec3 \u0111\u01b0\u1ee3c h\u1ed7 tr\u1ee3!",sticky:!0,life:1e4})}}))}})}else if("DS-EH001"===p.objectError.errorCode)this.hanldeTimeoutIssue();else{const u=(null===(T=p.objectError)||void 0===T?void 0:T.errorDescription.vi)||(null===(E=p.objectError)||void 0===E?void 0:E.errorDescription.en);this._toastService.add({severity:"error",summary:"Xu\u1ea5t v\xe9 th\u1ea5t b\u1ea1i",detail:u,sticky:!0,life:1e4})}},error:p=>{p instanceof w.W?this.hanldeTimeoutIssue():this._toastService.add({severity:"error",summary:"C\xf3 l\u1ed7i x\u1ea3y ra",detail:"Xu\u1ea5t s\u1ed1 v\xe9 kh\xf4ng th\xe0nh c\xf4ng. Vui l\xf2ng th\u1eed l\u1ea1i ho\u1eb7c li\xean h\u1ec7 booker \u0111\u1ec3 \u0111\u01b0\u1ee3c h\u1ed7 tr\u1ee3!",sticky:!0,life:1e4})}})};if(this._mobileDetectService.isMobile()){const c=this._bottomSheetService.open(y.V0,{headerTitle:"Kh\xf4ng th\u1ec3 ti\u1ebfp t\u1ee5c",rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4",data:{title:"",body:"C\u1ea7n b\u1ed5 sung \u0111\u1ea7y \u0111\u1ee7 th\xf4ng tin h\u1ed9 chi\u1ebfu c\u1ee7a h\xe0nh kh\xe1ch tr\u01b0\u1edbc khi xu\u1ea5t v\xe9",okText:"B\u1ed5 sung",cancelText:"\u0110\xf3ng",hasIcon:!0}});c.containerInstance._rightButtonClick.subscribe(()=>{c.dismiss()}),c.afterDismissed().subscribe({next:p=>{if(p){const T=[];this.bookingDetail.passengers.forEach((u,C)=>{var m,d,v,x,b;T.push({index:u.index,key:u.key||"",name:u.lastName+" "+u.firstName,parentKey:"N/A"==u.parentKey||null==u.parentKey?"":u.parentKey,type:u.type,child:"N/A",selected:0==C,gender:u.gender,firstName:u.firstName,lastName:u.lastName,dayOfBirth:u.birthday?u.birthday:"",parentName:"",fullType:u.type,issuanceDate:u.document&&(null===(m=u.document[0])||void 0===m?void 0:m.issuanceDate)||"",expiryDate:u.document&&(null===(d=u.document[0])||void 0===d?void 0:d.expiryDate)||"",issuanceCountry:u.document&&(null===(v=u.document[0])||void 0===v?void 0:v.issuanceCountry)||"",nationality:u.document&&(null===(x=u.document[0])||void 0===x?void 0:x.nationality)||"",number:u.document&&(null===(b=u.document[0])||void 0===b?void 0:b.number)||""})});const E=this._bottomSheetService.open(ee.vj,{headerTitle:"Ch\u1ec9nh s\u1eeda h\u1ed9 chi\u1ebfu",rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4",containerFullHeigh:!0,data:{listPaxUpdate:T}});E.containerInstance._rightButtonClick.subscribe(()=>{E.dismiss()}),E.afterDismissed().subscribe({next:u=>{u&&l(u)}})}}})}else this._modal.open(y.V0,{title:"Kh\xf4ng th\u1ec3 ti\u1ebfp t\u1ee5c",body:"C\u1ea7n b\u1ed5 sung \u0111\u1ea7y \u0111\u1ee7 th\xf4ng tin h\u1ed9 chi\u1ebfu c\u1ee7a h\xe0nh kh\xe1ch tr\u01b0\u1edbc khi xu\u1ea5t v\xe9",okText:"B\u1ed5 sung",cancelText:"\u0110\xf3ng"}).afterClosed$.subscribe({next:p=>{if(p.data){const T=[];this.bookingDetail.passengers.forEach((u,C)=>{var m,d,v,x,b;T.push({index:u.index,key:u.key||"",name:u.lastName+" "+u.firstName,parentKey:"N/A"==u.parentKey||null==u.parentKey?"":u.parentKey,type:u.type,child:"N/A",selected:0==C,gender:u.gender,firstName:u.firstName,lastName:u.lastName,dayOfBirth:u.birthday?u.birthday:"",parentName:"",fullType:u.type,issuanceDate:u.document&&(null===(m=u.document[0])||void 0===m?void 0:m.issuanceDate)||"",expiryDate:u.document&&(null===(d=u.document[0])||void 0===d?void 0:d.expiryDate)||"",issuanceCountry:u.document&&(null===(v=u.document[0])||void 0===v?void 0:v.issuanceCountry)||"",nationality:u.document&&(null===(x=u.document[0])||void 0===x?void 0:x.nationality)||"",number:u.document&&(null===(b=u.document[0])||void 0===b?void 0:b.number)||""})}),this._modal.open(ee.vj,{listPaxUpdate:T}).afterClosed$.subscribe({next:u=>{u.data&&l(u.data)}})}}})}else{const l=()=>{this.isLoadingIssue=!0,this._manageBookingService.issueTicket(a).pipe((0,Z.x)(()=>this.isLoadingIssue=!1)).subscribe({next:c=>{var p,T;if(c.success)this._toastService.add({severity:"success",summary:"Xu\u1ea5t v\xe9 th\xe0nh c\xf4ng",detail:"M\xe3 \u0111\u1eb7t ch\u1ed7 \u0111\xe3 \u0111\u01b0\u1ee3c xu\u1ea5t v\xe9 th\xe0nh c\xf4ng!",sticky:!1}),this._router.navigate([r]);else if("DS-EL005"===c.objectError.errorCode){const E=c.objectError.errorData.priceInfo.newPrice-c.objectError.errorData.priceInfo.oldPrice,u={newPrice:c.objectError.errorData.priceInfo.newPrice,oldPrice:c.objectError.errorData.priceInfo.oldPrice,priceGap:Math.abs(E),type:E>0?"+":"-"};if(this._mobileDetectService.isMobile()){const C=this._bottomSheetService.open(S.EH,{headerTitle:"Chi ph\xed thay \u0111\u1ed5i",containerFullHeigh:!0,rightButtonIcon:"",leftButtonIcon:"close",leftButtonIconClass:"text-neutral-gray-4",data:{priceChangeData:u}});C.containerInstance._leftButtonClick.subscribe(m=>C.dismiss()),C.afterDismissed().subscribe(m=>{m&&(this.isLoadingIssue=!0,this._manageBookingService.issueTicket(a).pipe((0,Z.x)(()=>this.isLoadingIssue=!1)).subscribe({next:d=>{d.success?(this._toastService.add({severity:"success",summary:"Xu\u1ea5t v\xe9 th\xe0nh c\xf4ng",detail:"M\xe3 \u0111\u1eb7t ch\u1ed7 \u0111\xe3 \u0111\u01b0\u1ee3c xu\u1ea5t v\xe9 th\xe0nh c\xf4ng!",sticky:!1}),this._router.navigate([r])):"DS-EH001"===d.objectError.errorCode?this.hanldeTimeoutIssue():this._toastService.add({severity:"error",summary:"Xu\u1ea5t v\xe9 th\u1ea5t b\u1ea1i",detail:d.objectError.errorDescription.vi?d.objectError.errorDescription.vi:d.objectError.errorDescription.en,sticky:!0,life:1e4})},error:d=>{d instanceof w.W?this.hanldeTimeoutIssue():this._toastService.add({severity:"error",summary:"C\xf3 l\u1ed7i x\u1ea3y ra",detail:"Xu\u1ea5t s\u1ed1 v\xe9 kh\xf4ng th\xe0nh c\xf4ng. Vui l\xf2ng th\u1eed l\u1ea1i ho\u1eb7c li\xean h\u1ec7 booker \u0111\u1ec3 \u0111\u01b0\u1ee3c h\u1ed7 tr\u1ee3!",sticky:!0,life:1e4})}}))})}else this._modal.open(S.EH,{priceChangeData:u}).afterClosed$.subscribe({next:m=>{m.data&&(this.isLoadingIssue=!0,this._manageBookingService.issueTicket(a).pipe((0,Z.x)(()=>this.isLoadingIssue=!1)).subscribe({next:d=>{d.success?(this._toastService.add({severity:"success",summary:"Xu\u1ea5t v\xe9 th\xe0nh c\xf4ng",detail:"M\xe3 \u0111\u1eb7t ch\u1ed7 \u0111\xe3 \u0111\u01b0\u1ee3c xu\u1ea5t v\xe9 th\xe0nh c\xf4ng!",sticky:!1}),this._router.navigate([r])):this._toastService.add({severity:"error",summary:"Xu\u1ea5t v\xe9 th\u1ea5t b\u1ea1i",detail:d.objectError.errorDescription.vi?d.objectError.errorDescription.vi:d.objectError.errorDescription.en,sticky:!0,life:1e4})}}))}})}else if("DS-EH001"===c.objectError.errorCode)this.hanldeTimeoutIssue();else if("BE-EF045"===c.objectError.errorCode){const E={newPrice:c.objectError.errorData.newPriceTicket,oldPrice:c.objectError.errorData.oldPriceTicket,get priceGap(){return Math.abs(this.newPrice-this.oldPrice)},type:c.objectError.errorData.discountChange};if(this._mobileDetectService.isMobile()){const u=this._bottomSheetService.open(S.Gn,{headerTitle:"Th\xf4ng b\xe1o thay \u0111\u1ed5i chi\u1ebft kh\u1ea5u",rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4",data:{discountChangeData:E}});u.containerInstance._rightButtonClick.subscribe(()=>{u.dismiss()}),u.afterDismissed().subscribe({next:C=>{C&&(this.isLoadingIssue=!0,a.checkDiscountFee=!1,this._manageBookingService.issueTicket(a).pipe((0,Z.x)(()=>this.isLoadingIssue=!1)).subscribe({next:m=>{m.success?(this._toastService.add({severity:"success",summary:"Xu\u1ea5t v\xe9 th\xe0nh c\xf4ng",detail:"M\xe3 \u0111\u1eb7t ch\u1ed7 \u0111\xe3 \u0111\u01b0\u1ee3c xu\u1ea5t v\xe9 th\xe0nh c\xf4ng!",sticky:!1}),this._router.navigate([r])):"DS-EH001"===m.objectError.errorCode?this.hanldeTimeoutIssue():this._toastService.add({severity:"error",summary:"Xu\u1ea5t v\xe9 th\u1ea5t b\u1ea1i",detail:m.objectError.errorDescription.vi?m.objectError.errorDescription.vi:m.objectError.errorDescription.en,sticky:!0,life:1e4})},error:m=>{m instanceof w.W?this.hanldeTimeoutIssue():this._toastService.add({severity:"error",summary:"C\xf3 l\u1ed7i x\u1ea3y ra",detail:"Xu\u1ea5t s\u1ed1 v\xe9 kh\xf4ng th\xe0nh c\xf4ng. Vui l\xf2ng th\u1eed l\u1ea1i ho\u1eb7c li\xean h\u1ec7 booker \u0111\u1ec3 \u0111\u01b0\u1ee3c h\u1ed7 tr\u1ee3!",sticky:!0,life:1e4})}}))}})}else this._modal.open(S.Gn,{discountChangeData:E}).afterClosed$.subscribe({next:C=>{C.data&&(this.isLoadingIssue=!0,a.checkDiscountFee=!1,this._manageBookingService.issueTicket(a).pipe((0,Z.x)(()=>this.isLoadingIssue=!1)).subscribe({next:m=>{m.success?(this._toastService.add({severity:"success",summary:"Xu\u1ea5t v\xe9 th\xe0nh c\xf4ng",detail:"M\xe3 \u0111\u1eb7t ch\u1ed7 \u0111\xe3 \u0111\u01b0\u1ee3c xu\u1ea5t v\xe9 th\xe0nh c\xf4ng!",sticky:!1}),this._router.navigate([r])):"DS-EH001"===m.objectError.errorCode?this.hanldeTimeoutIssue():this._toastService.add({severity:"error",summary:"Xu\u1ea5t v\xe9 th\u1ea5t b\u1ea1i",detail:m.objectError.errorDescription.vi?m.objectError.errorDescription.vi:m.objectError.errorDescription.en,sticky:!0,life:1e4})},error:m=>{m instanceof w.W?this.hanldeTimeoutIssue():this._toastService.add({severity:"error",summary:"C\xf3 l\u1ed7i x\u1ea3y ra",detail:"Xu\u1ea5t s\u1ed1 v\xe9 kh\xf4ng th\xe0nh c\xf4ng. Vui l\xf2ng th\u1eed l\u1ea1i ho\u1eb7c li\xean h\u1ec7 booker \u0111\u1ec3 \u0111\u01b0\u1ee3c h\u1ed7 tr\u1ee3!",sticky:!0,life:1e4})}}))}})}else{const E=(null===(p=c.objectError)||void 0===p?void 0:p.errorDescription.vi)||(null===(T=c.objectError)||void 0===T?void 0:T.errorDescription.en);this._toastService.add({severity:"error",summary:"Xu\u1ea5t v\xe9 th\u1ea5t b\u1ea1i",detail:E,sticky:!0,life:1e4})}},error:c=>{c instanceof w.W?this.hanldeTimeoutIssue():this._toastService.add({severity:"error",summary:"C\xf3 l\u1ed7i x\u1ea3y ra",detail:"Xu\u1ea5t s\u1ed1 v\xe9 kh\xf4ng th\xe0nh c\xf4ng. Vui l\xf2ng th\u1eed l\u1ea1i ho\u1eb7c li\xean h\u1ec7 booker \u0111\u1ec3 \u0111\u01b0\u1ee3c h\u1ed7 tr\u1ee3!",sticky:!0,life:1e4})}})};if(this._mobileDetectService.isMobile()){const c=this._bottomSheetService.open(y._3,{headerTitle:"X\xe1c nh\u1eadn xu\u1ea5t v\xe9",rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4",data:{issueDataConfirm:this.getIssueData()}});c.containerInstance._rightButtonClick.subscribe(()=>{c.dismiss()}),c.afterDismissed().subscribe(p=>{p&&l()})}else this._modal.open(y._3,{issueDataConfirm:this.getIssueData()}).afterClosed$.subscribe({next:p=>{p.data&&l()}})}}onGotoBooking(){const t=this._getCurrentUrl();window.open(t)}onSelectedAgent(t){this.agentSelected=t}_getCurrentUrl(){return`${window.location.origin}/admin/booking-detail/${this.airline}/${this.bookingCode}`}onMobileSearch(){this.tempMobileAirline&&this.searchForm.controls.airline.setValue(this.tempMobileAirline),this._bottomSheetService.dismiss(),this.onSearch()}openSearchBts(t){const i=this._bottomSheetService.open(t,{headerTitle:"T\xecm ki\u1ebfm",rightButtonIcon:"",leftButtonIcon:"close",containerFullHeigh:!0,leftButtonIconClass:"text-neutral-gray-4",restoreFocus:!1});i.containerInstance._leftButtonClick.subscribe(()=>i.dismiss())}openAirlineBts(t){const i=this._bottomSheetService.open(t,{headerTitle:"H\xe3ng bay",rightButtonIcon:"",leftButtonIcon:"close",leftButtonIconClass:"text-neutral-gray-4",restoreFocus:!1});i.containerInstance._leftButtonClick.subscribe(()=>i.dismiss())}openSupplierBts(t){if(this.isDisableSupplier)return;const i=this._bottomSheetService.open(t,{headerTitle:"Nh\xe0 cung c\u1ea5p",rightButtonIcon:"",leftButtonIcon:"close",leftButtonIconClass:"text-neutral-gray-4",restoreFocus:!1});i.containerInstance._leftButtonClick.subscribe(()=>i.dismiss())}mobileAirlineChange(t){this.tempMobileAirline=t}mobileSupplierChange(t){this.tempMobileSupplier=t}airlineOptionChange(){this.checkDisableSupplier(this.tempMobileAirline),this.searchForm.controls.airline.setValue(this.tempMobileAirline),this._bottomSheetService.dismiss(),this.onSearch()}supplierOptionChange(){this.searchForm.controls.supplier.setValue(this.tempMobileSupplier),this._bottomSheetService.dismiss(),this.onSearch()}checkDisableSupplier(t){this.isDisableSupplier="VN"!==t}hanldeTimeoutIssue(){this._mobileDetectService.isMobile()?(this.refTimoutBts=this._bottomSheetService.open(y.NK,{headerTitle:"",leftButtonIcon:"",rightButtonIcon:"close",rightButtonIconClass:"text-neutral-gray-4",containerFullHeigh:!1,data:{title:"\u0110ang x\u1eed l\xfd xu\u1ea5t v\xe9",body:"Qu\xfd \u0111\u1ea1i l\xfd vui l\xf2ng \u0111\u1ee3i trong gi\xe2y l\xe1t ho\u1eb7c ch\u1ee7 \u0111\u1ed9ng theo d\xf5i tr\u1ea1ng th\xe1i v\xe9 \u1edf m\u1ee5c Qu\u1ea3n l\xfd \u0111\u1eb7t ch\u1ed7",cancelText:"\u0110\xf3ng",okText:"M\u1edf qu\u1ea3n l\xfd \u0111\u1eb7t ch\u1ed7"}}),this.refTimoutBts.containerInstance._leftButtonClick.subscribe(t=>this.refTimoutBts.dismiss()),this.refTimoutBts.afterDismissed().subscribe({next:t=>{t&&this._route.navigate(["admin/manage-booking"])}})):(this.refTimoutModal=this._modal.open(y.NK,{title:"\u0110ang x\u1eed l\xfd xu\u1ea5t v\xe9",body:"Qu\xfd \u0111\u1ea1i l\xfd vui l\xf2ng \u0111\u1ee3i trong gi\xe2y l\xe1t ho\u1eb7c ch\u1ee7 \u0111\u1ed9ng theo d\xf5i tr\u1ea1ng th\xe1i v\xe9 \u1edf m\u1ee5c Qu\u1ea3n l\xfd \u0111\u1eb7t ch\u1ed7",cancelText:"\u0110\xf3ng",okText:"M\u1edf qu\u1ea3n l\xfd \u0111\u1eb7t ch\u1ed7"}),this.refTimoutModal.afterClosed$.subscribe({next:t=>{t.data&&this._route.navigate(["admin/manage-booking"])}}))}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(_.KNP),e.Y36(h.qu),e.Y36(J.F0),e.Y36(te.P3),e.Y36(H.fB),e.Y36(Q.oE),e.Y36(q.G),e.Y36(J.F0),e.Y36(W.KD),e.Y36($.t7),e.Y36(O.BX),e.Y36(N.a2),e.Y36(L.L),e.Y36(K.$A),e.Y36(fe.$))},o.\u0275cmp=e.Xpm({type:o,selectors:[["issue-booking-page"]],standalone:!0,features:[e.jDz],decls:38,vars:15,consts:[[1,"flex-auto","flex","flex-col","w-full"],[1,"bg-white","p-[30px]","w-full","shadow-sm","flex","flex-col","gap-y-[30px]","md:hidden"],[1,"text-heading-lg"],[1,"flex","gap-x-3","items-start","min-h-[60px]"],["textField","name","valueField","value","size","medium",1,"w-[200px]",3,"formControl","data","allowSearch","selectedChange"],["class","w-[180px]","textField","name","valueField","value","size","medium","placeholder","Ch\u1ecdn nh\xe0 cung c\u1ea5p",3,"formControl","data","allowSearch","ngClass",4,"ngIf"],[1,"flex-1",3,"status"],["cfHeadIcon","","icon","search","size","small"],["size","medium","cf-input","","placeholder","Nh\u1eadp booking code",3,"formControl"],["tableSearchInput",""],["cfHint","",3,"hint",4,"ngIf"],["cf-button","","size","medium","type","secondary",1,"!text-button-md",3,"disabled","click"],["icon","search","size","small",1,"mr-2.5"],[1,"hidden","md:flex","flex-col","py-3","px-4","gap-y-3","pr-0","bg-neutral-white"],[1,"text-heading-sm","text-neutral-gray-6"],[1,"flex","gap-x-3","overflow-x-auto"],[1,"gap-x-1.5","items-center","border","border-neutral-gray-3","rounded-full","px-4","py-[5px]","hidden","md:flex",3,"click"],[1,"text-body-md","whitespace-nowrap"],["icon","chevron_down","size","small",1,"text-neutral-gray-5"],["class","gap-x-1.5 items-center border border-neutral-gray-3 rounded-full px-4 py-[5px] hidden md:flex",3,"ngClass","click",4,"ngIf"],[1,"hidden","!w-full","md:pr-4","md:block"],["size","medium","cf-input","","placeholder","T\xecm ki\u1ebfm",3,"formControl","focus"],["airlineOptionMobile",""],["supplierOptionMobile",""],["searchBts",""],["class","flex-auto w-full max-h-[calc(100vh-152px)] py-4 px-[30px] md:p-0",4,"ngIf"],["class","flex-auto flex justify-center w-full max-h-[calc(100vh-152px)] py-4",4,"ngIf"],["class","flex-auto flex justify-center w-full max-h-[calc(100vh-152px)] py-4 px-[30px]",4,"ngIf"],[4,"ngIf"],["textField","name","valueField","value","size","medium","placeholder","Ch\u1ecdn nh\xe0 cung c\u1ea5p",1,"w-[180px]",3,"formControl","data","allowSearch","ngClass"],["cfHint","",3,"hint"],[1,"gap-x-1.5","items-center","border","border-neutral-gray-3","rounded-full","px-4","py-[5px]","hidden","md:flex",3,"ngClass","click"],[1,"flex","flex-col","justify-between","w-full"],[1,"p-4","pb-2"],[1,"flex","flex-col","gap-y-4",3,"ngModel","ngModelChange"],["size","medium",3,"value",4,"ngFor","ngForOf"],[1,"p-4"],["cf-button","",1,"justify-center","w-full",3,"click"],["size","medium",3,"value"],[1,"p-4","w-full","flex","flex-col","justify-between"],[1,"flex","flex-col","gap-y-4"],["size","medium","cf-input","","placeholder","T\xecm ki\u1ebfm",3,"formControl"],["textField","name","valueField","value","size","medium","placeholder","Ch\u1ecdn h\xe3ng bay",1,"w-full","max-w-none","mr-4",3,"ngModel","data","allowSearch","ngModelChange"],["cfLabel",""],["cf-button","",1,"w-full","justify-center","gap-x-2",3,"click"],["icon","search","size","small"],[1,"flex-auto","w-full","max-h-[calc(100vh-152px)]","py-4","px-[30px]","md:p-0"],[1,"bg-white","w-full","h-full","rounded-lg","md:bg-transparent"],[1,"h-[500px]","flex","flex-col","justify-center","items-center"],[1,"flex","flex-col","justify-center","items-center"],[1,"mb-8"],["src","assets/images/web-page.svg","alt",""],[1,"text-heading-md","text-neutral-black","mb-2"],[1,"text-espressive-md","text-neutral-gray-5","md:w-[257px]","md:text-center"],[1,"text-espressive-md"],["src","assets/images/empty-result.svg","alt",""],[1,"text-espressive-md","text-neutral-gray-5","text-center","md:w-[257px]"],[1,"text-espressive-md","text-neutral-gray-5","text-center"],[1,"flex-auto","flex","justify-center","w-full","max-h-[calc(100vh-152px)]","py-4"],[1,"w-fit",3,"optionAgent","isLoading","bookingDetail","priceDetail","hasDiscountFare","issueBooking","gotoBooking","selectedAgent"],[1,"flex-auto","flex","justify-center","w-full","max-h-[calc(100vh-152px)]","py-4","px-[30px]"],[1,"flex","flex-col","justify-center","items-center","w-full","h-full"],[1,"w-full"]],template:function(t,i){if(1&t){const n=e.EpF();e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._uU(3,"Xu\u1ea5t v\xe9"),e.qZA(),e.TgZ(4,"div",3)(5,"cf-select",4),e.NdJ("selectedChange",function(r){return i.onAirlineChange(r)}),e.qZA(),e.YNc(6,_e,1,6,"cf-select",5),e.TgZ(7,"cf-input-group",6),e._UZ(8,"cf-icon",7)(9,"input",8,9),e.YNc(11,ve,1,1,"cf-hint",10),e.qZA(),e.TgZ(12,"button",11),e.NdJ("click",function(){return i.onSearch()}),e._UZ(13,"cf-icon",12),e._uU(14," T\xecm ki\u1ebfm "),e.qZA()()(),e.TgZ(15,"div",13)(16,"div",14),e._uU(17,"Xu\u1ea5t v\xe9"),e.qZA(),e.TgZ(18,"div",15)(19,"div",16),e.NdJ("click",function(){e.CHM(n);const r=e.MAs(28);return e.KtG(i.openAirlineBts(r))}),e.TgZ(20,"div",17),e._uU(21,"Ch\u1ecdn h\xe3ng bay"),e.qZA(),e._UZ(22,"cf-icon",18),e.qZA(),e.YNc(23,xe,4,3,"div",19),e.qZA(),e.TgZ(24,"cf-input-group",20),e._UZ(25,"cf-icon",7),e.TgZ(26,"input",21),e.NdJ("focus",function(){e.CHM(n);const r=e.MAs(32);return e.KtG(i.openSearchBts(r))}),e.qZA()()(),e.YNc(27,Ce,7,2,"ng-template",null,22,e.W1O),e.YNc(29,ke,7,2,"ng-template",null,23,e.W1O),e.YNc(31,ye,13,4,"ng-template",null,24,e.W1O),e.YNc(33,Ee,13,0,"div",25),e.YNc(34,Ae,9,3,"div",25),e.YNc(35,Me,2,5,"div",26),e.YNc(36,Be,6,0,"div",27),e.qZA(),e.YNc(37,Ne,2,0,"div",28)}2&t&&(e.xp6(5),e.Q6J("formControl",i.searchForm.controls.airline)("data",i.airlineSelectOption)("allowSearch",!1),e.xp6(1),e.Q6J("ngIf",i.isShowSupplier),e.xp6(1),e.Q6J("status",i.searchForm.controls.searchText.invalid&&(i.searchForm.controls.searchText.dirty||i.searchForm.controls.searchText.touched)?"error":"default"),e.xp6(2),e.Q6J("formControl",i.searchForm.controls.searchText),e.xp6(2),e.Q6J("ngIf",(null==i.searchForm.controls.searchText.errors?null:i.searchForm.controls.searchText.errors.required)&&(i.searchForm.controls.searchText.dirty||i.searchForm.controls.searchText.touched)),e.xp6(1),e.Q6J("disabled",i.isLoading),e.xp6(11),e.Q6J("ngIf",i.isShowSupplier),e.xp6(3),e.Q6J("formControl",i.searchForm.controls.searchText),e.xp6(7),e.Q6J("ngIf",!i.isLoading&&"search_default"===i.stateMode),e.xp6(1),e.Q6J("ngIf",!i.isLoading&&("not_found"===i.stateMode||"cancelled"===i.stateMode||"issued"===i.stateMode)),e.xp6(1),e.Q6J("ngIf",!i.isLoading&&"has_value"===i.stateMode),e.xp6(1),e.Q6J("ngIf",i.isLoading),e.xp6(1),e.Q6J("ngIf",i.isLoadingIssue))},dependencies:[g.ez,g.mk,g.sg,g.O5,D.j$,D.ND,D.BN,_.AxE,_.Sm8,h.u5,h.Fj,h.JJ,h.On,h.UX,h.oH,j.q,A.N8,A.Xq,G.m,S.Wn,Y.IA,y.OR,I.o,I.T,N.DW],encapsulation:2}),o})();var Fe=f(27898),P=f(88516),we=f(4688),U=f(48373),z=f(77296);let Ue=(()=>{class o{transform(t,i){return t.length<i?t:t.slice(0,i)+"..."}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275pipe=e.Yjl({name:"truncateName",type:o,pure:!0,standalone:!0}),o})();var Pe=f(16039);function qe(o,s){1&o&&e._UZ(0,"cf-input-hint",70),2&o&&e.Q6J("hint","Th\u1eddi gian kh\xf4ng \u0111\u01b0\u1ee3c \u0111\u1ec3 tr\u1ed1ng")}function Oe(o,s){1&o&&(e.TgZ(0,"div",26),e._uU(1,"Th\u1eddi gian \u0111\u1eb7t"),e.qZA())}function Je(o,s){1&o&&(e.TgZ(0,"div",26),e._uU(1,"Th\u1eddi gian bay"),e.qZA())}function Qe(o,s){1&o&&(e.TgZ(0,"th",47),e._uU(1,"Provider"),e.qZA()),2&o&&e.Q6J("sortName","pnr")}function He(o,s){1&o&&(e.TgZ(0,"th",47),e._uU(1,"NCC"),e.qZA()),2&o&&e.Q6J("sortName","pnr")}function je(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"td",53)(1,"cf-input-group",51)(2,"input",52),e.NdJ("ngModelChange",function(n){e.CHM(t);const a=e.oxw();return e.KtG(a.filterData.provider=n)})("input",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.filterChange())}),e.qZA()()()}if(2&o){const t=e.oxw();e.Q6J("sticky","left"),e.xp6(2),e.Q6J("ngModel",t.filterData.provider)}}function Ye(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"td",53)(1,"cf-input-group",51)(2,"input",52),e.NdJ("ngModelChange",function(n){e.CHM(t);const a=e.oxw();return e.KtG(a.filterData.supplier=n)})("input",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.filterChange())}),e.qZA()()()}if(2&o){const t=e.oxw();e.Q6J("sticky","left"),e.xp6(2),e.Q6J("ngModel",t.filterData.supplier)}}function Ve(o,s){1&o&&e._UZ(0,"td",71),2&o&&e.Q6J("sticky","right")}function Le(o,s){if(1&o&&(e.TgZ(0,"td",75),e._uU(1),e.qZA()),2&o){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.provider||"-"," ")}}function Ke(o,s){if(1&o&&(e.TgZ(0,"td",75),e._uU(1),e.qZA()),2&o){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.supplier||"-"," ")}}function ze(o,s){if(1&o&&(e.TgZ(0,"td",75)(1,"div",77)(2,"div",85),e._uU(3),e.ALo(4,"date"),e.qZA(),e.TgZ(5,"div",85),e._uU(6),e.ALo(7,"date"),e.qZA()()()),2&o){const t=e.oxw().$implicit;e.xp6(3),e.hij(" ",e.xi3(4,2,1e3*t.departureTime,"dd/MM/yyyy HH:mm")," "),e.xp6(3),e.hij(" ",e.xi3(7,5,t.returnTime,"dd/MM/yyyy HH:mm")," ")}}function Ge(o,s){if(1&o&&(e.TgZ(0,"td",79),e._uU(1),e.ALo(2,"date"),e.qZA()),2&o){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.departureTime?e.xi3(2,1,1e3*t.departureTime,"dd/MM/yyyy HH:mm"):"-"," ")}}function $e(o,s){1&o&&(e.ynx(0),e.TgZ(1,"cf-label",86),e._UZ(2,"cf-icon",87),e._uU(3," \u0110\xe3 xu\u1ea5t v\xe9 "),e.qZA(),e.BQk()),2&o&&(e.xp6(1),e.Q6J("color","green"))}function Xe(o,s){1&o&&(e.ynx(0),e.TgZ(1,"cf-label",86),e._UZ(2,"cf-icon",87),e._uU(3," \u0110\xe3 gi\u1eef ch\u1ed7 "),e.qZA(),e.BQk()),2&o&&(e.xp6(1),e.Q6J("color","yellow"))}function Re(o,s){1&o&&(e.ynx(0),e.TgZ(1,"cf-label",88),e._UZ(2,"cf-icon",89),e._uU(3," \u0110\xe3 void "),e.qZA(),e.BQk()),2&o&&(e.xp6(1),e.Q6J("color","red"))}function We(o,s){1&o&&(e.ynx(0),e.TgZ(1,"cf-label",88),e._UZ(2,"cf-icon",89),e._uU(3," \u0110\xe3 h\u1ee7y "),e.qZA(),e.BQk()),2&o&&(e.xp6(1),e.Q6J("color","red"))}function et(o,s){1&o&&(e.ynx(0),e.TgZ(1,"cf-label",88),e._UZ(2,"cf-icon",89),e._uU(3," \u0110\u1eb7t ch\u1ed7 l\u1ed7i "),e.qZA(),e.BQk()),2&o&&(e.xp6(1),e.Q6J("color","red"))}function tt(o,s){1&o&&(e.ynx(0),e.TgZ(1,"cf-label",88),e._UZ(2,"cf-icon",89),e._uU(3," \u0110ang x\u1eed l\xfd "),e.qZA(),e.BQk()),2&o&&(e.xp6(1),e.Q6J("color","red"))}function it(o,s){1&o&&(e.ynx(0),e.TgZ(1,"cf-label",88),e._UZ(2,"cf-icon",89),e._uU(3," \u0110ang x\u1eed l\xfd xu\u1ea5t v\xe9 "),e.qZA(),e.BQk()),2&o&&(e.xp6(1),e.Q6J("color","red"))}function nt(o,s){if(1&o&&(e.ynx(0),e._uU(1),e.BQk()),2&o){const t=e.oxw().$implicit;e.xp6(1),e.Oqu(t.state)}}function ot(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"div",92),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(2).$implicit,a=e.oxw();return e.KtG(a.gotoBookingDetail(n.bookingCode,n.provider))}),e._uU(1,"Chi ti\u1ebft"),e.qZA()}}function at(o,s){if(1&o&&(e.TgZ(0,"td",90),e.YNc(1,ot,2,0,"div",91),e.qZA()),2&o){const t=e.oxw().$implicit;e.Q6J("sticky","right"),e.xp6(1),e.Q6J("ngIf",t.bookingCode)}}function rt(o,s){if(1&o&&(e.TgZ(0,"tr",72)(1,"td",73),e._UZ(2,"img",74),e.qZA(),e.TgZ(3,"td",75),e._uU(4),e.qZA(),e.YNc(5,Le,2,1,"td",76),e.YNc(6,Ke,2,1,"td",76),e.TgZ(7,"td",75)(8,"div",77),e._uU(9),e.ALo(10,"date"),e.qZA()(),e.YNc(11,ze,8,8,"td",76),e.YNc(12,Ge,3,4,"td",78),e.TgZ(13,"td",79),e._uU(14),e.ALo(15,"truncateName"),e.qZA(),e.TgZ(16,"td",75)(17,"div",80),e.YNc(18,$e,4,1,"ng-container",81),e.YNc(19,Xe,4,1,"ng-container",81),e.YNc(20,Re,4,1,"ng-container",81),e.YNc(21,We,4,1,"ng-container",81),e.YNc(22,et,4,1,"ng-container",81),e.YNc(23,tt,4,1,"ng-container",81),e.YNc(24,it,4,1,"ng-container",81),e.YNc(25,nt,2,1,"ng-container",82),e.qZA()(),e.TgZ(26,"td",79),e._uU(27),e.ALo(28,"date"),e.qZA(),e.TgZ(29,"td",75),e._uU(30),e.qZA(),e.TgZ(31,"td",75),e._uU(32),e.qZA(),e.TgZ(33,"td",83),e._uU(34),e.ALo(35,"number"),e.qZA(),e.YNc(36,at,2,2,"td",84),e.qZA()),2&o){const t=s.$implicit,i=e.oxw();e.xp6(2),e.Q6J("src",t.airlineLogo,e.LSH),e.xp6(2),e.hij(" ",t.bookingCode||"-"," "),e.xp6(1),e.Q6J("ngIf",i.isShowSupplier),e.xp6(1),e.Q6J("ngIf",i.isShowSupplier),e.xp6(3),e.hij(" ",e.xi3(10,21,t.bookedTime,"dd/MM/yyyy HH:mm")," "),e.xp6(2),e.Q6J("ngIf",t.returnTime),e.xp6(1),e.Q6J("ngIf",!t.returnTime),e.xp6(2),e.Oqu(e.xi3(15,24,t.passengerName,20)),e.xp6(3),e.Q6J("ngSwitch",t.state),e.xp6(1),e.Q6J("ngSwitchCase","ISSUED"),e.xp6(1),e.Q6J("ngSwitchCase","BOOKED"),e.xp6(1),e.Q6J("ngSwitchCase","VOID"),e.xp6(1),e.Q6J("ngSwitchCase","CANCEL"),e.xp6(1),e.Q6J("ngSwitchCase","ERROR"),e.xp6(1),e.Q6J("ngSwitchCase","IN_PROGRESS"),e.xp6(1),e.Q6J("ngSwitchCase","ISSUED_PENDING"),e.xp6(3),e.hij(" ",t.timeKeepHolding?e.xi3(28,27,1e3*t.timeKeepHolding,"dd/MM/yyyy HH:mm"):"-"," "),e.xp6(3),e.Oqu(t.userBooked||"-"),e.xp6(2),e.Oqu(t.agentName||"-"),e.xp6(2),e.hij("",e.lcZ(35,30,t.total)," \u0111"),e.xp6(2),e.Q6J("ngIf",i.viewAllFlightBookingDetail||i.viewOwnFlightBookingDetail)}}function st(o,s){1&o&&(e.ynx(0),e.TgZ(1,"div",107),e._UZ(2,"cf-icon",108),e.TgZ(3,"div",109),e._uU(4,"\u0110\xe3 xu\u1ea5t v\xe9"),e.qZA()(),e.BQk())}function lt(o,s){1&o&&(e.ynx(0),e.TgZ(1,"div",110),e._UZ(2,"cf-icon",111),e.TgZ(3,"div",112),e._uU(4,"\u0110ang gi\u1eef ch\u1ed7"),e.qZA()(),e.BQk())}function ct(o,s){1&o&&(e.ynx(0),e.TgZ(1,"div",113),e._UZ(2,"cf-icon",114),e.TgZ(3,"div",115),e._uU(4,"\u0110\xe3 void"),e.qZA()(),e.BQk())}function ut(o,s){1&o&&(e.ynx(0),e.TgZ(1,"div",116),e._UZ(2,"cf-icon",117),e.TgZ(3,"div",118),e._uU(4,"\u0110\xe3 h\u1ee7y"),e.qZA()(),e.BQk())}function gt(o,s){1&o&&(e.ynx(0),e.TgZ(1,"div",113),e._UZ(2,"cf-icon",119),e.TgZ(3,"div",120),e._uU(4,"\u0110ang x\u1eed l\xfd"),e.qZA()(),e.BQk())}function pt(o,s){if(1&o&&(e.ynx(0),e._uU(1),e.BQk()),2&o){const t=e.oxw(2).$implicit;e.xp6(1),e.Oqu(t.state)}}function dt(o,s){if(1&o&&(e.TgZ(0,"div",98)(1,"div",99),e._uU(2,"H\u1ea1n gi\u1eef ch\u1ed7"),e.qZA(),e.TgZ(3,"div",100),e._uU(4),e.ALo(5,"date"),e.qZA()()),2&o){const t=e.oxw(2).$implicit;e.xp6(4),e.hij("",e.xi3(5,1,1e3*t.timeKeepHolding,"dd/MM/yyyy HH:mm")," ")}}function ht(o,s){if(1&o&&(e.TgZ(0,"div",98)(1,"div",99),e._uU(2,"Provider"),e.qZA(),e.TgZ(3,"div",100),e._uU(4),e.qZA()()),2&o){const t=e.oxw(2).$implicit;e.xp6(4),e.Oqu(t.provider||"-")}}function mt(o,s){if(1&o&&(e.TgZ(0,"div",121)(1,"div",99),e._uU(2,"NCC"),e.qZA(),e.TgZ(3,"div",100),e._uU(4),e.qZA()()),2&o){const t=e.oxw(2).$implicit;e.xp6(4),e.Oqu(t.supplier||"-")}}function ft(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"div",94),e.NdJ("click",function(){e.CHM(t);const n=e.oxw().$implicit,a=e.oxw();return e.KtG(a.gotoBookingDetail(n.bookingCode,n.airline))}),e.TgZ(1,"div",95),e._UZ(2,"img",96),e.TgZ(3,"div",97),e.YNc(4,st,5,0,"ng-container",81),e.YNc(5,lt,5,0,"ng-container",81),e.YNc(6,ct,5,0,"ng-container",81),e.YNc(7,ut,5,0,"ng-container",81),e.YNc(8,gt,5,0,"ng-container",81),e.YNc(9,pt,2,1,"ng-container",82),e.qZA()(),e.TgZ(10,"div",98)(11,"div",99),e._uU(12,"H\xe0nh kh\xe1ch"),e.qZA(),e.TgZ(13,"div",100),e._uU(14),e.qZA()(),e.TgZ(15,"div",98)(16,"div",99),e._uU(17,"Ng\xe0y \u0111\u1eb7t"),e.qZA(),e.TgZ(18,"div",100),e._uU(19),e.ALo(20,"date"),e.qZA()(),e.YNc(21,dt,6,4,"div",101),e.YNc(22,ht,5,1,"div",101),e.YNc(23,mt,5,1,"div",102),e.TgZ(24,"div",103)(25,"div",104)(26,"div",105),e._uU(27,"M\xe3 v\xe9"),e.qZA(),e.TgZ(28,"div",106),e._uU(29),e.qZA()(),e.TgZ(30,"div",104)(31,"div",105),e._uU(32,"Ng\xe0y bay"),e.qZA(),e.TgZ(33,"div",106),e._uU(34),e.ALo(35,"date"),e.qZA()(),e.TgZ(36,"div",104)(37,"div",105),e._uU(38,"Ng\xe0y v\u1ec1"),e.qZA(),e.TgZ(39,"div",106),e._uU(40),e.ALo(41,"date"),e.qZA()()()()}if(2&o){const t=e.oxw().$implicit,i=e.oxw();e.xp6(2),e.s9C("src",t.airlineMobileLogo,e.LSH),e.xp6(1),e.Q6J("ngSwitch",t.state),e.xp6(1),e.Q6J("ngSwitchCase","ISSUED"),e.xp6(1),e.Q6J("ngSwitchCase","BOOKED"),e.xp6(1),e.Q6J("ngSwitchCase","VOID"),e.xp6(1),e.Q6J("ngSwitchCase","CANCEL"),e.xp6(1),e.Q6J("ngSwitchCase","IN_PROGRESS"),e.xp6(6),e.Oqu(t.passengerName),e.xp6(5),e.Oqu(e.xi3(20,15,t.bookedTime,"dd/MM/yyyy HH:mm")),e.xp6(2),e.Q6J("ngIf",t.timeKeepHolding>0),e.xp6(1),e.Q6J("ngIf",i.isShowSupplier),e.xp6(1),e.Q6J("ngIf",i.isShowSupplier),e.xp6(6),e.Oqu(t.bookingCode),e.xp6(5),e.Oqu(e.xi3(35,18,1e3*t.departureTime,"dd/MM/yyyy")),e.xp6(6),e.Oqu(e.xi3(41,21,t.returnTime,"dd/MM/yyyy"))}}function _t(o,s){if(1&o&&(e.ynx(0),e.YNc(1,ft,42,24,"div",93),e.BQk()),2&o){const t=s.index,i=e.oxw();e.xp6(1),e.Q6J("ngIf",t<i.ticketInfiniteScrollCount)}}function vt(o,s){1&o&&e._UZ(0,"cf-input-hint",70),2&o&&e.Q6J("hint","Th\u1eddi gian kh\xf4ng \u0111\u01b0\u1ee3c \u0111\u1ec3 tr\u1ed1ng")}function xt(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"div",122)(1,"div",123)(2,"cf-input-group",124),e._UZ(3,"cf-icon",19)(4,"input",125,21),e.qZA(),e.TgZ(6,"cf-select",126)(7,"label",127)(8,"span"),e._uU(9,"L\u1ecdc theo"),e.qZA()()(),e.TgZ(10,"cf-input-group",128),e._UZ(11,"cf-icon",9),e.TgZ(12,"label",127),e._uU(13,"Th\u1eddi gian"),e.qZA(),e.TgZ(14,"input",10),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(),a=e.MAs(146);return e.KtG(n.openTimeSelectBts(a))})("ngModelChange",function(n){e.CHM(t);const a=e.oxw();return e.KtG(a.dateRangeStr=n)}),e.qZA(),e.TgZ(15,"div",11),e.YNc(16,vt,1,1,"cf-input-hint",12),e.qZA()(),e.TgZ(17,"cf-select",126)(18,"label",127)(19,"span"),e._uU(20,"H\xe3ng bay"),e.qZA()()(),e.TgZ(21,"cf-select",126)(22,"label",127)(23,"span"),e._uU(24,"Tr\u1ea1ng th\xe1i"),e.qZA()()()(),e.TgZ(25,"div")(26,"button",129),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.search())}),e._UZ(27,"cf-icon",130),e.TgZ(28,"div"),e._uU(29,"T\xecm ki\u1ebfm"),e.qZA()()()()}if(2&o){const t=e.oxw();e.xp6(4),e.Q6J("formControl",t.searchForm.controls.searchText),e.xp6(2),e.Q6J("status","default")("data",t.timeSelectOption)("allowSearch",!1)("formControl",t.searchForm.controls.timeType),e.xp6(4),e.Q6J("status",t.invalidTimeFilter?"error":"default"),e.xp6(4),e.Q6J("ngModel",t.dateRangeStr),e.xp6(2),e.Q6J("ngIf",t.invalidTimeFilter),e.xp6(1),e.Q6J("status","default")("data",t.airlineSelectOption)("allowSearch",!1)("formControl",t.searchForm.controls.airline),e.xp6(4),e.Q6J("status","default")("data",t.stateBookingOption)("allowSearch",!1)("formControl",t.searchForm.controls.stateBooking)}}function Tt(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"div",131)(1,"div",132)(2,"div",133),e.NdJ("scrolled",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.scrollDown())})("scrolledUp",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.scrollUp())}),e.TgZ(3,"cf-datepicker-inline",134),e.NdJ("dateSelect",function(n){e.CHM(t);const a=e.oxw();return e.KtG(a.onMobileDateSelection(n,a.searchForm.controls.fromDate,a.searchForm.controls.toDate))}),e.qZA()()(),e.TgZ(4,"div",135)(5,"button",136),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.onMobileDatePickerOK())}),e._uU(6,"X\xe1c nh\u1eadn"),e.qZA()()()}if(2&o){const t=e.oxw();e.xp6(2),e.Q6J("infiniteScrollDistance",2)("infiniteScrollThrottle",300)("infiniteScrollUpDistance",2)("scrollWindow",!1)("fromRoot",!0)("alwaysCallback",!0)("infiniteScrollContainer",".ngb-dp-content"),e.xp6(1),e.Q6J("displayMonths",t.numOfMonth)("displayMonthsOffset",t.displayMonthsOffset)("rangeSelection",!0)("fromDate",t.searchForm.controls.fromDate.value)("startDate",t.startDate)("toDate",t.searchForm.controls.toDate.value)}}function Ct(o,s){if(1&o&&(e.TgZ(0,"div",147),e._uU(1),e.qZA()),2&o){const t=e.oxw().$implicit;e.xp6(1),e.AsE(" ",t.name," (",t.value,") ")}}function bt(o,s){if(1&o&&(e.TgZ(0,"div",147),e._uU(1),e.qZA()),2&o){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.name," ")}}function kt(o,s){if(1&o&&(e.TgZ(0,"cf-radio",143)(1,"div",144),e._UZ(2,"img",145),e.YNc(3,Ct,2,2,"div",146),e.YNc(4,bt,2,1,"div",146),e.qZA()()),2&o){const t=s.$implicit;e.Q6J("value",t.value),e.xp6(2),e.Q6J("src",t.logo,e.LSH),e.xp6(1),e.Q6J("ngIf",t.value),e.xp6(1),e.Q6J("ngIf",!t.value)}}function yt(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"div",137)(1,"div",123)(2,"div",138)(3,"cf-radio-group",139),e.YNc(4,kt,5,4,"cf-radio",140),e.qZA()(),e.TgZ(5,"div",141)(6,"button",142),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.search())}),e._uU(7,"X\xe1c nh\u1eadn"),e.qZA()()()()}if(2&o){const t=e.oxw();e.xp6(3),e.Q6J("formControl",t.searchForm.controls.airline),e.xp6(1),e.Q6J("ngForOf",t.airlineSelectOption)}}function Et(o,s){if(1&o&&(e.TgZ(0,"cf-radio",143),e._uU(1),e.qZA()),2&o){const t=s.$implicit;e.Q6J("value",t.value),e.xp6(1),e.hij(" ",t.name," ")}}function Dt(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"div",137)(1,"div",123)(2,"div",138)(3,"cf-radio-group",139),e.YNc(4,Et,2,2,"cf-radio",140),e.qZA()(),e.TgZ(5,"div",141)(6,"button",142),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.search())}),e._uU(7,"X\xe1c nh\u1eadn"),e.qZA()()()()}if(2&o){const t=e.oxw();e.xp6(3),e.Q6J("formControl",t.searchForm.controls.timeType),e.xp6(1),e.Q6J("ngForOf",t.timeSelectOption)}}function Zt(o,s){if(1&o&&(e.TgZ(0,"cf-radio",143),e._uU(1),e.qZA()),2&o){const t=s.$implicit;e.Q6J("value",t.value),e.xp6(1),e.hij(" ",t.name," ")}}function St(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"div",137)(1,"div",123)(2,"div",138)(3,"cf-radio-group",139),e.YNc(4,Zt,2,2,"cf-radio",140),e.qZA()(),e.TgZ(5,"div",141)(6,"button",142),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.search())}),e._uU(7,"X\xe1c nh\u1eadn"),e.qZA()()()()}if(2&o){const t=e.oxw();e.xp6(3),e.Q6J("formControl",t.searchForm.controls.stateBooking),e.xp6(1),e.Q6J("ngForOf",t.stateBookingOption)}}function At(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"div",122)(1,"div",123)(2,"cf-input-group",124)(3,"label",127)(4,"span"),e._uU(5,"H\xe3ng bay"),e.qZA()(),e.TgZ(6,"input",148),e.NdJ("ngModelChange",function(n){e.CHM(t);const a=e.oxw();return e.KtG(a.tempFilterData.airline=n)}),e.qZA()(),e.TgZ(7,"cf-input-group",124)(8,"label",127)(9,"span"),e._uU(10,"PNR"),e.qZA()(),e.TgZ(11,"input",148),e.NdJ("ngModelChange",function(n){e.CHM(t);const a=e.oxw();return e.KtG(a.tempFilterData.pnr=n)}),e.qZA()(),e.TgZ(12,"cf-input-group",124)(13,"label",127)(14,"span"),e._uU(15,"Ng\xe0y bay"),e.qZA()(),e.TgZ(16,"input",148),e.NdJ("ngModelChange",function(n){e.CHM(t);const a=e.oxw();return e.KtG(a.tempFilterData.departDate=n)}),e.qZA()(),e.TgZ(17,"cf-input-group",124)(18,"label",127)(19,"span"),e._uU(20,"H\xe0nh kh\xe1ch"),e.qZA()(),e.TgZ(21,"input",148),e.NdJ("ngModelChange",function(n){e.CHM(t);const a=e.oxw();return e.KtG(a.tempFilterData.passenger=n)}),e.qZA()(),e.TgZ(22,"cf-input-group",124)(23,"label",127)(24,"span"),e._uU(25,"Tr\u1ea1ng th\xe1i"),e.qZA()(),e.TgZ(26,"input",148),e.NdJ("ngModelChange",function(n){e.CHM(t);const a=e.oxw();return e.KtG(a.tempFilterData.state=n)}),e.qZA()(),e.TgZ(27,"cf-input-group",124)(28,"label",127)(29,"span"),e._uU(30,"T\u1ed5ng gi\xe1"),e.qZA()(),e.TgZ(31,"input",148),e.NdJ("ngModelChange",function(n){e.CHM(t);const a=e.oxw();return e.KtG(a.tempFilterData.totalPrice=n)}),e.qZA()()(),e.TgZ(32,"div")(33,"button",129),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.mobileFilterOk())}),e._UZ(34,"cf-icon",130),e.TgZ(35,"div"),e._uU(36,"T\xecm ki\u1ebfm"),e.qZA()()()()}if(2&o){const t=e.oxw();e.xp6(6),e.Q6J("ngModel",t.filterData.airline),e.xp6(5),e.Q6J("ngModel",t.filterData.pnr),e.xp6(5),e.Q6J("ngModel",t.filterData.departDate),e.xp6(5),e.Q6J("ngModel",t.filterData.passenger),e.xp6(5),e.Q6J("ngModel",t.filterData.state),e.xp6(5),e.Q6J("ngModel",t.filterData.totalPrice)}}function Mt(o,s){1&o&&e._UZ(0,"cf-spinner")}const Bt=function(){return{num:25}},Nt=function(){return{num:50}},It=function(){return{num:75}},Ft=function(){return{num:100}},wt=function(o,s,t,i){return[o,s,t,i]};let Ut=(()=>{class o{constructor(t,i,n,a,r,l,c,p,T){this._bookingManageService=n,this._excelService=a,this._flightDataService=r,this._route=l,this._bottomSheetService=c,this._mobileDetectService=p,this._permissionService=T,this.timeSelectOption=[],this.airlineSelectOption=[],this.stateBookingOption=[],this.pageSize=25,this.currentPage=1,this.listOfData=[],this.dataSource=[],this.TICKET_INFINITE_SCROLL_DEFAULT=10,this.TICKET_INFINITE_OFSET_INCREASE=10,this.ticketInfiniteScrollCount=this.TICKET_INFINITE_SCROLL_DEFAULT,this.dateRangeStr="",this.isLoading=!1,this.invalidTimeFilter=!1,this.filterData={airline:"",pnr:"",provider:"",supplier:"",bookedDate:"",departDate:"",passenger:"",state:"",timeKeepHolding:"",user:"",agentName:"",totalPrice:""},this.tempFilterData={airline:"",provider:"",pnr:"",supplier:"",bookedDate:"",departDate:"",passenger:"",state:"",timeKeepHolding:"",user:"",agentName:"",totalPrice:""},this.numberOfDateFilter=6,this.viewAllFlightBookingDetail=this._permissionService.hasPermission(K.or.ViewAllFlightBookingDetail),this.viewOwnFlightBookingDetail=this._permissionService.hasPermission(K.or.ViewOwnFlightBookingDetail),this.isShowSupplier=this._permissionService.isAgent1()||this._permissionService.isBooker(),this.sortChange=(x,b)=>{let k=b.map(F=>F);for(let F=0;F<x.length;F++){const M=x[F];switch(M.key){case"airline":k=this.airlineSort(k,M);break;case"pnr":k=this.pnrSort(k,M);break;case"bookedDate":k=this.bookedTimeSort(k,M);break;case"departDate":k=this.deaprtDateSort(k,M);break;case"passenger":k=this.passengerSort(k,M);break;case"state":k=this.stateSort(k,M);break;case"user":k=this.userSort(k,M);break;case"totalPrice":k=this.totalPriceSort(k,M);break;case"timeKeepHolding":k=this.timeKeepHoldingSort(k,M);break;case"agentName":k=this.agentNameSort(k,M)}}return this.reloadScroll(),k},this.searchChange=(x,b)=>x?(this.reloadScroll(),b.filter(k=>{const F=this.removeAccents(k.passengerName.toLowerCase()),M=this.removeAccents(k.bookingCode.toLowerCase());return F.includes(x.toLocaleLowerCase())||M.includes(x.toLocaleLowerCase())})):b,this.increaseAlphabetSort=(x,b)=>x<b?-1:x>b?1:0,this.decreaseAlphabetSort=(x,b)=>x>b?-1:x<b?1:0,this.increaseNumberSort=(x,b)=>x-b,this.decreaseNumberSort=(x,b)=>b-x,this.increaseDateSort=(x,b)=>x.getTime()-b.getTime(),this.decreaseDateSort=(x,b)=>b.getTime()-x.getTime(),this.DEFAULT_NUM_OF_MONTH=4,this.INCREASE_OFFSET=4,this.numOfMonth=this.DEFAULT_NUM_OF_MONTH,this.displayMonthsOffset=0,t.registerIcons([_.wvd,_.esH,_.n78,_.PlV,_.iYu,_.LdZ,_.D7,_.xbi,_.fXw,_.poJ,_.iK7]);const E=sessionStorage.getItem("manageBookingFilter"),u=JSON.parse(E||"{}"),C=new Date;C.setDate(C.getDate()-this.numberOfDateFilter);const m=new Date,d=(0,g.p6)(C,"dd/MM/yyyy","vi-VN"),v=(0,g.p6)(m,"dd/MM/yyyy","vi-VN");this.dateRangeStr=d+" - "+v,this.searchForm=i.group({timeType:[u.timeType||"BOOKED_TIME",h.kI.required],fromDate:[C,h.kI.required],toDate:[m,h.kI.required],airline:[u.airline||""],searchText:[u.searchText||""],stateBooking:[u.stateBooking||""]}),this.search()}ngOnInit(){this.timeSelectOption=[{name:"Th\u1eddi gian \u0111\u1eb7t ch\u1ed7",value:"BOOKED_TIME"},{name:"Th\u1eddi gian bay",value:"DEPART_TIME"}],this.airlineSelectOption=[{name:"T\u1ea5t c\u1ea3 h\xe3ng bay",value:"",logo:this._flightDataService.getAirlineLogoByCode("")},{name:"Vietnam Airlines",value:"VN",logo:this._flightDataService.getAirlineLogoByCode("VN")},{name:"Bamboo Airways",value:"QH",logo:this._flightDataService.getAirlineLogoByCode("QH")},{name:"Vietjet Air",value:"VJ",logo:this._flightDataService.getAirlineLogoByCode("VJ")},{name:"Vietravel Airlines",value:"VU",logo:this._flightDataService.getAirlineLogoByCode("VU")},{name:"Sun Phu Quoc Airways",value:"9G",logo:this._flightDataService.getAirlineLogoByCode("9G")}],this.stateBookingOption=[{name:"T\u1ea5t c\u1ea3 tr\u1ea1ng th\xe1i",value:""},{name:"\u0110\xe3 gi\u1eef ch\u1ed7",value:"BOOKED"},{name:"\u0110\xe3 xu\u1ea5t v\xe9",value:"ISSUED"},{name:"\u0110\xe3 h\u1ee7y",value:"CANCEL"},{name:"\u0110\xe3 void",value:"REFUND"},{name:"\u0110ang x\u1eed l\xed",value:"IN_PROGRESS"},{name:"\u0110\u1eb7t ch\u1ed7 l\u1ed7i",value:"INVALID"}]}fromDateChange(t){t&&(this.minToDate=new P.Ao(t.getFullYear(),t.getMonth()+1,t.getDate()))}resetRangeDate(t,i){t.setValue(""),i.setValue("")}onDateSelection(t,i,n,a){if(i.value||n.value)if(i.value&&!n.value&&t&&t.getTime()>=i.value.getTime()){n.setValue(t),a.close(),this.startDate=i.value;const r=(0,g.p6)(t,"dd/MM/yyyy","vi-VN");this.dateRangeStr+=r}else{n.setValue(null),i.setValue(t);const r=(0,g.p6)(t,"dd/MM/yyyy","vi-VN");this.dateRangeStr=r+" - "}else{i.setValue(t),n.setValue(null);const r=(0,g.p6)(t,"dd/MM/yyyy","vi-VN");this.dateRangeStr=r+" - "}this.invalidTimeFilter=i.invalid||n.invalid}search(){if(this._mobileDetectService.isMobile()&&this.btsSearchMobile&&this.btsSearchMobile.dismiss(),this.searchForm.valid){const t={airline:this.searchForm.controls.airline.value,bookedTime:"BOOKED_TIME"===this.searchForm.controls.timeType.value?1:0,bookingCodeOrPassName:this.searchForm.controls.searchText.value.trim().toUpperCase(),fromDateTime:(0,g.p6)(this.searchForm.controls.fromDate.value,"yyyy-MM-dd","vi-VN"),toDateTime:(0,g.p6)(this.searchForm.controls.toDate.value,"yyyy-MM-dd","vi-VN"),state:this.searchForm.controls.stateBooking.value};this.isLoading=!0,this._bookingManageService.getBookingTicket(t).pipe((0,Z.x)(()=>this.isLoading=!1)).subscribe({next:i=>{this.dataSource=i.data.sort((n,a)=>a.bookedTime-n.bookedTime).map(n=>({airline:n.airline||"",airlineName:n.airlineName||"",airlineLogo:this._flightDataService.getAirlineLogoByCode(n.airline)||"",airlineMobileLogo:this._flightDataService.getSmallAirlineLogoByCode(n.airline)||"",bookingCode:n.bookingCode||"",provider:n.provider||"",supplier:n.supplier||"",passengerName:n.passengerName||"",state:n.state||"",bookedTime:new Date(1e3*n.bookedTime),departureTime:n.departureTime||0,returnTime:n.returnTime?new Date(1e3*n.returnTime):void 0,userBooked:n.userBooked||"",total:n.total||0,timeKeepHolding:n.timeKeepHolding||0,agentName:n.agentName||""})),this.listOfData=this.dataSource.map(n=>n),this.reloadScroll()}}),sessionStorage.setItem("manageBookingFilter",JSON.stringify(this.searchForm.value))}this.searchForm.markAllAsTouched()}reloadScroll(){this.ticketInfiniteScrollCount=this.TICKET_INFINITE_SCROLL_DEFAULT}removeAccents(t){return t?t.normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/\u0111/g,"d").replace(/\u0110/g,"D"):""}airlineSort(t,i){return t.sort("ascend"===i.sort?(n,a)=>this.increaseAlphabetSort(n.airline,a.airline):(n,a)=>this.decreaseAlphabetSort(n.airline,a.airline))}pnrSort(t,i){return t.sort("ascend"===i.sort?(n,a)=>this.increaseAlphabetSort(n.bookingCode,a.bookingCode):(n,a)=>this.decreaseAlphabetSort(n.bookingCode,a.bookingCode))}bookedTimeSort(t,i){return t.sort("ascend"===i.sort?(n,a)=>this.increaseDateSort(n.bookedTime,a.bookedTime):(n,a)=>this.decreaseDateSort(n.bookedTime,a.bookedTime))}deaprtDateSort(t,i){return t.sort("ascend"===i.sort?(n,a)=>n.departureTime-a.departureTime:(n,a)=>a.departureTime-n.departureTime)}passengerSort(t,i){return t.sort("ascend"===i.sort?(n,a)=>this.increaseAlphabetSort(n.passengerName,a.passengerName):(n,a)=>this.decreaseAlphabetSort(n.passengerName,a.passengerName))}stateSort(t,i){return t.sort("ascend"===i.sort?(n,a)=>this.increaseAlphabetSort(n.state,a.state):(n,a)=>this.decreaseAlphabetSort(n.state,a.state))}userSort(t,i){return t.sort("ascend"===i.sort?(n,a)=>this.increaseAlphabetSort(n.userBooked,a.userBooked):(n,a)=>this.decreaseAlphabetSort(n.userBooked,a.userBooked))}totalPriceSort(t,i){return t.sort("ascend"===i.sort?(n,a)=>this.increaseNumberSort(n.total,a.total):(n,a)=>this.decreaseNumberSort(n.total,a.total))}timeKeepHoldingSort(t,i){return t.sort("ascend"===i.sort?(n,a)=>this.increaseNumberSort(n.timeKeepHolding,a.timeKeepHolding):(n,a)=>this.decreaseNumberSort(n.timeKeepHolding,a.timeKeepHolding))}agentNameSort(t,i){return t.sort("ascend"===i.sort?(n,a)=>this.increaseAlphabetSort(n.agentName,a.agentName):(n,a)=>this.decreaseAlphabetSort(n.agentName,a.agentName))}checkChange(t){this.pageSize=parseInt(t)}exportExcel(t){const i="ve_"+(0,g.p6)(new Date,"yyyy-MM-dd","vi-VN");this._excelService.exportToExcel(t.map(n=>({airline:n.airline,bookingCode:n.bookingCode,provider:n.provider,supplier:n.supplier,bookedTime:(0,g.p6)(n.bookedTime,"dd/MM/yyyy HH:mm","vi-VN"),departureTime:n.returnTime?(0,g.p6)(1e3*n.departureTime,"dd/MM/yyyy HH:mm","vi-VN")+" - "+(0,g.p6)(n.returnTime,"dd/MM/yyyy HH:mm","vi-VN"):(0,g.p6)(1e3*n.departureTime,"dd/MM/yyyy HH:mm","vi-VN"),passengerName:n.passengerName,state:n.state,userBooked:n.userBooked,total:n.total})),["H\xe3ng bay","PNR","Provider","NCC","Ng\xe0y \u0111\u1eb7t","Ng\xe0y bay","H\xe0nh kh\xe1ch","Tr\u1ea1ng th\xe1i","Ng\u01b0\u1eddi \u0111\u1eb7t","T\u1ed5ng gi\xe1"],i,[{wch:10},{wch:10},{wch:20},{wch:25},{wch:25},{wch:10},{wch:20},{wch:20}])}gotoBookingDetail(t,i){(this.viewAllFlightBookingDetail||this.viewOwnFlightBookingDetail)&&this._route.navigate([`admin/booking-detail/${i}/${t}`])}ticketTrackByFn(t,i){return i.bookingCode}onScrollDown(){this.ticketInfiniteScrollCount+=this.TICKET_INFINITE_OFSET_INCREASE}mobileFilterOk(){this.filterData={airline:this.tempFilterData.airline,pnr:this.tempFilterData.pnr,provider:this.tempFilterData.provider,supplier:this.tempFilterData.supplier,bookedDate:this.tempFilterData.bookedDate,departDate:this.tempFilterData.departDate,passenger:this.tempFilterData.passenger,state:this.tempFilterData.state,timeKeepHolding:this.tempFilterData.timeKeepHolding,user:this.tempFilterData.user,agentName:this.tempFilterData.agentName,totalPrice:this.tempFilterData.totalPrice},this.filterChange(),this._bottomSheetService.dismiss()}filterChange(){this.listOfData=this.dataSource.filter(t=>{const i=this.removeAccents(this.filterData.airline.toLowerCase()),n=this.removeAccents(t.airline.toLowerCase()),a=this.removeAccents(t.provider.toLowerCase());if("gds".includes(i)){if(!a.includes(i))return!1}else if(!n.includes(i))return!1;const r=this.removeAccents(this.filterData.pnr.toLowerCase());if(!this.removeAccents(t.bookingCode.toLowerCase()).includes(r))return!1;const c=this.removeAccents(this.filterData.bookedDate.toLowerCase());if(!this.removeAccents((0,g.p6)(t.bookedTime,"dd/MM/yyyy HH:mm","vi-VN")).includes(c))return!1;const T=this.removeAccents(this.filterData.departDate.toLowerCase());if(!`${this.removeAccents((0,g.p6)(new Date(1e3*t.departureTime),"dd/MM/yyyy HH:mm","vi-VN"))} ${t.returnTime?this.removeAccents((0,g.p6)(t.returnTime,"dd/MM/yyyy HH:mm","vi-VN")):""}`.includes(T))return!1;const C=this.removeAccents(this.filterData.passenger.toLowerCase());if(!this.removeAccents(t.passengerName.toLowerCase()).includes(C))return!1;let d="";switch(t.state){case"ISSUED":d="\u0110\xe3 xu\u1ea5t v\xe9";break;case"BOOKED":d="\u0110\xe3 gi\u1eef ch\u1ed7";break;case"VOID":d="\u0110\xe3 void";break;case"CANCEL":d="\u0110\xe3 h\u1ee7y";break;case"ERROR":d="\u0110\u1eb7t ch\u1ed7 l\u1ed7i";break;case"IN_PROGRESS":d="\u0110ang x\u1eed l\xfd"}const v=this.removeAccents(this.filterData.state.toLowerCase());if(!this.removeAccents(d.toLowerCase()).includes(v))return!1;const b=this.removeAccents(this.filterData.timeKeepHolding.toLowerCase());if(!this.removeAccents((0,g.p6)(new Date(1e3*t.timeKeepHolding),"dd/MM/yyyy HH:mm","vi-VN")).includes(b))return!1;const F=this.removeAccents(this.filterData.user.toLowerCase());if(!this.removeAccents(t.userBooked.toLowerCase()).includes(F))return!1;const wi=this.removeAccents(this.filterData.agentName.toLowerCase());if(!this.removeAccents(t.agentName.toLowerCase()).includes(wi))return!1;const Ui=this.removeAccents(this.filterData.totalPrice.toLowerCase());return!!this.removeAccents(t.total.toString().toLowerCase()).includes(Ui)})}openSearchBts(t){this.btsSearchMobile=this._bottomSheetService.open(t,{headerTitle:"Danh s\xe1ch \u0111\u1eb7t ch\u1ed7",containerFullHeigh:!0,rightButtonIcon:"",leftButtonIcon:"close",leftButtonIconClass:"text-neutral-gray-4",restoreFocus:!1}),this.btsSearchMobile.containerInstance._leftButtonClick.subscribe(()=>this.btsSearchMobile.dismiss())}openFilterBts(t){this.tempFilterData={airline:"",pnr:"",provider:"",supplier:"",bookedDate:"",departDate:"",passenger:"",state:"",timeKeepHolding:"",user:"",agentName:"",totalPrice:""};const i=this._bottomSheetService.open(t,{headerTitle:"B\u1ed9 l\u1ecdc",containerFullHeigh:!0,rightButtonIcon:"",leftButtonIcon:"close",leftButtonIconClass:"text-neutral-gray-4",restoreFocus:!1});i.containerInstance._leftButtonClick.subscribe(()=>i.dismiss())}openAirlineBts(t){this.btsSearchMobile=this._bottomSheetService.open(t,{headerTitle:"H\xe3ng bay",rightButtonIcon:"close",leftButtonIcon:"",rightButtonIconClass:"text-neutral-gray-4",restoreFocus:!1}),this.btsSearchMobile.containerInstance._rightButtonClick.subscribe(()=>this.btsSearchMobile.dismiss())}openTimeTypeBts(t){this.btsSearchMobile=this._bottomSheetService.open(t,{headerTitle:"Lo\u1ea1i th\u1eddi gian",rightButtonIcon:"close",leftButtonIcon:"",rightButtonIconClass:"text-neutral-gray-4",restoreFocus:!1}),this.btsSearchMobile.containerInstance._rightButtonClick.subscribe(()=>this.btsSearchMobile.dismiss())}openStatusBts(t){this.btsSearchMobile=this._bottomSheetService.open(t,{headerTitle:"Tr\u1ea1ng th\xe1i",rightButtonIcon:"close",leftButtonIcon:"",rightButtonIconClass:"text-neutral-gray-4",restoreFocus:!1}),this.btsSearchMobile.containerInstance._rightButtonClick.subscribe(()=>this.btsSearchMobile.dismiss())}openTimeSelectBts(t,i=""){if(this._mobileDetectService.mobileSubject.value){const n=this._bottomSheetService.open(t,{headerTitle:"T\xf9y ch\u1ec9nh th\u1eddi gian",leftButtonIcon:"close",leftButtonIconClass:"text-neutral-gray-4",rightButtonIcon:"",containerFullHeigh:!0,restoreFocus:!1});n.afterDismissed().subscribe(a=>{this.displayMonthsOffset=0,this.numOfMonth=0,"TIME_ONLY"===i&&this.search()}),n.containerInstance._leftButtonClick.subscribe(a=>{n.dismiss()}),setTimeout(()=>{this.displayMonthsOffset=this.DEFAULT_NUM_OF_MONTH})}}scrollDown(){this.numOfMonth=this.numOfMonth+this.INCREASE_OFFSET}scrollUp(){this.displayMonthsOffset=this.displayMonthsOffset+this.INCREASE_OFFSET}onMobileDateSelection(t,i,n){if(i.value||n.value)if(i.value&&!n.value&&t&&t.getTime()>=i.value.getTime()){n.setValue(t),this.startDate=i.value;const a=(0,g.p6)(t,"dd/MM/yyyy","vi-VN");this.dateRangeStr+=a}else if(i.value&&n.value&&t&&t.getTime()>n.value.getTime()){n.setValue(null),i.setValue(t);const a=(0,g.p6)(t,"dd/MM/yyyy","vi-VN");this.dateRangeStr=a+" - "}else if(i.value&&n.value&&t&&t.getTime()<n.value.getTime()){i.setValue(t);const a=(0,g.p6)(t,"dd/MM/yyyy","vi-VN"),r=(0,g.p6)(n.value,"dd/MM/yyyy","vi-VN");this.dateRangeStr=a+" - "+r}else{i.setValue(t);const a=(0,g.p6)(t,"dd/MM/yyyy","vi-VN");this.dateRangeStr=a+" - "}else{i.setValue(t);const a=(0,g.p6)(t,"dd/MM/yyyy","vi-VN");this.dateRangeStr=a+" - "}}onMobileDatePickerOK(){this._bottomSheetService.dismiss()}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(_.KNP),e.Y36(h.qu),e.Y36(H.fB),e.Y36(Pe.x),e.Y36(q.G),e.Y36(J.F0),e.Y36(N.a2),e.Y36(L.L),e.Y36(K.$A))},o.\u0275cmp=e.Xpm({type:o,selectors:[["manage-booking-page"]],standalone:!0,features:[e.jDz],decls:156,vars:85,consts:[[1,"flex","flex-col","py-4","px-[30px]","bg-white","w-full","md:py-3","md:pl-4","md:pr-0"],[1,"text-heading-sm","text-neutral-gray-6","mb-3","hidden","md:block"],[1,"flex","gap-x-[17px]","md:flex-col"],[1,"flex","flex-col","grow","gap-y-4"],[1,"flex","w-full","justify-between","items-end","md:hidden"],["size","medium","textField","name","valueField","value",1,"grow-[180]","mr-4",3,"formControl","data","allowSearch"],["cfLabel",""],[1,"flex","mr-2"],[1,"grow",3,"status"],["cfHeadIcon","","icon","calendar","size","small"],["cf-input","","type","text","size","medium","placeholder","Ch\u1ecdn ng\xe0y kh\u1edfi h\xe0nh",1,"py-[7px]",3,"ngModel","click","ngModelChange"],[1,"hidden"],["cfHint","",3,"hint",4,"ngIf"],["cfDatepicker","","type","text","outsideDays","hidden",1,"w-0","m-0","mr-2","bottom-0",3,"secondaryCalendar","displayMonths","rangeSelection","containerWidth","startDate","canReset","fromDate","toDate","dateSelect"],["dateRange","cfDatepicker"],["textField","name","valueField","value","size","medium",1,"grow-[180]","mr-4",3,"formControl","data","allowSearch"],["textField","name","valueField","value","size","medium",1,"grow-[180]",3,"formControl","data","allowSearch"],[1,"flex","justify-center","gap-x-2","items-center"],[1,"!w-full","md:mr-4","md:hidden"],["cfHeadIcon","","icon","search","size","small"],["size","medium","cf-input","","placeholder","T\xecm ki\u1ebfm trong danh s\xe1ch k\u1ebft qu\u1ea3...",3,"formControl","keydown.enter"],["tableSearchInput",""],[1,"hidden","!w-full","md:mr-4","md:block"],["size","medium","cf-input","","placeholder","T\xecm ki\u1ebfm trong danh s\xe1ch k\u1ebft qu\u1ea3...",3,"formControl","focus"],[1,"gap-x-2","hidden","md:flex","overflow-x-auto","mt-3","pr-4"],[1,"gap-x-1.5","items-center","border","border-neutral-gray-3","rounded-full","px-4","py-[5px]","hidden","md:flex",3,"click"],[1,"text-body-md","whitespace-nowrap"],["icon","filter_alt","size","small",1,"text-neutral-gray-5"],["class","text-body-md whitespace-nowrap",4,"ngIf"],["icon","chevron_down","size","small",1,"text-neutral-gray-5"],[1,"flex","flex-col","justify-end","w-[168px]","shrink-0","md:hidden"],["cf-button","","type","secondary","size","medium",1,"justify-center",3,"disabled","click"],["cfHeadIcon","","icon","search","size","small",1,"mr-2"],[1,"flex","justify-start","mt-4","md:justify-between","md:mr-4"],["size","medium"],[1,"md:flex","hidden","gap-x-1.5",3,"click"],["icon","export","size","small"],[1,"text-body-md"],[1,"py-4","px-[30px]","rounded-lg","md:hidden"],[1,"bg-neutral-white","rounded-lg","shadow-cf-md"],[1,"p-4","flex","justify-between","items-center"],[1,"text-heading-sm"],["cf-button","","type","secondary",3,"click"],["icon","export","size","small",1,"mr-2"],[1,"",3,"fnSort","fnSearch","pageSizeList","listData","pageSize"],["managerTable",""],["cf-thead",""],["cf-th","",1,"whitespace-nowrap",3,"sortName"],["cf-th","","class","whitespace-nowrap",3,"sortName",4,"ngIf"],["cf-th","",3,"sticky"],["cf-td","",1,"py-2","px-1","!bg-neutral-white"],[1,"grow","!w-auto"],["type","text","size","medium","cf-input","","placeholder","L\u1ecdc",3,"ngModel","ngModelChange","input"],["cf-td","",1,"py-2","px-1","!bg-neutral-white",3,"sticky"],["cf-td","","class","py-2 px-1 !bg-neutral-white",3,"sticky",4,"ngIf"],["cf-td","",3,"sticky",4,"ngIf"],["ngFor","",3,"ngForOf"],[1,"hidden","md:flex","p-4","flex-col"],[1,"w-full","flex","items-center","justify-between"],[1,"text-body-md","text-neutral-gray-6"],[1,"flex","gap-x-1.5","text-neutral-gray-6","items-center"],["infinite-scroll","",3,"infiniteScrollDistance","infiniteScrollThrottle","infiniteScrollContainer","scrollWindow","fromRoot","alwaysCallback","scrolled"],[4,"ngFor","ngForOf","ngForTrackBy"],["searchBts",""],["timeDatepickerBottomSheet",""],["airlineBts",""],["timeTypeBts",""],["statusBts",""],["filterBts",""],[4,"ngIf"],["cfHint","",3,"hint"],["cf-td","",3,"sticky"],[1,"border-b","border-neutral-gray-1"],[1,"py-2","px-3"],[1,"w-12","h-6","object-contain",3,"src"],[1,"py-2","px-3","text-body-sm"],["class","py-2 px-3 text-body-sm",4,"ngIf"],[1,"w-[120px]"],["class","py-2 px-3 text-body-sm whitespace-nowrap",4,"ngIf"],[1,"py-2","px-3","text-body-sm","whitespace-nowrap"],[1,"w-[120px]",3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"py-2","px-3","text-body-sm","whitespace-nowrap","text-right"],["cf-td","","class","py-2 px-3",3,"sticky",4,"ngIf"],[1,"whitespace-nowrap"],["type","inverted",1,"whitespace-nowrap",3,"color"],["icon","document","size","small",1,"mr-2.5"],["type","inverted",3,"color"],["icon","error","size","small",1,"mr-2.5"],["cf-td","",1,"py-2","px-3",3,"sticky"],["class","text-espressive-sm text-secondary-3-4 cursor-pointer whitespace-nowrap",3,"click",4,"ngIf"],[1,"text-espressive-sm","text-secondary-3-4","cursor-pointer","whitespace-nowrap",3,"click"],["class","flex flex-col rounded-lg bg-white p-3 mt-3 gap-y-2 shadow-cf-sm",3,"click",4,"ngIf"],[1,"flex","flex-col","rounded-lg","bg-white","p-3","mt-3","gap-y-2","shadow-cf-sm",3,"click"],[1,"flex","justify-between","items-center"],[1,"w-9","h-9","object-contain",3,"src"],[3,"ngSwitch"],[1,"flex","justify-start","items-center"],[1,"text-body-sm","text-neutral-gray-4","w-[104px]"],[1,"text-express-md","text-neutral-gray-6"],["class","flex justify-start items-center",4,"ngIf"],["ngif","","class","flex justify-start items-center",4,"ngIf"],[1,"flex","p-2","justify-between","rounded","bg-neutral-gray-1"],[1,"flex","flex-col","gap-y-2","w-[70px]"],[1,"text-body-sm","text-neutral-gray-4"],[1,"text-express-sm","text-neutral-gray-6"],[1,"py-1","px-2","rounded","flex","gap-x-1","bg-secondary-5-1","w-fit"],["icon","document",1,"text-secondary-5-4"],[1,"text-espressive-sm","text-secondary-5-4"],[1,"py-1","px-2","rounded","flex","gap-x-1","bg-secondary-7-1","w-fit"],["icon","document",1,"text-secondary-7-4"],[1,"text-espressive-sm","text-secondary-7-4"],[1,"py-1","px-2","rounded","flex","gap-x-1","bg-[#ffeceb]","w-fit"],["icon","document",1,"text-secondary-6-4"],[1,"text-espressive-sm","text-primary-1-4"],[1,"py-1","px-2","rounded","flex","gap-x-1","bg-neutral-gray-1","w-fit"],["icon","coupon_slash",1,"text-neutral-black"],[1,"text-espressive-sm","text-neutral-black"],["icon","error",1,"text-secondary-6-4"],[1,"text-espressive-sm","text-secondary-6-4"],["ngif","",1,"flex","justify-start","items-center"],[1,"p-4","w-full","flex","flex-col","justify-between"],[1,"flex","flex-col","gap-y-4"],[1,"!w-full"],["size","medium","cf-input","","placeholder","T\xecm ki\u1ebfm trong danh s\xe1ch k\u1ebft qu\u1ea3",3,"formControl"],["textField","name","valueField","value","size","medium","placeholder","Ch\u1ecdn tr\u1ea1ng th\xe1i",1,"!max-w-none","w-full",3,"status","data","allowSearch","formControl"],["cfLabel","",1,"text-espressive-sm","text-black","mb-1.5"],[1,"!w-full",3,"status"],["cf-button","",1,"w-full","justify-center","gap-x-2",3,"click"],["icon","search","size","small"],[1,"flex","w-full","h-full","flex-col","justify-between"],[1,"grow","overflow-y-hidden","flex","pb-12"],["infinite-scroll","",1,"w-full","flex",3,"infiniteScrollDistance","infiniteScrollThrottle","infiniteScrollUpDistance","scrollWindow","fromRoot","alwaysCallback","infiniteScrollContainer","scrolled","scrolledUp"],["outsideDays","hidden","navigation","none","direction","vertical",1,"",3,"displayMonths","displayMonthsOffset","rangeSelection","fromDate","startDate","toDate","dateSelect"],[1,"p-4","fixed","bottom-0","w-full","right-0","bg-neutral-white"],["cf-button","",1,"justify-center","w-full",3,"click"],[1,"p-4","shadow-cf-lg","w-[280px]","bg-neutral-white","rounded","md:w-full"],[1,"flex","flex-col","gap-y-[9px]","md:gap-y-4"],[1,"flex","flex-col","gap-x-8","gap-y-4",3,"formControl"],["size","medium",3,"value",4,"ngFor","ngForOf"],[1,"hidden","md:block"],["cf-button","",1,"w-full","justify-center",3,"click"],["size","medium",3,"value"],[1,"flex","items-center","gap-x-2"],[1,"w-6","h-6","object-contain",3,"src"],["class","text-body-md-long",4,"ngIf"],[1,"text-body-md-long"],["size","medium","cf-input","","placeholder","Nh\u1eadp h\xe3ng bay",3,"ngModel","ngModelChange"]],template:function(t,i){if(1&t){const n=e.EpF();e.TgZ(0,"div",0)(1,"div",1),e._uU(2,"Qu\u1ea3n l\xfd danh s\xe1ch \u0111\u1eb7t ch\u1ed7"),e.qZA(),e.TgZ(3,"div",2)(4,"div",3)(5,"div",4)(6,"cf-select",5)(7,"label",6),e._uU(8,"L\u1ecdc theo"),e.qZA()(),e.TgZ(9,"div",7)(10,"cf-input-group",8),e._UZ(11,"cf-icon",9),e.TgZ(12,"label",6),e._uU(13,"Th\u1eddi gian"),e.qZA(),e.TgZ(14,"input",10),e.NdJ("click",function(){e.CHM(n);const r=e.MAs(18);return e.KtG(r.open())})("ngModelChange",function(r){return i.dateRangeStr=r}),e.qZA(),e.TgZ(15,"div",11),e.YNc(16,qe,1,1,"cf-input-hint",12),e.qZA()(),e.TgZ(17,"input",13,14),e.NdJ("dateSelect",function(r){e.CHM(n);const l=e.MAs(18);return e.KtG(i.onDateSelection(r,i.searchForm.controls.fromDate,i.searchForm.controls.toDate,l))}),e.qZA()(),e.TgZ(19,"cf-select",15)(20,"label",6),e._uU(21,"H\xe3ng bay"),e.qZA()(),e.TgZ(22,"cf-select",16)(23,"label",6),e._uU(24,"Tr\u1ea1ng th\xe1i"),e.qZA()()(),e.TgZ(25,"div",17)(26,"cf-input-group",18),e._UZ(27,"cf-icon",19),e.TgZ(28,"input",20,21),e.NdJ("keydown.enter",function(){return i.search()}),e.qZA()(),e.TgZ(30,"cf-input-group",22),e._UZ(31,"cf-icon",19),e.TgZ(32,"input",23,21),e.NdJ("focus",function(){e.CHM(n);const r=e.MAs(144);return e.KtG(i.openSearchBts(r))}),e.qZA()()()(),e.TgZ(34,"div",24)(35,"div",25),e.NdJ("click",function(){e.CHM(n);const r=e.MAs(154);return e.KtG(i.openFilterBts(r))}),e.TgZ(36,"div",26),e._uU(37,"B\u1ed9 l\u1ecdc"),e.qZA(),e._UZ(38,"cf-icon",27),e.qZA(),e.TgZ(39,"div",25),e.NdJ("click",function(){e.CHM(n);const r=e.MAs(150);return e.KtG(i.openTimeTypeBts(r))}),e.YNc(40,Oe,2,0,"div",28),e.YNc(41,Je,2,0,"div",28),e._UZ(42,"cf-icon",29),e.qZA(),e.TgZ(43,"div",25),e.NdJ("click",function(){e.CHM(n);const r=e.MAs(146);return e.KtG(i.openTimeSelectBts(r,"TIME_ONLY"))}),e.TgZ(44,"div",26),e._uU(45,"Th\u1eddi gian"),e.qZA(),e._UZ(46,"cf-icon",29),e.qZA(),e.TgZ(47,"div",25),e.NdJ("click",function(){e.CHM(n);const r=e.MAs(148);return e.KtG(i.openAirlineBts(r))}),e.TgZ(48,"div",26),e._uU(49,"H\xe3ng bay"),e.qZA(),e._UZ(50,"cf-icon",29),e.qZA(),e.TgZ(51,"div",25),e.NdJ("click",function(){e.CHM(n);const r=e.MAs(152);return e.KtG(i.openStatusBts(r))}),e.TgZ(52,"div",26),e._uU(53,"Tr\u1ea1ng th\xe1i"),e.qZA(),e._UZ(54,"cf-icon",29),e.qZA()(),e.TgZ(55,"div",30)(56,"button",31),e.NdJ("click",function(){return i.search()}),e._UZ(57,"cf-icon",32),e._uU(58," T\xecm ki\u1ebfm "),e.qZA()()(),e.TgZ(59,"div",33)(60,"cf-checkbox",34),e._uU(61,"\u1ea8n PNR h\u1ebft h\u1ea1n gi\u1eef ch\u1ed7"),e.qZA(),e.TgZ(62,"div",35),e.NdJ("click",function(){e.CHM(n);const r=e.MAs(75);return e.KtG(i.exportExcel(r.data))}),e._UZ(63,"cf-icon",36),e.TgZ(64,"div",37),e._uU(65,"Xu\u1ea5t excel"),e.qZA()()()(),e.TgZ(66,"div",38)(67,"div",39)(68,"div",40)(69,"div",41),e._uU(70,"Qu\u1ea3n l\xfd danh s\xe1ch \u0111\u1eb7t ch\u1ed7"),e.qZA(),e.TgZ(71,"button",42),e.NdJ("click",function(){e.CHM(n);const r=e.MAs(75);return e.KtG(i.exportExcel(r.data))}),e._UZ(72,"cf-icon",43),e._uU(73," Xu\u1ea5t excel "),e.qZA()(),e.TgZ(74,"cf-table",44,45)(76,"thead",46)(77,"th",47),e._uU(78,"H\xe3ng bay"),e.qZA(),e.TgZ(79,"th",47),e._uU(80,"PNR"),e.qZA(),e.YNc(81,Qe,2,1,"th",48),e.YNc(82,He,2,1,"th",48),e.TgZ(83,"th",47),e._uU(84,"Ng\xe0y \u0111\u1eb7t"),e.qZA(),e.TgZ(85,"th",47),e._uU(86,"Ng\xe0y bay"),e.qZA(),e.TgZ(87,"th",47),e._uU(88,"H\xe0nh kh\xe1ch"),e.qZA(),e.TgZ(89,"th",47),e._uU(90,"Tr\u1ea1ng th\xe1i"),e.qZA(),e.TgZ(91,"th",47),e._uU(92,"H\u1ea1n gi\u1eef ch\u1ed7"),e.qZA(),e.TgZ(93,"th",47),e._uU(94,"Ng\u01b0\u1eddi \u0111\u1eb7t"),e.qZA(),e.TgZ(95,"th",47),e._uU(96,"Thu\u1ed9c \u0111\u1ea1i l\xfd"),e.qZA(),e.TgZ(97,"th",47),e._uU(98,"T\u1ed5ng gi\xe1"),e.qZA(),e._UZ(99,"th",49),e.qZA(),e.TgZ(100,"tbody")(101,"tr")(102,"td",50)(103,"cf-input-group",51)(104,"input",52),e.NdJ("ngModelChange",function(r){return i.filterData.airline=r})("input",function(){return i.filterChange()}),e.qZA()()(),e.TgZ(105,"td",53)(106,"cf-input-group",51)(107,"input",52),e.NdJ("ngModelChange",function(r){return i.filterData.pnr=r})("input",function(){return i.filterChange()}),e.qZA()()(),e.YNc(108,je,3,2,"td",54),e.YNc(109,Ye,3,2,"td",54),e.TgZ(110,"td",53)(111,"cf-input-group",51)(112,"input",52),e.NdJ("ngModelChange",function(r){return i.filterData.bookedDate=r})("input",function(){return i.filterChange()}),e.qZA()()(),e.TgZ(113,"td",53)(114,"cf-input-group",51)(115,"input",52),e.NdJ("ngModelChange",function(r){return i.filterData.departDate=r})("input",function(){return i.filterChange()}),e.qZA()()(),e.TgZ(116,"td",53)(117,"cf-input-group",51)(118,"input",52),e.NdJ("ngModelChange",function(r){return i.filterData.passenger=r})("input",function(){return i.filterChange()}),e.qZA()()(),e.TgZ(119,"td",53)(120,"cf-input-group",51)(121,"input",52),e.NdJ("ngModelChange",function(r){return i.filterData.state=r})("input",function(){return i.filterChange()}),e.qZA()()(),e.TgZ(122,"td",53)(123,"cf-input-group",51)(124,"input",52),e.NdJ("ngModelChange",function(r){return i.filterData.timeKeepHolding=r})("input",function(){return i.filterChange()}),e.qZA()()(),e.TgZ(125,"td",53)(126,"cf-input-group",51)(127,"input",52),e.NdJ("ngModelChange",function(r){return i.filterData.user=r})("input",function(){return i.filterChange()}),e.qZA()()(),e.TgZ(128,"td",53)(129,"cf-input-group",51)(130,"input",52),e.NdJ("ngModelChange",function(r){return i.filterData.agentName=r})("input",function(){return i.filterChange()}),e.qZA()()(),e.TgZ(131,"td",53)(132,"cf-input-group",51)(133,"input",52),e.NdJ("ngModelChange",function(r){return i.filterData.totalPrice=r})("input",function(){return i.filterChange()}),e.qZA()()(),e.YNc(134,Ve,1,1,"td",55),e.qZA(),e.YNc(135,rt,37,32,"ng-template",56),e.qZA()()()(),e.TgZ(136,"div",57)(137,"div",58)(138,"div",59),e._uU(139),e.qZA(),e._UZ(140,"div",60),e.qZA(),e.TgZ(141,"div",61),e.NdJ("scrolled",function(){return i.onScrollDown()}),e.YNc(142,_t,2,1,"ng-container",62),e.qZA()(),e.YNc(143,xt,30,16,"ng-template",null,63,e.W1O),e.YNc(145,Tt,7,13,"ng-template",null,64,e.W1O),e.YNc(147,yt,8,2,"ng-template",null,65,e.W1O),e.YNc(149,Dt,8,2,"ng-template",null,66,e.W1O),e.YNc(151,St,8,2,"ng-template",null,67,e.W1O),e.YNc(153,At,37,6,"ng-template",null,68,e.W1O),e.YNc(155,Mt,1,0,"cf-spinner",69)}if(2&t){const n=e.MAs(75);e.xp6(6),e.Q6J("formControl",i.searchForm.controls.timeType)("data",i.timeSelectOption)("allowSearch",!1),e.xp6(4),e.Q6J("status",i.invalidTimeFilter?"error":"default"),e.xp6(4),e.Q6J("ngModel",i.dateRangeStr),e.xp6(2),e.Q6J("ngIf",i.invalidTimeFilter),e.xp6(1),e.Q6J("secondaryCalendar","lunar")("displayMonths",2)("rangeSelection",!0)("containerWidth",600)("startDate",i.startDate)("canReset",!1)("fromDate",i.searchForm.controls.fromDate.value)("toDate",i.searchForm.controls.toDate.value),e.xp6(2),e.Q6J("formControl",i.searchForm.controls.airline)("data",i.airlineSelectOption)("allowSearch",!1),e.xp6(3),e.Q6J("formControl",i.searchForm.controls.stateBooking)("data",i.stateBookingOption)("allowSearch",!1),e.xp6(6),e.Q6J("formControl",i.searchForm.controls.searchText),e.xp6(4),e.Q6J("formControl",i.searchForm.controls.searchText),e.xp6(8),e.Q6J("ngIf","BOOKED_TIME"===i.searchForm.controls.timeType.value),e.xp6(1),e.Q6J("ngIf","DEPART_TIME"===i.searchForm.controls.timeType.value),e.xp6(15),e.Q6J("disabled",i.invalidTimeFilter),e.xp6(18),e.Q6J("fnSort",i.sortChange)("fnSearch",i.searchChange)("pageSizeList",e.l5B(80,wt,e.DdM(76,Bt),e.DdM(77,Nt),e.DdM(78,It),e.DdM(79,Ft)))("listData",i.listOfData)("pageSize",i.pageSize),e.xp6(3),e.Q6J("sortName","airline"),e.xp6(2),e.Q6J("sortName","pnr"),e.xp6(2),e.Q6J("ngIf",i.isShowSupplier),e.xp6(1),e.Q6J("ngIf",i.isShowSupplier),e.xp6(1),e.Q6J("sortName","bookedDate"),e.xp6(2),e.Q6J("sortName","departDate"),e.xp6(2),e.Q6J("sortName","passenger"),e.xp6(2),e.Q6J("sortName","state"),e.xp6(2),e.Q6J("sortName","timeKeepHolding"),e.xp6(2),e.Q6J("sortName","user"),e.xp6(2),e.Q6J("sortName","agentName"),e.xp6(2),e.Q6J("sortName","totalPrice"),e.xp6(2),e.Q6J("sticky","right"),e.xp6(5),e.Q6J("ngModel",i.filterData.airline),e.xp6(1),e.Q6J("sticky","left"),e.xp6(2),e.Q6J("ngModel",i.filterData.pnr),e.xp6(1),e.Q6J("ngIf",i.isShowSupplier),e.xp6(1),e.Q6J("ngIf",i.isShowSupplier),e.xp6(1),e.Q6J("sticky","left"),e.xp6(2),e.Q6J("ngModel",i.filterData.bookedDate),e.xp6(1),e.Q6J("sticky","left"),e.xp6(2),e.Q6J("ngModel",i.filterData.departDate),e.xp6(1),e.Q6J("sticky","left"),e.xp6(2),e.Q6J("ngModel",i.filterData.passenger),e.xp6(1),e.Q6J("sticky","left"),e.xp6(2),e.Q6J("ngModel",i.filterData.state),e.xp6(1),e.Q6J("sticky","left"),e.xp6(2),e.Q6J("ngModel",i.filterData.timeKeepHolding),e.xp6(1),e.Q6J("sticky","left"),e.xp6(2),e.Q6J("ngModel",i.filterData.user),e.xp6(1),e.Q6J("sticky","left"),e.xp6(2),e.Q6J("ngModel",i.filterData.agentName),e.xp6(1),e.Q6J("sticky","left"),e.xp6(2),e.Q6J("ngModel",i.filterData.totalPrice),e.xp6(1),e.Q6J("ngIf",i.viewAllFlightBookingDetail||i.viewOwnFlightBookingDetail),e.xp6(1),e.Q6J("ngForOf",n.partOfdata),e.xp6(4),e.hij("",i.listOfData.length," k\u1ebft qu\u1ea3"),e.xp6(2),e.Q6J("infiniteScrollDistance",1)("infiniteScrollThrottle",300)("infiniteScrollContainer",".main-scroll-bar")("scrollWindow",!1)("fromRoot",!0)("alwaysCallback",!0),e.xp6(1),e.Q6J("ngForOf",i.listOfData)("ngForTrackBy",i.ticketTrackByFn),e.xp6(13),e.Q6J("ngIf",i.isLoading)}},dependencies:[j.q,h.u5,h.Fj,h.JJ,h.On,h.UX,h.oH,D.j$,D.ND,D.BN,D.v2,g.ez,g.sg,g.O5,g.RF,g.n9,g.ED,g.JJ,g.uU,_.AxE,_.Sm8,P.Cs,A.N8,A.Xq,U.rC,U.E_,U.qS,U.zs,Fe.u,z.Rq,z.Ry,we.b,Ue,y.OR,N.DW,P._o,I.T,I.o],encapsulation:2}),o})();function Pt(o,s){1&o&&e._UZ(0,"cf-input-hint",52),2&o&&e.Q6J("hint","Th\u1eddi gian kh\xf4ng \u0111\u01b0\u1ee3c \u0111\u1ec3 tr\u1ed1ng")}function qt(o,s){1&o&&e._UZ(0,"cf-input-hint",52),2&o&&e.Q6J("hint","Th\u1eddi gian kh\xf4ng \u0111\u01b0\u1ee3c \u0111\u1ec3 tr\u1ed1ng")}function Ot(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"tr",53)(1,"td",54),e._uU(2),e.qZA(),e.TgZ(3,"td",54),e._uU(4),e.qZA(),e.TgZ(5,"td",54),e._uU(6),e.qZA(),e.TgZ(7,"td",54),e._uU(8),e.qZA(),e.TgZ(9,"td",54),e._uU(10),e.qZA(),e.TgZ(11,"td",54),e._uU(12),e.qZA(),e.TgZ(13,"td",54),e._uU(14),e.qZA(),e.TgZ(15,"td",54)(16,"div",55),e.NdJ("click",function(){const a=e.CHM(t).$implicit,r=e.oxw();return e.KtG(r.onDeleteOriginalTicket(a))}),e._uU(17," X\xf3a "),e.qZA()()()}if(2&o){const t=s.$implicit;e.xp6(2),e.hij(" ",t.fullNamePax||"-"," "),e.xp6(2),e.hij(" ",t.dob||"-"," "),e.xp6(2),e.hij(" ",t.ticketNumber||"-"," "),e.xp6(2),e.hij(" ",t.fareBasic||"-"," "),e.xp6(2),e.hij(" ",t.journeysInfo||"-"," "),e.xp6(2),e.hij(" ",t.localDepartureTime||"-"," "),e.xp6(2),e.hij(" ",t.issuedTime||"-"," ")}}function Jt(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"div",57)(1,"div",58)(2,"div",59),e._uU(3,"T\xean kh\xe1ch"),e.qZA(),e.TgZ(4,"div",60),e._uU(5),e.qZA()(),e.TgZ(6,"div",58)(7,"div",59),e._uU(8,"Ng\xe0y sinh"),e.qZA(),e.TgZ(9,"div",60),e._uU(10),e.qZA()(),e.TgZ(11,"div",58)(12,"div",59),e._uU(13,"S\u1ed1 v\xe9"),e.qZA(),e.TgZ(14,"div",60),e._uU(15),e.qZA()(),e.TgZ(16,"div",58)(17,"div",59),e._uU(18,"Fare Basis"),e.qZA(),e.TgZ(19,"div",60),e._uU(20),e.qZA()(),e.TgZ(21,"div",58)(22,"div",59),e._uU(23,"H\xe0nh tr\xecnh bay"),e.qZA(),e.TgZ(24,"div",60),e._uU(25),e.qZA()(),e.TgZ(26,"div",58)(27,"div",59),e._uU(28,"Ng\xe0y bay"),e.qZA(),e.TgZ(29,"div",60),e._uU(30),e.qZA()(),e.TgZ(31,"div",58)(32,"div",59),e._uU(33,"Ng\xe0y xu\u1ea5t v\xe9"),e.qZA(),e.TgZ(34,"div",60),e._uU(35),e.qZA()(),e.TgZ(36,"button",61),e.NdJ("click",function(){e.CHM(t);const n=e.oxw().$implicit,a=e.oxw();return e.KtG(a.onDeleteOriginalTicket(n))}),e._uU(37," X\xf3a v\xe9 g\u1ed1c "),e.qZA()()}if(2&o){const t=e.oxw().$implicit;e.xp6(5),e.Oqu(t.fullNamePax),e.xp6(5),e.Oqu(t.dob),e.xp6(5),e.hij("",t.ticketNumber," "),e.xp6(5),e.hij("",t.fareBasic," "),e.xp6(5),e.hij("",t.journeysInfo," "),e.xp6(5),e.hij("",t.localDepartureTime," "),e.xp6(5),e.hij("",t.issuedTime," "),e.xp6(1),e.Q6J("size","small")}}function Qt(o,s){if(1&o&&(e.ynx(0),e.YNc(1,Jt,38,8,"div",56),e.BQk()),2&o){const t=s.index,i=e.oxw();e.xp6(1),e.Q6J("ngIf",t<i.ticketInfiniteScrollCount)}}function Ht(o,s){1&o&&e._UZ(0,"cf-input-hint",52),2&o&&e.Q6J("hint","Th\u1eddi gian kh\xf4ng \u0111\u01b0\u1ee3c \u0111\u1ec3 tr\u1ed1ng")}function jt(o,s){1&o&&e._UZ(0,"cf-input-hint",52),2&o&&e.Q6J("hint","Th\u1eddi gian kh\xf4ng \u0111\u01b0\u1ee3c \u0111\u1ec3 tr\u1ed1ng")}function Yt(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"div",62)(1,"div",63)(2,"cf-input-group",64),e._UZ(3,"cf-icon",19)(4,"input",65,21),e.qZA(),e.TgZ(6,"cf-input-group",66),e._UZ(7,"cf-icon",7),e.TgZ(8,"label",67),e._uU(9,"Ng\xe0y bay"),e.qZA(),e.TgZ(10,"input",9),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(),a=e.MAs(81);return e.KtG(n.openTimeSelectBts(a))})("ngModelChange",function(n){e.CHM(t);const a=e.oxw();return e.KtG(a.departureDateRangeStr=n)}),e.qZA(),e.TgZ(11,"div",10),e.YNc(12,Ht,1,1,"cf-input-hint",11),e.qZA()(),e.TgZ(13,"cf-input-group",66),e._UZ(14,"cf-icon",7),e.TgZ(15,"label",67),e._uU(16,"Ng\xe0y xu\u1ea5t v\xe9"),e.qZA(),e.TgZ(17,"input",14),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(),a=e.MAs(83);return e.KtG(n.openTimeSelectBts(a))})("ngModelChange",function(n){e.CHM(t);const a=e.oxw();return e.KtG(a.issuedDateRangeStr=n)}),e.qZA(),e.TgZ(18,"div",10),e.YNc(19,jt,1,1,"cf-input-hint",11),e.qZA()()(),e.TgZ(20,"div")(21,"button",68),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.search())}),e._UZ(22,"cf-icon",69),e.TgZ(23,"div"),e._uU(24,"T\xecm ki\u1ebfm"),e.qZA()()()()}if(2&o){const t=e.oxw();e.xp6(4),e.Q6J("formControl",t.searchForm.controls.searchText),e.xp6(2),e.Q6J("status",t.invalidDepartureDateFilter?"error":"default"),e.xp6(4),e.Q6J("ngModel",t.departureDateRangeStr),e.xp6(2),e.Q6J("ngIf",t.invalidDepartureDateFilter),e.xp6(1),e.Q6J("status",t.invalidIssueDateFilter?"error":"default"),e.xp6(4),e.Q6J("ngModel",t.issuedDateRangeStr),e.xp6(2),e.Q6J("ngIf",t.invalidIssueDateFilter)}}function Vt(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"div",70)(1,"div",71)(2,"div",72),e.NdJ("scrolled",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.scrollDown())})("scrolledUp",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.scrollUp())}),e.TgZ(3,"cf-datepicker-inline",73),e.NdJ("dateSelect",function(n){e.CHM(t);const a=e.oxw();return e.KtG(a.onMobileDepartureDateSelection(n,a.searchForm.controls.startTimeDeparture,a.searchForm.controls.endTimeDeparture))}),e.qZA()()(),e.TgZ(4,"div",74)(5,"button",75),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.onMobileDatePickerOK())}),e._uU(6,"X\xe1c nh\u1eadn"),e.qZA()()()}if(2&o){const t=e.oxw();e.xp6(2),e.Q6J("infiniteScrollDistance",2)("infiniteScrollThrottle",300)("infiniteScrollUpDistance",2)("scrollWindow",!1)("fromRoot",!0)("alwaysCallback",!0)("infiniteScrollContainer",".ngb-dp-content"),e.xp6(1),e.Q6J("displayMonths",t.numOfMonth)("displayMonthsOffset",t.displayMonthsOffset)("rangeSelection",!0)("fromDate",t.searchForm.controls.startTimeDeparture.value)("startDate",t.startDepartureDate)("toDate",t.searchForm.controls.endTimeDeparture.value)}}function Lt(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"div",70)(1,"div",71)(2,"div",72),e.NdJ("scrolled",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.scrollDown())})("scrolledUp",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.scrollUp())}),e.TgZ(3,"cf-datepicker-inline",73),e.NdJ("dateSelect",function(n){e.CHM(t);const a=e.oxw();return e.KtG(a.onMobileIssueDateSelection(n,a.searchForm.controls.startTimeIssue,a.searchForm.controls.endTimeIssue))}),e.qZA()()(),e.TgZ(4,"div",74)(5,"button",75),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.onMobileDatePickerOK())}),e._uU(6,"X\xe1c nh\u1eadn"),e.qZA()()()}if(2&o){const t=e.oxw();e.xp6(2),e.Q6J("infiniteScrollDistance",2)("infiniteScrollThrottle",300)("infiniteScrollUpDistance",2)("scrollWindow",!1)("fromRoot",!0)("alwaysCallback",!0)("infiniteScrollContainer",".ngb-dp-content"),e.xp6(1),e.Q6J("displayMonths",t.numOfMonth)("displayMonthsOffset",t.displayMonthsOffset)("rangeSelection",!0)("fromDate",t.searchForm.controls.startTimeIssue.value)("startDate",t.startIssuedDate)("toDate",t.searchForm.controls.endTimeIssue.value)}}function Kt(o,s){if(1&o&&(e.TgZ(0,"cf-radio",82),e._uU(1),e.qZA()),2&o){const t=s.$implicit;e.Q6J("value",t.value),e.xp6(1),e.hij(" ",t.text," ")}}function zt(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"div",76)(1,"div",63)(2,"div",77)(3,"cf-radio-group",78),e.YNc(4,Kt,2,2,"cf-radio",79),e.qZA()(),e.TgZ(5,"div",80)(6,"button",81),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.search())}),e._uU(7,"X\xe1c nh\u1eadn"),e.qZA()()()()}if(2&o){const t=e.oxw();e.xp6(3),e.Q6J("formControl",t.searchForm.controls.timeType),e.xp6(1),e.Q6J("ngForOf",t.timeSelectOption)}}function Gt(o,s){1&o&&e._UZ(0,"cf-spinner")}const $t=function(){return{num:25}},Xt=function(){return{num:50}},Rt=function(){return{num:75}},Wt=function(){return{num:100}},ei=function(o,s,t,i){return[o,s,t,i]};let ti=(()=>{class o{constructor(t,i,n,a,r,l,c){this._flightDataService=t,this._fb=i,this._manageBookingService=n,this._modal=a,this._toastService=r,this._bottomSheetService=l,this._mobileDetectService=c,this.timeSelectOption=[],this.invalidDepartureDateFilter=!1,this.invalidIssueDateFilter=!1,this.departureDateRangeStr="",this.issuedDateRangeStr="",this.listOfData=[],this.pageOffset=1,this.pageSize=25,this.numberOfDateFilter=6,this.TICKET_INFINITE_SCROLL_DEFAULT=10,this.TICKET_INFINITE_OFSET_INCREASE=10,this.ticketInfiniteScrollCount=this.TICKET_INFINITE_SCROLL_DEFAULT,this.isLoading=!1,this.totalData=0,this.DEFAULT_NUM_OF_MONTH=4,this.INCREASE_OFFSET=4,this.numOfMonth=this.DEFAULT_NUM_OF_MONTH,this.displayMonthsOffset=0,this.searchChange=(p,T)=>T,this.sortChange=(p,T)=>T}ngOnInit(){this.searchForm=this._fb.group({startTimeDeparture:[null],endTimeDeparture:[null],startTimeIssue:[null],endTimeIssue:[null],searchText:[""]}),this.timeSelectOption=[{text:"Th\u1eddi gian xu\u1ea5t v\xe9",value:"ISSUED_TIME"},{text:"Th\u1eddi gian bay",value:"FLY_TIME"}],this.search()}search(){this.pageOffset=1,this.onGetListOriginTicket()}onGetListOriginTicket(){const t=this.searchForm.value,i={startTimeDeparture:t.startTimeDeparture?B(t.startTimeDeparture).format("YYYY-MM-DD"):"",endTimeDeparture:t.endTimeDeparture?B(t.endTimeDeparture).format("YYYY-MM-DD"):"",startTimeIssue:t.startTimeIssue?B(t.startTimeIssue).format("YYYY-MM-DD"):"",endTimeIssue:t.endTimeIssue?B(t.endTimeIssue).format("YYYY-MM-DD"):"",pageOffset:this.pageOffset,pageSize:this.pageSize,searchText:t.searchText||""};this.isLoading=!0,this._manageBookingService.getListOriginalTicket(i).pipe((0,Z.x)(()=>this.isLoading=!1)).subscribe({next:n=>{var a,r;"OK"===n.status&&(this.listOfData=(null===(a=n.data)||void 0===a?void 0:a.listTicketOriginal.map(l=>{var c;return{id:l.id,fullNamePax:l.fullNamePax,dob:l.dob,ticketNumber:l.ticketNumber,fareBasic:l.fareBasic,journeysInfo:null===(c=l.journeysInfo)||void 0===c?void 0:c.sort((p,T)=>p.leg-T.leg).map(p=>`${p.startPoint} ${p.endPoint}`).join(" | "),localDepartureTime:B(new Date(l.localDepartureTime)).format("DD/MM/YYYY"),issuedTime:B(new Date(l.issuedTime)).format("DD/MM/YYYY")}}))||[],this.totalData=(null===(r=n.data)||void 0===r?void 0:r.total)||0)}})}onDepartureDateSelection(t,i,n,a){if(i.value||n.value)if(i.value&&!n.value&&t&&t.getTime()>=i.value.getTime()){n.setValue(t),a.close(),this.startDepartureDate=i.value;const r=(0,g.p6)(t,"dd/MM/yyyy","vi-VN");this.departureDateRangeStr+=r}else{n.setValue(null),i.setValue(t);const r=(0,g.p6)(t,"dd/MM/yyyy","vi-VN");this.departureDateRangeStr=r+" - "}else{i.setValue(t),n.setValue(null);const r=(0,g.p6)(t,"dd/MM/yyyy","vi-VN");this.departureDateRangeStr=r+" - "}this.invalidDepartureDateFilter=i.invalid||n.invalid}onIssuedDateSelection(t,i,n,a){if(i.value||n.value)if(i.value&&!n.value&&t&&t.getTime()>=i.value.getTime()){n.setValue(t),a.close(),this.startIssuedDate=i.value;const r=(0,g.p6)(t,"dd/MM/yyyy","vi-VN");this.issuedDateRangeStr+=r}else{n.setValue(null),i.setValue(t);const r=(0,g.p6)(t,"dd/MM/yyyy","vi-VN");this.issuedDateRangeStr=r+" - "}else{i.setValue(t),n.setValue(null);const r=(0,g.p6)(t,"dd/MM/yyyy","vi-VN");this.issuedDateRangeStr=r+" - "}this.invalidIssueDateFilter=i.invalid||n.invalid}onDeleteOriginalTicket(t){const i=()=>{const n={id:t.id};this.isLoading=!0,this._manageBookingService.deleteOriginalTicket(n).pipe((0,Z.x)(()=>this.isLoading=!1)).subscribe({next:a=>{"OK"===a.status?(this._toastService.add({severity:"success",summary:"X\xf3a v\xe9 g\u1ed1c th\xe0nh c\xf4ng",detail:"",sticky:!1}),this.search()):this._toastService.add({severity:"error",summary:"X\xf3a v\xe9 g\u1ed1c th\u1ea5t b\u1ea1i. Vui l\xf2ng th\u1eed l\u1ea1i sau",detail:"",sticky:!1})},error:()=>{this._toastService.add({severity:"error",summary:"X\xf3a v\xe9 g\u1ed1c th\u1ea5t b\u1ea1i. Vui l\xf2ng th\u1eed l\u1ea1i sau",detail:"",sticky:!1})}})};if(this._mobileDetectService.isMobile()){const n=this._bottomSheetService.open(y.V0,{headerTitle:"X\xe1c nh\u1eadn x\xf3a v\xe9 g\u1ed1c",leftButtonIcon:"close",leftButtonIconClass:"text-neutral-gray-4",rightButtonIcon:"",data:{title:"",body:`\u0110\u1ed3ng \xfd x\xf3a v\xe9 g\u1ed1c c\u1ee7a kh\xe1ch ${t.fullNamePax}, s\u1ed1 v\xe9 ${t.ticketNumber}`,okText:"X\xe1c nh\u1eadn",cancelText:"\u0110\xf3ng"}});n.containerInstance._leftButtonClick.subscribe(()=>n.dismiss()),n.afterDismissed().subscribe({next:a=>{a&&i()}})}else this._modal.open(y.V0,{title:"X\xe1c nh\u1eadn x\xf3a v\xe9 g\u1ed1c",body:`\u0110\u1ed3ng \xfd x\xf3a v\xe9 g\u1ed1c c\u1ee7a kh\xe1ch ${t.fullNamePax}, s\u1ed1 v\xe9 ${t.ticketNumber}`,okText:"X\xe1c nh\u1eadn",cancelText:"\u0110\xf3ng"}).afterClosed$.subscribe({next:a=>{a.data&&i()}})}resetRangeDate(t,i,n,a){t.setValue(""),i.setValue(""),"DEPARTURE"===a&&(this.departureDateRangeStr=""),"ISSUE"===a&&(this.issuedDateRangeStr="");const r=(0,P.jy)(new Date);setTimeout(()=>{n.navigateTo(r)})}openSearchBts(t){this.btsSearchMobile=this._bottomSheetService.open(t,{headerTitle:"Danh s\xe1ch v\xe9 g\u1ed1c",containerFullHeigh:!0,rightButtonIcon:"",leftButtonIcon:"close",leftButtonIconClass:"text-neutral-gray-4",restoreFocus:!1}),this.btsSearchMobile.containerInstance._leftButtonClick.subscribe(()=>this.btsSearchMobile.dismiss())}openTimeTypeBts(t){this.btsSearchMobile=this._bottomSheetService.open(t,{headerTitle:"Lo\u1ea1i th\u1eddi gian",rightButtonIcon:"close",leftButtonIcon:"",rightButtonIconClass:"text-neutral-gray-4",restoreFocus:!1}),this.btsSearchMobile.containerInstance._rightButtonClick.subscribe(()=>this.btsSearchMobile.dismiss())}openAirlineBts(t){this.btsSearchMobile=this._bottomSheetService.open(t,{headerTitle:"H\xe3ng bay",rightButtonIcon:"close",leftButtonIcon:"",rightButtonIconClass:"text-neutral-gray-4",restoreFocus:!1}),this.btsSearchMobile.containerInstance._rightButtonClick.subscribe(()=>this.btsSearchMobile.dismiss())}openTimeSelectBts(t){if(this._mobileDetectService.mobileSubject.value){const i=this._bottomSheetService.open(t,{headerTitle:"T\xf9y ch\u1ec9nh th\u1eddi gian",leftButtonIcon:"close",leftButtonIconClass:"text-neutral-gray-4",rightButtonIcon:"",containerFullHeigh:!0,restoreFocus:!1});i.afterDismissed().subscribe(n=>{this.displayMonthsOffset=0,this.numOfMonth=0}),i.containerInstance._leftButtonClick.subscribe(n=>{i.dismiss()}),setTimeout(()=>{this.displayMonthsOffset=this.DEFAULT_NUM_OF_MONTH})}}scrollDown(){this.numOfMonth=this.numOfMonth+this.INCREASE_OFFSET}onScrollDown(){this.ticketInfiniteScrollCount+=this.TICKET_INFINITE_OFSET_INCREASE}onMobileDepartureDateSelection(t,i,n){if(i.value||n.value)if(i.value&&!n.value&&t&&t.getTime()>=i.value.getTime()){n.setValue(t),this.startDepartureDate=i.value;const a=(0,g.p6)(t,"dd/MM/yyyy","vi-VN");this.departureDateRangeStr+=a}else if(i.value&&n.value&&t&&t.getTime()>n.value.getTime()){n.setValue(null),i.setValue(t);const a=(0,g.p6)(t,"dd/MM/yyyy","vi-VN");this.departureDateRangeStr=a+" - "}else if(i.value&&n.value&&t&&t.getTime()<n.value.getTime()){i.setValue(t);const a=(0,g.p6)(t,"dd/MM/yyyy","vi-VN"),r=(0,g.p6)(n.value,"dd/MM/yyyy","vi-VN");this.departureDateRangeStr=a+" - "+r}else{i.setValue(t);const a=(0,g.p6)(t,"dd/MM/yyyy","vi-VN");this.departureDateRangeStr=a+" - "}else{i.setValue(t);const a=(0,g.p6)(t,"dd/MM/yyyy","vi-VN");this.departureDateRangeStr=a+" - "}}onMobileIssueDateSelection(t,i,n){if(i.value||n.value)if(i.value&&!n.value&&t&&t.getTime()>=i.value.getTime()){n.setValue(t),this.startIssuedDate=i.value;const a=(0,g.p6)(t,"dd/MM/yyyy","vi-VN");this.issuedDateRangeStr+=a}else if(i.value&&n.value&&t&&t.getTime()>n.value.getTime()){n.setValue(null),i.setValue(t);const a=(0,g.p6)(t,"dd/MM/yyyy","vi-VN");this.issuedDateRangeStr=a+" - "}else if(i.value&&n.value&&t&&t.getTime()<n.value.getTime()){i.setValue(t);const a=(0,g.p6)(t,"dd/MM/yyyy","vi-VN"),r=(0,g.p6)(n.value,"dd/MM/yyyy","vi-VN");this.issuedDateRangeStr=a+" - "+r}else{i.setValue(t);const a=(0,g.p6)(t,"dd/MM/yyyy","vi-VN");this.issuedDateRangeStr=a+" - "}else{i.setValue(t);const a=(0,g.p6)(t,"dd/MM/yyyy","vi-VN");this.issuedDateRangeStr=a+" - "}}onMobileDatePickerOK(){this._bottomSheetService.dismiss()}scrollUp(){this.displayMonthsOffset=this.displayMonthsOffset+this.INCREASE_OFFSET}pageIndexChange(t){this.pageOffset=t,this.search()}ticketTrackByFn(){return""}onImportOriginalTicket(){const t=i=>{this.isLoading=!0,this._manageBookingService.createOriginalTicket(i).pipe((0,Z.x)(()=>this.isLoading=!1)).subscribe({next:n=>{"OK"===n.status?(this._toastService.add({severity:"success",summary:`Nh\u1eadp v\xe9 g\u1ed1c cho h\xe0nh kh\xe1ch ${i.fullNamePax} th\xe0nh c\xf4ng`,detail:"",sticky:!1}),this.search()):this._toastService.add({severity:"error",summary:`Nh\u1eadp v\xe9 g\u1ed1c cho h\xe0nh kh\xe1ch ${i.fullNamePax} th\u1ea5t b\u1ea1i`,detail:"",sticky:!0})},error:()=>{this._toastService.add({severity:"error",summary:`Nh\u1eadp v\xe9 g\u1ed1c cho h\xe0nh kh\xe1ch ${i.fullNamePax} th\u1ea5t b\u1ea1i`,detail:"",sticky:!0})}})};if(this._mobileDetectService.isMobile()){const i=this._bottomSheetService.open(S.r_,{headerTitle:"Nh\u1eadp v\xe9 g\u1ed1c",leftButtonIcon:"close",leftButtonIconClass:"text-neutral-gray-4",rightButtonIcon:"",containerFullHeigh:!0,restoreFocus:!1});i.containerInstance._leftButtonClick.subscribe(()=>i.dismiss()),i.afterDismissed().subscribe({next:n=>{n&&t(n)}})}else this._modal.open(S.r_,{}).afterClosed$.subscribe({next:n=>{n.data&&t(n.data)}})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(q.G),e.Y36(h.qu),e.Y36(H.fB),e.Y36(Q.oE),e.Y36(O.BX),e.Y36(N.a2),e.Y36(L.L))},o.\u0275cmp=e.Xpm({type:o,selectors:[["manage-original-ticket"]],standalone:!0,features:[e.jDz],decls:87,vars:58,consts:[[1,"flex","flex-col","py-4","px-[30px]","bg-white","w-full","md:py-3","md:pl-4","md:pr-0"],[1,"text-heading-sm","text-neutral-gray-6","mb-3","hidden","md:block"],[1,"flex","gap-x-[17px]","md:flex-col"],[1,"flex","flex-col","grow","gap-y-4"],[1,"flex","w-full","items-center","md:hidden"],[1,"flex","mr-2"],[1,"grow",3,"status"],["cfHeadIcon","","icon","calendar","size","small"],["cfLabel",""],["cf-input","","type","text","size","medium","placeholder","Ch\u1ecdn ng\xe0y bay",1,"py-[7px]",3,"ngModel","click","ngModelChange"],[1,"hidden"],["cfHint","",3,"hint",4,"ngIf"],["cfDatepicker","","type","text","outsideDays","hidden",1,"w-0","m-0","mr-2","bottom-0",3,"secondaryCalendar","displayMonths","rangeSelection","containerWidth","startDate","fromDate","toDate","reset","dateSelect"],["departureDateRange","cfDatepicker"],["cf-input","","type","text","size","medium","placeholder","Ch\u1ecdn ng\xe0y xu\u1ea5t v\xe9",1,"py-[7px]",3,"ngModel","click","ngModelChange"],["cfDatepicker","","type","text","outsideDays","hidden",1,"w-0","m-0","mr-2","bottom-0",3,"secondaryCalendar","displayMonths","rangeSelection","containerWidth","startDate","canReset","fromDate","toDate","reset","dateSelect"],["issuedDateRange","cfDatepicker"],[1,"flex","justify-center","gap-x-2","items-center"],[1,"!w-full","md:mr-4","md:hidden"],["cfHeadIcon","","icon","search","size","small"],["size","medium","cf-input","","placeholder","T\xecm ki\u1ebfm theo t\xean kh\xe1ch ho\u1eb7c s\u1ed1 v\xe9 g\u1ed1c",3,"formControl","keydown.enter"],["tableSearchInput",""],[1,"hidden","!w-full","md:mr-4","md:block"],["size","medium","cf-input","","placeholder","T\xecm ki\u1ebfm theo t\xean kh\xe1ch ho\u1eb7c s\u1ed1 v\xe9 g\u1ed1c",3,"formControl","focus"],[1,"gap-x-2","hidden","md:flex","overflow-x-auto","mt-3","pr-4"],[1,"flex","flex-col","justify-end","w-[168px]","shrink-0","md:hidden"],["cf-button","","type","secondary","size","medium",1,"justify-center",3,"click"],["cfHeadIcon","","icon","search","size","small",1,"mr-2"],[1,"justify-end","px-4","hidden","md:flex"],["cf-button","",3,"size","click"],[1,"py-4","px-[30px]","rounded-lg","md:hidden"],[1,"bg-neutral-white","rounded-lg","shadow-cf-md"],[1,"p-4","flex","justify-between","items-center"],[1,"text-heading-sm"],["cf-button","",3,"click"],[1,"",3,"fnSort","fnSearch","pageSizeList","listData","pageSize","totalData","serverSidePagination","pageIndexChange"],["managerTable",""],["cf-thead",""],["cf-th","",1,"whitespace-nowrap",3,"sortName"],["cf-th","",1,"whitespace-nowrap"],["ngFor","",3,"ngForOf"],[1,"hidden","md:flex","p-4","flex-col"],[1,"w-full","flex","items-center","justify-between"],[1,"text-body-md","text-neutral-gray-6"],[1,"flex","gap-x-1.5","text-neutral-gray-6","items-center"],["infinite-scroll","",3,"infiniteScrollDistance","infiniteScrollThrottle","infiniteScrollContainer","scrollWindow","fromRoot","alwaysCallback","scrolled"],[4,"ngFor","ngForOf","ngForTrackBy"],["searchBts",""],["departureTimeDatepickerBottomSheet",""],["issueTimeDatepickerBottomSheet",""],["timeTypeBts",""],[4,"ngIf"],["cfHint","",3,"hint"],[1,"border-b","border-neutral-gray-1"],[1,"py-2","px-3","text-body-sm"],[1,"text-body-md","text-secondary-6-4","cursor-pointer",3,"click"],["class","flex flex-col rounded-lg bg-white p-3 mt-3 gap-y-2 shadow-cf-sm",4,"ngIf"],[1,"flex","flex-col","rounded-lg","bg-white","p-3","mt-3","gap-y-2","shadow-cf-sm"],[1,"flex","justify-start","items-center"],[1,"text-body-sm","text-neutral-gray-4","w-[104px]"],[1,"text-express-md","text-neutral-gray-6"],["cf-button","","type","secondary",1,"justify-center",3,"size","click"],[1,"p-4","w-full","flex","flex-col","justify-between"],[1,"flex","flex-col","gap-y-4"],[1,"!w-full"],["size","medium","cf-input","","placeholder","T\xecm ki\u1ebfm theo t\xean kh\xe1ch",3,"formControl"],[1,"!w-full",3,"status"],["cfLabel","",1,"text-espressive-sm","text-black","mb-1.5"],["cf-button","",1,"w-full","justify-center","gap-x-2",3,"click"],["icon","search","size","small"],[1,"flex","w-full","h-full","flex-col","justify-between"],[1,"grow","overflow-y-hidden","flex","pb-12"],["infinite-scroll","",1,"w-full","flex",3,"infiniteScrollDistance","infiniteScrollThrottle","infiniteScrollUpDistance","scrollWindow","fromRoot","alwaysCallback","infiniteScrollContainer","scrolled","scrolledUp"],["outsideDays","hidden","navigation","none","direction","vertical",1,"",3,"displayMonths","displayMonthsOffset","rangeSelection","fromDate","startDate","toDate","dateSelect"],[1,"p-4","fixed","bottom-0","w-full","right-0","bg-neutral-white"],["cf-button","",1,"justify-center","w-full",3,"click"],[1,"p-4","shadow-cf-lg","w-[280px]","bg-neutral-white","rounded","md:w-full"],[1,"flex","flex-col","gap-y-[9px]","md:gap-y-4"],[1,"flex","flex-col","gap-x-8","gap-y-4",3,"formControl"],["size","medium",3,"value",4,"ngFor","ngForOf"],[1,"hidden","md:block"],["cf-button","",1,"w-full","justify-center",3,"click"],["size","medium",3,"value"]],template:function(t,i){if(1&t){const n=e.EpF();e.TgZ(0,"div",0)(1,"div",1),e._uU(2,"Qu\u1ea3n l\xfd danh s\xe1ch v\xe9 g\u1ed1c"),e.qZA(),e.TgZ(3,"div",2)(4,"div",3)(5,"div",4)(6,"div",5)(7,"cf-input-group",6),e._UZ(8,"cf-icon",7),e.TgZ(9,"label",8),e._uU(10,"Ng\xe0y bay"),e.qZA(),e.TgZ(11,"input",9),e.NdJ("click",function(){e.CHM(n);const r=e.MAs(15);return e.KtG(r.open())})("ngModelChange",function(r){return i.departureDateRangeStr=r}),e.qZA(),e.TgZ(12,"div",10),e.YNc(13,Pt,1,1,"cf-input-hint",11),e.qZA()(),e.TgZ(14,"input",12,13),e.NdJ("reset",function(){e.CHM(n);const r=e.MAs(15);return e.KtG(i.resetRangeDate(i.searchForm.controls.startTimeDeparture,i.searchForm.controls.endTimeDeparture,r,"DEPARTURE"))})("dateSelect",function(r){e.CHM(n);const l=e.MAs(15);return e.KtG(i.onDepartureDateSelection(r,i.searchForm.controls.startTimeDeparture,i.searchForm.controls.endTimeDeparture,l))}),e.qZA()(),e.TgZ(16,"div",5)(17,"cf-input-group",6),e._UZ(18,"cf-icon",7),e.TgZ(19,"label",8),e._uU(20,"Ng\xe0y xu\u1ea5t v\xe9"),e.qZA(),e.TgZ(21,"input",14),e.NdJ("click",function(){e.CHM(n);const r=e.MAs(25);return e.KtG(r.open())})("ngModelChange",function(r){return i.issuedDateRangeStr=r}),e.qZA(),e.TgZ(22,"div",10),e.YNc(23,qt,1,1,"cf-input-hint",11),e.qZA()(),e.TgZ(24,"input",15,16),e.NdJ("reset",function(){e.CHM(n);const r=e.MAs(25);return e.KtG(i.resetRangeDate(i.searchForm.controls.startTimeIssue,i.searchForm.controls.endTimeIssue,r,"ISSUE"))})("dateSelect",function(r){e.CHM(n);const l=e.MAs(25);return e.KtG(i.onIssuedDateSelection(r,i.searchForm.controls.startTimeIssue,i.searchForm.controls.endTimeIssue,l))}),e.qZA()()(),e.TgZ(26,"div",17)(27,"cf-input-group",18),e._UZ(28,"cf-icon",19),e.TgZ(29,"input",20,21),e.NdJ("keydown.enter",function(){return i.search()}),e.qZA()(),e.TgZ(31,"cf-input-group",22),e._UZ(32,"cf-icon",19),e.TgZ(33,"input",23,21),e.NdJ("focus",function(){e.CHM(n);const r=e.MAs(79);return e.KtG(i.openSearchBts(r))}),e.qZA()()()(),e._UZ(35,"div",24),e.TgZ(36,"div",25)(37,"button",26),e.NdJ("click",function(){return i.search()}),e._UZ(38,"cf-icon",27),e._uU(39," T\xecm ki\u1ebfm "),e.qZA()()(),e.TgZ(40,"div",28)(41,"button",29),e.NdJ("click",function(){return i.onImportOriginalTicket()}),e._uU(42," Nh\u1eadp v\xe9 g\u1ed1c "),e.qZA()()(),e.TgZ(43,"div",30)(44,"div",31)(45,"div",32)(46,"div",33),e._uU(47,"Qu\u1ea3n l\xfd danh s\xe1ch v\xe9 g\u1ed1c"),e.qZA(),e.TgZ(48,"button",34),e.NdJ("click",function(){return i.onImportOriginalTicket()}),e._uU(49," Nh\u1eadp v\xe9 g\u1ed1c "),e.qZA()(),e.TgZ(50,"cf-table",35,36),e.NdJ("pageIndexChange",function(r){return i.pageIndexChange(r)}),e.TgZ(52,"thead",37)(53,"th",38),e._uU(54,"T\xean kh\xe1ch"),e.qZA(),e.TgZ(55,"th",38),e._uU(56,"Ng\xe0y sinh"),e.qZA(),e.TgZ(57,"th",38),e._uU(58,"S\u1ed1 v\xe9"),e.qZA(),e.TgZ(59,"th",38),e._uU(60,"Fare Basis"),e.qZA(),e.TgZ(61,"th",38),e._uU(62,"H\xe0nh tr\xecnh bay"),e.qZA(),e.TgZ(63,"th",38),e._uU(64,"Ng\xe0y bay"),e.qZA(),e.TgZ(65,"th",38),e._uU(66,"Ng\xe0y xu\u1ea5t v\xe9"),e.qZA(),e.TgZ(67,"th",39),e._uU(68,"Ch\u1ee9c n\u0103ng"),e.qZA()(),e.TgZ(69,"tbody"),e.YNc(70,Ot,18,7,"ng-template",40),e.qZA()()()(),e.TgZ(71,"div",41)(72,"div",42)(73,"div",43),e._uU(74),e.qZA(),e._UZ(75,"div",44),e.qZA(),e.TgZ(76,"div",45),e.NdJ("scrolled",function(){return i.onScrollDown()}),e.YNc(77,Qt,2,1,"ng-container",46),e.qZA()(),e.YNc(78,Yt,25,7,"ng-template",null,47,e.W1O),e.YNc(80,Vt,7,13,"ng-template",null,48,e.W1O),e.YNc(82,Lt,7,13,"ng-template",null,49,e.W1O),e.YNc(84,zt,8,2,"ng-template",null,50,e.W1O),e.YNc(86,Gt,1,0,"cf-spinner",51)}if(2&t){const n=e.MAs(51);e.xp6(7),e.Q6J("status",i.invalidDepartureDateFilter?"error":"default"),e.xp6(4),e.Q6J("ngModel",i.departureDateRangeStr),e.xp6(2),e.Q6J("ngIf",i.invalidDepartureDateFilter),e.xp6(1),e.Q6J("secondaryCalendar","lunar")("displayMonths",2)("rangeSelection",!0)("containerWidth",600)("startDate",i.startDepartureDate)("fromDate",i.searchForm.controls.startTimeDeparture.value)("toDate",i.searchForm.controls.endTimeDeparture.value),e.xp6(3),e.Q6J("status",i.invalidIssueDateFilter?"error":"default"),e.xp6(4),e.Q6J("ngModel",i.issuedDateRangeStr),e.xp6(2),e.Q6J("ngIf",i.invalidIssueDateFilter),e.xp6(1),e.Q6J("secondaryCalendar","lunar")("displayMonths",2)("rangeSelection",!0)("containerWidth",600)("startDate",i.startIssuedDate)("canReset",!0)("fromDate",i.searchForm.controls.startTimeIssue.value)("toDate",i.searchForm.controls.endTimeIssue.value),e.xp6(5),e.Q6J("formControl",i.searchForm.controls.searchText),e.xp6(4),e.Q6J("formControl",i.searchForm.controls.searchText),e.xp6(8),e.Q6J("size","small"),e.xp6(9),e.Q6J("fnSort",i.sortChange)("fnSearch",i.searchChange)("pageSizeList",e.l5B(53,ei,e.DdM(49,$t),e.DdM(50,Xt),e.DdM(51,Rt),e.DdM(52,Wt)))("listData",i.listOfData)("pageSize",i.pageSize)("totalData",i.totalData)("serverSidePagination",!0),e.xp6(3),e.Q6J("sortName","fullNamePax"),e.xp6(2),e.Q6J("sortName","dob"),e.xp6(2),e.Q6J("sortName","ticketNumber"),e.xp6(2),e.Q6J("sortName","fareBasic"),e.xp6(2),e.Q6J("sortName","journeysInfo"),e.xp6(2),e.Q6J("sortName","localDepartureTime"),e.xp6(2),e.Q6J("sortName","issuedTime"),e.xp6(5),e.Q6J("ngForOf",n.partOfdata),e.xp6(4),e.hij("",i.listOfData.length," k\u1ebft qu\u1ea3"),e.xp6(2),e.Q6J("infiniteScrollDistance",1)("infiniteScrollThrottle",300)("infiniteScrollContainer",".main-scroll-bar")("scrollWindow",!1)("fromRoot",!0)("alwaysCallback",!0),e.xp6(1),e.Q6J("ngForOf",i.listOfData)("ngForTrackBy",i.ticketTrackByFn),e.xp6(9),e.Q6J("ngIf",i.isLoading)}},dependencies:[g.ez,g.sg,g.O5,_.AxE,_.Sm8,A.N8,A.Xq,D.j$,D.ND,D.BN,D.v2,U.rC,U.E_,U.zs,h.u5,h.Fj,h.JJ,h.On,h.UX,h.oH,P._o,P.Cs,z.Rq,z.Ry,y.OR,I.T,I.o],encapsulation:2}),o})();var ii=f(28490);function ni(o,s){1&o&&e._UZ(0,"cf-input-hint",16),2&o&&e.Q6J("hint","M\xe3 \u0111\u1eb7t ch\u1ed7 kh\xf4ng \u0111\u01b0\u1ee3c \u0111\u1ec3 tr\u1ed1ng")}function oi(o,s){1&o&&(e.TgZ(0,"div",17)(1,"div",18)(2,"div",19)(3,"div",20)(4,"div",21),e._UZ(5,"img",22),e.qZA(),e.TgZ(6,"div",23),e._uU(7," Nh\u1eadp m\xe3 \u0111\u1eb7t ch\u1ed7 \u0111\u1ec3 tra c\u1ee9u th\xf4ng tin "),e.qZA(),e.TgZ(8,"div",24),e._uU(9," Vui l\xf2ng nh\u1eadp m\xe3 \u0111\u1eb7t ch\u1ed7 c\u1ea7n tra c\u1ee9u v\xe0o \xf4 b\xean tr\xean v\xe0 ch\u1ecdn n\xfat "),e.TgZ(10,"span",25),e._uU(11,"T\xecm ki\u1ebfm"),e.qZA(),e._uU(12," \u0111\u1ec3 b\u1eaft \u0111\u1ea7u "),e.qZA()()()()())}function ai(o,s){if(1&o&&(e.TgZ(0,"div",17)(1,"div",18)(2,"div",19)(3,"div",20)(4,"div",26),e._UZ(5,"img",27),e.qZA(),e.TgZ(6,"div",23),e._uU(7," Kh\xf4ng c\xf3 k\u1ebft qu\u1ea3 "),e.qZA(),e.TgZ(8,"div",28)(9,"div"),e._uU(10,"Kh\xf4ng t\xecm th\u1ea5y th\xf4ng tin m\xe3 \u0111\u1eb7t ch\u1ed7 "),e.TgZ(11,"strong"),e._uU(12),e.qZA(),e._uU(13,"."),e.qZA(),e.TgZ(14,"div"),e._uU(15,"M\xe3 \u0111\u1eb7t ch\u1ed7 c\xf3 th\u1ec3 kh\xf4ng t\u1ed3n t\u1ea1i trong h\u1ec7 th\u1ed1ng. Vui l\xf2ng ki\u1ec3m tra l\u1ea1i th\xf4ng tin."),e.qZA()()()()()()),2&o){const t=e.oxw();e.xp6(12),e.Oqu(t.bookingCode)}}function ri(o,s){1&o&&(e.TgZ(0,"div",29),e._UZ(1,"ticket-item-skeleton")(2,"ticket-item-skeleton")(3,"ticket-item-skeleton")(4,"ticket-item-skeleton"),e.qZA())}function si(o,s){1&o&&e._UZ(0,"cf-icon",69)}function li(o,s){1&o&&e._UZ(0,"cf-icon",70)}function ci(o,s){if(1&o&&(e.TgZ(0,"div",71),e._UZ(1,"cf-icon",72),e.TgZ(2,"span",73),e._uU(3),e.ALo(4,"date"),e.qZA()()),2&o){const t=s.$implicit;e.xp6(3),e.lnq("",t.startPoint," - ",t.endPoint," (",e.xi3(4,3,t.startTime,"HH:mm - dd/MM/yyyy"),")")}}function ui(o,s){1&o&&e._UZ(0,"div",48)}function gi(o,s){1&o&&e._UZ(0,"cf-icon",74)}function pi(o,s){if(1&o&&(e.TgZ(0,"div",80)(1,"div",81)(2,"div",82)(3,"div",56),e._uU(4,"H\u1ec7 th\u1ed1ng \u0111\u1eb7t ch\u1ed7:"),e.qZA(),e.TgZ(5,"div",83),e._uU(6),e.qZA()(),e.TgZ(7,"div",82)(8,"div",56),e._uU(9,"Ng\xe0y \u0111\u1eb7t:"),e.qZA(),e.TgZ(10,"div",84),e._uU(11),e.qZA()()(),e.TgZ(12,"div",85)(13,"div",82)(14,"div",56),e._uU(15,"H\u1ea1n gi\u1eef ch\u1ed7:"),e.qZA(),e.TgZ(16,"div",84),e._uU(17),e.qZA()(),e.TgZ(18,"div",82)(19,"div",56),e._uU(20,"Ng\u01b0\u1eddi \u0111\u1eb7t:"),e.qZA(),e.TgZ(21,"div",84),e._uU(22),e.qZA()()(),e.TgZ(23,"div",85)(24,"div",82)(25,"div",56),e._uU(26,"H\u1ea1n gi\u1eef gi\xe1:"),e.qZA(),e.TgZ(27,"div",84),e._uU(28),e.qZA()(),e.TgZ(29,"div",82)(30,"div",56),e._uU(31,"Thu\u1ed9c \u0111\u1ea1i l\xfd:"),e.qZA(),e.TgZ(32,"div",84),e._uU(33),e.qZA()()()()),2&o){const t=e.oxw(3);e.xp6(6),e.AsE(" ",t.bookingDetail.airlineSystem," - ",t.bookingDetail.airlineName,""),e.xp6(5),e.hij("",t.bookingDetail.dateBooked||"N/A"," "),e.xp6(6),e.hij("",t.bookingDetail.timeHoldBooking||"N/A"," "),e.xp6(5),e.hij("",t.bookingDetail.userBooked||"N/A"," "),e.xp6(6),e.hij("",t.bookingDetail.timeHoldPricing||"N/A"," "),e.xp6(5),e.hij("",t.bookingDetail.agentName||"N/A"," ")}}function di(o,s){if(1&o&&(e.TgZ(0,"div",86),e._uU(1),e.qZA()),2&o){const t=e.oxw(3);e.xp6(1),e.hij(" ",t.bookingDetail.statusDesc," ")}}function hi(o,s){if(1&o&&(e.TgZ(0,"div")(1,"div")(2,"div",75),e._UZ(3,"cf-icon",76),e.TgZ(4,"span",77),e._uU(5,"Th\xf4ng tin \u0111\u1eb7t ch\u1ed7"),e.qZA()(),e.YNc(6,pi,34,7,"div",78),e.YNc(7,di,2,1,"ng-template",null,79,e.W1O),e.qZA()()),2&o){const t=e.MAs(8),i=e.oxw(2);e.xp6(6),e.Q6J("ngIf","ERROR"!==i.bookingDetail.status)("ngIfElse",t)}}function mi(o,s){if(1&o&&(e.TgZ(0,"tr")(1,"td",87),e._uU(2),e.qZA(),e.TgZ(3,"td",88),e._uU(4),e.qZA(),e.TgZ(5,"td",88),e._uU(6),e.qZA()()),2&o){const t=s.$implicit;e.xp6(2),e.Oqu(t.name),e.xp6(2),e.Oqu(t.type),e.xp6(2),e.Oqu(t.sex)}}function fi(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"div",30)(1,"div",31)(2,"div",32)(3,"div",33)(4,"div",34),e._UZ(5,"div",35),e.TgZ(6,"div",36),e._uU(7,"Chi ti\u1ebft \u0111\u1eb7t ch\u1ed7"),e.qZA()(),e.TgZ(8,"button",37),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.gotoBooking(n.bookingDetail.bookingCodeDisplay,n.bookingDetail.airline))}),e._UZ(9,"cf-icon",38),e._uU(10," M\u1edf booking "),e.qZA()(),e.TgZ(11,"div",39)(12,"div",40)(13,"div",41)(14,"div",42)(15,"div"),e._UZ(16,"img",43),e.qZA(),e.TgZ(17,"div",44)(18,"span",45),e._uU(19),e.qZA(),e.TgZ(20,"span",46),e._uU(21),e.qZA()(),e.TgZ(22,"div",47),e._uU(23),e.qZA()(),e._UZ(24,"div",48),e.TgZ(25,"div",49)(26,"div",50)(27,"span"),e._uU(28),e.qZA(),e.YNc(29,si,1,0,"cf-icon",51),e.YNc(30,li,1,0,"cf-icon",52),e.TgZ(31,"span"),e._uU(32),e.qZA()(),e.YNc(33,ci,5,6,"div",53),e.qZA(),e.YNc(34,ui,1,0,"div",54),e.TgZ(35,"div",55)(36,"div",56),e._uU(37,"M\xe3 \u0111\u1eb7t ch\u1ed7"),e.qZA(),e.TgZ(38,"div",57),e._uU(39),e.qZA()(),e._UZ(40,"div",48),e.TgZ(41,"div",55)(42,"div",56),e._uU(43,"Tr\u1ea1ng th\xe1i"),e.qZA(),e.TgZ(44,"div",58),e.YNc(45,gi,1,0,"cf-icon",59),e.TgZ(46,"div",60)(47,"label",61),e._uU(48),e.qZA()()()()(),e.YNc(49,hi,9,2,"div",62),e.qZA()()(),e.TgZ(50,"div",63)(51,"div",34),e._UZ(52,"div",35),e.TgZ(53,"div",36),e._uU(54,"Th\xf4ng tin h\xe0nh kh\xe1ch"),e.qZA()(),e.TgZ(55,"div",64)(56,"table",65)(57,"thead")(58,"tr",66)(59,"th",67),e._uU(60,"H\xe0nh kh\xe1ch"),e.qZA(),e.TgZ(61,"th",67),e._uU(62,"Lo\u1ea1i kh\xe1ch"),e.qZA(),e.TgZ(63,"th",67),e._uU(64,"Gi\u1edbi t\xednh"),e.qZA()()(),e.TgZ(65,"tbody"),e.YNc(66,mi,7,3,"tr",68),e.qZA()()()()()()}if(2&o){const t=e.oxw();e.xp6(16),e.Q6J("src",t.bookingDetail.airlineLogo,e.LSH),e.xp6(3),e.hij("",t.bookingDetail.airlineSystem," -\xa0"),e.xp6(2),e.Oqu(t.bookingDetail.airlineName),e.xp6(2),e.hij(" H\u1ec7 th\u1ed1ng: ",t.bookingDetail.airlineSystem," "),e.xp6(5),e.hij(" ",t.bookingDetail.startPoint,""),e.xp6(1),e.Q6J("ngIf",1===t.bookingDetail.journeys.length),e.xp6(1),e.Q6J("ngIf",t.bookingDetail.journeys.length>1),e.xp6(2),e.hij(" ",t.bookingDetail.endPoint," "),e.xp6(1),e.Q6J("ngForOf",t.bookingDetail.journeys),e.xp6(1),e.Q6J("ngIf",t.isBooked),e.xp6(5),e.Oqu(t.bookingDetail.bookingCodeDisplay),e.xp6(6),e.Q6J("ngIf",t.isBooked),e.xp6(3),e.Oqu(t.bookingDetail.statusText),e.xp6(1),e.Q6J("ngIf","CANCEL"!==t.bookingDetail.status),e.xp6(17),e.Q6J("ngForOf",t.passengerInfos)}}function _i(o,s){1&o&&(e.TgZ(0,"td",89),e._uU(1,"N/A"),e.qZA())}function vi(o,s){1&o&&(e.TgZ(0,"td",90),e._uU(1,"N/A"),e.qZA())}function xi(o,s){1&o&&(e.TgZ(0,"div",91),e._uU(1,"N/A \u0111"),e.qZA())}let Ti=(()=>{class o{constructor(t,i,n,a,r,l){this._searchFlightService=i,this._flightDataService=n,this._locationDataService=a,this._router=l,this.isLoading=!1,this.isFirst=!0,this.isBooked=!1,this.state="SEARCH",this.passengerInfos=[],r.registerIcons([_.Ffn,_._tC,_.llu,_.QkI])}bookingInputChange(){this.isFirst=!1}validInput(){return!(""===this.bookingCode&&!this.isFirst||!this.isFirst&&this.bookingCode&&""===this.bookingCode.trim())}validBooking(){return this.bookingCode&&""!==this.bookingCode.trim()}getBookingTicket(){this.state="LOADING",this._searchFlightService.searchByPNR({provider:"",bookingCode:this.bookingCode,globalSearch:!0}).pipe((0,Z.x)(()=>this.isLoading=!1)).subscribe({next:t=>{var i,n,a;if(t.success){this.state="SUCCESS",this.passengerInfos=t.data.passengers.map(l=>({name:l.getName(),type:l.getType(),sex:l.getGender(),birthday:l.getBirthday(),membershipNumber:l.membershipNumber||""}));const r=t.data;this.isBooked=["BOOKED","ISSUED"].includes(r.state),this.bookingDetail={bookingCodeDisplay:r.bookingCode,statusText:this.getStatusText(r.state),airline:r.airline,airlineLogo:this._flightDataService.getAirlineLogoByCode(t.data.airline),airlineSystem:t.data.airline,airlineName:t.data.airlineName,status:r.state,startPoint:r.journeys[0]?r.journeys[0].departure.airport.code:"N/A",endPoint:1===r.journeys.length?r.journeys[0].arrival.airport.code:r.journeys[r.journeys.length-1]?r.journeys[r.journeys.length-1].departure.airport.code:"N/A",timeHoldBooking:null!==(i=r.bookDetail)&&void 0!==i&&i.timeHoldBooking?B(r.bookDetail.timeHoldBooking).format("HH:mm, DD/MM/YYYY"):"",timeHoldPricing:null!==(n=r.bookDetail)&&void 0!==n&&n.timeKeepPrice?B(r.bookDetail.timeKeepPrice).format("HH:mm, DD/MM/YYYY"):"N/A",userBooked:r.bookDetail.userBooked?r.bookDetail.userBooked:"",dateBooked:null!==(a=r.bookDetail)&&void 0!==a&&a.dateBooked?B(1e3*r.bookDetail.dateBooked).format("HH:mm, DD/MM/YYYY"):"N/A",agentName:r.bookDetail.agentName?r.bookDetail.agentName:"",journeys:r.journeys.map(l=>({airline:l.airline,airlineLogo:this._flightDataService.getAirlineLogoByCode(l.airline),airlineName:this._flightDataService.getAirlineSystemNameByCode(l.airline),operating:l.operating,operatingName:l.operating,startPoint:l.departure.airport.code,startPointName:this._locationDataService.getCityNameByCode(l.departure.airport.code),endPoint:l.arrival.airport.code,endPointName:this._locationDataService.getCityNameByCode(l.arrival.airport.code),startTime:new Date(1e3*l.departure.scheduleTime),endTime:new Date(1e3*l.arrival.scheduleTime)}))}}else this.state="EMPTY"},error:()=>{this.state="EMPTY"}})}getStatusText(t){switch(t){case"BOOKED":return"\u0110\xe3 gi\u1eef ch\u1ed7";case"ISSUED":return"\u0110\xe3 xu\u1ea5t v\xe9";case"REFUND":return"\u0110\xe3 ho\xe0n";case"CANCEL":return"\u0110\xe3 h\u1ee7y";case"EXPIRED":return"H\u1ebft h\u1ea1n";case"INVALID":return"Kh\xf4ng c\xf2n gi\xe1 tr\u1ecb";case"VOID":return"\u0110\xe3 void";default:return"\u0110\u1eb7t ch\u1ed7 l\u1ed7i"}}gotoBooking(t,i){this._router.navigate([`admin/booking-detail/${i}/${t}`])}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(h.qu),e.Y36($.t7),e.Y36(q.G),e.Y36(ii._),e.Y36(_.KNP),e.Y36(J.F0))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-open-booking"]],standalone:!0,features:[e.jDz],decls:25,vars:8,consts:[[1,"flex-auto","flex","flex-col","w-full"],[1,"bg-white","p-[30px]","w-full","shadow-sm","flex","flex-col","gap-y-[30px]","md:hidden"],[1,"text-heading-lg"],[1,"flex","gap-x-4","items-start"],[1,"!w-full",3,"status"],["cfHeadIcon","","icon","search","size","small"],["size","medium","cf-input","","placeholder","Nh\u1eadp m\xe3 \u0111\u1eb7t ch\u1ed7",3,"ngModel","ngModelChange","keydown.enter"],["cfLabel",""],["cfHint","",3,"hint",4,"ngIf"],["cf-button","","size","medium","type","secondary",1,"whitespace-nowrap","justify-center","mt-[28px]",3,"disabled","click"],["icon","search","size","small",1,"pr-3"],["class","flex-auto w-full max-h-[calc(100vh-152px)] py-4 px-[30px]",4,"ngIf"],["class","p-6",4,"ngIf"],["class","px-6 py-4 md:p-4 md:pb-[90px] flex justify-center",4,"ngIf"],["NATemplate",""],["NARightTemplate",""],["cfHint","",3,"hint"],[1,"flex-auto","w-full","max-h-[calc(100vh-152px)]","py-4","px-[30px]"],[1,"bg-white","w-full","h-full","rounded-lg","md:bg-transparent"],[1,"h-[500px]","flex","flex-col","justify-center","items-center"],[1,"flex","flex-col","justify-center","items-center"],[1,"mb-8"],["src","assets/images/web-page.svg","alt",""],[1,"text-heading-md","text-neutral-black","mb-2"],[1,"text-body-md-short","text-neutral-gray-5","md:text-center"],[1,"text-espressive-md"],[1,"mb-3"],["src","assets/images/empty-result.svg","alt",""],[1,"text-body-md-short","text-neutral-gray-5","text-center"],[1,"p-6"],[1,"px-6","py-4","md:p-4","md:pb-[90px]","flex","justify-center"],[1,"w-[764px]","h-full","flex","flex-col","gap-2"],[1,""],[1,"flex","gap-x-[20px]","mb-4","justify-between","items-center"],[1,"flex","gap-x-[20px]","mb-4"],[1,"w-1","bg-primary-2-4"],[1,"text-heading-md","text-neutral-black"],["cf-button","",3,"click"],["icon","external_link",1,"mr-2"],[1,"flex","flex-col","gap-y-2"],[1,"p-6","bg-white","rounded","shadow-cf-md"],[1,"h-[100px]","flex","justify-between","items-center","mb-6","gap-x-7"],[1,"h-full","w-full","flex","flex-col","gap-y-1.5","justify-center","items-center"],[1,"w-[120px]","h-[60px]","object-contain",3,"src"],[1,"text-body-sm","flex","flex-nowrap"],[1,"text-espressive-sm","whitespace-nowrap"],[1,"whitespace-nowrap"],[1,"h-5","flex","items-center","px-2","bg-neutral-gray-1","rounded","text-espressive-sm","text-neutral-black"],[1,"w-[2px]","h-full","border-l","border-dashed","border-neutral-gray-1"],[1,"h-full","w-[206px]","shrink-0","flex","flex-col","justify-center"],[1,"text-heading-sm","py-1","px-3","bg-neutral-gray-1","flex","gap-x-2","items-center","justify-center","w-fit","rounded"],["icon","arrow_right","size","small",4,"ngIf"],["icon","switch","size","small",4,"ngIf"],["class","mt-3 flex gap-x-2",4,"ngFor","ngForOf"],["class","w-[2px] h-full border-l border-dashed border-neutral-gray-1",4,"ngIf"],[1,"h-full","w-full","flex","flex-col","py-3","gap-[20px]"],[1,"text-body-md","text-neutral-black"],["CfSelectable","",1,"text-heading-lg"],[1,"text-espressive-md","text-neutral-black","flex","gap-2.5","items-center"],["icon","checkbox_checked","size","medium","class","text-secondary-5-4",4,"ngIf"],[1,"flex","flex-col","items-center"],[1,"text-espressive-md","text-neutral-black","whitespace-nowrap"],[4,"ngIf"],[1,"mb-2"],[1,"px-6","pt-6","pb-6","bg-white","rounded","shadow-cf-md"],[1,"table-auto","w-full"],[1,"border-b","border-neutral-gray-1"],[1,"text-left","text-espressive-sm","text-neutral-gray-4","pb-3"],[4,"ngFor","ngForOf"],["icon","arrow_right","size","small"],["icon","switch","size","small"],[1,"mt-3","flex","gap-x-2"],["icon","plane","size","small",1,"text-[#ccc]"],[1,"text-espressive-sm","text-neutral-black"],["icon","checkbox_checked","size","medium",1,"text-secondary-5-4"],[1,"mb-4","mt-6","flex","items-center","gap-x-2"],["icon","circle_information","size","small"],[1,"text-heading-sm","text-neutral-black"],["class","border border-dashed rounded border-neutral-gray-2 p-6 mb-6",4,"ngIf","ngIfElse"],["templateBookingFail",""],[1,"border","border-dashed","rounded","border-neutral-gray-2","p-6","mb-6"],[1,"flex","justify-between","items-center","gap-x-16","border-b","border-neutral-gray-1","pb-2"],[1,"flex","justify-between","items-center","w-full"],[1,"px-3","bg-secondary-5-1","rounded","text-body-md","text-secondary-5-5"],[1,"text-espressive-md","text-neutral-black"],[1,"flex","justify-between","items-center","gap-x-16","border-b","border-neutral-gray-1","py-3"],[1,"w-full","mb-6","bg-secondary-6-1","rounded","text-body-md","py-[10px]","px-[18px]","text-secondary-6-5","break-all"],[1,"text-body-md","text-neutral-black","pt-4","uppercase"],[1,"text-body-md","text-neutral-black","pt-4"],[1,"text-body-md","text-neutral-black","py-3"],[1,"text-right","text-body-md","text-neutral-black","py-3"],[1,"text-heading-md"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._uU(3,"M\u1edf \u0111\u1eb7t ch\u1ed7"),e.qZA(),e.TgZ(4,"div",3)(5,"cf-input-group",4),e._UZ(6,"cf-icon",5),e.TgZ(7,"input",6),e.NdJ("ngModelChange",function(a){return i.bookingCode=a})("ngModelChange",function(){return i.bookingInputChange()})("keydown.enter",function(){return i.getBookingTicket()}),e.qZA(),e.TgZ(8,"label",7),e._uU(9,"M\xe3 \u0111\u1eb7t ch\u1ed7 (PNR)"),e.qZA(),e.YNc(10,ni,1,1,"cf-input-hint",8),e.qZA(),e.TgZ(11,"button",9),e.NdJ("click",function(){return i.getBookingTicket()}),e._UZ(12,"cf-icon",10),e._uU(13," T\xecm ki\u1ebfm "),e.qZA()()(),e.TgZ(14,"div"),e.YNc(15,oi,13,0,"div",11),e.YNc(16,ai,16,1,"div",11),e.YNc(17,ri,5,0,"div",12),e.YNc(18,fi,67,15,"div",13),e.qZA()(),e.YNc(19,_i,2,0,"ng-template",null,14,e.W1O),e.YNc(21,vi,2,0,"ng-template",null,15,e.W1O),e.YNc(23,xi,2,0,"ng-template",null,15,e.W1O)),2&t&&(e.xp6(5),e.Q6J("status",i.validInput()?"default":"error"),e.xp6(2),e.Q6J("ngModel",i.bookingCode),e.xp6(3),e.Q6J("ngIf",!i.validInput()),e.xp6(1),e.Q6J("disabled",!i.validBooking()||"LOADING"===i.state),e.xp6(4),e.Q6J("ngIf","SEARCH"===i.state),e.xp6(1),e.Q6J("ngIf","EMPTY"===i.state),e.xp6(1),e.Q6J("ngIf","LOADING"===i.state),e.xp6(1),e.Q6J("ngIf","SUCCESS"===i.state))},dependencies:[g.ez,g.sg,g.O5,g.uU,h.u5,h.Fj,h.JJ,h.On,D.j$,D.ND,D.BN,D.v2,_.AxE,_.Sm8,A.N8,A.Xq,Y.IA,h.UX,N.DW],encapsulation:2}),o})();function Ci(o,s){1&o&&e._UZ(0,"cf-hint",21),2&o&&e.Q6J("hint","Ch\u01b0a nh\u1eadp m\xe3 \u0111\u1eb7t ch\u1ed7")}function bi(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"div",22)(1,"div",23)(2,"cf-input-group",13),e._UZ(3,"cf-icon",5)(4,"input",24),e.qZA()(),e.TgZ(5,"div")(6,"button",25),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.onMobileSearch())}),e._UZ(7,"cf-icon",26),e.TgZ(8,"div"),e._uU(9,"T\xecm ki\u1ebfm"),e.qZA()()()()}if(2&o){const t=e.oxw();e.xp6(4),e.Q6J("formControl",t.searchForm.controls.searchText)}}function ki(o,s){1&o&&(e.TgZ(0,"div",27)(1,"div",28),e._UZ(2,"img",29),e.qZA(),e.TgZ(3,"div",30)(4,"div",31),e._uU(5,"Nh\u1eadp m\xe3 \u0111\u1eb7t ch\u1ed7 \u0111\u1ec3 ti\u1ebfn h\xe0nh h\u1ee7y v\xe9"),e.qZA(),e.TgZ(6,"div",32),e._uU(7," Vui l\xf2ng nh\u1eadp m\xe3 \u0111\u1eb7t ch\u1ed7 c\u1ee7a b\u1ea1n v\xe0o \xf4 b\xean tr\xean v\xe0 ch\u1ecdn n\xfat T\xecm ki\u1ebfm \u0111\u1ec3 b\u1eaft \u0111\u1ea7u "),e.qZA()()())}function yi(o,s){1&o&&(e.TgZ(0,"div",33),e._UZ(1,"ticket-item-skeleton")(2,"ticket-item-skeleton")(3,"ticket-item-skeleton")(4,"ticket-item-skeleton"),e.qZA())}function Ei(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"div")(1,"div",34)(2,"ticket-number",35),e.NdJ("actionChange",function(n){e.CHM(t);const a=e.oxw();return e.KtG(a.onActionChange(n))}),e.qZA()(),e.TgZ(3,"div",23)(4,"div",36)(5,"div",37)(6,"div",38),e._uU(7,"Gi\u1eef l\u1ea1i h\xe0nh tr\xecnh sau khi void v\xe9?"),e.qZA(),e.TgZ(8,"div",39)(9,"cf-radio-group",40),e.NdJ("ngModelChange",function(n){e.CHM(t);const a=e.oxw();return e.KtG(a.cancelBooking=n)}),e.TgZ(10,"cf-radio",41),e._uU(11,"Kh\xf4ng, h\xe3y h\u1ee7y h\xe0nh tr\xecnh"),e.qZA(),e.TgZ(12,"cf-radio",41),e._uU(13,"C\xf3, gi\u1eef l\u1ea1i \u0111\u1ec3 ti\u1ebfp t\u1ee5c \u0111\u1eb7t v\xe9"),e.qZA()()()()(),e.TgZ(14,"div",42)(15,"button",43),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.onCancel())}),e._uU(16," \u0110\xf3ng "),e.qZA(),e.TgZ(17,"button",44),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.onVoidBooking())}),e._UZ(18,"cf-icon",45),e._uU(19," Void t\u1ea5t c\u1ea3 "),e.qZA()()()()}if(2&o){const t=e.oxw();e.xp6(2),e.Q6J("bookingCode",t.bookingCode)("listTicketNumber",t.listTicketNumber)("totalCharge",t.totalCharge),e.xp6(7),e.Q6J("ngModel",t.cancelBooking),e.xp6(1),e.Q6J("value","true"),e.xp6(2),e.Q6J("value","false")}}function Di(o,s){1&o&&(e.TgZ(0,"div",27)(1,"div",28),e._UZ(2,"img",46),e.qZA(),e.TgZ(3,"div",30)(4,"div",47),e._uU(5,"Kh\xf4ng c\xf3 k\u1ebft qu\u1ea3"),e.qZA(),e.TgZ(6,"div",32)(7,"div"),e._uU(8,"Kh\xf4ng c\xf3 k\u1ebft qu\u1ea3 \u0111\u1ec3 hi\u1ec3n th\u1ecb"),e.qZA(),e.TgZ(9,"div"),e._uU(10,"Vui l\xf2ng th\u1eed l\u1ea1i sau ho\u1eb7c ki\u1ec3m tra l\u1ea1i th\xf4ng tin m\xe3 \u0111\u1eb7t ch\u1ed7"),e.qZA()()()())}function Zi(o,s){1&o&&(e.TgZ(0,"div"),e._UZ(1,"cf-spinner"),e.qZA())}let Si=(()=>{class o{constructor(t,i,n,a,r,l,c,p){this._modal=n,this._toastService=a,this._bookingDetailService=r,this._manageBookingService=l,this._bottomSheetService=c,this._mobileDetectService=p,this.airline="VN",this.listTicketNumber=[],this.state="SEARCH",this.isLoading=!1,this.cancelBooking="true",i.registerIcons([_.esH,_.tLH]),this.searchForm=t.group({searchText:["",h.kI.required]})}onSearch(){this.searchForm.invalid||(this.bookingCode=this.searchForm.value.searchText.trim().toUpperCase(),this.loadTicketVoid())}loadTicketVoid(){this.state="LOADING",this._manageBookingService.getTicketVoid(this.bookingCode).subscribe({next:t=>{t.success&&t.data&&t.data.listTicketNumber.length?(this.state="SUCCESS",this.totalCharge=t.data.totalCharge,this.provider=t.data.provider,this.supplier=t.data.supplier,this.listTicketNumber=t.data.listTicketNumber.map(i=>({ticketNumber:i.ticketNumber,status:i.status,totalCharge:i.totalCharge||0,ticketType:i.ticketType}))):this.state="EMPTY"},error:()=>{this.state="EMPTY"}})}onActionChange(t){if("review"===t.action)return this.onReview(t)}onVoidBooking(){const t={title:"Void v\xe9 th\xe0nh c\xf4ng",content:`<div>T\u1ea5t c\u1ea3 c\xe1c s\u1ed1 v\xe9 h\u1ee3p l\u1ec7 t\u1eeb m\xe3 \u0111\u1eb7t ch\u1ed7 <strong>${this.bookingCode}</strong> \u0111\xe3 \u0111\u01b0\u1ee3c void th\xe0nh c\xf4ng.</div>`,status:"success"},i={title:"Void v\xe9 th\u1ea5t b\u1ea1i",content:"<div>Void s\u1ed1 v\xe9 kh\xf4ng th\xe0nh c\xf4ng. Vui l\xf2ng th\u1eed l\u1ea1i ho\u1eb7c li\xean h\u1ec7 booker \u0111\u1ec3 \u0111\u01b0\u1ee3c h\u1ed7 tr\u1ee3.</div>",status:"error"};this._modal.open(y.V0,{title:"X\xe1c nh\u1eadn h\u1ee7y v\xe9",body:"B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n void c\xe1c s\u1ed1 v\xe9 n\xe0y kh\xf4ng? H\xe0nh \u0111\u1ed9ng n\xe0y kh\xf4ng th\u1ec3 ho\xe0n t\xe1c."}).afterClosed$.subscribe({next:a=>{var r;if(a.data){const c={agentName:JSON.parse(null!==(r=localStorage.getItem("currentUser"))&&void 0!==r?r:"").data.roleId,cancelBooking:"true"===this.cancelBooking,airline:this.airline,bookingCode:this.bookingCode,ticketNumber:this.listTicketNumber.map(p=>p.ticketNumber)};this.isLoading=!0,this._manageBookingService.voidTicket(c).pipe((0,Z.x)(()=>this.isLoading=!1)).subscribe({next:p=>{p.success&&p.data.filter(u=>u.void).length===p.data.length?this._modal.open(y.z5,t).afterClosed$.subscribe({next:()=>{this.state="SEARCH",this.searchForm.reset()}}):this._modal.open(y.z5,i).afterClosed$.subscribe({next:()=>{this.state="SUCCESS",this.loadTicketVoid()}})},error:()=>{this.state="SUCCESS",this._toastService.add({severity:"error",summary:"C\xf3 l\u1ed7i x\u1ea3y ra",detail:"Void v\xe9 kh\xf4ng th\xe0nh c\xf4ng. Vui l\xf2ng li\xean h\u1ec7 booker \u0111\u1ec3 \u0111\u01b0\u1ee3c h\u1ed7 tr\u1ee3!",sticky:!0})}})}}})}onReview(t){var i;if(V.PY&&"VN"===(null===(i=this.airline)||void 0===i?void 0:i.toUpperCase()))return void this._modal.open(y.z5,{title:"Th\xf4ng b\xe1o",content:"H\u1ec7 th\u1ed1ng m\u1edbi Vietnam Airlines ch\u01b0a h\u1ed7 tr\u1ee3 t\xednh n\u0103ng n\xe0y. Xin li\u1ec7n h\u1ec7 booker \u0111\u1ec3 \u0111\u01b0\u1ee3c h\u1ed7 tr\u1ee3",status:"error",cancelText:"\u0110\xf3ng"});const n=this._getCurrentUrl(),a={provider:this.provider,supplier:this.supplier?this.supplier:null,ticketNumber:t.ticketNumber,ticketType:t.ticketType};this.isLoading=!0,this._manageBookingService.getTicketDetail(a).pipe((0,Z.x)(()=>this.isLoading=!1)).subscribe({next:r=>{const l=this.proccessTicketDetail(r.data);if(this._mobileDetectService.isMobile()){const c=this._bottomSheetService.open(S.co,{headerTitle:"Th\xf4ng tin s\u1ed1 v\xe9",rightButtonIcon:"",leftButtonIcon:"close",leftButtonIconClass:"text-neutral-gray-4",data:{ticketDetail:l,isAction:!1,airline:this.airline,bookingCode:this.bookingCode}});c.containerInstance._leftButtonClick.subscribe(()=>c.dismiss())}else this._modal.open(S.co,{ticketDetail:l,curentUrl:n,isAction:!0,airline:this.airline,bookingCode:this.bookingCode})}})}onOpenBooking(){const t=this._getCurrentUrl();window.open(t)}_getCurrentUrl(){return`${window.location.origin}/admin/booking-detail/${this.airline}/${this.bookingCode}`}proccessTicketDetail(t){return{ticketImage:t.ticketImage,ticketInfo:{numCoupons:t.ticketInfo.numCoupons,issueDate:t.ticketInfo.issueDate,createDate:t.ticketInfo.createDate,bookingCode:t.ticketInfo.prn}}}onCancel(){this.searchForm.reset(),this.state="SEARCH"}onMobileSearch(){this._bottomSheetService.dismiss(),this.onSearch()}openSearchBts(t){const i=this._bottomSheetService.open(t,{headerTitle:"T\xecm ki\u1ebfm",rightButtonIcon:"",leftButtonIcon:"close",containerFullHeigh:!0,leftButtonIconClass:"text-neutral-gray-4",restoreFocus:!1});i.containerInstance._leftButtonClick.subscribe(()=>i.dismiss())}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(h.qu),e.Y36(_.KNP),e.Y36(Q.oE),e.Y36(O.BX),e.Y36(te.P3),e.Y36(H.fB),e.Y36(N.a2),e.Y36(L.L))},o.\u0275cmp=e.Xpm({type:o,selectors:[["void-booking-page"]],standalone:!0,features:[e.jDz],decls:29,vars:9,consts:[[1,"flex-auto","flex","flex-col","w-full"],[1,"bg-white","p-[30px]","w-full","shadow-sm","flex","flex-col","gap-y-[30px]","md:hidden"],[1,"text-heading-lg"],[1,"flex","items-stretch","gap-x-3"],[1,"!w-full",3,"status"],["cfHeadIcon","","icon","search","size","small"],["size","medium","cf-input","","placeholder","Nh\u1eadp m\xe3 \u0111\u1eb7t ch\u1ed7 \u0111\u1ec3 b\u1eaft \u0111\u1ea7u vi\u1ec7c t\xecm s\u1ed1 v\xe9...",3,"formControl"],["tableSearchInput",""],["cfHint","",3,"hint",4,"ngIf"],["cf-button","","size","medium","type","secondary",1,"w-[168px]","justify-center",3,"click"],["icon","search","size","small",1,"pr-3"],[1,"hidden","md:flex","flex-col","py-3","px-4","gap-y-3","pr-0","bg-neutral-white"],[1,"text-heading-sm","text-neutral-gray-6"],[1,"hidden","!w-full","md:pr-4","md:block"],["size","medium","cf-input","","placeholder","T\xecm ki\u1ebfm",3,"formControl","focus"],["searchBts",""],[1,"flex-auto","w-full","max-h-[calc(100vh-152px)]","px-[30px]","py-4","md:p-0","md:h-full"],[1,"bg-white","w-full","h-full","rounded-lg","md:bg-transparent"],["class","h-[500px] p-6 flex flex-col gap-y-8 justify-center items-center",4,"ngIf"],["class","p-6",4,"ngIf"],[4,"ngIf"],["cfHint","",3,"hint"],[1,"p-4","w-full","flex","flex-col","justify-between"],[1,"flex","flex-col","gap-y-4"],["size","medium","cf-input","","placeholder","T\xecm ki\u1ebfm",3,"formControl"],["cf-button","",1,"w-full","justify-center","gap-x-2",3,"click"],["icon","search","size","small"],[1,"h-[500px]","p-6","flex","flex-col","gap-y-8","justify-center","items-center"],[1,"flex","justify-center"],["src","assets/images/web-page.svg","alt",""],[1,"text-center"],[1,"text-heading-md","text-neutral-black","mb-4"],[1,"text-body-md-short","text-neutral-gray-5"],[1,"p-6"],[1,"h-fit","w-full"],[3,"bookingCode","listTicketNumber","totalCharge","actionChange"],[1,"md:px-4","md:rounded-lg"],[1,"p-4","flex","flex-col","gap-y-2","bg-neutral-white"],[1,"text-express-md"],[1,"flex","gap-x-6"],[1,"flex","items-center","gap-x-8",3,"ngModel","ngModelChange"],["size","medium",3,"value"],[1,"flex","justify-end","gap-x-4","p-4"],["cf-button","","size","medium","type","secondary",1,"bg-white",3,"click"],["cf-button","","size","medium",3,"click"],["icon","coupon","size","small",1,"mr-2.5","text-white"],["src","assets/images/empty-result.svg","alt",""],[1,"text-heading-md","text-neutral-black","mb-2"]],template:function(t,i){if(1&t){const n=e.EpF();e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._uU(3,"Void v\xe9"),e.qZA(),e.TgZ(4,"div",3)(5,"cf-input-group",4),e._UZ(6,"cf-icon",5)(7,"input",6,7),e.YNc(9,Ci,1,1,"cf-hint",8),e.qZA(),e.TgZ(10,"button",9),e.NdJ("click",function(){return i.onSearch()}),e._UZ(11,"cf-icon",10),e._uU(12," T\xecm ki\u1ebfm "),e.qZA()()(),e.TgZ(13,"div",11)(14,"div",12),e._uU(15,"Void v\xe9"),e.qZA(),e.TgZ(16,"cf-input-group",13),e._UZ(17,"cf-icon",5),e.TgZ(18,"input",14),e.NdJ("focus",function(){e.CHM(n);const r=e.MAs(20);return e.KtG(i.openSearchBts(r))}),e.qZA()()(),e.YNc(19,bi,10,1,"ng-template",null,15,e.W1O),e.TgZ(21,"div",16)(22,"div",17),e.YNc(23,ki,8,0,"div",18),e.YNc(24,yi,5,0,"div",19),e.YNc(25,Ei,20,6,"div",20),e.YNc(26,Di,11,0,"div",18),e.qZA()()(),e._UZ(27,"cf-toast"),e.YNc(28,Zi,2,0,"div",20)}2&t&&(e.xp6(5),e.Q6J("status",i.searchForm.controls.searchText.invalid&&(i.searchForm.controls.searchText.dirty||i.searchForm.controls.searchText.touched)?"error":"default"),e.xp6(2),e.Q6J("formControl",i.searchForm.controls.searchText),e.xp6(2),e.Q6J("ngIf",(null==i.searchForm.controls.searchText.errors?null:i.searchForm.controls.searchText.errors.required)&&(i.searchForm.controls.searchText.dirty||i.searchForm.controls.searchText.touched)),e.xp6(9),e.Q6J("formControl",i.searchForm.controls.searchText),e.xp6(5),e.Q6J("ngIf","SEARCH"===i.state),e.xp6(1),e.Q6J("ngIf","LOADING"===i.state),e.xp6(1),e.Q6J("ngIf","SUCCESS"===i.state),e.xp6(1),e.Q6J("ngIf","EMPTY"===i.state),e.xp6(2),e.Q6J("ngIf",i.isLoading))},dependencies:[g.ez,g.O5,D.j$,D.ND,D.BN,_.AxE,_.Sm8,h.u5,h.Fj,h.JJ,h.On,h.UX,h.oH,A.N8,A.Xq,G.m,O.hj,S.kP,y.OR,Y.IA,N.DW,I.o,I.T],encapsulation:2}),o})();var Ai=f(34541),Mi=f(46779);function Bi(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"button",17),e.NdJ("click",function(){e.CHM(t),e.oxw();const n=e.MAs(17);return e.KtG(n.click())}),e._UZ(1,"cf-icon",18),e._uU(2," Ch\u1ecdn file "),e.qZA()}}function Ni(o,s){1&o&&(e.TgZ(0,"button",19),e._UZ(1,"cf-icon",18),e._uU(2," Ch\u1ecdn file "),e.qZA()),2&o&&e.Q6J("disabled",!0)}function Ii(o,s){1&o&&e._UZ(0,"cf-spinner")}let Fi=(()=>{class o{constructor(t,i,n,a){this._modal=t,this.manageBookingService=i,this.cfIconRegister=n,this._loginService=a,this.airlineControl=new h.NI("VN",h.kI.required),this.selectedFile=null,this.isUploading=!1,this.airlineSelectOption=[{text:"Vietnam Airlines",value:"VN"},{text:"Bamboo Airways",value:"QH"}],n.registerIcons([_.iYu])}onFileSelected(t){var i;const n=t.target;if(null!==(i=n.files)&&void 0!==i&&i.length){const a=n.files[0];this.isValidExcelFile(a)?(this.selectedFile=a,this.onImportTicket()):this.selectedFile=null}}isValidExcelFile(t){return["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel"].includes(t.type)}onImportTicket(){this.selectedFile&&(this.isUploading=!0,this.manageBookingService.importTicketGetStatus({file:this.selectedFile,provider:this.airlineControl.value}).pipe((0,Z.x)(()=>this.isUploading=!1)).subscribe({next:t=>{this.selectedFile=null,this._modal.open(y.V0,"OK"===t.status?{title:"Upload file th\xe0nh c\xf4ng",body:`H\u1ec7 th\u1ed1ng s\u1ebd x\u1eed l\xfd v\xe0 g\u1eedi tr\u1ea3 k\u1ebft qu\u1ea3 qua email ${this._loginService.currentUserSubject.value.data.email}.`,okText:"\u0110\xf3ng",hasCancel:!1,hasIcon:!1}:{title:"Upload file th\u1ea5t b\u1ea1i",body:"C\xf3 l\u1ed7i x\u1ea3y ra, vui l\xf2ng ki\u1ec3m tra l\u1ea1i file t\u1ea3i l\xean ho\u1eb7c th\u1eed l\u1ea1i sau.",okText:"\u0110\xf3ng",hasCancel:!1,hasIcon:!1})},error:()=>{this.selectedFile=null,this._modal.open(y.V0,{title:"Upload file th\u1ea5t b\u1ea1i",body:"C\xf3 l\u1ed7i x\u1ea3y ra, vui l\xf2ng ki\u1ec3m tra l\u1ea1i file t\u1ea3i l\xean ho\u1eb7c th\u1eed l\u1ea1i sau.",okText:"\u0110\xf3ng",hasCancel:!1,hasIcon:!1})}}))}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(Q.oE),e.Y36(H.fB),e.Y36(_.KNP),e.Y36(Mi.r))},o.\u0275cmp=e.Xpm({type:o,selectors:[["import-ticket-page"]],standalone:!0,features:[e.jDz],decls:21,vars:8,consts:[[1,"flex-auto","flex","flex-col","w-full"],[1,"bg-white","p-[30px]","w-full","shadow-sm","flex","flex-col","gap-y-[30px]"],[1,"text-heading-lg"],[1,"flex","flex-col","gap-y-4"],[1,"flex","gap-x-3","items-start"],["textField","text","valueField","value","size","medium","placeholder","Ch\u1ecdn h\xe3ng",1,"w-[180px]",3,"status","formControl","data","allowSearch"],["cfLabel","",1,"text-espressive-sm","text-black","mb-1.5",3,"CfRequired"],[1,"p-[30px]"],[1,"bg-neutral-white","flex","flex-col","gap-y-4","justify-center","items-center","w-full","max-h-[calc(100vh-152px)]","p-[60px]"],["src","assets/images/no-data.svg","alt","empty",1,"w-[160px]","h-160px","object-contain"],[1,"text-body-md"],[1,"flex","items-center","gap-x-4"],["type","file","accept",".xlsx, .xls",1,"hidden",3,"change"],["fileInput",""],["cf-button","","size","medium","type","secondary",3,"click",4,"ngIf"],["cf-button","","size","medium","type","secondary",3,"disabled",4,"ngIf"],[4,"ngIf"],["cf-button","","size","medium","type","secondary",3,"click"],["icon","export","size","small",1,"mr-2.5"],["cf-button","","size","medium","type","secondary",3,"disabled"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._uU(3,"L\u1ea5y tr\u1ea1ng th\xe1i v\xe9"),e.qZA(),e.TgZ(4,"div",3)(5,"div",4)(6,"cf-select",5)(7,"label",6),e._uU(8," Ch\u1ecdn h\xe3ng bay "),e.qZA()()()()(),e.TgZ(9,"div",7)(10,"div",8)(11,"div"),e._UZ(12,"img",9),e.qZA(),e.TgZ(13,"div",10),e._uU(14,"H\xe3ng VN/QH ch\u1ecdn file ch\u1ee9a s\u1ed1 v\xe9, h\xe3ng VJ/VU ch\u1ecdn file ch\u1ee9a th\xf4ng tin m\xe3 \u0111\u1eb7t ch\u1ed7"),e.qZA(),e.TgZ(15,"div",11)(16,"input",12,13),e.NdJ("change",function(a){return i.onFileSelected(a)}),e.qZA(),e.YNc(18,Bi,3,0,"button",14),e.YNc(19,Ni,3,1,"button",15),e.qZA()()()(),e.YNc(20,Ii,1,0,"cf-spinner",16)),2&t&&(e.xp6(6),e.Q6J("status",i.airlineControl.invalid&&(i.airlineControl.dirty||i.airlineControl.touched)?"error":"default")("formControl",i.airlineControl)("data",i.airlineSelectOption)("allowSearch",!1),e.xp6(1),e.Q6J("CfRequired",!0),e.xp6(11),e.Q6J("ngIf",i.airlineControl.valid),e.xp6(1),e.Q6J("ngIf",i.airlineControl.invalid),e.xp6(1),e.Q6J("ngIf",i.isUploading))},dependencies:[g.ez,g.O5,j.q,h.u5,h.JJ,h.UX,h.oH,A.N8,A.Xq,_.AxE,_.Sm8,y.OR,Ai.C],encapsulation:2}),o})()}}]);